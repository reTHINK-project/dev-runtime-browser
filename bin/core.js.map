{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/dexie/dist/dexie.js","node_modules/process/browser.js","node_modules/runtime-core/dist/minibus.js","node_modules/runtime-core/dist/sandbox.js","node_modules/service-framework/dist/PersistenceManager.js","node_modules/service-framework/dist/RuntimeCatalogue.js","node_modules/service-framework/dist/StorageManager.js","node_modules/timers-browserify/main.js","node_modules/urijs/src/IPv6.js","node_modules/urijs/src/SecondLevelDomains.js","node_modules/urijs/src/URI.js","node_modules/urijs/src/punycode.js","src/Request.js","src/RuntimeCapabilities.js","src/RuntimeFactory.js","src/SandboxApp.js","src/Sandboxes.js","src/admin/IdentitiesGUI.js","src/admin/PoliciesGUI.js","src/admin/PoliciesManager.js","src/core.js"],"names":[],"mappings":"AAAA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC5/IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AClyEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACrhBA;;;;;;;;;;;;;;;;;;;;;;AAsBA,IAAM,UAAU,EAAC,KAAK,KAAN,EAAa,MAAM;AACnC;;;;;;;AAOA;;;AARgB,CAAhB;IAWM,O;AAEL,oBAAc;AAAA;;AA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","file":"core.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","(function (global, factory) {\n   typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n   typeof define === 'function' && define.amd ? define(factory) :\n   (global.Dexie = factory());\n}(this, (function () { 'use strict';\n\n/*\r\n* Dexie.js - a minimalistic wrapper for IndexedDB\r\n* ===============================================\r\n*\r\n* By David Fahlander, david.fahlander@gmail.com\r\n*\r\n* Version 1.5.1, Tue Nov 01 2016\r\n* www.dexie.com\r\n* Apache License Version 2.0, January 2004, http://www.apache.org/licenses/\r\n*/\nvar keys = Object.keys;\nvar isArray = Array.isArray;\nvar _global = typeof self !== 'undefined' ? self : typeof window !== 'undefined' ? window : global;\n\nfunction extend(obj, extension) {\n    if (typeof extension !== 'object') return obj;\n    keys(extension).forEach(function (key) {\n        obj[key] = extension[key];\n    });\n    return obj;\n}\n\nvar getProto = Object.getPrototypeOf;\nvar _hasOwn = {}.hasOwnProperty;\nfunction hasOwn(obj, prop) {\n    return _hasOwn.call(obj, prop);\n}\n\nfunction props(proto, extension) {\n    if (typeof extension === 'function') extension = extension(getProto(proto));\n    keys(extension).forEach(function (key) {\n        setProp(proto, key, extension[key]);\n    });\n}\n\nfunction setProp(obj, prop, functionOrGetSet, options) {\n    Object.defineProperty(obj, prop, extend(functionOrGetSet && hasOwn(functionOrGetSet, \"get\") && typeof functionOrGetSet.get === 'function' ? { get: functionOrGetSet.get, set: functionOrGetSet.set, configurable: true } : { value: functionOrGetSet, configurable: true, writable: true }, options));\n}\n\nfunction derive(Child) {\n    return {\n        from: function (Parent) {\n            Child.prototype = Object.create(Parent.prototype);\n            setProp(Child.prototype, \"constructor\", Child);\n            return {\n                extend: props.bind(null, Child.prototype)\n            };\n        }\n    };\n}\n\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\nfunction getPropertyDescriptor(obj, prop) {\n    var pd = getOwnPropertyDescriptor(obj, prop),\n        proto;\n    return pd || (proto = getProto(obj)) && getPropertyDescriptor(proto, prop);\n}\n\nvar _slice = [].slice;\nfunction slice(args, start, end) {\n    return _slice.call(args, start, end);\n}\n\nfunction override(origFunc, overridedFactory) {\n    return overridedFactory(origFunc);\n}\n\nfunction doFakeAutoComplete(fn) {\n    var to = setTimeout(fn, 1000);\n    clearTimeout(to);\n}\n\nfunction assert(b) {\n    if (!b) throw new Error(\"Assertion Failed\");\n}\n\nfunction asap(fn) {\n    if (_global.setImmediate) setImmediate(fn);else setTimeout(fn, 0);\n}\n\n\n\n/** Generate an object (hash map) based on given array.\r\n * @param extractor Function taking an array item and its index and returning an array of 2 items ([key, value]) to\r\n *        instert on the resulting object for each item in the array. If this function returns a falsy value, the\r\n *        current item wont affect the resulting object.\r\n */\nfunction arrayToObject(array, extractor) {\n    return array.reduce(function (result, item, i) {\n        var nameAndValue = extractor(item, i);\n        if (nameAndValue) result[nameAndValue[0]] = nameAndValue[1];\n        return result;\n    }, {});\n}\n\nfunction trycatcher(fn, reject) {\n    return function () {\n        try {\n            fn.apply(this, arguments);\n        } catch (e) {\n            reject(e);\n        }\n    };\n}\n\nfunction tryCatch(fn, onerror, args) {\n    try {\n        fn.apply(null, args);\n    } catch (ex) {\n        onerror && onerror(ex);\n    }\n}\n\nfunction getByKeyPath(obj, keyPath) {\n    // http://www.w3.org/TR/IndexedDB/#steps-for-extracting-a-key-from-a-value-using-a-key-path\n    if (hasOwn(obj, keyPath)) return obj[keyPath]; // This line is moved from last to first for optimization purpose.\n    if (!keyPath) return obj;\n    if (typeof keyPath !== 'string') {\n        var rv = [];\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            var val = getByKeyPath(obj, keyPath[i]);\n            rv.push(val);\n        }\n        return rv;\n    }\n    var period = keyPath.indexOf('.');\n    if (period !== -1) {\n        var innerObj = obj[keyPath.substr(0, period)];\n        return innerObj === undefined ? undefined : getByKeyPath(innerObj, keyPath.substr(period + 1));\n    }\n    return undefined;\n}\n\nfunction setByKeyPath(obj, keyPath, value) {\n    if (!obj || keyPath === undefined) return;\n    if ('isFrozen' in Object && Object.isFrozen(obj)) return;\n    if (typeof keyPath !== 'string' && 'length' in keyPath) {\n        assert(typeof value !== 'string' && 'length' in value);\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            setByKeyPath(obj, keyPath[i], value[i]);\n        }\n    } else {\n        var period = keyPath.indexOf('.');\n        if (period !== -1) {\n            var currentKeyPath = keyPath.substr(0, period);\n            var remainingKeyPath = keyPath.substr(period + 1);\n            if (remainingKeyPath === \"\") {\n                if (value === undefined) delete obj[currentKeyPath];else obj[currentKeyPath] = value;\n            } else {\n                var innerObj = obj[currentKeyPath];\n                if (!innerObj) innerObj = obj[currentKeyPath] = {};\n                setByKeyPath(innerObj, remainingKeyPath, value);\n            }\n        } else {\n            if (value === undefined) delete obj[keyPath];else obj[keyPath] = value;\n        }\n    }\n}\n\nfunction delByKeyPath(obj, keyPath) {\n    if (typeof keyPath === 'string') setByKeyPath(obj, keyPath, undefined);else if ('length' in keyPath) [].map.call(keyPath, function (kp) {\n        setByKeyPath(obj, kp, undefined);\n    });\n}\n\nfunction shallowClone(obj) {\n    var rv = {};\n    for (var m in obj) {\n        if (hasOwn(obj, m)) rv[m] = obj[m];\n    }\n    return rv;\n}\n\nfunction deepClone(any) {\n    if (!any || typeof any !== 'object') return any;\n    var rv;\n    if (isArray(any)) {\n        rv = [];\n        for (var i = 0, l = any.length; i < l; ++i) {\n            rv.push(deepClone(any[i]));\n        }\n    } else if (any instanceof Date) {\n        rv = new Date();\n        rv.setTime(any.getTime());\n    } else {\n        rv = any.constructor ? Object.create(any.constructor.prototype) : {};\n        for (var prop in any) {\n            if (hasOwn(any, prop)) {\n                rv[prop] = deepClone(any[prop]);\n            }\n        }\n    }\n    return rv;\n}\n\nfunction getObjectDiff(a, b, rv, prfx) {\n    // Compares objects a and b and produces a diff object.\n    rv = rv || {};\n    prfx = prfx || '';\n    keys(a).forEach(function (prop) {\n        if (!hasOwn(b, prop)) rv[prfx + prop] = undefined; // Property removed\n        else {\n                var ap = a[prop],\n                    bp = b[prop];\n                if (typeof ap === 'object' && typeof bp === 'object' && ap && bp && ap.constructor === bp.constructor)\n                    // Same type of object but its properties may have changed\n                    getObjectDiff(ap, bp, rv, prfx + prop + \".\");else if (ap !== bp) rv[prfx + prop] = b[prop]; // Primitive value changed\n            }\n    });\n    keys(b).forEach(function (prop) {\n        if (!hasOwn(a, prop)) {\n            rv[prfx + prop] = b[prop]; // Property added\n        }\n    });\n    return rv;\n}\n\n// If first argument is iterable or array-like, return it as an array\nvar iteratorSymbol = typeof Symbol !== 'undefined' && Symbol.iterator;\nvar getIteratorOf = iteratorSymbol ? function (x) {\n    var i;\n    return x != null && (i = x[iteratorSymbol]) && i.apply(x);\n} : function () {\n    return null;\n};\n\nvar NO_CHAR_ARRAY = {};\n// Takes one or several arguments and returns an array based on the following criteras:\n// * If several arguments provided, return arguments converted to an array in a way that\n//   still allows javascript engine to optimize the code.\n// * If single argument is an array, return a clone of it.\n// * If this-pointer equals NO_CHAR_ARRAY, don't accept strings as valid iterables as a special\n//   case to the two bullets below.\n// * If single argument is an iterable, convert it to an array and return the resulting array.\n// * If single argument is array-like (has length of type number), convert it to an array.\nfunction getArrayOf(arrayLike) {\n    var i, a, x, it;\n    if (arguments.length === 1) {\n        if (isArray(arrayLike)) return arrayLike.slice();\n        if (this === NO_CHAR_ARRAY && typeof arrayLike === 'string') return [arrayLike];\n        if (it = getIteratorOf(arrayLike)) {\n            a = [];\n            while (x = it.next(), !x.done) {\n                a.push(x.value);\n            }return a;\n        }\n        if (arrayLike == null) return [arrayLike];\n        i = arrayLike.length;\n        if (typeof i === 'number') {\n            a = new Array(i);\n            while (i--) {\n                a[i] = arrayLike[i];\n            }return a;\n        }\n        return [arrayLike];\n    }\n    i = arguments.length;\n    a = new Array(i);\n    while (i--) {\n        a[i] = arguments[i];\n    }return a;\n}\n\nvar concat = [].concat;\nfunction flatten(a) {\n    return concat.apply([], a);\n}\n\nfunction nop() {}\nfunction mirror(val) {\n    return val;\n}\nfunction pureFunctionChain(f1, f2) {\n    // Enables chained events that takes ONE argument and returns it to the next function in chain.\n    // This pattern is used in the hook(\"reading\") event.\n    if (f1 == null || f1 === mirror) return f2;\n    return function (val) {\n        return f2(f1(val));\n    };\n}\n\nfunction callBoth(on1, on2) {\n    return function () {\n        on1.apply(this, arguments);\n        on2.apply(this, arguments);\n    };\n}\n\nfunction hookCreatingChain(f1, f2) {\n    // Enables chained events that takes several arguments and may modify first argument by making a modification and then returning the same instance.\n    // This pattern is used in the hook(\"creating\") event.\n    if (f1 === nop) return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res !== undefined) arguments[0] = res;\n        var onsuccess = this.onsuccess,\n            // In case event listener has set this.onsuccess\n        onerror = this.onerror; // In case event listener has set this.onerror\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess) this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror) this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res2 !== undefined ? res2 : res;\n    };\n}\n\nfunction hookDeletingChain(f1, f2) {\n    if (f1 === nop) return f2;\n    return function () {\n        f1.apply(this, arguments);\n        var onsuccess = this.onsuccess,\n            // In case event listener has set this.onsuccess\n        onerror = this.onerror; // In case event listener has set this.onerror\n        this.onsuccess = this.onerror = null;\n        f2.apply(this, arguments);\n        if (onsuccess) this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror) this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n    };\n}\n\nfunction hookUpdatingChain(f1, f2) {\n    if (f1 === nop) return f2;\n    return function (modifications) {\n        var res = f1.apply(this, arguments);\n        extend(modifications, res); // If f1 returns new modifications, extend caller's modifications with the result before calling next in chain.\n        var onsuccess = this.onsuccess,\n            // In case event listener has set this.onsuccess\n        onerror = this.onerror; // In case event listener has set this.onerror\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess) this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror) this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res === undefined ? res2 === undefined ? undefined : res2 : extend(res, res2);\n    };\n}\n\nfunction reverseStoppableEventChain(f1, f2) {\n    if (f1 === nop) return f2;\n    return function () {\n        if (f2.apply(this, arguments) === false) return false;\n        return f1.apply(this, arguments);\n    };\n}\n\n\n\nfunction promisableChain(f1, f2) {\n    if (f1 === nop) return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res && typeof res.then === 'function') {\n            var thiz = this,\n                i = arguments.length,\n                args = new Array(i);\n            while (i--) {\n                args[i] = arguments[i];\n            }return res.then(function () {\n                return f2.apply(thiz, args);\n            });\n        }\n        return f2.apply(this, arguments);\n    };\n}\n\n// By default, debug will be true only if platform is a web platform and its page is served from localhost.\n// When debug = true, error's stacks will contain asyncronic long stacks.\nvar debug = typeof location !== 'undefined' &&\n// By default, use debug mode if served from localhost.\n/^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);\n\nfunction setDebug(value, filter) {\n    debug = value;\n    libraryFilter = filter;\n}\n\nvar libraryFilter = function () {\n    return true;\n};\n\nvar NEEDS_THROW_FOR_STACK = !new Error(\"\").stack;\n\nfunction getErrorWithStack() {\n    \"use strict\";\n\n    if (NEEDS_THROW_FOR_STACK) try {\n        // Doing something naughty in strict mode here to trigger a specific error\n        // that can be explicitely ignored in debugger's exception settings.\n        // If we'd just throw new Error() here, IE's debugger's exception settings\n        // will just consider it as \"exception thrown by javascript code\" which is\n        // something you wouldn't want it to ignore.\n        getErrorWithStack.arguments;\n        throw new Error(); // Fallback if above line don't throw.\n    } catch (e) {\n        return e;\n    }\n    return new Error();\n}\n\nfunction prettyStack(exception, numIgnoredFrames) {\n    var stack = exception.stack;\n    if (!stack) return \"\";\n    numIgnoredFrames = numIgnoredFrames || 0;\n    if (stack.indexOf(exception.name) === 0) numIgnoredFrames += (exception.name + exception.message).split('\\n').length;\n    return stack.split('\\n').slice(numIgnoredFrames).filter(libraryFilter).map(function (frame) {\n        return \"\\n\" + frame;\n    }).join('');\n}\n\nfunction deprecated(what, fn) {\n    return function () {\n        console.warn(what + \" is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. \" + prettyStack(getErrorWithStack(), 1));\n        return fn.apply(this, arguments);\n    };\n}\n\nvar dexieErrorNames = ['Modify', 'Bulk', 'OpenFailed', 'VersionChange', 'Schema', 'Upgrade', 'InvalidTable', 'MissingAPI', 'NoSuchDatabase', 'InvalidArgument', 'SubTransaction', 'Unsupported', 'Internal', 'DatabaseClosed', 'IncompatiblePromise'];\n\nvar idbDomErrorNames = ['Unknown', 'Constraint', 'Data', 'TransactionInactive', 'ReadOnly', 'Version', 'NotFound', 'InvalidState', 'InvalidAccess', 'Abort', 'Timeout', 'QuotaExceeded', 'Syntax', 'DataClone'];\n\nvar errorList = dexieErrorNames.concat(idbDomErrorNames);\n\nvar defaultTexts = {\n    VersionChanged: \"Database version changed by other database connection\",\n    DatabaseClosed: \"Database has been closed\",\n    Abort: \"Transaction aborted\",\n    TransactionInactive: \"Transaction has already completed or failed\"\n};\n\n//\n// DexieError - base class of all out exceptions.\n//\nfunction DexieError(name, msg) {\n    // Reason we don't use ES6 classes is because:\n    // 1. It bloats transpiled code and increases size of minified code.\n    // 2. It doesn't give us much in this case.\n    // 3. It would require sub classes to call super(), which\n    //    is not needed when deriving from Error.\n    this._e = getErrorWithStack();\n    this.name = name;\n    this.message = msg;\n}\n\nderive(DexieError).from(Error).extend({\n    stack: {\n        get: function () {\n            return this._stack || (this._stack = this.name + \": \" + this.message + prettyStack(this._e, 2));\n        }\n    },\n    toString: function () {\n        return this.name + \": \" + this.message;\n    }\n});\n\nfunction getMultiErrorMessage(msg, failures) {\n    return msg + \". Errors: \" + failures.map(function (f) {\n        return f.toString();\n    }).filter(function (v, i, s) {\n        return s.indexOf(v) === i;\n    }) // Only unique error strings\n    .join('\\n');\n}\n\n//\n// ModifyError - thrown in WriteableCollection.modify()\n// Specific constructor because it contains members failures and failedKeys.\n//\nfunction ModifyError(msg, failures, successCount, failedKeys) {\n    this._e = getErrorWithStack();\n    this.failures = failures;\n    this.failedKeys = failedKeys;\n    this.successCount = successCount;\n}\nderive(ModifyError).from(DexieError);\n\nfunction BulkError(msg, failures) {\n    this._e = getErrorWithStack();\n    this.name = \"BulkError\";\n    this.failures = failures;\n    this.message = getMultiErrorMessage(msg, failures);\n}\nderive(BulkError).from(DexieError);\n\n//\n//\n// Dynamically generate error names and exception classes based\n// on the names in errorList.\n//\n//\n\n// Map of {ErrorName -> ErrorName + \"Error\"}\nvar errnames = errorList.reduce(function (obj, name) {\n    return obj[name] = name + \"Error\", obj;\n}, {});\n\n// Need an alias for DexieError because we're gonna create subclasses with the same name.\nvar BaseException = DexieError;\n// Map of {ErrorName -> exception constructor}\nvar exceptions = errorList.reduce(function (obj, name) {\n    // Let the name be \"DexieError\" because this name may\n    // be shown in call stack and when debugging. DexieError is\n    // the most true name because it derives from DexieError,\n    // and we cannot change Function.name programatically without\n    // dynamically create a Function object, which would be considered\n    // 'eval-evil'.\n    var fullName = name + \"Error\";\n    function DexieError(msgOrInner, inner) {\n        this._e = getErrorWithStack();\n        this.name = fullName;\n        if (!msgOrInner) {\n            this.message = defaultTexts[name] || fullName;\n            this.inner = null;\n        } else if (typeof msgOrInner === 'string') {\n            this.message = msgOrInner;\n            this.inner = inner || null;\n        } else if (typeof msgOrInner === 'object') {\n            this.message = msgOrInner.name + ' ' + msgOrInner.message;\n            this.inner = msgOrInner;\n        }\n    }\n    derive(DexieError).from(BaseException);\n    obj[name] = DexieError;\n    return obj;\n}, {});\n\n// Use ECMASCRIPT standard exceptions where applicable:\nexceptions.Syntax = SyntaxError;\nexceptions.Type = TypeError;\nexceptions.Range = RangeError;\n\nvar exceptionMap = idbDomErrorNames.reduce(function (obj, name) {\n    obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\n\nfunction mapError(domError, message) {\n    if (!domError || domError instanceof DexieError || domError instanceof TypeError || domError instanceof SyntaxError || !domError.name || !exceptionMap[domError.name]) return domError;\n    var rv = new exceptionMap[domError.name](message || domError.message, domError);\n    if (\"stack\" in domError) {\n        // Derive stack from inner exception if it has a stack\n        setProp(rv, \"stack\", { get: function () {\n                return this.inner.stack;\n            } });\n    }\n    return rv;\n}\n\nvar fullNameExceptions = errorList.reduce(function (obj, name) {\n    if ([\"Syntax\", \"Type\", \"Range\"].indexOf(name) === -1) obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\n\nfullNameExceptions.ModifyError = ModifyError;\nfullNameExceptions.DexieError = DexieError;\nfullNameExceptions.BulkError = BulkError;\n\nfunction Events(ctx) {\n    var evs = {};\n    var rv = function (eventName, subscriber) {\n        if (subscriber) {\n            // Subscribe. If additional arguments than just the subscriber was provided, forward them as well.\n            var i = arguments.length,\n                args = new Array(i - 1);\n            while (--i) {\n                args[i - 1] = arguments[i];\n            }evs[eventName].subscribe.apply(null, args);\n            return ctx;\n        } else if (typeof eventName === 'string') {\n            // Return interface allowing to fire or unsubscribe from event\n            return evs[eventName];\n        }\n    };\n    rv.addEventType = add;\n\n    for (var i = 1, l = arguments.length; i < l; ++i) {\n        add(arguments[i]);\n    }\n\n    return rv;\n\n    function add(eventName, chainFunction, defaultFunction) {\n        if (typeof eventName === 'object') return addConfiguredEvents(eventName);\n        if (!chainFunction) chainFunction = reverseStoppableEventChain;\n        if (!defaultFunction) defaultFunction = nop;\n\n        var context = {\n            subscribers: [],\n            fire: defaultFunction,\n            subscribe: function (cb) {\n                if (context.subscribers.indexOf(cb) === -1) {\n                    context.subscribers.push(cb);\n                    context.fire = chainFunction(context.fire, cb);\n                }\n            },\n            unsubscribe: function (cb) {\n                context.subscribers = context.subscribers.filter(function (fn) {\n                    return fn !== cb;\n                });\n                context.fire = context.subscribers.reduce(chainFunction, defaultFunction);\n            }\n        };\n        evs[eventName] = rv[eventName] = context;\n        return context;\n    }\n\n    function addConfiguredEvents(cfg) {\n        // events(this, {reading: [functionChain, nop]});\n        keys(cfg).forEach(function (eventName) {\n            var args = cfg[eventName];\n            if (isArray(args)) {\n                add(eventName, cfg[eventName][0], cfg[eventName][1]);\n            } else if (args === 'asap') {\n                // Rather than approaching event subscription using a functional approach, we here do it in a for-loop where subscriber is executed in its own stack\n                // enabling that any exception that occur wont disturb the initiator and also not nescessary be catched and forgotten.\n                var context = add(eventName, mirror, function fire() {\n                    // Optimazation-safe cloning of arguments into args.\n                    var i = arguments.length,\n                        args = new Array(i);\n                    while (i--) {\n                        args[i] = arguments[i];\n                    } // All each subscriber:\n                    context.subscribers.forEach(function (fn) {\n                        asap(function fireEvent() {\n                            fn.apply(null, args);\n                        });\n                    });\n                });\n            } else throw new exceptions.InvalidArgument(\"Invalid event config\");\n        });\n    }\n}\n\n//\n// Promise Class for Dexie library\n//\n// I started out writing this Promise class by copying promise-light (https://github.com/taylorhakes/promise-light) by\n// https://github.com/taylorhakes - an A+ and ECMASCRIPT 6 compliant Promise implementation.\n//\n// Modifications needed to be done to support indexedDB because it wont accept setTimeout()\n// (See discussion: https://github.com/promises-aplus/promises-spec/issues/45) .\n// This topic was also discussed in the following thread: https://github.com/promises-aplus/promises-spec/issues/45\n//\n// This implementation will not use setTimeout or setImmediate when it's not needed. The behavior is 100% Promise/A+ compliant since\n// the caller of new Promise() can be certain that the promise wont be triggered the lines after constructing the promise.\n//\n// In previous versions this was fixed by not calling setTimeout when knowing that the resolve() or reject() came from another\n// tick. In Dexie v1.4.0, I've rewritten the Promise class entirely. Just some fragments of promise-light is left. I use\n// another strategy now that simplifies everything a lot: to always execute callbacks in a new tick, but have an own microTick\n// engine that is used instead of setImmediate() or setTimeout().\n// Promise class has also been optimized a lot with inspiration from bluebird - to avoid closures as much as possible.\n// Also with inspiration from bluebird, asyncronic stacks in debug mode.\n//\n// Specific non-standard features of this Promise class:\n// * Async static context support (Promise.PSD)\n// * Promise.follow() method built upon PSD, that allows user to track all promises created from current stack frame\n//   and below + all promises that those promises creates or awaits.\n// * Detect any unhandled promise in a PSD-scope (PSD.onunhandled). \n//\n// David Fahlander, https://github.com/dfahlander\n//\n\n// Just a pointer that only this module knows about.\n// Used in Promise constructor to emulate a private constructor.\nvar INTERNAL = {};\n\n// Async stacks (long stacks) must not grow infinitely.\nvar LONG_STACKS_CLIP_LIMIT = 100;\nvar MAX_LONG_STACKS = 20;\nvar stack_being_generated = false;\n\n/* The default \"nextTick\" function used only for the very first promise in a promise chain.\r\n   As soon as then promise is resolved or rejected, all next tasks will be executed in micro ticks\r\n   emulated in this module. For indexedDB compatibility, this means that every method needs to \r\n   execute at least one promise before doing an indexedDB operation. Dexie will always call \r\n   db.ready().then() for every operation to make sure the indexedDB event is started in an\r\n   emulated micro tick.\r\n*/\nvar schedulePhysicalTick = _global.setImmediate ?\n// setImmediate supported. Those modern platforms also supports Function.bind().\nsetImmediate.bind(null, physicalTick) : _global.MutationObserver ?\n// MutationObserver supported\nfunction () {\n    var hiddenDiv = document.createElement(\"div\");\n    new MutationObserver(function () {\n        physicalTick();\n        hiddenDiv = null;\n    }).observe(hiddenDiv, { attributes: true });\n    hiddenDiv.setAttribute('i', '1');\n} :\n// No support for setImmediate or MutationObserver. No worry, setTimeout is only called\n// once time. Every tick that follows will be our emulated micro tick.\n// Could have uses setTimeout.bind(null, 0, physicalTick) if it wasnt for that FF13 and below has a bug \nfunction () {\n    setTimeout(physicalTick, 0);\n};\n\n// Confifurable through Promise.scheduler.\n// Don't export because it would be unsafe to let unknown\n// code call it unless they do try..catch within their callback.\n// This function can be retrieved through getter of Promise.scheduler though,\n// but users must not do Promise.scheduler (myFuncThatThrows exception)!\nvar asap$1 = function (callback, args) {\n    microtickQueue.push([callback, args]);\n    if (needsNewPhysicalTick) {\n        schedulePhysicalTick();\n        needsNewPhysicalTick = false;\n    }\n};\n\nvar isOutsideMicroTick = true;\nvar needsNewPhysicalTick = true;\nvar unhandledErrors = [];\nvar rejectingErrors = [];\nvar currentFulfiller = null;\nvar rejectionMapper = mirror; // Remove in next major when removing error mapping of DOMErrors and DOMExceptions\n\nvar globalPSD = {\n    global: true,\n    ref: 0,\n    unhandleds: [],\n    onunhandled: globalError,\n    //env: null, // Will be set whenever leaving a scope using wrappers.snapshot()\n    finalize: function () {\n        this.unhandleds.forEach(function (uh) {\n            try {\n                globalError(uh[0], uh[1]);\n            } catch (e) {}\n        });\n    }\n};\n\nvar PSD = globalPSD;\n\nvar microtickQueue = []; // Callbacks to call in this or next physical tick.\nvar numScheduledCalls = 0; // Number of listener-calls left to do in this physical tick.\nvar tickFinalizers = []; // Finalizers to call when there are no more async calls scheduled within current physical tick.\n\n// Wrappers are not being used yet. Their framework is functioning and can be used\n// to replace environment during a PSD scope (a.k.a. 'zone').\n/* **KEEP** export var wrappers = (() => {\r\n    var wrappers = [];\r\n\r\n    return {\r\n        snapshot: () => {\r\n            var i = wrappers.length,\r\n                result = new Array(i);\r\n            while (i--) result[i] = wrappers[i].snapshot();\r\n            return result;\r\n        },\r\n        restore: values => {\r\n            var i = wrappers.length;\r\n            while (i--) wrappers[i].restore(values[i]);\r\n        },\r\n        wrap: () => wrappers.map(w => w.wrap()),\r\n        add: wrapper => {\r\n            wrappers.push(wrapper);\r\n        }\r\n    };\r\n})();\r\n*/\n\nfunction Promise(fn) {\n    if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n    this._listeners = [];\n    this.onuncatched = nop; // Deprecate in next major. Not needed. Better to use global error handler.\n\n    // A library may set `promise._lib = true;` after promise is created to make resolve() or reject()\n    // execute the microtask engine implicitely within the call to resolve() or reject().\n    // To remain A+ compliant, a library must only set `_lib=true` if it can guarantee that the stack\n    // only contains library code when calling resolve() or reject().\n    // RULE OF THUMB: ONLY set _lib = true for promises explicitely resolving/rejecting directly from\n    // global scope (event handler, timer etc)!\n    this._lib = false;\n    // Current async scope\n    var psd = this._PSD = PSD;\n\n    if (debug) {\n        this._stackHolder = getErrorWithStack();\n        this._prev = null;\n        this._numPrev = 0; // Number of previous promises (for long stacks)\n        linkToPreviousPromise(this, currentFulfiller);\n    }\n\n    if (typeof fn !== 'function') {\n        if (fn !== INTERNAL) throw new TypeError('Not a function');\n        // Private constructor (INTERNAL, state, value).\n        // Used internally by Promise.resolve() and Promise.reject().\n        this._state = arguments[1];\n        this._value = arguments[2];\n        if (this._state === false) handleRejection(this, this._value); // Map error, set stack and addPossiblyUnhandledError().\n        return;\n    }\n\n    this._state = null; // null (=pending), false (=rejected) or true (=resolved)\n    this._value = null; // error or result\n    ++psd.ref; // Refcounting current scope\n    executePromiseTask(this, fn);\n}\n\nprops(Promise.prototype, {\n\n    then: function (onFulfilled, onRejected) {\n        var _this = this;\n\n        var rv = new Promise(function (resolve, reject) {\n            propagateToListener(_this, new Listener(onFulfilled, onRejected, resolve, reject));\n        });\n        debug && (!this._prev || this._state === null) && linkToPreviousPromise(rv, this);\n        return rv;\n    },\n\n    _then: function (onFulfilled, onRejected) {\n        // A little tinier version of then() that don't have to create a resulting promise.\n        propagateToListener(this, new Listener(null, null, onFulfilled, onRejected));\n    },\n\n    catch: function (onRejected) {\n        if (arguments.length === 1) return this.then(null, onRejected);\n        // First argument is the Error type to catch\n        var type = arguments[0],\n            handler = arguments[1];\n        return typeof type === 'function' ? this.then(null, function (err) {\n            return (\n                // Catching errors by its constructor type (similar to java / c++ / c#)\n                // Sample: promise.catch(TypeError, function (e) { ... });\n                err instanceof type ? handler(err) : PromiseReject(err)\n            );\n        }) : this.then(null, function (err) {\n            return (\n                // Catching errors by the error.name property. Makes sense for indexedDB where error type\n                // is always DOMError but where e.name tells the actual error type.\n                // Sample: promise.catch('ConstraintError', function (e) { ... });\n                err && err.name === type ? handler(err) : PromiseReject(err)\n            );\n        });\n    },\n\n    finally: function (onFinally) {\n        return this.then(function (value) {\n            onFinally();\n            return value;\n        }, function (err) {\n            onFinally();\n            return PromiseReject(err);\n        });\n    },\n\n    // Deprecate in next major. Needed only for db.on.error.\n    uncaught: function (uncaughtHandler) {\n        var _this2 = this;\n\n        // Be backward compatible and use \"onuncatched\" as the event name on this.\n        // Handle multiple subscribers through reverseStoppableEventChain(). If a handler returns `false`, bubbling stops.\n        this.onuncatched = reverseStoppableEventChain(this.onuncatched, uncaughtHandler);\n        // In case caller does this on an already rejected promise, assume caller wants to point out the error to this promise and not\n        // a previous promise. Reason: the prevous promise may lack onuncatched handler. \n        if (this._state === false && unhandledErrors.indexOf(this) === -1) {\n            // Replace unhandled error's destinaion promise with this one!\n            unhandledErrors.some(function (p, i, l) {\n                return p._value === _this2._value && (l[i] = _this2);\n            });\n            // Actually we do this shit because we need to support db.on.error() correctly during db.open(). If we deprecate db.on.error, we could\n            // take away this piece of code as well as the onuncatched and uncaught() method.\n        }\n        return this;\n    },\n\n    stack: {\n        get: function () {\n            if (this._stack) return this._stack;\n            try {\n                stack_being_generated = true;\n                var stacks = getStack(this, [], MAX_LONG_STACKS);\n                var stack = stacks.join(\"\\nFrom previous: \");\n                if (this._state !== null) this._stack = stack; // Stack may be updated on reject.\n                return stack;\n            } finally {\n                stack_being_generated = false;\n            }\n        }\n    }\n});\n\nfunction Listener(onFulfilled, onRejected, resolve, reject) {\n    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n    this.resolve = resolve;\n    this.reject = reject;\n    this.psd = PSD;\n}\n\n// Promise Static Properties\nprops(Promise, {\n    all: function () {\n        var values = getArrayOf.apply(null, arguments); // Supports iterables, implicit arguments and array-like.\n        return new Promise(function (resolve, reject) {\n            if (values.length === 0) resolve([]);\n            var remaining = values.length;\n            values.forEach(function (a, i) {\n                return Promise.resolve(a).then(function (x) {\n                    values[i] = x;\n                    if (! --remaining) resolve(values);\n                }, reject);\n            });\n        });\n    },\n\n    resolve: function (value) {\n        if (value instanceof Promise) return value;\n        if (value && typeof value.then === 'function') return new Promise(function (resolve, reject) {\n            value.then(resolve, reject);\n        });\n        return new Promise(INTERNAL, true, value);\n    },\n\n    reject: PromiseReject,\n\n    race: function () {\n        var values = getArrayOf.apply(null, arguments);\n        return new Promise(function (resolve, reject) {\n            values.map(function (value) {\n                return Promise.resolve(value).then(resolve, reject);\n            });\n        });\n    },\n\n    PSD: {\n        get: function () {\n            return PSD;\n        },\n        set: function (value) {\n            return PSD = value;\n        }\n    },\n\n    newPSD: newScope,\n\n    usePSD: usePSD,\n\n    scheduler: {\n        get: function () {\n            return asap$1;\n        },\n        set: function (value) {\n            asap$1 = value;\n        }\n    },\n\n    rejectionMapper: {\n        get: function () {\n            return rejectionMapper;\n        },\n        set: function (value) {\n            rejectionMapper = value;\n        } // Map reject failures\n    },\n\n    follow: function (fn) {\n        return new Promise(function (resolve, reject) {\n            return newScope(function (resolve, reject) {\n                var psd = PSD;\n                psd.unhandleds = []; // For unhandled standard- or 3rd party Promises. Checked at psd.finalize()\n                psd.onunhandled = reject; // Triggered directly on unhandled promises of this library.\n                psd.finalize = callBoth(function () {\n                    var _this3 = this;\n\n                    // Unhandled standard or 3rd part promises are put in PSD.unhandleds and\n                    // examined upon scope completion while unhandled rejections in this Promise\n                    // will trigger directly through psd.onunhandled\n                    run_at_end_of_this_or_next_physical_tick(function () {\n                        _this3.unhandleds.length === 0 ? resolve() : reject(_this3.unhandleds[0]);\n                    });\n                }, psd.finalize);\n                fn();\n            }, resolve, reject);\n        });\n    },\n\n    on: Events(null, { \"error\": [reverseStoppableEventChain, defaultErrorHandler] // Default to defaultErrorHandler\n    })\n\n});\n\nvar PromiseOnError = Promise.on.error;\nPromiseOnError.subscribe = deprecated(\"Promise.on('error')\", PromiseOnError.subscribe);\nPromiseOnError.unsubscribe = deprecated(\"Promise.on('error').unsubscribe\", PromiseOnError.unsubscribe);\n\n/**\r\n* Take a potentially misbehaving resolver function and make sure\r\n* onFulfilled and onRejected are only called once.\r\n*\r\n* Makes no guarantees about asynchrony.\r\n*/\nfunction executePromiseTask(promise, fn) {\n    // Promise Resolution Procedure:\n    // https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    try {\n        fn(function (value) {\n            if (promise._state !== null) return;\n            if (value === promise) throw new TypeError('A promise cannot be resolved with itself.');\n            var shouldExecuteTick = promise._lib && beginMicroTickScope();\n            if (value && typeof value.then === 'function') {\n                executePromiseTask(promise, function (resolve, reject) {\n                    value instanceof Promise ? value._then(resolve, reject) : value.then(resolve, reject);\n                });\n            } else {\n                promise._state = true;\n                promise._value = value;\n                propagateAllListeners(promise);\n            }\n            if (shouldExecuteTick) endMicroTickScope();\n        }, handleRejection.bind(null, promise)); // If Function.bind is not supported. Exception is handled in catch below\n    } catch (ex) {\n        handleRejection(promise, ex);\n    }\n}\n\nfunction handleRejection(promise, reason) {\n    rejectingErrors.push(reason);\n    if (promise._state !== null) return;\n    var shouldExecuteTick = promise._lib && beginMicroTickScope();\n    reason = rejectionMapper(reason);\n    promise._state = false;\n    promise._value = reason;\n    debug && reason !== null && typeof reason === 'object' && !reason._promise && tryCatch(function () {\n        var origProp = getPropertyDescriptor(reason, \"stack\");\n        reason._promise = promise;\n        setProp(reason, \"stack\", {\n            get: function () {\n                return stack_being_generated ? origProp && (origProp.get ? origProp.get.apply(reason) : origProp.value) : promise.stack;\n            }\n        });\n    });\n    // Add the failure to a list of possibly uncaught errors\n    addPossiblyUnhandledError(promise);\n    propagateAllListeners(promise);\n    if (shouldExecuteTick) endMicroTickScope();\n}\n\nfunction propagateAllListeners(promise) {\n    //debug && linkToPreviousPromise(promise);\n    var listeners = promise._listeners;\n    promise._listeners = [];\n    for (var i = 0, len = listeners.length; i < len; ++i) {\n        propagateToListener(promise, listeners[i]);\n    }\n    var psd = promise._PSD;\n    --psd.ref || psd.finalize(); // if psd.ref reaches zero, call psd.finalize();\n    if (numScheduledCalls === 0) {\n        // If numScheduledCalls is 0, it means that our stack is not in a callback of a scheduled call,\n        // and that no deferreds where listening to this rejection or success.\n        // Since there is a risk that our stack can contain application code that may\n        // do stuff after this code is finished that may generate new calls, we cannot\n        // call finalizers here.\n        ++numScheduledCalls;\n        asap$1(function () {\n            if (--numScheduledCalls === 0) finalizePhysicalTick(); // Will detect unhandled errors\n        }, []);\n    }\n}\n\nfunction propagateToListener(promise, listener) {\n    if (promise._state === null) {\n        promise._listeners.push(listener);\n        return;\n    }\n\n    var cb = promise._state ? listener.onFulfilled : listener.onRejected;\n    if (cb === null) {\n        // This Listener doesnt have a listener for the event being triggered (onFulfilled or onReject) so lets forward the event to any eventual listeners on the Promise instance returned by then() or catch()\n        return (promise._state ? listener.resolve : listener.reject)(promise._value);\n    }\n    var psd = listener.psd;\n    ++psd.ref;\n    ++numScheduledCalls;\n    asap$1(callListener, [cb, promise, listener]);\n}\n\nfunction callListener(cb, promise, listener) {\n    var outerScope = PSD;\n    var psd = listener.psd;\n    try {\n        if (psd !== outerScope) {\n            // **KEEP** outerScope.env = wrappers.snapshot(); // Snapshot outerScope's environment.\n            PSD = psd;\n            // **KEEP** wrappers.restore(psd.env); // Restore PSD's environment.\n        }\n\n        // Set static variable currentFulfiller to the promise that is being fullfilled,\n        // so that we connect the chain of promises (for long stacks support)\n        currentFulfiller = promise;\n\n        // Call callback and resolve our listener with it's return value.\n        var value = promise._value,\n            ret;\n        if (promise._state) {\n            ret = cb(value);\n        } else {\n            if (rejectingErrors.length) rejectingErrors = [];\n            ret = cb(value);\n            if (rejectingErrors.indexOf(value) === -1) markErrorAsHandled(promise); // Callback didnt do Promise.reject(err) nor reject(err) onto another promise.\n        }\n        listener.resolve(ret);\n    } catch (e) {\n        // Exception thrown in callback. Reject our listener.\n        listener.reject(e);\n    } finally {\n        // Restore PSD, env and currentFulfiller.\n        if (psd !== outerScope) {\n            PSD = outerScope;\n            // **KEEP** wrappers.restore(outerScope.env); // Restore outerScope's environment\n        }\n        currentFulfiller = null;\n        if (--numScheduledCalls === 0) finalizePhysicalTick();\n        --psd.ref || psd.finalize();\n    }\n}\n\nfunction getStack(promise, stacks, limit) {\n    if (stacks.length === limit) return stacks;\n    var stack = \"\";\n    if (promise._state === false) {\n        var failure = promise._value,\n            errorName,\n            message;\n\n        if (failure != null) {\n            errorName = failure.name || \"Error\";\n            message = failure.message || failure;\n            stack = prettyStack(failure, 0);\n        } else {\n            errorName = failure; // If error is undefined or null, show that.\n            message = \"\";\n        }\n        stacks.push(errorName + (message ? \": \" + message : \"\") + stack);\n    }\n    if (debug) {\n        stack = prettyStack(promise._stackHolder, 2);\n        if (stack && stacks.indexOf(stack) === -1) stacks.push(stack);\n        if (promise._prev) getStack(promise._prev, stacks, limit);\n    }\n    return stacks;\n}\n\nfunction linkToPreviousPromise(promise, prev) {\n    // Support long stacks by linking to previous completed promise.\n    var numPrev = prev ? prev._numPrev + 1 : 0;\n    if (numPrev < LONG_STACKS_CLIP_LIMIT) {\n        // Prohibit infinite Promise loops to get an infinite long memory consuming \"tail\".\n        promise._prev = prev;\n        promise._numPrev = numPrev;\n    }\n}\n\n/* The callback to schedule with setImmediate() or setTimeout().\r\n   It runs a virtual microtick and executes any callback registered in microtickQueue.\r\n */\nfunction physicalTick() {\n    beginMicroTickScope() && endMicroTickScope();\n}\n\nfunction beginMicroTickScope() {\n    var wasRootExec = isOutsideMicroTick;\n    isOutsideMicroTick = false;\n    needsNewPhysicalTick = false;\n    return wasRootExec;\n}\n\n/* Executes micro-ticks without doing try..catch.\r\n   This can be possible because we only use this internally and\r\n   the registered functions are exception-safe (they do try..catch\r\n   internally before calling any external method). If registering\r\n   functions in the microtickQueue that are not exception-safe, this\r\n   would destroy the framework and make it instable. So we don't export\r\n   our asap method.\r\n*/\nfunction endMicroTickScope() {\n    var callbacks, i, l;\n    do {\n        while (microtickQueue.length > 0) {\n            callbacks = microtickQueue;\n            microtickQueue = [];\n            l = callbacks.length;\n            for (i = 0; i < l; ++i) {\n                var item = callbacks[i];\n                item[0].apply(null, item[1]);\n            }\n        }\n    } while (microtickQueue.length > 0);\n    isOutsideMicroTick = true;\n    needsNewPhysicalTick = true;\n}\n\nfunction finalizePhysicalTick() {\n    var unhandledErrs = unhandledErrors;\n    unhandledErrors = [];\n    unhandledErrs.forEach(function (p) {\n        p._PSD.onunhandled.call(null, p._value, p);\n    });\n    var finalizers = tickFinalizers.slice(0); // Clone first because finalizer may remove itself from list.\n    var i = finalizers.length;\n    while (i) {\n        finalizers[--i]();\n    }\n}\n\nfunction run_at_end_of_this_or_next_physical_tick(fn) {\n    function finalizer() {\n        fn();\n        tickFinalizers.splice(tickFinalizers.indexOf(finalizer), 1);\n    }\n    tickFinalizers.push(finalizer);\n    ++numScheduledCalls;\n    asap$1(function () {\n        if (--numScheduledCalls === 0) finalizePhysicalTick();\n    }, []);\n}\n\nfunction addPossiblyUnhandledError(promise) {\n    // Only add to unhandledErrors if not already there. The first one to add to this list\n    // will be upon the first rejection so that the root cause (first promise in the\n    // rejection chain) is the one listed.\n    if (!unhandledErrors.some(function (p) {\n        return p._value === promise._value;\n    })) unhandledErrors.push(promise);\n}\n\nfunction markErrorAsHandled(promise) {\n    // Called when a reject handled is actually being called.\n    // Search in unhandledErrors for any promise whos _value is this promise_value (list\n    // contains only rejected promises, and only one item per error)\n    var i = unhandledErrors.length;\n    while (i) {\n        if (unhandledErrors[--i]._value === promise._value) {\n            // Found a promise that failed with this same error object pointer,\n            // Remove that since there is a listener that actually takes care of it.\n            unhandledErrors.splice(i, 1);\n            return;\n        }\n    }\n}\n\n// By default, log uncaught errors to the console\nfunction defaultErrorHandler(e) {\n    console.warn('Unhandled rejection: ' + (e.stack || e));\n}\n\nfunction PromiseReject(reason) {\n    return new Promise(INTERNAL, false, reason);\n}\n\nfunction wrap(fn, errorCatcher) {\n    var psd = PSD;\n    return function () {\n        var wasRootExec = beginMicroTickScope(),\n            outerScope = PSD;\n\n        try {\n            if (outerScope !== psd) {\n                // **KEEP** outerScope.env = wrappers.snapshot(); // Snapshot outerScope's environment\n                PSD = psd;\n                // **KEEP** wrappers.restore(psd.env); // Restore PSD's environment.\n            }\n            return fn.apply(this, arguments);\n        } catch (e) {\n            errorCatcher && errorCatcher(e);\n        } finally {\n            if (outerScope !== psd) {\n                PSD = outerScope;\n                // **KEEP** wrappers.restore(outerScope.env); // Restore outerScope's environment\n            }\n            if (wasRootExec) endMicroTickScope();\n        }\n    };\n}\n\nfunction newScope(fn, a1, a2, a3) {\n    var parent = PSD,\n        psd = Object.create(parent);\n    psd.parent = parent;\n    psd.ref = 0;\n    psd.global = false;\n    // **KEEP** psd.env = wrappers.wrap(psd);\n\n    // unhandleds and onunhandled should not be specifically set here.\n    // Leave them on parent prototype.\n    // unhandleds.push(err) will push to parent's prototype\n    // onunhandled() will call parents onunhandled (with this scope's this-pointer though!)\n    ++parent.ref;\n    psd.finalize = function () {\n        --this.parent.ref || this.parent.finalize();\n    };\n    var rv = usePSD(psd, fn, a1, a2, a3);\n    if (psd.ref === 0) psd.finalize();\n    return rv;\n}\n\nfunction usePSD(psd, fn, a1, a2, a3) {\n    var outerScope = PSD;\n    try {\n        if (psd !== outerScope) {\n            // **KEEP** outerScope.env = wrappers.snapshot(); // snapshot outerScope's environment.\n            PSD = psd;\n            // **KEEP** wrappers.restore(psd.env); // Restore PSD's environment.\n        }\n        return fn(a1, a2, a3);\n    } finally {\n        if (psd !== outerScope) {\n            PSD = outerScope;\n            // **KEEP** wrappers.restore(outerScope.env); // Restore outerScope's environment.\n        }\n    }\n}\n\nvar UNHANDLEDREJECTION = \"unhandledrejection\";\n\nfunction globalError(err, promise) {\n    var rv;\n    try {\n        rv = promise.onuncatched(err);\n    } catch (e) {}\n    if (rv !== false) try {\n        var event,\n            eventData = { promise: promise, reason: err };\n        if (_global.document && document.createEvent) {\n            event = document.createEvent('Event');\n            event.initEvent(UNHANDLEDREJECTION, true, true);\n            extend(event, eventData);\n        } else if (_global.CustomEvent) {\n            event = new CustomEvent(UNHANDLEDREJECTION, { detail: eventData });\n            extend(event, eventData);\n        }\n        if (event && _global.dispatchEvent) {\n            dispatchEvent(event);\n            if (!_global.PromiseRejectionEvent && _global.onunhandledrejection)\n                // No native support for PromiseRejectionEvent but user has set window.onunhandledrejection. Manually call it.\n                try {\n                    _global.onunhandledrejection(event);\n                } catch (_) {}\n        }\n        if (!event.defaultPrevented) {\n            // Backward compatibility: fire to events registered at Promise.on.error\n            Promise.on.error.fire(err, promise);\n        }\n    } catch (e) {}\n}\n\n/* **KEEP** \r\n\r\nexport function wrapPromise(PromiseClass) {\r\n    var proto = PromiseClass.prototype;\r\n    var origThen = proto.then;\r\n    \r\n    wrappers.add({\r\n        snapshot: () => proto.then,\r\n        restore: value => {proto.then = value;},\r\n        wrap: () => patchedThen\r\n    });\r\n\r\n    function patchedThen (onFulfilled, onRejected) {\r\n        var promise = this;\r\n        var onFulfilledProxy = wrap(function(value){\r\n            var rv = value;\r\n            if (onFulfilled) {\r\n                rv = onFulfilled(rv);\r\n                if (rv && typeof rv.then === 'function') rv.then(); // Intercept that promise as well.\r\n            }\r\n            --PSD.ref || PSD.finalize();\r\n            return rv;\r\n        });\r\n        var onRejectedProxy = wrap(function(err){\r\n            promise._$err = err;\r\n            var unhandleds = PSD.unhandleds;\r\n            var idx = unhandleds.length,\r\n                rv;\r\n            while (idx--) if (unhandleds[idx]._$err === err) break;\r\n            if (onRejected) {\r\n                if (idx !== -1) unhandleds.splice(idx, 1); // Mark as handled.\r\n                rv = onRejected(err);\r\n                if (rv && typeof rv.then === 'function') rv.then(); // Intercept that promise as well.\r\n            } else {\r\n                if (idx === -1) unhandleds.push(promise);\r\n                rv = PromiseClass.reject(err);\r\n                rv._$nointercept = true; // Prohibit eternal loop.\r\n            }\r\n            --PSD.ref || PSD.finalize();\r\n            return rv;\r\n        });\r\n        \r\n        if (this._$nointercept) return origThen.apply(this, arguments);\r\n        ++PSD.ref;\r\n        return origThen.call(this, onFulfilledProxy, onRejectedProxy);\r\n    }\r\n}\r\n\r\n// Global Promise wrapper\r\nif (_global.Promise) wrapPromise(_global.Promise);\r\n\r\n*/\n\ndoFakeAutoComplete(function () {\n    // Simplify the job for VS Intellisense. This piece of code is one of the keys to the new marvellous intellisense support in Dexie.\n    asap$1 = function (fn, args) {\n        setTimeout(function () {\n            fn.apply(null, args);\n        }, 0);\n    };\n});\n\nfunction rejection(err, uncaughtHandler) {\n    // Get the call stack and return a rejected promise.\n    var rv = Promise.reject(err);\n    return uncaughtHandler ? rv.uncaught(uncaughtHandler) : rv;\n}\n\n/*\r\n * Dexie.js - a minimalistic wrapper for IndexedDB\r\n * ===============================================\r\n *\r\n * By David Fahlander, david.fahlander@gmail.com\r\n *\r\n * Version 1.5.1, Tue Nov 01 2016\r\n *\r\n * http://dexie.org\r\n *\r\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/\r\n */\n\nvar DEXIE_VERSION = '1.5.1';\nvar maxString = String.fromCharCode(65535);\nvar maxKey = function () {\n    try {\n        IDBKeyRange.only([[]]);return [[]];\n    } catch (e) {\n        return maxString;\n    }\n}();\nvar INVALID_KEY_ARGUMENT = \"Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.\";\nvar STRING_EXPECTED = \"String expected.\";\nvar connections = [];\nvar isIEOrEdge = typeof navigator !== 'undefined' && /(MSIE|Trident|Edge)/.test(navigator.userAgent);\nvar hasIEDeleteObjectStoreBug = isIEOrEdge;\nvar hangsOnDeleteLargeKeyRange = isIEOrEdge;\nvar dexieStackFrameFilter = function (frame) {\n    return !/(dexie\\.js|dexie\\.min\\.js)/.test(frame);\n};\n\nsetDebug(debug, dexieStackFrameFilter);\n\nfunction Dexie(dbName, options) {\n    /// <param name=\"options\" type=\"Object\" optional=\"true\">Specify only if you wich to control which addons that should run on this instance</param>\n    var deps = Dexie.dependencies;\n    var opts = extend({\n        // Default Options\n        addons: Dexie.addons, // Pick statically registered addons by default\n        autoOpen: true, // Don't require db.open() explicitely.\n        indexedDB: deps.indexedDB, // Backend IndexedDB api. Default to IDBShim or browser env.\n        IDBKeyRange: deps.IDBKeyRange // Backend IDBKeyRange api. Default to IDBShim or browser env.\n    }, options);\n    var addons = opts.addons,\n        autoOpen = opts.autoOpen,\n        indexedDB = opts.indexedDB,\n        IDBKeyRange = opts.IDBKeyRange;\n\n    var globalSchema = this._dbSchema = {};\n    var versions = [];\n    var dbStoreNames = [];\n    var allTables = {};\n    ///<var type=\"IDBDatabase\" />\n    var idbdb = null; // Instance of IDBDatabase\n    var dbOpenError = null;\n    var isBeingOpened = false;\n    var openComplete = false;\n    var READONLY = \"readonly\",\n        READWRITE = \"readwrite\";\n    var db = this;\n    var dbReadyResolve,\n        dbReadyPromise = new Promise(function (resolve) {\n        dbReadyResolve = resolve;\n    }),\n        cancelOpen,\n        openCanceller = new Promise(function (_, reject) {\n        cancelOpen = reject;\n    });\n    var autoSchema = true;\n    var hasNativeGetDatabaseNames = !!getNativeGetDatabaseNamesFn(indexedDB),\n        hasGetAll;\n\n    function init() {\n        // Default subscribers to \"versionchange\" and \"blocked\".\n        // Can be overridden by custom handlers. If custom handlers return false, these default\n        // behaviours will be prevented.\n        db.on(\"versionchange\", function (ev) {\n            // Default behavior for versionchange event is to close database connection.\n            // Caller can override this behavior by doing db.on(\"versionchange\", function(){ return false; });\n            // Let's not block the other window from making it's delete() or open() call.\n            // NOTE! This event is never fired in IE,Edge or Safari.\n            if (ev.newVersion > 0) console.warn('Another connection wants to upgrade database \\'' + db.name + '\\'. Closing db now to resume the upgrade.');else console.warn('Another connection wants to delete database \\'' + db.name + '\\'. Closing db now to resume the delete request.');\n            db.close();\n            // In many web applications, it would be recommended to force window.reload()\n            // when this event occurs. To do that, subscribe to the versionchange event\n            // and call window.location.reload(true) if ev.newVersion > 0 (not a deletion)\n            // The reason for this is that your current web app obviously has old schema code that needs\n            // to be updated. Another window got a newer version of the app and needs to upgrade DB but\n            // your window is blocking it unless we close it here.\n        });\n        db.on(\"blocked\", function (ev) {\n            if (!ev.newVersion || ev.newVersion < ev.oldVersion) console.warn('Dexie.delete(\\'' + db.name + '\\') was blocked');else console.warn('Upgrade \\'' + db.name + '\\' blocked by other connection holding version ' + ev.oldVersion / 10);\n        });\n    }\n\n    //\n    //\n    //\n    // ------------------------- Versioning Framework---------------------------\n    //\n    //\n    //\n\n    this.version = function (versionNumber) {\n        /// <param name=\"versionNumber\" type=\"Number\"></param>\n        /// <returns type=\"Version\"></returns>\n        if (idbdb || isBeingOpened) throw new exceptions.Schema(\"Cannot add version when database is open\");\n        this.verno = Math.max(this.verno, versionNumber);\n        var versionInstance = versions.filter(function (v) {\n            return v._cfg.version === versionNumber;\n        })[0];\n        if (versionInstance) return versionInstance;\n        versionInstance = new Version(versionNumber);\n        versions.push(versionInstance);\n        versions.sort(lowerVersionFirst);\n        return versionInstance;\n    };\n\n    function Version(versionNumber) {\n        this._cfg = {\n            version: versionNumber,\n            storesSource: null,\n            dbschema: {},\n            tables: {},\n            contentUpgrade: null\n        };\n        this.stores({}); // Derive earlier schemas by default.\n    }\n\n    extend(Version.prototype, {\n        stores: function (stores) {\n            /// <summary>\n            ///   Defines the schema for a particular version\n            /// </summary>\n            /// <param name=\"stores\" type=\"Object\">\n            /// Example: <br/>\n            ///   {users: \"id++,first,last,&amp;username,*email\", <br/>\n            ///   passwords: \"id++,&amp;username\"}<br/>\n            /// <br/>\n            /// Syntax: {Table: \"[primaryKey][++],[&amp;][*]index1,[&amp;][*]index2,...\"}<br/><br/>\n            /// Special characters:<br/>\n            ///  \"&amp;\"  means unique key, <br/>\n            ///  \"*\"  means value is multiEntry, <br/>\n            ///  \"++\" means auto-increment and only applicable for primary key <br/>\n            /// </param>\n            this._cfg.storesSource = this._cfg.storesSource ? extend(this._cfg.storesSource, stores) : stores;\n\n            // Derive stores from earlier versions if they are not explicitely specified as null or a new syntax.\n            var storesSpec = {};\n            versions.forEach(function (version) {\n                // 'versions' is always sorted by lowest version first.\n                extend(storesSpec, version._cfg.storesSource);\n            });\n\n            var dbschema = this._cfg.dbschema = {};\n            this._parseStoresSpec(storesSpec, dbschema);\n            // Update the latest schema to this version\n            // Update API\n            globalSchema = db._dbSchema = dbschema;\n            removeTablesApi([allTables, db, Transaction.prototype]);\n            setApiOnPlace([allTables, db, Transaction.prototype, this._cfg.tables], keys(dbschema), READWRITE, dbschema);\n            dbStoreNames = keys(dbschema);\n            return this;\n        },\n        upgrade: function (upgradeFunction) {\n            /// <param name=\"upgradeFunction\" optional=\"true\">Function that performs upgrading actions.</param>\n            var self = this;\n            fakeAutoComplete(function () {\n                upgradeFunction(db._createTransaction(READWRITE, keys(self._cfg.dbschema), self._cfg.dbschema)); // BUGBUG: No code completion for prev version's tables wont appear.\n            });\n            this._cfg.contentUpgrade = upgradeFunction;\n            return this;\n        },\n        _parseStoresSpec: function (stores, outSchema) {\n            keys(stores).forEach(function (tableName) {\n                if (stores[tableName] !== null) {\n                    var instanceTemplate = {};\n                    var indexes = parseIndexSyntax(stores[tableName]);\n                    var primKey = indexes.shift();\n                    if (primKey.multi) throw new exceptions.Schema(\"Primary key cannot be multi-valued\");\n                    if (primKey.keyPath) setByKeyPath(instanceTemplate, primKey.keyPath, primKey.auto ? 0 : primKey.keyPath);\n                    indexes.forEach(function (idx) {\n                        if (idx.auto) throw new exceptions.Schema(\"Only primary key can be marked as autoIncrement (++)\");\n                        if (!idx.keyPath) throw new exceptions.Schema(\"Index must have a name and cannot be an empty string\");\n                        setByKeyPath(instanceTemplate, idx.keyPath, idx.compound ? idx.keyPath.map(function () {\n                            return \"\";\n                        }) : \"\");\n                    });\n                    outSchema[tableName] = new TableSchema(tableName, primKey, indexes, instanceTemplate);\n                }\n            });\n        }\n    });\n\n    function runUpgraders(oldVersion, idbtrans, reject) {\n        var trans = db._createTransaction(READWRITE, dbStoreNames, globalSchema);\n        trans.create(idbtrans);\n        trans._completion.catch(reject);\n        var rejectTransaction = trans._reject.bind(trans);\n        newScope(function () {\n            PSD.trans = trans;\n            if (oldVersion === 0) {\n                // Create tables:\n                keys(globalSchema).forEach(function (tableName) {\n                    createTable(idbtrans, tableName, globalSchema[tableName].primKey, globalSchema[tableName].indexes);\n                });\n                Promise.follow(function () {\n                    return db.on.populate.fire(trans);\n                }).catch(rejectTransaction);\n            } else updateTablesAndIndexes(oldVersion, trans, idbtrans).catch(rejectTransaction);\n        });\n    }\n\n    function updateTablesAndIndexes(oldVersion, trans, idbtrans) {\n        // Upgrade version to version, step-by-step from oldest to newest version.\n        // Each transaction object will contain the table set that was current in that version (but also not-yet-deleted tables from its previous version)\n        var queue = [];\n        var oldVersionStruct = versions.filter(function (version) {\n            return version._cfg.version === oldVersion;\n        })[0];\n        if (!oldVersionStruct) throw new exceptions.Upgrade(\"Dexie specification of currently installed DB version is missing\");\n        globalSchema = db._dbSchema = oldVersionStruct._cfg.dbschema;\n        var anyContentUpgraderHasRun = false;\n\n        var versToRun = versions.filter(function (v) {\n            return v._cfg.version > oldVersion;\n        });\n        versToRun.forEach(function (version) {\n            /// <param name=\"version\" type=\"Version\"></param>\n            queue.push(function () {\n                var oldSchema = globalSchema;\n                var newSchema = version._cfg.dbschema;\n                adjustToExistingIndexNames(oldSchema, idbtrans);\n                adjustToExistingIndexNames(newSchema, idbtrans);\n                globalSchema = db._dbSchema = newSchema;\n                var diff = getSchemaDiff(oldSchema, newSchema);\n                // Add tables           \n                diff.add.forEach(function (tuple) {\n                    createTable(idbtrans, tuple[0], tuple[1].primKey, tuple[1].indexes);\n                });\n                // Change tables\n                diff.change.forEach(function (change) {\n                    if (change.recreate) {\n                        throw new exceptions.Upgrade(\"Not yet support for changing primary key\");\n                    } else {\n                        var store = idbtrans.objectStore(change.name);\n                        // Add indexes\n                        change.add.forEach(function (idx) {\n                            addIndex(store, idx);\n                        });\n                        // Update indexes\n                        change.change.forEach(function (idx) {\n                            store.deleteIndex(idx.name);\n                            addIndex(store, idx);\n                        });\n                        // Delete indexes\n                        change.del.forEach(function (idxName) {\n                            store.deleteIndex(idxName);\n                        });\n                    }\n                });\n                if (version._cfg.contentUpgrade) {\n                    anyContentUpgraderHasRun = true;\n                    return Promise.follow(function () {\n                        version._cfg.contentUpgrade(trans);\n                    });\n                }\n            });\n            queue.push(function (idbtrans) {\n                if (!anyContentUpgraderHasRun || !hasIEDeleteObjectStoreBug) {\n                    // Dont delete old tables if ieBug is present and a content upgrader has run. Let tables be left in DB so far. This needs to be taken care of.\n                    var newSchema = version._cfg.dbschema;\n                    // Delete old tables\n                    deleteRemovedTables(newSchema, idbtrans);\n                }\n            });\n        });\n\n        // Now, create a queue execution engine\n        function runQueue() {\n            return queue.length ? Promise.resolve(queue.shift()(trans.idbtrans)).then(runQueue) : Promise.resolve();\n        }\n\n        return runQueue().then(function () {\n            createMissingTables(globalSchema, idbtrans); // At last, make sure to create any missing tables. (Needed by addons that add stores to DB without specifying version)\n        });\n    }\n\n    function getSchemaDiff(oldSchema, newSchema) {\n        var diff = {\n            del: [], // Array of table names\n            add: [], // Array of [tableName, newDefinition]\n            change: [] // Array of {name: tableName, recreate: newDefinition, del: delIndexNames, add: newIndexDefs, change: changedIndexDefs}\n        };\n        for (var table in oldSchema) {\n            if (!newSchema[table]) diff.del.push(table);\n        }\n        for (table in newSchema) {\n            var oldDef = oldSchema[table],\n                newDef = newSchema[table];\n            if (!oldDef) {\n                diff.add.push([table, newDef]);\n            } else {\n                var change = {\n                    name: table,\n                    def: newDef,\n                    recreate: false,\n                    del: [],\n                    add: [],\n                    change: []\n                };\n                if (oldDef.primKey.src !== newDef.primKey.src) {\n                    // Primary key has changed. Remove and re-add table.\n                    change.recreate = true;\n                    diff.change.push(change);\n                } else {\n                    // Same primary key. Just find out what differs:\n                    var oldIndexes = oldDef.idxByName;\n                    var newIndexes = newDef.idxByName;\n                    for (var idxName in oldIndexes) {\n                        if (!newIndexes[idxName]) change.del.push(idxName);\n                    }\n                    for (idxName in newIndexes) {\n                        var oldIdx = oldIndexes[idxName],\n                            newIdx = newIndexes[idxName];\n                        if (!oldIdx) change.add.push(newIdx);else if (oldIdx.src !== newIdx.src) change.change.push(newIdx);\n                    }\n                    if (change.del.length > 0 || change.add.length > 0 || change.change.length > 0) {\n                        diff.change.push(change);\n                    }\n                }\n            }\n        }\n        return diff;\n    }\n\n    function createTable(idbtrans, tableName, primKey, indexes) {\n        /// <param name=\"idbtrans\" type=\"IDBTransaction\"></param>\n        var store = idbtrans.db.createObjectStore(tableName, primKey.keyPath ? { keyPath: primKey.keyPath, autoIncrement: primKey.auto } : { autoIncrement: primKey.auto });\n        indexes.forEach(function (idx) {\n            addIndex(store, idx);\n        });\n        return store;\n    }\n\n    function createMissingTables(newSchema, idbtrans) {\n        keys(newSchema).forEach(function (tableName) {\n            if (!idbtrans.db.objectStoreNames.contains(tableName)) {\n                createTable(idbtrans, tableName, newSchema[tableName].primKey, newSchema[tableName].indexes);\n            }\n        });\n    }\n\n    function deleteRemovedTables(newSchema, idbtrans) {\n        for (var i = 0; i < idbtrans.db.objectStoreNames.length; ++i) {\n            var storeName = idbtrans.db.objectStoreNames[i];\n            if (newSchema[storeName] == null) {\n                idbtrans.db.deleteObjectStore(storeName);\n            }\n        }\n    }\n\n    function addIndex(store, idx) {\n        store.createIndex(idx.name, idx.keyPath, { unique: idx.unique, multiEntry: idx.multi });\n    }\n\n    function dbUncaught(err) {\n        return db.on.error.fire(err);\n    }\n\n    //\n    //\n    //      Dexie Protected API\n    //\n    //\n\n    this._allTables = allTables;\n\n    this._tableFactory = function createTable(mode, tableSchema) {\n        /// <param name=\"tableSchema\" type=\"TableSchema\"></param>\n        if (mode === READONLY) return new Table(tableSchema.name, tableSchema, Collection);else return new WriteableTable(tableSchema.name, tableSchema);\n    };\n\n    this._createTransaction = function (mode, storeNames, dbschema, parentTransaction) {\n        return new Transaction(mode, storeNames, dbschema, parentTransaction);\n    };\n\n    /* Generate a temporary transaction when db operations are done outside a transactino scope.\r\n    */\n    function tempTransaction(mode, storeNames, fn) {\n        // Last argument is \"writeLocked\". But this doesnt apply to oneshot direct db operations, so we ignore it.\n        if (!openComplete && !PSD.letThrough) {\n            if (!isBeingOpened) {\n                if (!autoOpen) return rejection(new exceptions.DatabaseClosed(), dbUncaught);\n                db.open().catch(nop); // Open in background. If if fails, it will be catched by the final promise anyway.\n            }\n            return dbReadyPromise.then(function () {\n                return tempTransaction(mode, storeNames, fn);\n            });\n        } else {\n            var trans = db._createTransaction(mode, storeNames, globalSchema);\n            return trans._promise(mode, function (resolve, reject) {\n                newScope(function () {\n                    // OPTIMIZATION POSSIBLE? newScope() not needed because it's already done in _promise.\n                    PSD.trans = trans;\n                    fn(resolve, reject, trans);\n                });\n            }).then(function (result) {\n                // Instead of resolving value directly, wait with resolving it until transaction has completed.\n                // Otherwise the data would not be in the DB if requesting it in the then() operation.\n                // Specifically, to ensure that the following expression will work:\n                //\n                //   db.friends.put({name: \"Arne\"}).then(function () {\n                //       db.friends.where(\"name\").equals(\"Arne\").count(function(count) {\n                //           assert (count === 1);\n                //       });\n                //   });\n                //\n                return trans._completion.then(function () {\n                    return result;\n                });\n            }); /*.catch(err => { // Don't do this as of now. If would affect bulk- and modify methods in a way that could be more intuitive. But wait! Maybe change in next major.\r\n                 trans._reject(err);\r\n                 return rejection(err);\r\n                });*/\n        }\n    }\n\n    this._whenReady = function (fn) {\n        return new Promise(fake || openComplete || PSD.letThrough ? fn : function (resolve, reject) {\n            if (!isBeingOpened) {\n                if (!autoOpen) {\n                    reject(new exceptions.DatabaseClosed());\n                    return;\n                }\n                db.open().catch(nop); // Open in background. If if fails, it will be catched by the final promise anyway.\n            }\n            dbReadyPromise.then(function () {\n                fn(resolve, reject);\n            });\n        }).uncaught(dbUncaught);\n    };\n\n    //\n    //\n    //\n    //\n    //      Dexie API\n    //\n    //\n    //\n\n    this.verno = 0;\n\n    this.open = function () {\n        if (isBeingOpened || idbdb) return dbReadyPromise.then(function () {\n            return dbOpenError ? rejection(dbOpenError, dbUncaught) : db;\n        });\n        debug && (openCanceller._stackHolder = getErrorWithStack()); // Let stacks point to when open() was called rather than where new Dexie() was called.\n        isBeingOpened = true;\n        dbOpenError = null;\n        openComplete = false;\n\n        // Function pointers to call when the core opening process completes.\n        var resolveDbReady = dbReadyResolve,\n\n        // upgradeTransaction to abort on failure.\n        upgradeTransaction = null;\n\n        return Promise.race([openCanceller, new Promise(function (resolve, reject) {\n            doFakeAutoComplete(function () {\n                return resolve();\n            });\n\n            // Make sure caller has specified at least one version\n            if (versions.length > 0) autoSchema = false;\n\n            // Multiply db.verno with 10 will be needed to workaround upgrading bug in IE:\n            // IE fails when deleting objectStore after reading from it.\n            // A future version of Dexie.js will stopover an intermediate version to workaround this.\n            // At that point, we want to be backward compatible. Could have been multiplied with 2, but by using 10, it is easier to map the number to the real version number.\n\n            // If no API, throw!\n            if (!indexedDB) throw new exceptions.MissingAPI(\"indexedDB API not found. If using IE10+, make sure to run your code on a server URL \" + \"(not locally). If using old Safari versions, make sure to include indexedDB polyfill.\");\n\n            var req = autoSchema ? indexedDB.open(dbName) : indexedDB.open(dbName, Math.round(db.verno * 10));\n            if (!req) throw new exceptions.MissingAPI(\"IndexedDB API not available\"); // May happen in Safari private mode, see https://github.com/dfahlander/Dexie.js/issues/134\n            req.onerror = wrap(eventRejectHandler(reject));\n            req.onblocked = wrap(fireOnBlocked);\n            req.onupgradeneeded = wrap(function (e) {\n                upgradeTransaction = req.transaction;\n                if (autoSchema && !db._allowEmptyDB) {\n                    // Unless an addon has specified db._allowEmptyDB, lets make the call fail.\n                    // Caller did not specify a version or schema. Doing that is only acceptable for opening alread existing databases.\n                    // If onupgradeneeded is called it means database did not exist. Reject the open() promise and make sure that we\n                    // do not create a new database by accident here.\n                    req.onerror = preventDefault; // Prohibit onabort error from firing before we're done!\n                    upgradeTransaction.abort(); // Abort transaction (would hope that this would make DB disappear but it doesnt.)\n                    // Close database and delete it.\n                    req.result.close();\n                    var delreq = indexedDB.deleteDatabase(dbName); // The upgrade transaction is atomic, and javascript is single threaded - meaning that there is no risk that we delete someone elses database here!\n                    delreq.onsuccess = delreq.onerror = wrap(function () {\n                        reject(new exceptions.NoSuchDatabase('Database ' + dbName + ' doesnt exist'));\n                    });\n                } else {\n                    upgradeTransaction.onerror = wrap(eventRejectHandler(reject));\n                    var oldVer = e.oldVersion > Math.pow(2, 62) ? 0 : e.oldVersion; // Safari 8 fix.\n                    runUpgraders(oldVer / 10, upgradeTransaction, reject, req);\n                }\n            }, reject);\n\n            req.onsuccess = wrap(function () {\n                // Core opening procedure complete. Now let's just record some stuff.\n                upgradeTransaction = null;\n                idbdb = req.result;\n                connections.push(db); // Used for emulating versionchange event on IE/Edge/Safari.\n\n                if (autoSchema) readGlobalSchema();else if (idbdb.objectStoreNames.length > 0) {\n                    try {\n                        adjustToExistingIndexNames(globalSchema, idbdb.transaction(safariMultiStoreFix(idbdb.objectStoreNames), READONLY));\n                    } catch (e) {\n                        // Safari may bail out if > 1 store names. However, this shouldnt be a showstopper. Issue #120.\n                    }\n                }\n\n                idbdb.onversionchange = wrap(function (ev) {\n                    db._vcFired = true; // detect implementations that not support versionchange (IE/Edge/Safari)\n                    db.on(\"versionchange\").fire(ev);\n                });\n\n                if (!hasNativeGetDatabaseNames) {\n                    // Update localStorage with list of database names\n                    globalDatabaseList(function (databaseNames) {\n                        if (databaseNames.indexOf(dbName) === -1) return databaseNames.push(dbName);\n                    });\n                }\n\n                resolve();\n            }, reject);\n        })]).then(function () {\n            // Before finally resolving the dbReadyPromise and this promise,\n            // call and await all on('ready') subscribers:\n            // Dexie.vip() makes subscribers able to use the database while being opened.\n            // This is a must since these subscribers take part of the opening procedure.\n            return Dexie.vip(db.on.ready.fire);\n        }).then(function () {\n            // Resolve the db.open() with the db instance.\n            isBeingOpened = false;\n            return db;\n        }).catch(function (err) {\n            try {\n                // Did we fail within onupgradeneeded? Make sure to abort the upgrade transaction so it doesnt commit.\n                upgradeTransaction && upgradeTransaction.abort();\n            } catch (e) {}\n            isBeingOpened = false; // Set before calling db.close() so that it doesnt reject openCanceller again (leads to unhandled rejection event).\n            db.close(); // Closes and resets idbdb, removes connections, resets dbReadyPromise and openCanceller so that a later db.open() is fresh.\n            // A call to db.close() may have made on-ready subscribers fail. Use dbOpenError if set, since err could be a follow-up error on that.\n            dbOpenError = err; // Record the error. It will be used to reject further promises of db operations.\n            return rejection(dbOpenError, dbUncaught); // dbUncaught will make sure any error that happened in any operation before will now bubble to db.on.error() thanks to the special handling in Promise.uncaught().\n        }).finally(function () {\n            openComplete = true;\n            resolveDbReady(); // dbReadyPromise is resolved no matter if open() rejects or resolved. It's just to wake up waiters.\n        });\n    };\n\n    this.close = function () {\n        var idx = connections.indexOf(db);\n        if (idx >= 0) connections.splice(idx, 1);\n        if (idbdb) {\n            try {\n                idbdb.close();\n            } catch (e) {}\n            idbdb = null;\n        }\n        autoOpen = false;\n        dbOpenError = new exceptions.DatabaseClosed();\n        if (isBeingOpened) cancelOpen(dbOpenError);\n        // Reset dbReadyPromise promise:\n        dbReadyPromise = new Promise(function (resolve) {\n            dbReadyResolve = resolve;\n        });\n        openCanceller = new Promise(function (_, reject) {\n            cancelOpen = reject;\n        });\n    };\n\n    this.delete = function () {\n        var hasArguments = arguments.length > 0;\n        return new Promise(function (resolve, reject) {\n            if (hasArguments) throw new exceptions.InvalidArgument(\"Arguments not allowed in db.delete()\");\n            if (isBeingOpened) {\n                dbReadyPromise.then(doDelete);\n            } else {\n                doDelete();\n            }\n            function doDelete() {\n                db.close();\n                var req = indexedDB.deleteDatabase(dbName);\n                req.onsuccess = wrap(function () {\n                    if (!hasNativeGetDatabaseNames) {\n                        globalDatabaseList(function (databaseNames) {\n                            var pos = databaseNames.indexOf(dbName);\n                            if (pos >= 0) return databaseNames.splice(pos, 1);\n                        });\n                    }\n                    resolve();\n                });\n                req.onerror = wrap(eventRejectHandler(reject));\n                req.onblocked = fireOnBlocked;\n            }\n        }).uncaught(dbUncaught);\n    };\n\n    this.backendDB = function () {\n        return idbdb;\n    };\n\n    this.isOpen = function () {\n        return idbdb !== null;\n    };\n    this.hasFailed = function () {\n        return dbOpenError !== null;\n    };\n    this.dynamicallyOpened = function () {\n        return autoSchema;\n    };\n\n    //\n    // Properties\n    //\n    this.name = dbName;\n\n    // db.tables - an array of all Table instances.\n    setProp(this, \"tables\", {\n        get: function () {\n            /// <returns type=\"Array\" elementType=\"WriteableTable\" />\n            return keys(allTables).map(function (name) {\n                return allTables[name];\n            });\n        }\n    });\n\n    //\n    // Events\n    //\n    this.on = Events(this, \"error\", \"populate\", \"blocked\", \"versionchange\", { ready: [promisableChain, nop] });\n    this.on.error.subscribe = deprecated(\"Dexie.on.error\", this.on.error.subscribe);\n    this.on.error.unsubscribe = deprecated(\"Dexie.on.error.unsubscribe\", this.on.error.unsubscribe);\n\n    this.on.ready.subscribe = override(this.on.ready.subscribe, function (subscribe) {\n        return function (subscriber, bSticky) {\n            Dexie.vip(function () {\n                if (openComplete) {\n                    // Database already open. Call subscriber asap.\n                    if (!dbOpenError) Promise.resolve().then(subscriber);\n                    // bSticky: Also subscribe to future open sucesses (after close / reopen) \n                    if (bSticky) subscribe(subscriber);\n                } else {\n                    // Database not yet open. Subscribe to it.\n                    subscribe(subscriber);\n                    // If bSticky is falsy, make sure to unsubscribe subscriber when fired once.\n                    if (!bSticky) subscribe(function unsubscribe() {\n                        db.on.ready.unsubscribe(subscriber);\n                        db.on.ready.unsubscribe(unsubscribe);\n                    });\n                }\n            });\n        };\n    });\n\n    fakeAutoComplete(function () {\n        db.on(\"populate\").fire(db._createTransaction(READWRITE, dbStoreNames, globalSchema));\n        db.on(\"error\").fire(new Error());\n    });\n\n    this.transaction = function (mode, tableInstances, scopeFunc) {\n        /// <summary>\n        ///\n        /// </summary>\n        /// <param name=\"mode\" type=\"String\">\"r\" for readonly, or \"rw\" for readwrite</param>\n        /// <param name=\"tableInstances\">Table instance, Array of Table instances, String or String Array of object stores to include in the transaction</param>\n        /// <param name=\"scopeFunc\" type=\"Function\">Function to execute with transaction</param>\n\n        // Let table arguments be all arguments between mode and last argument.\n        var i = arguments.length;\n        if (i < 2) throw new exceptions.InvalidArgument(\"Too few arguments\");\n        // Prevent optimzation killer (https://github.com/petkaantonov/bluebird/wiki/Optimization-killers#32-leaking-arguments)\n        // and clone arguments except the first one into local var 'args'.\n        var args = new Array(i - 1);\n        while (--i) {\n            args[i - 1] = arguments[i];\n        } // Let scopeFunc be the last argument and pop it so that args now only contain the table arguments.\n        scopeFunc = args.pop();\n        var tables = flatten(args); // Support using array as middle argument, or a mix of arrays and non-arrays.\n        var parentTransaction = PSD.trans;\n        // Check if parent transactions is bound to this db instance, and if caller wants to reuse it\n        if (!parentTransaction || parentTransaction.db !== db || mode.indexOf('!') !== -1) parentTransaction = null;\n        var onlyIfCompatible = mode.indexOf('?') !== -1;\n        mode = mode.replace('!', '').replace('?', ''); // Ok. Will change arguments[0] as well but we wont touch arguments henceforth.\n\n        try {\n            //\n            // Get storeNames from arguments. Either through given table instances, or through given table names.\n            //\n            var storeNames = tables.map(function (table) {\n                var storeName = table instanceof Table ? table.name : table;\n                if (typeof storeName !== 'string') throw new TypeError(\"Invalid table argument to Dexie.transaction(). Only Table or String are allowed\");\n                return storeName;\n            });\n\n            //\n            // Resolve mode. Allow shortcuts \"r\" and \"rw\".\n            //\n            if (mode == \"r\" || mode == READONLY) mode = READONLY;else if (mode == \"rw\" || mode == READWRITE) mode = READWRITE;else throw new exceptions.InvalidArgument(\"Invalid transaction mode: \" + mode);\n\n            if (parentTransaction) {\n                // Basic checks\n                if (parentTransaction.mode === READONLY && mode === READWRITE) {\n                    if (onlyIfCompatible) {\n                        // Spawn new transaction instead.\n                        parentTransaction = null;\n                    } else throw new exceptions.SubTransaction(\"Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY\");\n                }\n                if (parentTransaction) {\n                    storeNames.forEach(function (storeName) {\n                        if (parentTransaction && parentTransaction.storeNames.indexOf(storeName) === -1) {\n                            if (onlyIfCompatible) {\n                                // Spawn new transaction instead.\n                                parentTransaction = null;\n                            } else throw new exceptions.SubTransaction(\"Table \" + storeName + \" not included in parent transaction.\");\n                        }\n                    });\n                }\n            }\n        } catch (e) {\n            return parentTransaction ? parentTransaction._promise(null, function (_, reject) {\n                reject(e);\n            }) : rejection(e, dbUncaught);\n        }\n        // If this is a sub-transaction, lock the parent and then launch the sub-transaction.\n        return parentTransaction ? parentTransaction._promise(mode, enterTransactionScope, \"lock\") : db._whenReady(enterTransactionScope);\n\n        function enterTransactionScope(resolve) {\n            var parentPSD = PSD;\n            resolve(Promise.resolve().then(function () {\n                return newScope(function () {\n                    // Keep a pointer to last non-transactional PSD to use if someone calls Dexie.ignoreTransaction().\n                    PSD.transless = PSD.transless || parentPSD;\n                    // Our transaction.\n                    //return new Promise((resolve, reject) => {\n                    var trans = db._createTransaction(mode, storeNames, globalSchema, parentTransaction);\n                    // Let the transaction instance be part of a Promise-specific data (PSD) value.\n                    PSD.trans = trans;\n\n                    if (parentTransaction) {\n                        // Emulate transaction commit awareness for inner transaction (must 'commit' when the inner transaction has no more operations ongoing)\n                        trans.idbtrans = parentTransaction.idbtrans;\n                    } else {\n                        trans.create(); // Create the backend transaction so that complete() or error() will trigger even if no operation is made upon it.\n                    }\n\n                    // Provide arguments to the scope function (for backward compatibility)\n                    var tableArgs = storeNames.map(function (name) {\n                        return allTables[name];\n                    });\n                    tableArgs.push(trans);\n\n                    var returnValue;\n                    return Promise.follow(function () {\n                        // Finally, call the scope function with our table and transaction arguments.\n                        returnValue = scopeFunc.apply(trans, tableArgs); // NOTE: returnValue is used in trans.on.complete() not as a returnValue to this func.\n                        if (returnValue) {\n                            if (typeof returnValue.next === 'function' && typeof returnValue.throw === 'function') {\n                                // scopeFunc returned an iterator with throw-support. Handle yield as await.\n                                returnValue = awaitIterator(returnValue);\n                            } else if (typeof returnValue.then === 'function' && !hasOwn(returnValue, '_PSD')) {\n                                throw new exceptions.IncompatiblePromise(\"Incompatible Promise returned from transaction scope (read more at http://tinyurl.com/znyqjqc). Transaction scope: \" + scopeFunc.toString());\n                            }\n                        }\n                    }).uncaught(dbUncaught).then(function () {\n                        if (parentTransaction) trans._resolve(); // sub transactions don't react to idbtrans.oncomplete. We must trigger a acompletion.\n                        return trans._completion; // Even if WE believe everything is fine. Await IDBTransaction's oncomplete or onerror as well.\n                    }).then(function () {\n                        return returnValue;\n                    }).catch(function (e) {\n                        //reject(e);\n                        trans._reject(e); // Yes, above then-handler were maybe not called because of an unhandled rejection in scopeFunc!\n                        return rejection(e);\n                    });\n                    //});\n                });\n            }));\n        }\n    };\n\n    this.table = function (tableName) {\n        /// <returns type=\"WriteableTable\"></returns>\n        if (fake && autoSchema) return new WriteableTable(tableName);\n        if (!hasOwn(allTables, tableName)) {\n            throw new exceptions.InvalidTable('Table ' + tableName + ' does not exist');\n        }\n        return allTables[tableName];\n    };\n\n    //\n    //\n    //\n    // Table Class\n    //\n    //\n    //\n    function Table(name, tableSchema, collClass) {\n        /// <param name=\"name\" type=\"String\"></param>\n        this.name = name;\n        this.schema = tableSchema;\n        this.hook = allTables[name] ? allTables[name].hook : Events(null, {\n            \"creating\": [hookCreatingChain, nop],\n            \"reading\": [pureFunctionChain, mirror],\n            \"updating\": [hookUpdatingChain, nop],\n            \"deleting\": [hookDeletingChain, nop]\n        });\n        this._collClass = collClass || Collection;\n    }\n\n    props(Table.prototype, {\n\n        //\n        // Table Protected Methods\n        //\n\n        _trans: function getTransaction(mode, fn, writeLocked) {\n            var trans = PSD.trans;\n            return trans && trans.db === db ? trans._promise(mode, fn, writeLocked) : tempTransaction(mode, [this.name], fn);\n        },\n        _idbstore: function getIDBObjectStore(mode, fn, writeLocked) {\n            if (fake) return new Promise(fn); // Simplify the work for Intellisense/Code completion.\n            var trans = PSD.trans,\n                tableName = this.name;\n            function supplyIdbStore(resolve, reject, trans) {\n                fn(resolve, reject, trans.idbtrans.objectStore(tableName), trans);\n            }\n            return trans && trans.db === db ? trans._promise(mode, supplyIdbStore, writeLocked) : tempTransaction(mode, [this.name], supplyIdbStore);\n        },\n\n        //\n        // Table Public Methods\n        //\n        get: function (key, cb) {\n            var self = this;\n            return this._idbstore(READONLY, function (resolve, reject, idbstore) {\n                fake && resolve(self.schema.instanceTemplate);\n                var req = idbstore.get(key);\n                req.onerror = eventRejectHandler(reject);\n                req.onsuccess = wrap(function () {\n                    resolve(self.hook.reading.fire(req.result));\n                }, reject);\n            }).then(cb);\n        },\n        where: function (indexName) {\n            return new WhereClause(this, indexName);\n        },\n        count: function (cb) {\n            return this.toCollection().count(cb);\n        },\n        offset: function (offset) {\n            return this.toCollection().offset(offset);\n        },\n        limit: function (numRows) {\n            return this.toCollection().limit(numRows);\n        },\n        reverse: function () {\n            return this.toCollection().reverse();\n        },\n        filter: function (filterFunction) {\n            return this.toCollection().and(filterFunction);\n        },\n        each: function (fn) {\n            return this.toCollection().each(fn);\n        },\n        toArray: function (cb) {\n            return this.toCollection().toArray(cb);\n        },\n        orderBy: function (index) {\n            return new this._collClass(new WhereClause(this, index));\n        },\n\n        toCollection: function () {\n            return new this._collClass(new WhereClause(this));\n        },\n\n        mapToClass: function (constructor, structure) {\n            /// <summary>\n            ///     Map table to a javascript constructor function. Objects returned from the database will be instances of this class, making\n            ///     it possible to the instanceOf operator as well as extending the class using constructor.prototype.method = function(){...}.\n            /// </summary>\n            /// <param name=\"constructor\">Constructor function representing the class.</param>\n            /// <param name=\"structure\" optional=\"true\">Helps IDE code completion by knowing the members that objects contain and not just the indexes. Also\n            /// know what type each member has. Example: {name: String, emailAddresses: [String], password}</param>\n            this.schema.mappedClass = constructor;\n            var instanceTemplate = Object.create(constructor.prototype);\n            if (structure) {\n                // structure and instanceTemplate is for IDE code competion only while constructor.prototype is for actual inheritance.\n                applyStructure(instanceTemplate, structure);\n            }\n            this.schema.instanceTemplate = instanceTemplate;\n\n            // Now, subscribe to the when(\"reading\") event to make all objects that come out from this table inherit from given class\n            // no matter which method to use for reading (Table.get() or Table.where(...)... )\n            var readHook = function (obj) {\n                if (!obj) return obj; // No valid object. (Value is null). Return as is.\n                // Create a new object that derives from constructor:\n                var res = Object.create(constructor.prototype);\n                // Clone members:\n                for (var m in obj) {\n                    if (hasOwn(obj, m)) try {\n                        res[m] = obj[m];\n                    } catch (_) {}\n                }return res;\n            };\n\n            if (this.schema.readHook) {\n                this.hook.reading.unsubscribe(this.schema.readHook);\n            }\n            this.schema.readHook = readHook;\n            this.hook(\"reading\", readHook);\n            return constructor;\n        },\n        defineClass: function (structure) {\n            /// <summary>\n            ///     Define all members of the class that represents the table. This will help code completion of when objects are read from the database\n            ///     as well as making it possible to extend the prototype of the returned constructor function.\n            /// </summary>\n            /// <param name=\"structure\">Helps IDE code completion by knowing the members that objects contain and not just the indexes. Also\n            /// know what type each member has. Example: {name: String, emailAddresses: [String], properties: {shoeSize: Number}}</param>\n            return this.mapToClass(Dexie.defineClass(structure), structure);\n        }\n    });\n\n    //\n    //\n    //\n    // WriteableTable Class (extends Table)\n    //\n    //\n    //\n    function WriteableTable(name, tableSchema, collClass) {\n        Table.call(this, name, tableSchema, collClass || WriteableCollection);\n    }\n\n    function BulkErrorHandlerCatchAll(errorList, done, supportHooks) {\n        return (supportHooks ? hookedEventRejectHandler : eventRejectHandler)(function (e) {\n            errorList.push(e);\n            done && done();\n        });\n    }\n\n    function bulkDelete(idbstore, trans, keysOrTuples, hasDeleteHook, deletingHook) {\n        // If hasDeleteHook, keysOrTuples must be an array of tuples: [[key1, value2],[key2,value2],...],\n        // else keysOrTuples must be just an array of keys: [key1, key2, ...].\n        return new Promise(function (resolve, reject) {\n            var len = keysOrTuples.length,\n                lastItem = len - 1;\n            if (len === 0) return resolve();\n            if (!hasDeleteHook) {\n                for (var i = 0; i < len; ++i) {\n                    var req = idbstore.delete(keysOrTuples[i]);\n                    req.onerror = wrap(eventRejectHandler(reject));\n                    if (i === lastItem) req.onsuccess = wrap(function () {\n                        return resolve();\n                    });\n                }\n            } else {\n                var hookCtx,\n                    errorHandler = hookedEventRejectHandler(reject),\n                    successHandler = hookedEventSuccessHandler(null);\n                tryCatch(function () {\n                    for (var i = 0; i < len; ++i) {\n                        hookCtx = { onsuccess: null, onerror: null };\n                        var tuple = keysOrTuples[i];\n                        deletingHook.call(hookCtx, tuple[0], tuple[1], trans);\n                        var req = idbstore.delete(tuple[0]);\n                        req._hookCtx = hookCtx;\n                        req.onerror = errorHandler;\n                        if (i === lastItem) req.onsuccess = hookedEventSuccessHandler(resolve);else req.onsuccess = successHandler;\n                    }\n                }, function (err) {\n                    hookCtx.onerror && hookCtx.onerror(err);\n                    throw err;\n                });\n            }\n        }).uncaught(dbUncaught);\n    }\n\n    derive(WriteableTable).from(Table).extend({\n        bulkDelete: function (keys$$1) {\n            if (this.hook.deleting.fire === nop) {\n                return this._idbstore(READWRITE, function (resolve, reject, idbstore, trans) {\n                    resolve(bulkDelete(idbstore, trans, keys$$1, false, nop));\n                });\n            } else {\n                return this.where(':id').anyOf(keys$$1).delete().then(function () {}); // Resolve with undefined.\n            }\n        },\n        bulkPut: function (objects, keys$$1) {\n            var _this = this;\n\n            return this._idbstore(READWRITE, function (resolve, reject, idbstore) {\n                if (!idbstore.keyPath && !_this.schema.primKey.auto && !keys$$1) throw new exceptions.InvalidArgument(\"bulkPut() with non-inbound keys requires keys array in second argument\");\n                if (idbstore.keyPath && keys$$1) throw new exceptions.InvalidArgument(\"bulkPut(): keys argument invalid on tables with inbound keys\");\n                if (keys$$1 && keys$$1.length !== objects.length) throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n                if (objects.length === 0) return resolve(); // Caller provided empty list.\n                var done = function (result) {\n                    if (errorList.length === 0) resolve(result);else reject(new BulkError(_this.name + '.bulkPut(): ' + errorList.length + ' of ' + numObjs + ' operations failed', errorList));\n                };\n                var req,\n                    errorList = [],\n                    errorHandler,\n                    numObjs = objects.length,\n                    table = _this;\n                if (_this.hook.creating.fire === nop && _this.hook.updating.fire === nop) {\n                    //\n                    // Standard Bulk (no 'creating' or 'updating' hooks to care about)\n                    //\n                    errorHandler = BulkErrorHandlerCatchAll(errorList);\n                    for (var i = 0, l = objects.length; i < l; ++i) {\n                        req = keys$$1 ? idbstore.put(objects[i], keys$$1[i]) : idbstore.put(objects[i]);\n                        req.onerror = errorHandler;\n                    }\n                    // Only need to catch success or error on the last operation\n                    // according to the IDB spec.\n                    req.onerror = BulkErrorHandlerCatchAll(errorList, done);\n                    req.onsuccess = eventSuccessHandler(done);\n                } else {\n                    var effectiveKeys = keys$$1 || idbstore.keyPath && objects.map(function (o) {\n                        return getByKeyPath(o, idbstore.keyPath);\n                    });\n                    // Generate map of {[key]: object}\n                    var objectLookup = effectiveKeys && arrayToObject(effectiveKeys, function (key, i) {\n                        return key != null && [key, objects[i]];\n                    });\n                    var promise = !effectiveKeys ?\n\n                    // Auto-incremented key-less objects only without any keys argument.\n                    table.bulkAdd(objects) :\n\n                    // Keys provided. Either as inbound in provided objects, or as a keys argument.\n                    // Begin with updating those that exists in DB:\n                    table.where(':id').anyOf(effectiveKeys.filter(function (key) {\n                        return key != null;\n                    })).modify(function () {\n                        this.value = objectLookup[this.primKey];\n                        objectLookup[this.primKey] = null; // Mark as \"don't add this\"\n                    }).catch(ModifyError, function (e) {\n                        errorList = e.failures; // No need to concat here. These are the first errors added.\n                    }).then(function () {\n                        // Now, let's examine which items didnt exist so we can add them:\n                        var objsToAdd = [],\n                            keysToAdd = keys$$1 && [];\n                        // Iterate backwards. Why? Because if same key was used twice, just add the last one.\n                        for (var i = effectiveKeys.length - 1; i >= 0; --i) {\n                            var key = effectiveKeys[i];\n                            if (key == null || objectLookup[key]) {\n                                objsToAdd.push(objects[i]);\n                                keys$$1 && keysToAdd.push(key);\n                                if (key != null) objectLookup[key] = null; // Mark as \"dont add again\"\n                            }\n                        }\n                        // The items are in reverse order so reverse them before adding.\n                        // Could be important in order to get auto-incremented keys the way the caller\n                        // would expect. Could have used unshift instead of push()/reverse(),\n                        // but: http://jsperf.com/unshift-vs-reverse\n                        objsToAdd.reverse();\n                        keys$$1 && keysToAdd.reverse();\n                        return table.bulkAdd(objsToAdd, keysToAdd);\n                    }).then(function (lastAddedKey) {\n                        // Resolve with key of the last object in given arguments to bulkPut():\n                        var lastEffectiveKey = effectiveKeys[effectiveKeys.length - 1]; // Key was provided.\n                        return lastEffectiveKey != null ? lastEffectiveKey : lastAddedKey;\n                    });\n\n                    promise.then(done).catch(BulkError, function (e) {\n                        // Concat failure from ModifyError and reject using our 'done' method.\n                        errorList = errorList.concat(e.failures);\n                        done();\n                    }).catch(reject);\n                }\n            }, \"locked\"); // If called from transaction scope, lock transaction til all steps are done.\n        },\n        bulkAdd: function (objects, keys$$1) {\n            var self = this,\n                creatingHook = this.hook.creating.fire;\n            return this._idbstore(READWRITE, function (resolve, reject, idbstore, trans) {\n                if (!idbstore.keyPath && !self.schema.primKey.auto && !keys$$1) throw new exceptions.InvalidArgument(\"bulkAdd() with non-inbound keys requires keys array in second argument\");\n                if (idbstore.keyPath && keys$$1) throw new exceptions.InvalidArgument(\"bulkAdd(): keys argument invalid on tables with inbound keys\");\n                if (keys$$1 && keys$$1.length !== objects.length) throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n                if (objects.length === 0) return resolve(); // Caller provided empty list.\n                function done(result) {\n                    if (errorList.length === 0) resolve(result);else reject(new BulkError(self.name + '.bulkAdd(): ' + errorList.length + ' of ' + numObjs + ' operations failed', errorList));\n                }\n                var req,\n                    errorList = [],\n                    errorHandler,\n                    successHandler,\n                    numObjs = objects.length;\n                if (creatingHook !== nop) {\n                    //\n                    // There are subscribers to hook('creating')\n                    // Must behave as documented.\n                    //\n                    var keyPath = idbstore.keyPath,\n                        hookCtx;\n                    errorHandler = BulkErrorHandlerCatchAll(errorList, null, true);\n                    successHandler = hookedEventSuccessHandler(null);\n\n                    tryCatch(function () {\n                        for (var i = 0, l = objects.length; i < l; ++i) {\n                            hookCtx = { onerror: null, onsuccess: null };\n                            var key = keys$$1 && keys$$1[i];\n                            var obj = objects[i],\n                                effectiveKey = keys$$1 ? key : keyPath ? getByKeyPath(obj, keyPath) : undefined,\n                                keyToUse = creatingHook.call(hookCtx, effectiveKey, obj, trans);\n                            if (effectiveKey == null && keyToUse != null) {\n                                if (keyPath) {\n                                    obj = deepClone(obj);\n                                    setByKeyPath(obj, keyPath, keyToUse);\n                                } else {\n                                    key = keyToUse;\n                                }\n                            }\n                            req = key != null ? idbstore.add(obj, key) : idbstore.add(obj);\n                            req._hookCtx = hookCtx;\n                            if (i < l - 1) {\n                                req.onerror = errorHandler;\n                                if (hookCtx.onsuccess) req.onsuccess = successHandler;\n                            }\n                        }\n                    }, function (err) {\n                        hookCtx.onerror && hookCtx.onerror(err);\n                        throw err;\n                    });\n\n                    req.onerror = BulkErrorHandlerCatchAll(errorList, done, true);\n                    req.onsuccess = hookedEventSuccessHandler(done);\n                } else {\n                    //\n                    // Standard Bulk (no 'creating' hook to care about)\n                    //\n                    errorHandler = BulkErrorHandlerCatchAll(errorList);\n                    for (var i = 0, l = objects.length; i < l; ++i) {\n                        req = keys$$1 ? idbstore.add(objects[i], keys$$1[i]) : idbstore.add(objects[i]);\n                        req.onerror = errorHandler;\n                    }\n                    // Only need to catch success or error on the last operation\n                    // according to the IDB spec.\n                    req.onerror = BulkErrorHandlerCatchAll(errorList, done);\n                    req.onsuccess = eventSuccessHandler(done);\n                }\n            });\n        },\n        add: function (obj, key) {\n            /// <summary>\n            ///   Add an object to the database. In case an object with same primary key already exists, the object will not be added.\n            /// </summary>\n            /// <param name=\"obj\" type=\"Object\">A javascript object to insert</param>\n            /// <param name=\"key\" optional=\"true\">Primary key</param>\n            var creatingHook = this.hook.creating.fire;\n            return this._idbstore(READWRITE, function (resolve, reject, idbstore, trans) {\n                var hookCtx = { onsuccess: null, onerror: null };\n                if (creatingHook !== nop) {\n                    var effectiveKey = key != null ? key : idbstore.keyPath ? getByKeyPath(obj, idbstore.keyPath) : undefined;\n                    var keyToUse = creatingHook.call(hookCtx, effectiveKey, obj, trans); // Allow subscribers to when(\"creating\") to generate the key.\n                    if (effectiveKey == null && keyToUse != null) {\n                        // Using \"==\" and \"!=\" to check for either null or undefined!\n                        if (idbstore.keyPath) setByKeyPath(obj, idbstore.keyPath, keyToUse);else key = keyToUse;\n                    }\n                }\n                try {\n                    var req = key != null ? idbstore.add(obj, key) : idbstore.add(obj);\n                    req._hookCtx = hookCtx;\n                    req.onerror = hookedEventRejectHandler(reject);\n                    req.onsuccess = hookedEventSuccessHandler(function (result) {\n                        // TODO: Remove these two lines in next major release (2.0?)\n                        // It's no good practice to have side effects on provided parameters\n                        var keyPath = idbstore.keyPath;\n                        if (keyPath) setByKeyPath(obj, keyPath, result);\n                        resolve(result);\n                    });\n                } catch (e) {\n                    if (hookCtx.onerror) hookCtx.onerror(e);\n                    throw e;\n                }\n            });\n        },\n\n        put: function (obj, key) {\n            /// <summary>\n            ///   Add an object to the database but in case an object with same primary key alread exists, the existing one will get updated.\n            /// </summary>\n            /// <param name=\"obj\" type=\"Object\">A javascript object to insert or update</param>\n            /// <param name=\"key\" optional=\"true\">Primary key</param>\n            var self = this,\n                creatingHook = this.hook.creating.fire,\n                updatingHook = this.hook.updating.fire;\n            if (creatingHook !== nop || updatingHook !== nop) {\n                //\n                // People listens to when(\"creating\") or when(\"updating\") events!\n                // We must know whether the put operation results in an CREATE or UPDATE.\n                //\n                return this._trans(READWRITE, function (resolve, reject, trans) {\n                    // Since key is optional, make sure we get it from obj if not provided\n                    var effectiveKey = key !== undefined ? key : self.schema.primKey.keyPath && getByKeyPath(obj, self.schema.primKey.keyPath);\n                    if (effectiveKey == null) {\n                        // \"== null\" means checking for either null or undefined.\n                        // No primary key. Must use add().\n                        self.add(obj).then(resolve, reject);\n                    } else {\n                        // Primary key exist. Lock transaction and try modifying existing. If nothing modified, call add().\n                        trans._lock(); // Needed because operation is splitted into modify() and add().\n                        // clone obj before this async call. If caller modifies obj the line after put(), the IDB spec requires that it should not affect operation.\n                        obj = deepClone(obj);\n                        self.where(\":id\").equals(effectiveKey).modify(function () {\n                            // Replace extisting value with our object\n                            // CRUD event firing handled in WriteableCollection.modify()\n                            this.value = obj;\n                        }).then(function (count) {\n                            if (count === 0) {\n                                // Object's key was not found. Add the object instead.\n                                // CRUD event firing will be done in add()\n                                return self.add(obj, key); // Resolving with another Promise. Returned Promise will then resolve with the new key.\n                            } else {\n                                return effectiveKey; // Resolve with the provided key.\n                            }\n                        }).finally(function () {\n                            trans._unlock();\n                        }).then(resolve, reject);\n                    }\n                });\n            } else {\n                // Use the standard IDB put() method.\n                return this._idbstore(READWRITE, function (resolve, reject, idbstore) {\n                    var req = key !== undefined ? idbstore.put(obj, key) : idbstore.put(obj);\n                    req.onerror = eventRejectHandler(reject);\n                    req.onsuccess = function (ev) {\n                        var keyPath = idbstore.keyPath;\n                        if (keyPath) setByKeyPath(obj, keyPath, ev.target.result);\n                        resolve(req.result);\n                    };\n                });\n            }\n        },\n\n        'delete': function (key) {\n            /// <param name=\"key\">Primary key of the object to delete</param>\n            if (this.hook.deleting.subscribers.length) {\n                // People listens to when(\"deleting\") event. Must implement delete using WriteableCollection.delete() that will\n                // call the CRUD event. Only WriteableCollection.delete() will know whether an object was actually deleted.\n                return this.where(\":id\").equals(key).delete();\n            } else {\n                // No one listens. Use standard IDB delete() method.\n                return this._idbstore(READWRITE, function (resolve, reject, idbstore) {\n                    var req = idbstore.delete(key);\n                    req.onerror = eventRejectHandler(reject);\n                    req.onsuccess = function () {\n                        resolve(req.result);\n                    };\n                });\n            }\n        },\n\n        clear: function () {\n            if (this.hook.deleting.subscribers.length) {\n                // People listens to when(\"deleting\") event. Must implement delete using WriteableCollection.delete() that will\n                // call the CRUD event. Only WriteableCollection.delete() will knows which objects that are actually deleted.\n                return this.toCollection().delete();\n            } else {\n                return this._idbstore(READWRITE, function (resolve, reject, idbstore) {\n                    var req = idbstore.clear();\n                    req.onerror = eventRejectHandler(reject);\n                    req.onsuccess = function () {\n                        resolve(req.result);\n                    };\n                });\n            }\n        },\n\n        update: function (keyOrObject, modifications) {\n            if (typeof modifications !== 'object' || isArray(modifications)) throw new exceptions.InvalidArgument(\"Modifications must be an object.\");\n            if (typeof keyOrObject === 'object' && !isArray(keyOrObject)) {\n                // object to modify. Also modify given object with the modifications:\n                keys(modifications).forEach(function (keyPath) {\n                    setByKeyPath(keyOrObject, keyPath, modifications[keyPath]);\n                });\n                var key = getByKeyPath(keyOrObject, this.schema.primKey.keyPath);\n                if (key === undefined) return rejection(new exceptions.InvalidArgument(\"Given object does not contain its primary key\"), dbUncaught);\n                return this.where(\":id\").equals(key).modify(modifications);\n            } else {\n                // key to modify\n                return this.where(\":id\").equals(keyOrObject).modify(modifications);\n            }\n        }\n    });\n\n    //\n    //\n    //\n    // Transaction Class\n    //\n    //\n    //\n    function Transaction(mode, storeNames, dbschema, parent) {\n        var _this2 = this;\n\n        /// <summary>\n        ///    Transaction class. Represents a database transaction. All operations on db goes through a Transaction.\n        /// </summary>\n        /// <param name=\"mode\" type=\"String\">Any of \"readwrite\" or \"readonly\"</param>\n        /// <param name=\"storeNames\" type=\"Array\">Array of table names to operate on</param>\n        this.db = db;\n        this.mode = mode;\n        this.storeNames = storeNames;\n        this.idbtrans = null;\n        this.on = Events(this, \"complete\", \"error\", \"abort\");\n        this.parent = parent || null;\n        this.active = true;\n        this._tables = null;\n        this._reculock = 0;\n        this._blockedFuncs = [];\n        this._psd = null;\n        this._dbschema = dbschema;\n        this._resolve = null;\n        this._reject = null;\n        this._completion = new Promise(function (resolve, reject) {\n            _this2._resolve = resolve;\n            _this2._reject = reject;\n        }).uncaught(dbUncaught);\n\n        this._completion.then(function () {\n            _this2.on.complete.fire();\n        }, function (e) {\n            _this2.on.error.fire(e);\n            _this2.parent ? _this2.parent._reject(e) : _this2.active && _this2.idbtrans && _this2.idbtrans.abort();\n            _this2.active = false;\n            return rejection(e); // Indicate we actually DO NOT catch this error.\n        });\n    }\n\n    props(Transaction.prototype, {\n        //\n        // Transaction Protected Methods (not required by API users, but needed internally and eventually by dexie extensions)\n        //\n        _lock: function () {\n            assert(!PSD.global); // Locking and unlocking reuires to be within a PSD scope.\n            // Temporary set all requests into a pending queue if they are called before database is ready.\n            ++this._reculock; // Recursive read/write lock pattern using PSD (Promise Specific Data) instead of TLS (Thread Local Storage)\n            if (this._reculock === 1 && !PSD.global) PSD.lockOwnerFor = this;\n            return this;\n        },\n        _unlock: function () {\n            assert(!PSD.global); // Locking and unlocking reuires to be within a PSD scope.\n            if (--this._reculock === 0) {\n                if (!PSD.global) PSD.lockOwnerFor = null;\n                while (this._blockedFuncs.length > 0 && !this._locked()) {\n                    var fnAndPSD = this._blockedFuncs.shift();\n                    try {\n                        usePSD(fnAndPSD[1], fnAndPSD[0]);\n                    } catch (e) {}\n                }\n            }\n            return this;\n        },\n        _locked: function () {\n            // Checks if any write-lock is applied on this transaction.\n            // To simplify the Dexie API for extension implementations, we support recursive locks.\n            // This is accomplished by using \"Promise Specific Data\" (PSD).\n            // PSD data is bound to a Promise and any child Promise emitted through then() or resolve( new Promise() ).\n            // PSD is local to code executing on top of the call stacks of any of any code executed by Promise():\n            //         * callback given to the Promise() constructor  (function (resolve, reject){...})\n            //         * callbacks given to then()/catch()/finally() methods (function (value){...})\n            // If creating a new independant Promise instance from within a Promise call stack, the new Promise will derive the PSD from the call stack of the parent Promise.\n            // Derivation is done so that the inner PSD __proto__ points to the outer PSD.\n            // PSD.lockOwnerFor will point to current transaction object if the currently executing PSD scope owns the lock.\n            return this._reculock && PSD.lockOwnerFor !== this;\n        },\n        create: function (idbtrans) {\n            var _this3 = this;\n\n            assert(!this.idbtrans);\n            if (!idbtrans && !idbdb) {\n                switch (dbOpenError && dbOpenError.name) {\n                    case \"DatabaseClosedError\":\n                        // Errors where it is no difference whether it was caused by the user operation or an earlier call to db.open()\n                        throw new exceptions.DatabaseClosed(dbOpenError);\n                    case \"MissingAPIError\":\n                        // Errors where it is no difference whether it was caused by the user operation or an earlier call to db.open()\n                        throw new exceptions.MissingAPI(dbOpenError.message, dbOpenError);\n                    default:\n                        // Make it clear that the user operation was not what caused the error - the error had occurred earlier on db.open()!\n                        throw new exceptions.OpenFailed(dbOpenError);\n                }\n            }\n            if (!this.active) throw new exceptions.TransactionInactive();\n            assert(this._completion._state === null);\n\n            idbtrans = this.idbtrans = idbtrans || idbdb.transaction(safariMultiStoreFix(this.storeNames), this.mode);\n            idbtrans.onerror = wrap(function (ev) {\n                preventDefault(ev); // Prohibit default bubbling to window.error\n                _this3._reject(idbtrans.error);\n            });\n            idbtrans.onabort = wrap(function (ev) {\n                preventDefault(ev);\n                _this3.active && _this3._reject(new exceptions.Abort());\n                _this3.active = false;\n                _this3.on(\"abort\").fire(ev);\n            });\n            idbtrans.oncomplete = wrap(function () {\n                _this3.active = false;\n                _this3._resolve();\n            });\n            return this;\n        },\n        _promise: function (mode, fn, bWriteLock) {\n            var self = this;\n            var p = self._locked() ?\n            // Read lock always. Transaction is write-locked. Wait for mutex.\n            new Promise(function (resolve, reject) {\n                self._blockedFuncs.push([function () {\n                    self._promise(mode, fn, bWriteLock).then(resolve, reject);\n                }, PSD]);\n            }) : newScope(function () {\n                var p_ = self.active ? new Promise(function (resolve, reject) {\n                    if (mode === READWRITE && self.mode !== READWRITE) throw new exceptions.ReadOnly(\"Transaction is readonly\");\n                    if (!self.idbtrans && mode) self.create();\n                    if (bWriteLock) self._lock(); // Write lock if write operation is requested\n                    fn(resolve, reject, self);\n                }) : rejection(new exceptions.TransactionInactive());\n                if (self.active && bWriteLock) p_.finally(function () {\n                    self._unlock();\n                });\n                return p_;\n            });\n\n            p._lib = true;\n            return p.uncaught(dbUncaught);\n        },\n\n        //\n        // Transaction Public Properties and Methods\n        //\n        abort: function () {\n            this.active && this._reject(new exceptions.Abort());\n            this.active = false;\n        },\n\n        tables: {\n            get: deprecated(\"Transaction.tables\", function () {\n                return arrayToObject(this.storeNames, function (name) {\n                    return [name, allTables[name]];\n                });\n            }, \"Use db.tables()\")\n        },\n\n        complete: deprecated(\"Transaction.complete()\", function (cb) {\n            return this.on(\"complete\", cb);\n        }),\n\n        error: deprecated(\"Transaction.error()\", function (cb) {\n            return this.on(\"error\", cb);\n        }),\n\n        table: deprecated(\"Transaction.table()\", function (name) {\n            if (this.storeNames.indexOf(name) === -1) throw new exceptions.InvalidTable(\"Table \" + name + \" not in transaction\");\n            return allTables[name];\n        })\n\n    });\n\n    //\n    //\n    //\n    // WhereClause\n    //\n    //\n    //\n    function WhereClause(table, index, orCollection) {\n        /// <param name=\"table\" type=\"Table\"></param>\n        /// <param name=\"index\" type=\"String\" optional=\"true\"></param>\n        /// <param name=\"orCollection\" type=\"Collection\" optional=\"true\"></param>\n        this._ctx = {\n            table: table,\n            index: index === \":id\" ? null : index,\n            collClass: table._collClass,\n            or: orCollection\n        };\n    }\n\n    props(WhereClause.prototype, function () {\n\n        // WhereClause private methods\n\n        function fail(collectionOrWhereClause, err, T) {\n            var collection = collectionOrWhereClause instanceof WhereClause ? new collectionOrWhereClause._ctx.collClass(collectionOrWhereClause) : collectionOrWhereClause;\n\n            collection._ctx.error = T ? new T(err) : new TypeError(err);\n            return collection;\n        }\n\n        function emptyCollection(whereClause) {\n            return new whereClause._ctx.collClass(whereClause, function () {\n                return IDBKeyRange.only(\"\");\n            }).limit(0);\n        }\n\n        function upperFactory(dir) {\n            return dir === \"next\" ? function (s) {\n                return s.toUpperCase();\n            } : function (s) {\n                return s.toLowerCase();\n            };\n        }\n        function lowerFactory(dir) {\n            return dir === \"next\" ? function (s) {\n                return s.toLowerCase();\n            } : function (s) {\n                return s.toUpperCase();\n            };\n        }\n        function nextCasing(key, lowerKey, upperNeedle, lowerNeedle, cmp, dir) {\n            var length = Math.min(key.length, lowerNeedle.length);\n            var llp = -1;\n            for (var i = 0; i < length; ++i) {\n                var lwrKeyChar = lowerKey[i];\n                if (lwrKeyChar !== lowerNeedle[i]) {\n                    if (cmp(key[i], upperNeedle[i]) < 0) return key.substr(0, i) + upperNeedle[i] + upperNeedle.substr(i + 1);\n                    if (cmp(key[i], lowerNeedle[i]) < 0) return key.substr(0, i) + lowerNeedle[i] + upperNeedle.substr(i + 1);\n                    if (llp >= 0) return key.substr(0, llp) + lowerKey[llp] + upperNeedle.substr(llp + 1);\n                    return null;\n                }\n                if (cmp(key[i], lwrKeyChar) < 0) llp = i;\n            }\n            if (length < lowerNeedle.length && dir === \"next\") return key + upperNeedle.substr(key.length);\n            if (length < key.length && dir === \"prev\") return key.substr(0, upperNeedle.length);\n            return llp < 0 ? null : key.substr(0, llp) + lowerNeedle[llp] + upperNeedle.substr(llp + 1);\n        }\n\n        function addIgnoreCaseAlgorithm(whereClause, match, needles, suffix) {\n            /// <param name=\"needles\" type=\"Array\" elementType=\"String\"></param>\n            var upper,\n                lower,\n                compare,\n                upperNeedles,\n                lowerNeedles,\n                direction,\n                nextKeySuffix,\n                needlesLen = needles.length;\n            if (!needles.every(function (s) {\n                return typeof s === 'string';\n            })) {\n                return fail(whereClause, STRING_EXPECTED);\n            }\n            function initDirection(dir) {\n                upper = upperFactory(dir);\n                lower = lowerFactory(dir);\n                compare = dir === \"next\" ? simpleCompare : simpleCompareReverse;\n                var needleBounds = needles.map(function (needle) {\n                    return { lower: lower(needle), upper: upper(needle) };\n                }).sort(function (a, b) {\n                    return compare(a.lower, b.lower);\n                });\n                upperNeedles = needleBounds.map(function (nb) {\n                    return nb.upper;\n                });\n                lowerNeedles = needleBounds.map(function (nb) {\n                    return nb.lower;\n                });\n                direction = dir;\n                nextKeySuffix = dir === \"next\" ? \"\" : suffix;\n            }\n            initDirection(\"next\");\n\n            var c = new whereClause._ctx.collClass(whereClause, function () {\n                return IDBKeyRange.bound(upperNeedles[0], lowerNeedles[needlesLen - 1] + suffix);\n            });\n\n            c._ondirectionchange = function (direction) {\n                // This event onlys occur before filter is called the first time.\n                initDirection(direction);\n            };\n\n            var firstPossibleNeedle = 0;\n\n            c._addAlgorithm(function (cursor, advance, resolve) {\n                /// <param name=\"cursor\" type=\"IDBCursor\"></param>\n                /// <param name=\"advance\" type=\"Function\"></param>\n                /// <param name=\"resolve\" type=\"Function\"></param>\n                var key = cursor.key;\n                if (typeof key !== 'string') return false;\n                var lowerKey = lower(key);\n                if (match(lowerKey, lowerNeedles, firstPossibleNeedle)) {\n                    return true;\n                } else {\n                    var lowestPossibleCasing = null;\n                    for (var i = firstPossibleNeedle; i < needlesLen; ++i) {\n                        var casing = nextCasing(key, lowerKey, upperNeedles[i], lowerNeedles[i], compare, direction);\n                        if (casing === null && lowestPossibleCasing === null) firstPossibleNeedle = i + 1;else if (lowestPossibleCasing === null || compare(lowestPossibleCasing, casing) > 0) {\n                            lowestPossibleCasing = casing;\n                        }\n                    }\n                    if (lowestPossibleCasing !== null) {\n                        advance(function () {\n                            cursor.continue(lowestPossibleCasing + nextKeySuffix);\n                        });\n                    } else {\n                        advance(resolve);\n                    }\n                    return false;\n                }\n            });\n            return c;\n        }\n\n        //\n        // WhereClause public methods\n        //\n        return {\n            between: function (lower, upper, includeLower, includeUpper) {\n                /// <summary>\n                ///     Filter out records whose where-field lays between given lower and upper values. Applies to Strings, Numbers and Dates.\n                /// </summary>\n                /// <param name=\"lower\"></param>\n                /// <param name=\"upper\"></param>\n                /// <param name=\"includeLower\" optional=\"true\">Whether items that equals lower should be included. Default true.</param>\n                /// <param name=\"includeUpper\" optional=\"true\">Whether items that equals upper should be included. Default false.</param>\n                /// <returns type=\"Collection\"></returns>\n                includeLower = includeLower !== false; // Default to true\n                includeUpper = includeUpper === true; // Default to false\n                try {\n                    if (cmp(lower, upper) > 0 || cmp(lower, upper) === 0 && (includeLower || includeUpper) && !(includeLower && includeUpper)) return emptyCollection(this); // Workaround for idiotic W3C Specification that DataError must be thrown if lower > upper. The natural result would be to return an empty collection.\n                    return new this._ctx.collClass(this, function () {\n                        return IDBKeyRange.bound(lower, upper, !includeLower, !includeUpper);\n                    });\n                } catch (e) {\n                    return fail(this, INVALID_KEY_ARGUMENT);\n                }\n            },\n            equals: function (value) {\n                return new this._ctx.collClass(this, function () {\n                    return IDBKeyRange.only(value);\n                });\n            },\n            above: function (value) {\n                return new this._ctx.collClass(this, function () {\n                    return IDBKeyRange.lowerBound(value, true);\n                });\n            },\n            aboveOrEqual: function (value) {\n                return new this._ctx.collClass(this, function () {\n                    return IDBKeyRange.lowerBound(value);\n                });\n            },\n            below: function (value) {\n                return new this._ctx.collClass(this, function () {\n                    return IDBKeyRange.upperBound(value, true);\n                });\n            },\n            belowOrEqual: function (value) {\n                return new this._ctx.collClass(this, function () {\n                    return IDBKeyRange.upperBound(value);\n                });\n            },\n            startsWith: function (str) {\n                /// <param name=\"str\" type=\"String\"></param>\n                if (typeof str !== 'string') return fail(this, STRING_EXPECTED);\n                return this.between(str, str + maxString, true, true);\n            },\n            startsWithIgnoreCase: function (str) {\n                /// <param name=\"str\" type=\"String\"></param>\n                if (str === \"\") return this.startsWith(str);\n                return addIgnoreCaseAlgorithm(this, function (x, a) {\n                    return x.indexOf(a[0]) === 0;\n                }, [str], maxString);\n            },\n            equalsIgnoreCase: function (str) {\n                /// <param name=\"str\" type=\"String\"></param>\n                return addIgnoreCaseAlgorithm(this, function (x, a) {\n                    return x === a[0];\n                }, [str], \"\");\n            },\n            anyOfIgnoreCase: function () {\n                var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n                if (set.length === 0) return emptyCollection(this);\n                return addIgnoreCaseAlgorithm(this, function (x, a) {\n                    return a.indexOf(x) !== -1;\n                }, set, \"\");\n            },\n            startsWithAnyOfIgnoreCase: function () {\n                var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n                if (set.length === 0) return emptyCollection(this);\n                return addIgnoreCaseAlgorithm(this, function (x, a) {\n                    return a.some(function (n) {\n                        return x.indexOf(n) === 0;\n                    });\n                }, set, maxString);\n            },\n            anyOf: function () {\n                var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n                var compare = ascending;\n                try {\n                    set.sort(compare);\n                } catch (e) {\n                    return fail(this, INVALID_KEY_ARGUMENT);\n                }\n                if (set.length === 0) return emptyCollection(this);\n                var c = new this._ctx.collClass(this, function () {\n                    return IDBKeyRange.bound(set[0], set[set.length - 1]);\n                });\n\n                c._ondirectionchange = function (direction) {\n                    compare = direction === \"next\" ? ascending : descending;\n                    set.sort(compare);\n                };\n                var i = 0;\n                c._addAlgorithm(function (cursor, advance, resolve) {\n                    var key = cursor.key;\n                    while (compare(key, set[i]) > 0) {\n                        // The cursor has passed beyond this key. Check next.\n                        ++i;\n                        if (i === set.length) {\n                            // There is no next. Stop searching.\n                            advance(resolve);\n                            return false;\n                        }\n                    }\n                    if (compare(key, set[i]) === 0) {\n                        // The current cursor value should be included and we should continue a single step in case next item has the same key or possibly our next key in set.\n                        return true;\n                    } else {\n                        // cursor.key not yet at set[i]. Forward cursor to the next key to hunt for.\n                        advance(function () {\n                            cursor.continue(set[i]);\n                        });\n                        return false;\n                    }\n                });\n                return c;\n            },\n\n            notEqual: function (value) {\n                return this.inAnyRange([[-Infinity, value], [value, maxKey]], { includeLowers: false, includeUppers: false });\n            },\n\n            noneOf: function () {\n                var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n                if (set.length === 0) return new this._ctx.collClass(this); // Return entire collection.\n                try {\n                    set.sort(ascending);\n                } catch (e) {\n                    return fail(this, INVALID_KEY_ARGUMENT);\n                }\n                // Transform [\"a\",\"b\",\"c\"] to a set of ranges for between/above/below: [[-Infinity,\"a\"], [\"a\",\"b\"], [\"b\",\"c\"], [\"c\",maxKey]]\n                var ranges = set.reduce(function (res, val) {\n                    return res ? res.concat([[res[res.length - 1][1], val]]) : [[-Infinity, val]];\n                }, null);\n                ranges.push([set[set.length - 1], maxKey]);\n                return this.inAnyRange(ranges, { includeLowers: false, includeUppers: false });\n            },\n\n            /** Filter out values withing given set of ranges.\r\n            * Example, give children and elders a rebate of 50%:\r\n            *\r\n            *   db.friends.where('age').inAnyRange([[0,18],[65,Infinity]]).modify({Rebate: 1/2});\r\n            *\r\n            * @param {(string|number|Date|Array)[][]} ranges\r\n            * @param {{includeLowers: boolean, includeUppers: boolean}} options\r\n            */\n            inAnyRange: function (ranges, options) {\n                var ctx = this._ctx;\n                if (ranges.length === 0) return emptyCollection(this);\n                if (!ranges.every(function (range) {\n                    return range[0] !== undefined && range[1] !== undefined && ascending(range[0], range[1]) <= 0;\n                })) {\n                    return fail(this, \"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower\", exceptions.InvalidArgument);\n                }\n                var includeLowers = !options || options.includeLowers !== false; // Default to true\n                var includeUppers = options && options.includeUppers === true; // Default to false\n\n                function addRange(ranges, newRange) {\n                    for (var i = 0, l = ranges.length; i < l; ++i) {\n                        var range = ranges[i];\n                        if (cmp(newRange[0], range[1]) < 0 && cmp(newRange[1], range[0]) > 0) {\n                            range[0] = min(range[0], newRange[0]);\n                            range[1] = max(range[1], newRange[1]);\n                            break;\n                        }\n                    }\n                    if (i === l) ranges.push(newRange);\n                    return ranges;\n                }\n\n                var sortDirection = ascending;\n                function rangeSorter(a, b) {\n                    return sortDirection(a[0], b[0]);\n                }\n\n                // Join overlapping ranges\n                var set;\n                try {\n                    set = ranges.reduce(addRange, []);\n                    set.sort(rangeSorter);\n                } catch (ex) {\n                    return fail(this, INVALID_KEY_ARGUMENT);\n                }\n\n                var i = 0;\n                var keyIsBeyondCurrentEntry = includeUppers ? function (key) {\n                    return ascending(key, set[i][1]) > 0;\n                } : function (key) {\n                    return ascending(key, set[i][1]) >= 0;\n                };\n\n                var keyIsBeforeCurrentEntry = includeLowers ? function (key) {\n                    return descending(key, set[i][0]) > 0;\n                } : function (key) {\n                    return descending(key, set[i][0]) >= 0;\n                };\n\n                function keyWithinCurrentRange(key) {\n                    return !keyIsBeyondCurrentEntry(key) && !keyIsBeforeCurrentEntry(key);\n                }\n\n                var checkKey = keyIsBeyondCurrentEntry;\n\n                var c = new ctx.collClass(this, function () {\n                    return IDBKeyRange.bound(set[0][0], set[set.length - 1][1], !includeLowers, !includeUppers);\n                });\n\n                c._ondirectionchange = function (direction) {\n                    if (direction === \"next\") {\n                        checkKey = keyIsBeyondCurrentEntry;\n                        sortDirection = ascending;\n                    } else {\n                        checkKey = keyIsBeforeCurrentEntry;\n                        sortDirection = descending;\n                    }\n                    set.sort(rangeSorter);\n                };\n\n                c._addAlgorithm(function (cursor, advance, resolve) {\n                    var key = cursor.key;\n                    while (checkKey(key)) {\n                        // The cursor has passed beyond this key. Check next.\n                        ++i;\n                        if (i === set.length) {\n                            // There is no next. Stop searching.\n                            advance(resolve);\n                            return false;\n                        }\n                    }\n                    if (keyWithinCurrentRange(key)) {\n                        // The current cursor value should be included and we should continue a single step in case next item has the same key or possibly our next key in set.\n                        return true;\n                    } else if (cmp(key, set[i][1]) === 0 || cmp(key, set[i][0]) === 0) {\n                        // includeUpper or includeLower is false so keyWithinCurrentRange() returns false even though we are at range border.\n                        // Continue to next key but don't include this one.\n                        return false;\n                    } else {\n                        // cursor.key not yet at set[i]. Forward cursor to the next key to hunt for.\n                        advance(function () {\n                            if (sortDirection === ascending) cursor.continue(set[i][0]);else cursor.continue(set[i][1]);\n                        });\n                        return false;\n                    }\n                });\n                return c;\n            },\n            startsWithAnyOf: function () {\n                var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n\n                if (!set.every(function (s) {\n                    return typeof s === 'string';\n                })) {\n                    return fail(this, \"startsWithAnyOf() only works with strings\");\n                }\n                if (set.length === 0) return emptyCollection(this);\n\n                return this.inAnyRange(set.map(function (str) {\n                    return [str, str + maxString];\n                }));\n            }\n        };\n    });\n\n    //\n    //\n    //\n    // Collection Class\n    //\n    //\n    //\n    function Collection(whereClause, keyRangeGenerator) {\n        /// <summary>\n        ///\n        /// </summary>\n        /// <param name=\"whereClause\" type=\"WhereClause\">Where clause instance</param>\n        /// <param name=\"keyRangeGenerator\" value=\"function(){ return IDBKeyRange.bound(0,1);}\" optional=\"true\"></param>\n        var keyRange = null,\n            error = null;\n        if (keyRangeGenerator) try {\n            keyRange = keyRangeGenerator();\n        } catch (ex) {\n            error = ex;\n        }\n\n        var whereCtx = whereClause._ctx,\n            table = whereCtx.table;\n        this._ctx = {\n            table: table,\n            index: whereCtx.index,\n            isPrimKey: !whereCtx.index || table.schema.primKey.keyPath && whereCtx.index === table.schema.primKey.name,\n            range: keyRange,\n            keysOnly: false,\n            dir: \"next\",\n            unique: \"\",\n            algorithm: null,\n            filter: null,\n            replayFilter: null,\n            justLimit: true, // True if a replayFilter is just a filter that performs a \"limit\" operation (or none at all)\n            isMatch: null,\n            offset: 0,\n            limit: Infinity,\n            error: error, // If set, any promise must be rejected with this error\n            or: whereCtx.or,\n            valueMapper: table.hook.reading.fire\n        };\n    }\n\n    function isPlainKeyRange(ctx, ignoreLimitFilter) {\n        return !(ctx.filter || ctx.algorithm || ctx.or) && (ignoreLimitFilter ? ctx.justLimit : !ctx.replayFilter);\n    }\n\n    props(Collection.prototype, function () {\n\n        //\n        // Collection Private Functions\n        //\n\n        function addFilter(ctx, fn) {\n            ctx.filter = combine(ctx.filter, fn);\n        }\n\n        function addReplayFilter(ctx, factory, isLimitFilter) {\n            var curr = ctx.replayFilter;\n            ctx.replayFilter = curr ? function () {\n                return combine(curr(), factory());\n            } : factory;\n            ctx.justLimit = isLimitFilter && !curr;\n        }\n\n        function addMatchFilter(ctx, fn) {\n            ctx.isMatch = combine(ctx.isMatch, fn);\n        }\n\n        /** @param ctx {\r\n         *      isPrimKey: boolean,\r\n         *      table: Table,\r\n         *      index: string\r\n         * }\r\n         * @param store IDBObjectStore\r\n         **/\n        function getIndexOrStore(ctx, store) {\n            if (ctx.isPrimKey) return store;\n            var indexSpec = ctx.table.schema.idxByName[ctx.index];\n            if (!indexSpec) throw new exceptions.Schema(\"KeyPath \" + ctx.index + \" on object store \" + store.name + \" is not indexed\");\n            return store.index(indexSpec.name);\n        }\n\n        /** @param ctx {\r\n         *      isPrimKey: boolean,\r\n         *      table: Table,\r\n         *      index: string,\r\n         *      keysOnly: boolean,\r\n         *      range?: IDBKeyRange,\r\n         *      dir: \"next\" | \"prev\"\r\n         * }\r\n         */\n        function openCursor(ctx, store) {\n            var idxOrStore = getIndexOrStore(ctx, store);\n            return ctx.keysOnly && 'openKeyCursor' in idxOrStore ? idxOrStore.openKeyCursor(ctx.range || null, ctx.dir + ctx.unique) : idxOrStore.openCursor(ctx.range || null, ctx.dir + ctx.unique);\n        }\n\n        function iter(ctx, fn, resolve, reject, idbstore) {\n            var filter = ctx.replayFilter ? combine(ctx.filter, ctx.replayFilter()) : ctx.filter;\n            if (!ctx.or) {\n                iterate(openCursor(ctx, idbstore), combine(ctx.algorithm, filter), fn, resolve, reject, !ctx.keysOnly && ctx.valueMapper);\n            } else (function () {\n                var set = {};\n                var resolved = 0;\n\n                function resolveboth() {\n                    if (++resolved === 2) resolve(); // Seems like we just support or btwn max 2 expressions, but there are no limit because we do recursion.\n                }\n\n                function union(item, cursor, advance) {\n                    if (!filter || filter(cursor, advance, resolveboth, reject)) {\n                        var key = cursor.primaryKey.toString(); // Converts any Date to String, String to String, Number to String and Array to comma-separated string\n                        if (!hasOwn(set, key)) {\n                            set[key] = true;\n                            fn(item, cursor, advance);\n                        }\n                    }\n                }\n\n                ctx.or._iterate(union, resolveboth, reject, idbstore);\n                iterate(openCursor(ctx, idbstore), ctx.algorithm, union, resolveboth, reject, !ctx.keysOnly && ctx.valueMapper);\n            })();\n        }\n        function getInstanceTemplate(ctx) {\n            return ctx.table.schema.instanceTemplate;\n        }\n\n        return {\n\n            //\n            // Collection Protected Functions\n            //\n\n            _read: function (fn, cb) {\n                var ctx = this._ctx;\n                if (ctx.error) return ctx.table._trans(null, function rejector(resolve, reject) {\n                    reject(ctx.error);\n                });else return ctx.table._idbstore(READONLY, fn).then(cb);\n            },\n            _write: function (fn) {\n                var ctx = this._ctx;\n                if (ctx.error) return ctx.table._trans(null, function rejector(resolve, reject) {\n                    reject(ctx.error);\n                });else return ctx.table._idbstore(READWRITE, fn, \"locked\"); // When doing write operations on collections, always lock the operation so that upcoming operations gets queued.\n            },\n            _addAlgorithm: function (fn) {\n                var ctx = this._ctx;\n                ctx.algorithm = combine(ctx.algorithm, fn);\n            },\n\n            _iterate: function (fn, resolve, reject, idbstore) {\n                return iter(this._ctx, fn, resolve, reject, idbstore);\n            },\n\n            clone: function (props$$1) {\n                var rv = Object.create(this.constructor.prototype),\n                    ctx = Object.create(this._ctx);\n                if (props$$1) extend(ctx, props$$1);\n                rv._ctx = ctx;\n                return rv;\n            },\n\n            raw: function () {\n                this._ctx.valueMapper = null;\n                return this;\n            },\n\n            //\n            // Collection Public methods\n            //\n\n            each: function (fn) {\n                var ctx = this._ctx;\n\n                if (fake) {\n                    var item = getInstanceTemplate(ctx),\n                        primKeyPath = ctx.table.schema.primKey.keyPath,\n                        key = getByKeyPath(item, ctx.index ? ctx.table.schema.idxByName[ctx.index].keyPath : primKeyPath),\n                        primaryKey = getByKeyPath(item, primKeyPath);\n                    fn(item, { key: key, primaryKey: primaryKey });\n                }\n\n                return this._read(function (resolve, reject, idbstore) {\n                    iter(ctx, fn, resolve, reject, idbstore);\n                });\n            },\n\n            count: function (cb) {\n                if (fake) return Promise.resolve(0).then(cb);\n                var ctx = this._ctx;\n\n                if (isPlainKeyRange(ctx, true)) {\n                    // This is a plain key range. We can use the count() method if the index.\n                    return this._read(function (resolve, reject, idbstore) {\n                        var idx = getIndexOrStore(ctx, idbstore);\n                        var req = ctx.range ? idx.count(ctx.range) : idx.count();\n                        req.onerror = eventRejectHandler(reject);\n                        req.onsuccess = function (e) {\n                            resolve(Math.min(e.target.result, ctx.limit));\n                        };\n                    }, cb);\n                } else {\n                    // Algorithms, filters or expressions are applied. Need to count manually.\n                    var count = 0;\n                    return this._read(function (resolve, reject, idbstore) {\n                        iter(ctx, function () {\n                            ++count;return false;\n                        }, function () {\n                            resolve(count);\n                        }, reject, idbstore);\n                    }, cb);\n                }\n            },\n\n            sortBy: function (keyPath, cb) {\n                /// <param name=\"keyPath\" type=\"String\"></param>\n                var parts = keyPath.split('.').reverse(),\n                    lastPart = parts[0],\n                    lastIndex = parts.length - 1;\n                function getval(obj, i) {\n                    if (i) return getval(obj[parts[i]], i - 1);\n                    return obj[lastPart];\n                }\n                var order = this._ctx.dir === \"next\" ? 1 : -1;\n\n                function sorter(a, b) {\n                    var aVal = getval(a, lastIndex),\n                        bVal = getval(b, lastIndex);\n                    return aVal < bVal ? -order : aVal > bVal ? order : 0;\n                }\n                return this.toArray(function (a) {\n                    return a.sort(sorter);\n                }).then(cb);\n            },\n\n            toArray: function (cb) {\n                var ctx = this._ctx;\n                return this._read(function (resolve, reject, idbstore) {\n                    fake && resolve([getInstanceTemplate(ctx)]);\n                    if (hasGetAll && ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                        // Special optimation if we could use IDBObjectStore.getAll() or\n                        // IDBKeyRange.getAll():\n                        var readingHook = ctx.table.hook.reading.fire;\n                        var idxOrStore = getIndexOrStore(ctx, idbstore);\n                        var req = ctx.limit < Infinity ? idxOrStore.getAll(ctx.range, ctx.limit) : idxOrStore.getAll(ctx.range);\n                        req.onerror = eventRejectHandler(reject);\n                        req.onsuccess = readingHook === mirror ? eventSuccessHandler(resolve) : wrap(eventSuccessHandler(function (res) {\n                            try {\n                                resolve(res.map(readingHook));\n                            } catch (e) {\n                                reject(e);\n                            }\n                        }));\n                    } else {\n                        // Getting array through a cursor.\n                        var a = [];\n                        iter(ctx, function (item) {\n                            a.push(item);\n                        }, function arrayComplete() {\n                            resolve(a);\n                        }, reject, idbstore);\n                    }\n                }, cb);\n            },\n\n            offset: function (offset) {\n                var ctx = this._ctx;\n                if (offset <= 0) return this;\n                ctx.offset += offset; // For count()\n                if (isPlainKeyRange(ctx)) {\n                    addReplayFilter(ctx, function () {\n                        var offsetLeft = offset;\n                        return function (cursor, advance) {\n                            if (offsetLeft === 0) return true;\n                            if (offsetLeft === 1) {\n                                --offsetLeft;return false;\n                            }\n                            advance(function () {\n                                cursor.advance(offsetLeft);\n                                offsetLeft = 0;\n                            });\n                            return false;\n                        };\n                    });\n                } else {\n                    addReplayFilter(ctx, function () {\n                        var offsetLeft = offset;\n                        return function () {\n                            return --offsetLeft < 0;\n                        };\n                    });\n                }\n                return this;\n            },\n\n            limit: function (numRows) {\n                this._ctx.limit = Math.min(this._ctx.limit, numRows); // For count()\n                addReplayFilter(this._ctx, function () {\n                    var rowsLeft = numRows;\n                    return function (cursor, advance, resolve) {\n                        if (--rowsLeft <= 0) advance(resolve); // Stop after this item has been included\n                        return rowsLeft >= 0; // If numRows is already below 0, return false because then 0 was passed to numRows initially. Otherwise we wouldnt come here.\n                    };\n                }, true);\n                return this;\n            },\n\n            until: function (filterFunction, bIncludeStopEntry) {\n                var ctx = this._ctx;\n                fake && filterFunction(getInstanceTemplate(ctx));\n                addFilter(this._ctx, function (cursor, advance, resolve) {\n                    if (filterFunction(cursor.value)) {\n                        advance(resolve);\n                        return bIncludeStopEntry;\n                    } else {\n                        return true;\n                    }\n                });\n                return this;\n            },\n\n            first: function (cb) {\n                return this.limit(1).toArray(function (a) {\n                    return a[0];\n                }).then(cb);\n            },\n\n            last: function (cb) {\n                return this.reverse().first(cb);\n            },\n\n            filter: function (filterFunction) {\n                /// <param name=\"jsFunctionFilter\" type=\"Function\">function(val){return true/false}</param>\n                fake && filterFunction(getInstanceTemplate(this._ctx));\n                addFilter(this._ctx, function (cursor) {\n                    return filterFunction(cursor.value);\n                });\n                // match filters not used in Dexie.js but can be used by 3rd part libraries to test a\n                // collection for a match without querying DB. Used by Dexie.Observable.\n                addMatchFilter(this._ctx, filterFunction);\n                return this;\n            },\n\n            and: function (filterFunction) {\n                return this.filter(filterFunction);\n            },\n\n            or: function (indexName) {\n                return new WhereClause(this._ctx.table, indexName, this);\n            },\n\n            reverse: function () {\n                this._ctx.dir = this._ctx.dir === \"prev\" ? \"next\" : \"prev\";\n                if (this._ondirectionchange) this._ondirectionchange(this._ctx.dir);\n                return this;\n            },\n\n            desc: function () {\n                return this.reverse();\n            },\n\n            eachKey: function (cb) {\n                var ctx = this._ctx;\n                ctx.keysOnly = !ctx.isMatch;\n                return this.each(function (val, cursor) {\n                    cb(cursor.key, cursor);\n                });\n            },\n\n            eachUniqueKey: function (cb) {\n                this._ctx.unique = \"unique\";\n                return this.eachKey(cb);\n            },\n\n            eachPrimaryKey: function (cb) {\n                var ctx = this._ctx;\n                ctx.keysOnly = !ctx.isMatch;\n                return this.each(function (val, cursor) {\n                    cb(cursor.primaryKey, cursor);\n                });\n            },\n\n            keys: function (cb) {\n                var ctx = this._ctx;\n                ctx.keysOnly = !ctx.isMatch;\n                var a = [];\n                return this.each(function (item, cursor) {\n                    a.push(cursor.key);\n                }).then(function () {\n                    return a;\n                }).then(cb);\n            },\n\n            primaryKeys: function (cb) {\n                var ctx = this._ctx;\n                if (hasGetAll && ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                    // Special optimation if we could use IDBObjectStore.getAllKeys() or\n                    // IDBKeyRange.getAllKeys():\n                    return this._read(function (resolve, reject, idbstore) {\n                        var idxOrStore = getIndexOrStore(ctx, idbstore);\n                        var req = ctx.limit < Infinity ? idxOrStore.getAllKeys(ctx.range, ctx.limit) : idxOrStore.getAllKeys(ctx.range);\n                        req.onerror = eventRejectHandler(reject);\n                        req.onsuccess = eventSuccessHandler(resolve);\n                    }).then(cb);\n                }\n                ctx.keysOnly = !ctx.isMatch;\n                var a = [];\n                return this.each(function (item, cursor) {\n                    a.push(cursor.primaryKey);\n                }).then(function () {\n                    return a;\n                }).then(cb);\n            },\n\n            uniqueKeys: function (cb) {\n                this._ctx.unique = \"unique\";\n                return this.keys(cb);\n            },\n\n            firstKey: function (cb) {\n                return this.limit(1).keys(function (a) {\n                    return a[0];\n                }).then(cb);\n            },\n\n            lastKey: function (cb) {\n                return this.reverse().firstKey(cb);\n            },\n\n            distinct: function () {\n                var ctx = this._ctx,\n                    idx = ctx.index && ctx.table.schema.idxByName[ctx.index];\n                if (!idx || !idx.multi) return this; // distinct() only makes differencies on multiEntry indexes.\n                var set = {};\n                addFilter(this._ctx, function (cursor) {\n                    var strKey = cursor.primaryKey.toString(); // Converts any Date to String, String to String, Number to String and Array to comma-separated string\n                    var found = hasOwn(set, strKey);\n                    set[strKey] = true;\n                    return !found;\n                });\n                return this;\n            }\n        };\n    });\n\n    //\n    //\n    // WriteableCollection Class\n    //\n    //\n    function WriteableCollection() {\n        Collection.apply(this, arguments);\n    }\n\n    derive(WriteableCollection).from(Collection).extend({\n\n        //\n        // WriteableCollection Public Methods\n        //\n\n        modify: function (changes) {\n            var self = this,\n                ctx = this._ctx,\n                hook = ctx.table.hook,\n                updatingHook = hook.updating.fire,\n                deletingHook = hook.deleting.fire;\n\n            fake && typeof changes === 'function' && changes.call({ value: ctx.table.schema.instanceTemplate }, ctx.table.schema.instanceTemplate);\n\n            return this._write(function (resolve, reject, idbstore, trans) {\n                var modifyer;\n                if (typeof changes === 'function') {\n                    // Changes is a function that may update, add or delete propterties or even require a deletion the object itself (delete this.item)\n                    if (updatingHook === nop && deletingHook === nop) {\n                        // Noone cares about what is being changed. Just let the modifier function be the given argument as is.\n                        modifyer = changes;\n                    } else {\n                        // People want to know exactly what is being modified or deleted.\n                        // Let modifyer be a proxy function that finds out what changes the caller is actually doing\n                        // and call the hooks accordingly!\n                        modifyer = function (item) {\n                            var origItem = deepClone(item); // Clone the item first so we can compare laters.\n                            if (changes.call(this, item, this) === false) return false; // Call the real modifyer function (If it returns false explicitely, it means it dont want to modify anyting on this object)\n                            if (!hasOwn(this, \"value\")) {\n                                // The real modifyer function requests a deletion of the object. Inform the deletingHook that a deletion is taking place.\n                                deletingHook.call(this, this.primKey, item, trans);\n                            } else {\n                                // No deletion. Check what was changed\n                                var objectDiff = getObjectDiff(origItem, this.value);\n                                var additionalChanges = updatingHook.call(this, objectDiff, this.primKey, origItem, trans);\n                                if (additionalChanges) {\n                                    // Hook want to apply additional modifications. Make sure to fullfill the will of the hook.\n                                    item = this.value;\n                                    keys(additionalChanges).forEach(function (keyPath) {\n                                        setByKeyPath(item, keyPath, additionalChanges[keyPath]); // Adding {keyPath: undefined} means that the keyPath should be deleted. Handled by setByKeyPath\n                                    });\n                                }\n                            }\n                        };\n                    }\n                } else if (updatingHook === nop) {\n                    // changes is a set of {keyPath: value} and no one is listening to the updating hook.\n                    var keyPaths = keys(changes);\n                    var numKeys = keyPaths.length;\n                    modifyer = function (item) {\n                        var anythingModified = false;\n                        for (var i = 0; i < numKeys; ++i) {\n                            var keyPath = keyPaths[i],\n                                val = changes[keyPath];\n                            if (getByKeyPath(item, keyPath) !== val) {\n                                setByKeyPath(item, keyPath, val); // Adding {keyPath: undefined} means that the keyPath should be deleted. Handled by setByKeyPath\n                                anythingModified = true;\n                            }\n                        }\n                        return anythingModified;\n                    };\n                } else {\n                    // changes is a set of {keyPath: value} and people are listening to the updating hook so we need to call it and\n                    // allow it to add additional modifications to make.\n                    var origChanges = changes;\n                    changes = shallowClone(origChanges); // Let's work with a clone of the changes keyPath/value set so that we can restore it in case a hook extends it.\n                    modifyer = function (item) {\n                        var anythingModified = false;\n                        var additionalChanges = updatingHook.call(this, changes, this.primKey, deepClone(item), trans);\n                        if (additionalChanges) extend(changes, additionalChanges);\n                        keys(changes).forEach(function (keyPath) {\n                            var val = changes[keyPath];\n                            if (getByKeyPath(item, keyPath) !== val) {\n                                setByKeyPath(item, keyPath, val);\n                                anythingModified = true;\n                            }\n                        });\n                        if (additionalChanges) changes = shallowClone(origChanges); // Restore original changes for next iteration\n                        return anythingModified;\n                    };\n                }\n\n                var count = 0;\n                var successCount = 0;\n                var iterationComplete = false;\n                var failures = [];\n                var failKeys = [];\n                var currentKey = null;\n\n                function modifyItem(item, cursor) {\n                    currentKey = cursor.primaryKey;\n                    var thisContext = {\n                        primKey: cursor.primaryKey,\n                        value: item,\n                        onsuccess: null,\n                        onerror: null\n                    };\n\n                    function onerror(e) {\n                        failures.push(e);\n                        failKeys.push(thisContext.primKey);\n                        checkFinished();\n                        return true; // Catch these errors and let a final rejection decide whether or not to abort entire transaction\n                    }\n\n                    if (modifyer.call(thisContext, item, thisContext) !== false) {\n                        // If a callback explicitely returns false, do not perform the update!\n                        var bDelete = !hasOwn(thisContext, \"value\");\n                        ++count;\n                        tryCatch(function () {\n                            var req = bDelete ? cursor.delete() : cursor.update(thisContext.value);\n                            req._hookCtx = thisContext;\n                            req.onerror = hookedEventRejectHandler(onerror);\n                            req.onsuccess = hookedEventSuccessHandler(function () {\n                                ++successCount;\n                                checkFinished();\n                            });\n                        }, onerror);\n                    } else if (thisContext.onsuccess) {\n                        // Hook will expect either onerror or onsuccess to always be called!\n                        thisContext.onsuccess(thisContext.value);\n                    }\n                }\n\n                function doReject(e) {\n                    if (e) {\n                        failures.push(e);\n                        failKeys.push(currentKey);\n                    }\n                    return reject(new ModifyError(\"Error modifying one or more objects\", failures, successCount, failKeys));\n                }\n\n                function checkFinished() {\n                    if (iterationComplete && successCount + failures.length === count) {\n                        if (failures.length > 0) doReject();else resolve(successCount);\n                    }\n                }\n                self.clone().raw()._iterate(modifyItem, function () {\n                    iterationComplete = true;\n                    checkFinished();\n                }, doReject, idbstore);\n            });\n        },\n\n        'delete': function () {\n            var _this4 = this;\n\n            var ctx = this._ctx,\n                range = ctx.range,\n                deletingHook = ctx.table.hook.deleting.fire,\n                hasDeleteHook = deletingHook !== nop;\n            if (!hasDeleteHook && isPlainKeyRange(ctx) && (ctx.isPrimKey && !hangsOnDeleteLargeKeyRange || !range)) // if no range, we'll use clear().\n                {\n                    // May use IDBObjectStore.delete(IDBKeyRange) in this case (Issue #208)\n                    // For chromium, this is the way most optimized version.\n                    // For IE/Edge, this could hang the indexedDB engine and make operating system instable\n                    // (https://gist.github.com/dfahlander/5a39328f029de18222cf2125d56c38f7)\n                    return this._write(function (resolve, reject, idbstore) {\n                        // Our API contract is to return a count of deleted items, so we have to count() before delete().\n                        var onerror = eventRejectHandler(reject),\n                            countReq = range ? idbstore.count(range) : idbstore.count();\n                        countReq.onerror = onerror;\n                        countReq.onsuccess = function () {\n                            var count = countReq.result;\n                            tryCatch(function () {\n                                var delReq = range ? idbstore.delete(range) : idbstore.clear();\n                                delReq.onerror = onerror;\n                                delReq.onsuccess = function () {\n                                    return resolve(count);\n                                };\n                            }, function (err) {\n                                return reject(err);\n                            });\n                        };\n                    });\n                }\n\n            // Default version to use when collection is not a vanilla IDBKeyRange on the primary key.\n            // Divide into chunks to not starve RAM.\n            // If has delete hook, we will have to collect not just keys but also objects, so it will use\n            // more memory and need lower chunk size.\n            var CHUNKSIZE = hasDeleteHook ? 2000 : 10000;\n\n            return this._write(function (resolve, reject, idbstore, trans) {\n                var totalCount = 0;\n                // Clone collection and change its table and set a limit of CHUNKSIZE on the cloned Collection instance.\n                var collection = _this4.clone({\n                    keysOnly: !ctx.isMatch && !hasDeleteHook }) // load just keys (unless filter() or and() or deleteHook has subscribers)\n                .distinct() // In case multiEntry is used, never delete same key twice because resulting count\n                // would become larger than actual delete count.\n                .limit(CHUNKSIZE).raw(); // Don't filter through reading-hooks (like mapped classes etc)\n\n                var keysOrTuples = [];\n\n                // We're gonna do things on as many chunks that are needed.\n                // Use recursion of nextChunk function:\n                var nextChunk = function () {\n                    return collection.each(hasDeleteHook ? function (val, cursor) {\n                        // Somebody subscribes to hook('deleting'). Collect all primary keys and their values,\n                        // so that the hook can be called with its values in bulkDelete().\n                        keysOrTuples.push([cursor.primaryKey, cursor.value]);\n                    } : function (val, cursor) {\n                        // No one subscribes to hook('deleting'). Collect only primary keys:\n                        keysOrTuples.push(cursor.primaryKey);\n                    }).then(function () {\n                        // Chromium deletes faster when doing it in sort order.\n                        hasDeleteHook ? keysOrTuples.sort(function (a, b) {\n                            return ascending(a[0], b[0]);\n                        }) : keysOrTuples.sort(ascending);\n                        return bulkDelete(idbstore, trans, keysOrTuples, hasDeleteHook, deletingHook);\n                    }).then(function () {\n                        var count = keysOrTuples.length;\n                        totalCount += count;\n                        keysOrTuples = [];\n                        return count < CHUNKSIZE ? totalCount : nextChunk();\n                    });\n                };\n\n                resolve(nextChunk());\n            });\n        }\n    });\n\n    //\n    //\n    //\n    // ------------------------- Help functions ---------------------------\n    //\n    //\n    //\n\n    function lowerVersionFirst(a, b) {\n        return a._cfg.version - b._cfg.version;\n    }\n\n    function setApiOnPlace(objs, tableNames, mode, dbschema) {\n        tableNames.forEach(function (tableName) {\n            var tableInstance = db._tableFactory(mode, dbschema[tableName]);\n            objs.forEach(function (obj) {\n                tableName in obj || (obj[tableName] = tableInstance);\n            });\n        });\n    }\n\n    function removeTablesApi(objs) {\n        objs.forEach(function (obj) {\n            for (var key in obj) {\n                if (obj[key] instanceof Table) delete obj[key];\n            }\n        });\n    }\n\n    function iterate(req, filter, fn, resolve, reject, valueMapper) {\n\n        // Apply valueMapper (hook('reading') or mappped class)\n        var mappedFn = valueMapper ? function (x, c, a) {\n            return fn(valueMapper(x), c, a);\n        } : fn;\n        // Wrap fn with PSD and microtick stuff from Promise.\n        var wrappedFn = wrap(mappedFn, reject);\n\n        if (!req.onerror) req.onerror = eventRejectHandler(reject);\n        if (filter) {\n            req.onsuccess = trycatcher(function filter_record() {\n                var cursor = req.result;\n                if (cursor) {\n                    var c = function () {\n                        cursor.continue();\n                    };\n                    if (filter(cursor, function (advancer) {\n                        c = advancer;\n                    }, resolve, reject)) wrappedFn(cursor.value, cursor, function (advancer) {\n                        c = advancer;\n                    });\n                    c();\n                } else {\n                    resolve();\n                }\n            }, reject);\n        } else {\n            req.onsuccess = trycatcher(function filter_record() {\n                var cursor = req.result;\n                if (cursor) {\n                    var c = function () {\n                        cursor.continue();\n                    };\n                    wrappedFn(cursor.value, cursor, function (advancer) {\n                        c = advancer;\n                    });\n                    c();\n                } else {\n                    resolve();\n                }\n            }, reject);\n        }\n    }\n\n    function parseIndexSyntax(indexes) {\n        /// <param name=\"indexes\" type=\"String\"></param>\n        /// <returns type=\"Array\" elementType=\"IndexSpec\"></returns>\n        var rv = [];\n        indexes.split(',').forEach(function (index) {\n            index = index.trim();\n            var name = index.replace(/([&*]|\\+\\+)/g, \"\"); // Remove \"&\", \"++\" and \"*\"\n            // Let keyPath of \"[a+b]\" be [\"a\",\"b\"]:\n            var keyPath = /^\\[/.test(name) ? name.match(/^\\[(.*)\\]$/)[1].split('+') : name;\n\n            rv.push(new IndexSpec(name, keyPath || null, /\\&/.test(index), /\\*/.test(index), /\\+\\+/.test(index), isArray(keyPath), /\\./.test(index)));\n        });\n        return rv;\n    }\n\n    function cmp(key1, key2) {\n        return indexedDB.cmp(key1, key2);\n    }\n\n    function min(a, b) {\n        return cmp(a, b) < 0 ? a : b;\n    }\n\n    function max(a, b) {\n        return cmp(a, b) > 0 ? a : b;\n    }\n\n    function ascending(a, b) {\n        return indexedDB.cmp(a, b);\n    }\n\n    function descending(a, b) {\n        return indexedDB.cmp(b, a);\n    }\n\n    function simpleCompare(a, b) {\n        return a < b ? -1 : a === b ? 0 : 1;\n    }\n\n    function simpleCompareReverse(a, b) {\n        return a > b ? -1 : a === b ? 0 : 1;\n    }\n\n    function combine(filter1, filter2) {\n        return filter1 ? filter2 ? function () {\n            return filter1.apply(this, arguments) && filter2.apply(this, arguments);\n        } : filter1 : filter2;\n    }\n\n    function readGlobalSchema() {\n        db.verno = idbdb.version / 10;\n        db._dbSchema = globalSchema = {};\n        dbStoreNames = slice(idbdb.objectStoreNames, 0);\n        if (dbStoreNames.length === 0) return; // Database contains no stores.\n        var trans = idbdb.transaction(safariMultiStoreFix(dbStoreNames), 'readonly');\n        dbStoreNames.forEach(function (storeName) {\n            var store = trans.objectStore(storeName),\n                keyPath = store.keyPath,\n                dotted = keyPath && typeof keyPath === 'string' && keyPath.indexOf('.') !== -1;\n            var primKey = new IndexSpec(keyPath, keyPath || \"\", false, false, !!store.autoIncrement, keyPath && typeof keyPath !== 'string', dotted);\n            var indexes = [];\n            for (var j = 0; j < store.indexNames.length; ++j) {\n                var idbindex = store.index(store.indexNames[j]);\n                keyPath = idbindex.keyPath;\n                dotted = keyPath && typeof keyPath === 'string' && keyPath.indexOf('.') !== -1;\n                var index = new IndexSpec(idbindex.name, keyPath, !!idbindex.unique, !!idbindex.multiEntry, false, keyPath && typeof keyPath !== 'string', dotted);\n                indexes.push(index);\n            }\n            globalSchema[storeName] = new TableSchema(storeName, primKey, indexes, {});\n        });\n        setApiOnPlace([allTables, Transaction.prototype], keys(globalSchema), READWRITE, globalSchema);\n    }\n\n    function adjustToExistingIndexNames(schema, idbtrans) {\n        /// <summary>\n        /// Issue #30 Problem with existing db - adjust to existing index names when migrating from non-dexie db\n        /// </summary>\n        /// <param name=\"schema\" type=\"Object\">Map between name and TableSchema</param>\n        /// <param name=\"idbtrans\" type=\"IDBTransaction\"></param>\n        var storeNames = idbtrans.db.objectStoreNames;\n        for (var i = 0; i < storeNames.length; ++i) {\n            var storeName = storeNames[i];\n            var store = idbtrans.objectStore(storeName);\n            hasGetAll = 'getAll' in store;\n            for (var j = 0; j < store.indexNames.length; ++j) {\n                var indexName = store.indexNames[j];\n                var keyPath = store.index(indexName).keyPath;\n                var dexieName = typeof keyPath === 'string' ? keyPath : \"[\" + slice(keyPath).join('+') + \"]\";\n                if (schema[storeName]) {\n                    var indexSpec = schema[storeName].idxByName[dexieName];\n                    if (indexSpec) indexSpec.name = indexName;\n                }\n            }\n        }\n    }\n\n    function fireOnBlocked(ev) {\n        db.on(\"blocked\").fire(ev);\n        // Workaround (not fully*) for missing \"versionchange\" event in IE,Edge and Safari:\n        connections.filter(function (c) {\n            return c.name === db.name && c !== db && !c._vcFired;\n        }).map(function (c) {\n            return c.on(\"versionchange\").fire(ev);\n        });\n    }\n\n    extend(this, {\n        Collection: Collection,\n        Table: Table,\n        Transaction: Transaction,\n        Version: Version,\n        WhereClause: WhereClause,\n        WriteableCollection: WriteableCollection,\n        WriteableTable: WriteableTable\n    });\n\n    init();\n\n    addons.forEach(function (fn) {\n        fn(db);\n    });\n}\n\nvar fakeAutoComplete = function () {}; // Will never be changed. We just fake for the IDE that we change it (see doFakeAutoComplete())\nvar fake = false; // Will never be changed. We just fake for the IDE that we change it (see doFakeAutoComplete())\n\nfunction parseType(type) {\n    if (typeof type === 'function') {\n        return new type();\n    } else if (isArray(type)) {\n        return [parseType(type[0])];\n    } else if (type && typeof type === 'object') {\n        var rv = {};\n        applyStructure(rv, type);\n        return rv;\n    } else {\n        return type;\n    }\n}\n\nfunction applyStructure(obj, structure) {\n    keys(structure).forEach(function (member) {\n        var value = parseType(structure[member]);\n        obj[member] = value;\n    });\n    return obj;\n}\n\nfunction eventSuccessHandler(done) {\n    return function (ev) {\n        done(ev.target.result);\n    };\n}\n\nfunction hookedEventSuccessHandler(resolve) {\n    // wrap() is needed when calling hooks because the rare scenario of:\n    //  * hook does a db operation that fails immediately (IDB throws exception)\n    //    For calling db operations on correct transaction, wrap makes sure to set PSD correctly.\n    //    wrap() will also execute in a virtual tick.\n    //  * If not wrapped in a virtual tick, direct exception will launch a new physical tick.\n    //  * If this was the last event in the bulk, the promise will resolve after a physical tick\n    //    and the transaction will have committed already.\n    // If no hook, the virtual tick will be executed in the reject()/resolve of the final promise,\n    // because it is always marked with _lib = true when created using Transaction._promise().\n    return wrap(function (event) {\n        var req = event.target,\n            result = req.result,\n            ctx = req._hookCtx,\n            // Contains the hook error handler. Put here instead of closure to boost performance.\n        hookSuccessHandler = ctx && ctx.onsuccess;\n        hookSuccessHandler && hookSuccessHandler(result);\n        resolve && resolve(result);\n    }, resolve);\n}\n\nfunction eventRejectHandler(reject) {\n    return function (event) {\n        preventDefault(event);\n        reject(event.target.error);\n        return false;\n    };\n}\n\nfunction hookedEventRejectHandler(reject) {\n    return wrap(function (event) {\n        // See comment on hookedEventSuccessHandler() why wrap() is needed only when supporting hooks.\n\n        var req = event.target,\n            err = req.error,\n            ctx = req._hookCtx,\n            // Contains the hook error handler. Put here instead of closure to boost performance.\n        hookErrorHandler = ctx && ctx.onerror;\n        hookErrorHandler && hookErrorHandler(err);\n        preventDefault(event);\n        reject(err);\n        return false;\n    });\n}\n\nfunction preventDefault(event) {\n    if (event.stopPropagation) // IndexedDBShim doesnt support this on Safari 8 and below.\n        event.stopPropagation();\n    if (event.preventDefault) // IndexedDBShim doesnt support this on Safari 8 and below.\n        event.preventDefault();\n}\n\nfunction globalDatabaseList(cb) {\n    var val,\n        localStorage = Dexie.dependencies.localStorage;\n    if (!localStorage) return cb([]); // Envs without localStorage support\n    try {\n        val = JSON.parse(localStorage.getItem('Dexie.DatabaseNames') || \"[]\");\n    } catch (e) {\n        val = [];\n    }\n    if (cb(val)) {\n        localStorage.setItem('Dexie.DatabaseNames', JSON.stringify(val));\n    }\n}\n\nfunction awaitIterator(iterator) {\n    var callNext = function (result) {\n        return iterator.next(result);\n    },\n        doThrow = function (error) {\n        return iterator.throw(error);\n    },\n        onSuccess = step(callNext),\n        onError = step(doThrow);\n\n    function step(getNext) {\n        return function (val) {\n            var next = getNext(val),\n                value = next.value;\n\n            return next.done ? value : !value || typeof value.then !== 'function' ? isArray(value) ? Promise.all(value).then(onSuccess, onError) : onSuccess(value) : value.then(onSuccess, onError);\n        };\n    }\n\n    return step(callNext)();\n}\n\n//\n// IndexSpec struct\n//\nfunction IndexSpec(name, keyPath, unique, multi, auto, compound, dotted) {\n    /// <param name=\"name\" type=\"String\"></param>\n    /// <param name=\"keyPath\" type=\"String\"></param>\n    /// <param name=\"unique\" type=\"Boolean\"></param>\n    /// <param name=\"multi\" type=\"Boolean\"></param>\n    /// <param name=\"auto\" type=\"Boolean\"></param>\n    /// <param name=\"compound\" type=\"Boolean\"></param>\n    /// <param name=\"dotted\" type=\"Boolean\"></param>\n    this.name = name;\n    this.keyPath = keyPath;\n    this.unique = unique;\n    this.multi = multi;\n    this.auto = auto;\n    this.compound = compound;\n    this.dotted = dotted;\n    var keyPathSrc = typeof keyPath === 'string' ? keyPath : keyPath && '[' + [].join.call(keyPath, '+') + ']';\n    this.src = (unique ? '&' : '') + (multi ? '*' : '') + (auto ? \"++\" : \"\") + keyPathSrc;\n}\n\n//\n// TableSchema struct\n//\nfunction TableSchema(name, primKey, indexes, instanceTemplate) {\n    /// <param name=\"name\" type=\"String\"></param>\n    /// <param name=\"primKey\" type=\"IndexSpec\"></param>\n    /// <param name=\"indexes\" type=\"Array\" elementType=\"IndexSpec\"></param>\n    /// <param name=\"instanceTemplate\" type=\"Object\"></param>\n    this.name = name;\n    this.primKey = primKey || new IndexSpec();\n    this.indexes = indexes || [new IndexSpec()];\n    this.instanceTemplate = instanceTemplate;\n    this.mappedClass = null;\n    this.idxByName = arrayToObject(indexes, function (index) {\n        return [index.name, index];\n    });\n}\n\n// Used in when defining dependencies later...\n// (If IndexedDBShim is loaded, prefer it before standard indexedDB)\nvar idbshim = _global.idbModules && _global.idbModules.shimIndexedDB ? _global.idbModules : {};\n\nfunction safariMultiStoreFix(storeNames) {\n    return storeNames.length === 1 ? storeNames[0] : storeNames;\n}\n\nfunction getNativeGetDatabaseNamesFn(indexedDB) {\n    var fn = indexedDB && (indexedDB.getDatabaseNames || indexedDB.webkitGetDatabaseNames);\n    return fn && fn.bind(indexedDB);\n}\n\n// Export Error classes\nprops(Dexie, fullNameExceptions); // Dexie.XXXError = class XXXError {...};\n\n//\n// Static methods and properties\n// \nprops(Dexie, {\n\n    //\n    // Static delete() method.\n    //\n    delete: function (databaseName) {\n        var db = new Dexie(databaseName),\n            promise = db.delete();\n        promise.onblocked = function (fn) {\n            db.on(\"blocked\", fn);\n            return this;\n        };\n        return promise;\n    },\n\n    //\n    // Static exists() method.\n    //\n    exists: function (name) {\n        return new Dexie(name).open().then(function (db) {\n            db.close();\n            return true;\n        }).catch(Dexie.NoSuchDatabaseError, function () {\n            return false;\n        });\n    },\n\n    //\n    // Static method for retrieving a list of all existing databases at current host.\n    //\n    getDatabaseNames: function (cb) {\n        return new Promise(function (resolve, reject) {\n            var getDatabaseNames = getNativeGetDatabaseNamesFn(indexedDB);\n            if (getDatabaseNames) {\n                // In case getDatabaseNames() becomes standard, let's prepare to support it:\n                var req = getDatabaseNames();\n                req.onsuccess = function (event) {\n                    resolve(slice(event.target.result, 0)); // Converst DOMStringList to Array<String>\n                };\n                req.onerror = eventRejectHandler(reject);\n            } else {\n                globalDatabaseList(function (val) {\n                    resolve(val);\n                    return false;\n                });\n            }\n        }).then(cb);\n    },\n\n    defineClass: function (structure) {\n        /// <summary>\n        ///     Create a javascript constructor based on given template for which properties to expect in the class.\n        ///     Any property that is a constructor function will act as a type. So {name: String} will be equal to {name: new String()}.\n        /// </summary>\n        /// <param name=\"structure\">Helps IDE code completion by knowing the members that objects contain and not just the indexes. Also\n        /// know what type each member has. Example: {name: String, emailAddresses: [String], properties: {shoeSize: Number}}</param>\n\n        // Default constructor able to copy given properties into this object.\n        function Class(properties) {\n            /// <param name=\"properties\" type=\"Object\" optional=\"true\">Properties to initialize object with.\n            /// </param>\n            properties ? extend(this, properties) : fake && applyStructure(this, structure);\n        }\n        return Class;\n    },\n\n    applyStructure: applyStructure,\n\n    ignoreTransaction: function (scopeFunc) {\n        // In case caller is within a transaction but needs to create a separate transaction.\n        // Example of usage:\n        //\n        // Let's say we have a logger function in our app. Other application-logic should be unaware of the\n        // logger function and not need to include the 'logentries' table in all transaction it performs.\n        // The logging should always be done in a separate transaction and not be dependant on the current\n        // running transaction context. Then you could use Dexie.ignoreTransaction() to run code that starts a new transaction.\n        //\n        //     Dexie.ignoreTransaction(function() {\n        //         db.logentries.add(newLogEntry);\n        //     });\n        //\n        // Unless using Dexie.ignoreTransaction(), the above example would try to reuse the current transaction\n        // in current Promise-scope.\n        //\n        // An alternative to Dexie.ignoreTransaction() would be setImmediate() or setTimeout(). The reason we still provide an\n        // API for this because\n        //  1) The intention of writing the statement could be unclear if using setImmediate() or setTimeout().\n        //  2) setTimeout() would wait unnescessary until firing. This is however not the case with setImmediate().\n        //  3) setImmediate() is not supported in the ES standard.\n        //  4) You might want to keep other PSD state that was set in a parent PSD, such as PSD.letThrough.\n        return PSD.trans ? usePSD(PSD.transless, scopeFunc) : // Use the closest parent that was non-transactional.\n        scopeFunc(); // No need to change scope because there is no ongoing transaction.\n    },\n\n    vip: function (fn) {\n        // To be used by subscribers to the on('ready') event.\n        // This will let caller through to access DB even when it is blocked while the db.ready() subscribers are firing.\n        // This would have worked automatically if we were certain that the Provider was using Dexie.Promise for all asyncronic operations. The promise PSD\n        // from the provider.connect() call would then be derived all the way to when provider would call localDatabase.applyChanges(). But since\n        // the provider more likely is using non-promise async APIs or other thenable implementations, we cannot assume that.\n        // Note that this method is only useful for on('ready') subscribers that is returning a Promise from the event. If not using vip()\n        // the database could deadlock since it wont open until the returned Promise is resolved, and any non-VIPed operation started by\n        // the caller will not resolve until database is opened.\n        return newScope(function () {\n            PSD.letThrough = true; // Make sure we are let through if still blocking db due to onready is firing.\n            return fn();\n        });\n    },\n\n    async: function (generatorFn) {\n        return function () {\n            try {\n                var rv = awaitIterator(generatorFn.apply(this, arguments));\n                if (!rv || typeof rv.then !== 'function') return Promise.resolve(rv);\n                return rv;\n            } catch (e) {\n                return rejection(e);\n            }\n        };\n    },\n\n    spawn: function (generatorFn, args, thiz) {\n        try {\n            var rv = awaitIterator(generatorFn.apply(thiz, args || []));\n            if (!rv || typeof rv.then !== 'function') return Promise.resolve(rv);\n            return rv;\n        } catch (e) {\n            return rejection(e);\n        }\n    },\n\n    // Dexie.currentTransaction property\n    currentTransaction: {\n        get: function () {\n            return PSD.trans || null;\n        }\n    },\n\n    // Export our Promise implementation since it can be handy as a standalone Promise implementation\n    Promise: Promise,\n\n    // Dexie.debug proptery:\n    // Dexie.debug = false\n    // Dexie.debug = true\n    // Dexie.debug = \"dexie\" - don't hide dexie's stack frames.\n    debug: {\n        get: function () {\n            return debug;\n        },\n        set: function (value) {\n            setDebug(value, value === 'dexie' ? function () {\n                return true;\n            } : dexieStackFrameFilter);\n        }\n    },\n\n    // Export our derive/extend/override methodology\n    derive: derive,\n    extend: extend,\n    props: props,\n    override: override,\n    // Export our Events() function - can be handy as a toolkit\n    Events: Events,\n    events: { get: deprecated(function () {\n            return Events;\n        }) }, // Backward compatible lowercase version.\n    // Utilities\n    getByKeyPath: getByKeyPath,\n    setByKeyPath: setByKeyPath,\n    delByKeyPath: delByKeyPath,\n    shallowClone: shallowClone,\n    deepClone: deepClone,\n    getObjectDiff: getObjectDiff,\n    asap: asap,\n    maxKey: maxKey,\n    // Addon registry\n    addons: [],\n    // Global DB connection list\n    connections: connections,\n\n    MultiModifyError: exceptions.Modify, // Backward compatibility 0.9.8. Deprecate.\n    errnames: errnames,\n\n    // Export other static classes\n    IndexSpec: IndexSpec,\n    TableSchema: TableSchema,\n\n    //\n    // Dependencies\n    //\n    // These will automatically work in browsers with indexedDB support, or where an indexedDB polyfill has been included.\n    //\n    // In node.js, however, these properties must be set \"manually\" before instansiating a new Dexie().\n    // For node.js, you need to require indexeddb-js or similar and then set these deps.\n    //\n    dependencies: {\n        // Required:\n        indexedDB: idbshim.shimIndexedDB || _global.indexedDB || _global.mozIndexedDB || _global.webkitIndexedDB || _global.msIndexedDB,\n        IDBKeyRange: idbshim.IDBKeyRange || _global.IDBKeyRange || _global.webkitIDBKeyRange\n    },\n\n    // API Version Number: Type Number, make sure to always set a version number that can be comparable correctly. Example: 0.9, 0.91, 0.92, 1.0, 1.01, 1.1, 1.2, 1.21, etc.\n    semVer: DEXIE_VERSION,\n    version: DEXIE_VERSION.split('.').map(function (n) {\n        return parseInt(n);\n    }).reduce(function (p, c, i) {\n        return p + c / Math.pow(10, i * 2);\n    }),\n    fakeAutoComplete: fakeAutoComplete,\n\n    // https://github.com/dfahlander/Dexie.js/issues/186\n    // typescript compiler tsc in mode ts-->es5 & commonJS, will expect require() to return\n    // x.default. Workaround: Set Dexie.default = Dexie.\n    default: Dexie\n});\n\ntryCatch(function () {\n    // Optional dependencies\n    // localStorage\n    Dexie.dependencies.localStorage = (typeof chrome !== \"undefined\" && chrome !== null ? chrome.storage : void 0) != null ? null : _global.localStorage;\n});\n\n// Map DOMErrors and DOMExceptions to corresponding Dexie errors. May change in Dexie v2.0.\nPromise.rejectionMapper = mapError;\n\n// Fool IDE to improve autocomplete. Tested with Visual Studio 2013 and 2015.\ndoFakeAutoComplete(function () {\n    Dexie.fakeAutoComplete = fakeAutoComplete = doFakeAutoComplete;\n    Dexie.fake = fake = true;\n});\n\nreturn Dexie;\n\n})));\n//# sourceMappingURL=dexie.js.map\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","// version: 0.12.0\n// date: Wed Aug 01 2018 09:48:10 GMT+0100 (Western European Summer Time)\n// licence: \n/**\n* Copyright 2016 PT Inovao e Sistemas SA\n* Copyright 2016 INESC-ID\n* Copyright 2016 QUOBIS NETWORKS SL\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n* Copyright 2016 ORANGE SA\n* Copyright 2016 Deutsche Telekom AG\n* Copyright 2016 Apizee\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n**/\n\n\n// version: 0.12.0\n// date: Wed Aug 01 2018 09:48:10 GMT+0100 (Western European Summer Time)\n// licence: \n/**\n* Copyright 2016 PT Inovao e Sistemas SA\n* Copyright 2016 INESC-ID\n* Copyright 2016 QUOBIS NETWORKS SL\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n* Copyright 2016 ORANGE SA\n* Copyright 2016 Deutsche Telekom AG\n* Copyright 2016 Apizee\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n**/\n\n\n!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(\"minibus\",[],e):\"object\"==typeof exports?exports.minibus=e():t.minibus=e()}(\"undefined\"!=typeof self?self:this,function(){return function(t){function __webpack_require__(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}var e={};return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.d=function(t,e,n){__webpack_require__.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},__webpack_require__.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return __webpack_require__.d(e,\"a\",e),e},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.p=\"\",__webpack_require__(__webpack_require__.s=136)}([function(t,e){var n=t.exports={version:\"2.5.7\"};\"number\"==typeof __e&&(__e=n)},function(t,e){var n=t.exports=\"undefined\"!=typeof window&&window.Math==Math?window:\"undefined\"!=typeof self&&self.Math==Math?self:Function(\"return this\")();\"number\"==typeof __g&&(__g=n)},function(t,e,n){var r=n(28)(\"wks\"),o=n(20),i=n(1).Symbol,u=\"function\"==typeof i;(t.exports=function(t){return r[t]||(r[t]=u&&i[t]||(u?i:o)(\"Symbol.\"+t))}).store=r},function(t,e,n){var r=n(1),o=n(0),i=n(15),u=n(9),s=n(8),c=function(t,e,n){var f,a,l,p=t&c.F,v=t&c.G,d=t&c.S,h=t&c.P,y=t&c.B,_=t&c.W,b=v?o:o[e]||(o[e]={}),g=b.prototype,m=v?r:d?r[e]:(r[e]||{}).prototype;v&&(n=e);for(f in n)(a=!p&&m&&void 0!==m[f])&&s(b,f)||(l=a?m[f]:n[f],b[f]=v&&\"function\"!=typeof m[f]?n[f]:y&&a?i(l,r):_&&m[f]==l?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):h&&\"function\"==typeof l?i(Function.call,l):l,h&&((b.virtual||(b.virtual={}))[f]=l,t&c.R&&g&&!g[f]&&u(g,f,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,e,n){var r=n(6);t.exports=function(t){if(!r(t))throw TypeError(t+\" is not an object!\");return t}},function(t,e,n){t.exports=!n(13)(function(){return 7!=Object.defineProperty({},\"a\",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){return\"object\"==typeof t?null!==t:\"function\"==typeof t}},function(t,e,n){var r=n(4),o=n(36),i=n(26),u=Object.defineProperty;e.f=n(5)?Object.defineProperty:function(t,e,n){if(r(t),e=i(e,!0),r(n),o)try{return u(t,e,n)}catch(t){}if(\"get\"in n||\"set\"in n)throw TypeError(\"Accessors not supported!\");return\"value\"in n&&(t[e]=n.value),t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(7),o=n(19);t.exports=n(5)?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(57),o=n(23);t.exports=function(t){return r(o(t))}},function(t,e,n){\"use strict\";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}},function(t,e,n){\"use strict\";e.__esModule=!0;var r=n(60),o=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=function(){function defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),(0,o.default)(t,r.key,r)}}return function(t,e,n){return e&&defineProperties(t.prototype,e),n&&defineProperties(t,n),t}}()},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=!0},function(t,e,n){var r=n(18);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports={}},function(t,e){t.exports=function(t){if(\"function\"!=typeof t)throw TypeError(t+\" is not a function!\");return t}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return\"Symbol(\".concat(void 0===t?\"\":t,\")_\",(++n+r).toString(36))}},function(t,e,n){var r=n(37),o=n(29);t.exports=Object.keys||function(t){return r(t,o)}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError(\"Can't call method on  \"+t);return t}},function(t,e,n){var r=n(7).f,o=n(8),i=n(2)(\"toStringTag\");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,i)&&r(t,i,{configurable:!0,value:e})}},function(t,e,n){var r=n(6),o=n(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,e,n){var r=n(6);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&\"function\"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if(\"function\"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&\"function\"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError(\"Can't convert object to primitive value\")}},function(t,e,n){var r=n(28)(\"keys\"),o=n(20);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,e,n){var r=n(0),o=n(1),i=o[\"__core-js_shared__\"]||(o[\"__core-js_shared__\"]={});(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})(\"versions\",[]).push({version:r.version,mode:n(14)?\"pure\":\"global\",copyright:\" 2018 Denis Pushkarev (zloirock.ru)\"})},function(t,e){t.exports=\"constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf\".split(\",\")},function(t,e,n){var r=n(23);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(4),o=n(69),i=n(29),u=n(27)(\"IE_PROTO\"),s=function(){},c=function(){var t,e=n(25)(\"iframe\"),r=i.length;for(e.style.display=\"none\",n(46).appendChild(e),e.src=\"javascript:\",t=e.contentWindow.document,t.open(),t.write(\"<script>document.F=Object<\\/script>\"),t.close(),c=t.F;r--;)delete c.prototype[i[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=r(t),n=new s,s.prototype=null,n[u]=t):n=c(),void 0===e?n:o(n,e)}},function(t,e,n){\"use strict\";function PromiseCapability(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError(\"Bad Promise constructor\");e=t,n=r}),this.resolve=r(e),this.reject=r(n)}var r=n(18);t.exports.f=function(t){return new PromiseCapability(t)}},function(t,e,n){e.f=n(2)},function(t,e,n){var r=n(1),o=n(0),i=n(14),u=n(33),s=n(7).f;t.exports=function(t){var e=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});\"_\"==t.charAt(0)||t in e||s(e,t,{value:u.f(t)})}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){t.exports=!n(5)&&!n(13)(function(){return 7!=Object.defineProperty(n(25)(\"div\"),\"a\",{get:function(){return 7}}).a})},function(t,e,n){var r=n(8),o=n(10),i=n(58)(!1),u=n(27)(\"IE_PROTO\");t.exports=function(t,e){var n,s=o(t),c=0,f=[];for(n in s)n!=u&&r(s,n)&&f.push(n);for(;e.length>c;)r(s,n=e[c++])&&(~i(f,n)||f.push(n));return f}},function(t,e,n){var r=n(22),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e,n){var r=n(3),o=n(0),i=n(13);t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],u={};u[t]=e(n),r(r.S+r.F*i(function(){n(1)}),\"Object\",u)}},function(t,e,n){var r=n(35),o=n(19),i=n(10),u=n(26),s=n(8),c=n(36),f=Object.getOwnPropertyDescriptor;e.f=n(5)?f:function(t,e){if(t=i(t),e=u(e,!0),c)try{return f(t,e)}catch(t){}if(s(t,e))return o(!r.f.call(t,e),t[e])}},function(t,e,n){t.exports={default:n(66),__esModule:!0}},function(t,e){},function(t,e,n){\"use strict\";var r=n(67)(!0);n(44)(String,\"String\",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){\"use strict\";var r=n(14),o=n(3),i=n(45),u=n(9),s=n(17),c=n(68),f=n(24),a=n(47),l=n(2)(\"iterator\"),p=!([].keys&&\"next\"in[].keys()),v=function(){return this};t.exports=function(t,e,n,d,h,y,_){c(n,e,d);var b,g,m,w=function(t){if(!p&&t in P)return P[t];switch(t){case\"keys\":case\"values\":return function(){return new n(this,t)}}return function(){return new n(this,t)}},x=e+\" Iterator\",O=\"values\"==h,M=!1,P=t.prototype,S=P[l]||P[\"@@iterator\"]||h&&P[h],L=S||w(h),j=h?O?w(\"entries\"):L:void 0,k=\"Array\"==e?P.entries||S:S;if(k&&(m=a(k.call(new t)))!==Object.prototype&&m.next&&(f(m,x,!0),r||\"function\"==typeof m[l]||u(m,l,v)),O&&S&&\"values\"!==S.name&&(M=!0,L=function(){return S.call(this)}),r&&!_||!p&&!M&&P[l]||u(P,l,L),s[e]=L,s[x]=v,h)if(b={values:O?L:w(\"values\"),keys:y?L:w(\"keys\"),entries:j},_)for(g in b)g in P||i(P,g,b[g]);else o(o.P+o.F*(p||M),e,b);return b}},function(t,e,n){t.exports=n(9)},function(t,e,n){var r=n(1).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(8),o=n(30),i=n(27)(\"IE_PROTO\"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:\"function\"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,e,n){n(70);for(var r=n(1),o=n(9),i=n(17),u=n(2)(\"toStringTag\"),s=\"CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList\".split(\",\"),c=0;c<s.length;c++){var f=s[c],a=r[f],l=a&&a.prototype;l&&!l[u]&&o(l,u,f),i[f]=i.Array}},function(t,e,n){var r=n(16),o=n(2)(\"toStringTag\"),i=\"Arguments\"==r(function(){return arguments}()),u=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,s;return void 0===t?\"Undefined\":null===t?\"Null\":\"string\"==typeof(n=u(e=Object(t),o))?n:i?r(e):\"Object\"==(s=r(e))&&\"function\"==typeof e.callee?\"Arguments\":s}},function(t,e,n){var r=n(4),o=n(18),i=n(2)(\"species\");t.exports=function(t,e){var n,u=r(t).constructor;return void 0===u||void 0==(n=r(u)[i])?e:o(n)}},function(t,e,n){var r,o,i,u=n(15),s=n(79),c=n(46),f=n(25),a=n(1),l=a.process,p=a.setImmediate,v=a.clearImmediate,d=a.MessageChannel,h=a.Dispatch,y=0,_={},b=function(){var t=+this;if(_.hasOwnProperty(t)){var e=_[t];delete _[t],e()}},g=function(t){b.call(t.data)};p&&v||(p=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return _[++y]=function(){s(\"function\"==typeof t?t:Function(t),e)},r(y),y},v=function(t){delete _[t]},\"process\"==n(16)(l)?r=function(t){l.nextTick(u(b,t,1))}:h&&h.now?r=function(t){h.now(u(b,t,1))}:d?(o=new d,i=o.port2,o.port1.onmessage=g,r=u(i.postMessage,i,1)):a.addEventListener&&\"function\"==typeof postMessage&&!a.importScripts?(r=function(t){a.postMessage(t+\"\",\"*\")},a.addEventListener(\"message\",g,!1)):r=\"onreadystatechange\"in f(\"script\")?function(t){c.appendChild(f(\"script\")).onreadystatechange=function(){c.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:p,clear:v}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var r=n(4),o=n(6),i=n(32);t.exports=function(t,e){if(r(t),o(e)&&e.constructor===t)return e;var n=i.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){\"use strict\";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(90),o=_interopRequireDefault(r),i=n(92),u=_interopRequireDefault(i),s=\"function\"==typeof u.default&&\"symbol\"==typeof o.default?function(t){return typeof t}:function(t){return t&&\"function\"==typeof u.default&&t.constructor===u.default&&t!==u.default.prototype?\"symbol\":typeof t};e.default=\"function\"==typeof u.default&&\"symbol\"===s(o.default)?function(t){return void 0===t?\"undefined\":s(t)}:function(t){return t&&\"function\"==typeof u.default&&t.constructor===u.default&&t!==u.default.prototype?\"symbol\":void 0===t?\"undefined\":s(t)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(37),o=n(29).concat(\"length\",\"prototype\");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,e,n){var r=n(16);t.exports=Object(\"z\").propertyIsEnumerable(0)?Object:function(t){return\"String\"==r(t)?t.split(\"\"):Object(t)}},function(t,e,n){var r=n(10),o=n(38),i=n(59);t.exports=function(t){return function(e,n,u){var s,c=r(e),f=o(c.length),a=i(u,f);if(t&&n!=n){for(;f>a;)if((s=c[a++])!=s)return!0}else for(;f>a;a++)if((t||a in c)&&c[a]===n)return t||a||0;return!t&&-1}}},function(t,e,n){var r=n(22),o=Math.max,i=Math.min;t.exports=function(t,e){return t=r(t),t<0?o(t+e,0):i(t,e)}},function(t,e,n){t.exports={default:n(61),__esModule:!0}},function(t,e,n){n(62);var r=n(0).Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},function(t,e,n){var r=n(3);r(r.S+r.F*!n(5),\"Object\",{defineProperty:n(7).f})},function(t,e,n){t.exports={default:n(88),__esModule:!0}},function(t,e,n){\"use strict\";e.__esModule=!0;var r=n(54),o=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=function(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!==(void 0===e?\"undefined\":(0,o.default)(e))&&\"function\"!=typeof e?t:e}},function(t,e,n){\"use strict\";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(101),o=_interopRequireDefault(r),i=n(105),u=_interopRequireDefault(i),s=n(54),c=_interopRequireDefault(s);e.default=function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+(void 0===e?\"undefined\":(0,c.default)(e)));t.prototype=(0,u.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(o.default?(0,o.default)(t,e):t.__proto__=e)}},function(t,e,n){n(42),n(43),n(48),n(73),n(85),n(86),t.exports=n(0).Promise},function(t,e,n){var r=n(22),o=n(23);t.exports=function(t){return function(e,n){var i,u,s=String(o(e)),c=r(n),f=s.length;return c<0||c>=f?t?\"\":void 0:(i=s.charCodeAt(c),i<55296||i>56319||c+1===f||(u=s.charCodeAt(c+1))<56320||u>57343?t?s.charAt(c):i:t?s.slice(c,c+2):u-56320+(i-55296<<10)+65536)}}},function(t,e,n){\"use strict\";var r=n(31),o=n(19),i=n(24),u={};n(9)(u,n(2)(\"iterator\"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(u,{next:o(1,n)}),i(t,e+\" Iterator\")}},function(t,e,n){var r=n(7),o=n(4),i=n(21);t.exports=n(5)?Object.defineProperties:function(t,e){o(t);for(var n,u=i(e),s=u.length,c=0;s>c;)r.f(t,n=u[c++],e[n]);return t}},function(t,e,n){\"use strict\";var r=n(71),o=n(72),i=n(17),u=n(10);t.exports=n(44)(Array,\"Array\",function(t,e){this._t=u(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,o(1)):\"keys\"==e?o(0,n):\"values\"==e?o(0,t[n]):o(0,[n,t[n]])},\"values\"),i.Arguments=i.Array,r(\"keys\"),r(\"values\"),r(\"entries\")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){\"use strict\";var r,o,i,u,s=n(14),c=n(1),f=n(15),a=n(49),l=n(3),p=n(6),v=n(18),d=n(74),h=n(75),y=n(50),_=n(51).set,b=n(80)(),g=n(32),m=n(52),w=n(81),x=n(53),O=c.TypeError,M=c.process,P=M&&M.versions,S=P&&P.v8||\"\",L=c.Promise,j=\"process\"==a(M),k=function(){},E=o=g.f,R=!!function(){try{var t=L.resolve(1),e=(t.constructor={})[n(2)(\"species\")]=function(t){t(k,k)};return(j||\"function\"==typeof PromiseRejectionEvent)&&t.then(k)instanceof e&&0!==S.indexOf(\"6.6\")&&-1===w.indexOf(\"Chrome/66\")}catch(t){}}(),T=function(t){var e;return!(!p(t)||\"function\"!=typeof(e=t.then))&&e},C=function(t,e){if(!t._n){t._n=!0;var n=t._c;b(function(){for(var r=t._v,o=1==t._s,i=0;n.length>i;)!function(e){var n,i,u,s=o?e.ok:e.fail,c=e.resolve,f=e.reject,a=e.domain;try{s?(o||(2==t._h&&F(t),t._h=1),!0===s?n=r:(a&&a.enter(),n=s(r),a&&(a.exit(),u=!0)),n===e.promise?f(O(\"Promise-chain cycle\")):(i=T(n))?i.call(n,c,f):c(n)):f(r)}catch(t){a&&!u&&a.exit(),f(t)}}(n[i++]);t._c=[],t._n=!1,e&&!t._h&&A(t)})}},A=function(t){_.call(c,function(){var e,n,r,o=t._v,i=D(t);if(i&&(e=m(function(){j?M.emit(\"unhandledRejection\",o,t):(n=c.onunhandledrejection)?n({promise:t,reason:o}):(r=c.console)&&r.error&&r.error(\"Unhandled promise rejection\",o)}),t._h=j||D(t)?2:1),t._a=void 0,i&&e.e)throw e.v})},D=function(t){return 1!==t._h&&0===(t._a||t._c).length},F=function(t){_.call(c,function(){var e;j?M.emit(\"rejectionHandled\",t):(e=c.onrejectionhandled)&&e({promise:t,reason:t._v})})},q=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),C(e,!0))},I=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw O(\"Promise can't be resolved itself\");(e=T(t))?b(function(){var r={_w:n,_d:!1};try{e.call(t,f(I,r,1),f(q,r,1))}catch(t){q.call(r,t)}}):(n._v=t,n._s=1,C(n,!1))}catch(t){q.call({_w:n,_d:!1},t)}}};R||(L=function(t){d(this,L,\"Promise\",\"_h\"),v(t),r.call(this);try{t(f(I,this,1),f(q,this,1))}catch(t){q.call(this,t)}},r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n(82)(L.prototype,{then:function(t,e){var n=E(y(this,L));return n.ok=\"function\"!=typeof t||t,n.fail=\"function\"==typeof e&&e,n.domain=j?M.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&C(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),i=function(){var t=new r;this.promise=t,this.resolve=f(I,t,1),this.reject=f(q,t,1)},g.f=E=function(t){return t===L||t===u?new i(t):o(t)}),l(l.G+l.W+l.F*!R,{Promise:L}),n(24)(L,\"Promise\"),n(83)(\"Promise\"),u=n(0).Promise,l(l.S+l.F*!R,\"Promise\",{reject:function(t){var e=E(this);return(0,e.reject)(t),e.promise}}),l(l.S+l.F*(s||!R),\"Promise\",{resolve:function(t){return x(s&&this===u?L:this,t)}}),l(l.S+l.F*!(R&&n(84)(function(t){L.all(t).catch(k)})),\"Promise\",{all:function(t){var e=this,n=E(e),r=n.resolve,o=n.reject,i=m(function(){var n=[],i=0,u=1;h(t,!1,function(t){var s=i++,c=!1;n.push(void 0),u++,e.resolve(t).then(function(t){c||(c=!0,n[s]=t,--u||r(n))},o)}),--u||r(n)});return i.e&&o(i.v),n.promise},race:function(t){var e=this,n=E(e),r=n.reject,o=m(function(){h(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return o.e&&r(o.v),n.promise}})},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+\": incorrect invocation!\");return t}},function(t,e,n){var r=n(15),o=n(76),i=n(77),u=n(4),s=n(38),c=n(78),f={},a={},e=t.exports=function(t,e,n,l,p){var v,d,h,y,_=p?function(){return t}:c(t),b=r(n,l,e?2:1),g=0;if(\"function\"!=typeof _)throw TypeError(t+\" is not iterable!\");if(i(_)){for(v=s(t.length);v>g;g++)if((y=e?b(u(d=t[g])[0],d[1]):b(t[g]))===f||y===a)return y}else for(h=_.call(t);!(d=h.next()).done;)if((y=o(h,b,d.value,e))===f||y===a)return y};e.BREAK=f,e.RETURN=a},function(t,e,n){var r=n(4);t.exports=function(t,e,n,o){try{return o?e(r(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&r(i.call(t)),e}}},function(t,e,n){var r=n(17),o=n(2)(\"iterator\"),i=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||i[o]===t)}},function(t,e,n){var r=n(49),o=n(2)(\"iterator\"),i=n(17);t.exports=n(0).getIteratorMethod=function(t){if(void 0!=t)return t[o]||t[\"@@iterator\"]||i[r(t)]}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(1),o=n(51).set,i=r.MutationObserver||r.WebKitMutationObserver,u=r.process,s=r.Promise,c=\"process\"==n(16)(u);t.exports=function(){var t,e,n,f=function(){var r,o;for(c&&(r=u.domain)&&r.exit();t;){o=t.fn,t=t.next;try{o()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(c)n=function(){u.nextTick(f)};else if(!i||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var a=s.resolve(void 0);n=function(){a.then(f)}}else n=function(){o.call(r,f)};else{var l=!0,p=document.createTextNode(\"\");new i(f).observe(p,{characterData:!0}),n=function(){p.data=l=!l}}return function(r){var o={fn:r,next:void 0};e&&(e.next=o),t||(t=o,n()),e=o}}},function(t,e,n){var r=n(1),o=r.navigator;t.exports=o&&o.userAgent||\"\"},function(t,e,n){var r=n(9);t.exports=function(t,e,n){for(var o in e)n&&t[o]?t[o]=e[o]:r(t,o,e[o]);return t}},function(t,e,n){\"use strict\";var r=n(1),o=n(0),i=n(7),u=n(5),s=n(2)(\"species\");t.exports=function(t){var e=\"function\"==typeof o[t]?o[t]:r[t];u&&e&&!e[s]&&i.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,n){var r=n(2)(\"iterator\"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var i=[7],u=i[r]();u.next=function(){return{done:n=!0}},i[r]=function(){return u},t(i)}catch(t){}return n}},function(t,e,n){\"use strict\";var r=n(3),o=n(0),i=n(1),u=n(50),s=n(53);r(r.P+r.R,\"Promise\",{finally:function(t){var e=u(this,o.Promise||i.Promise),n=\"function\"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){\"use strict\";var r=n(3),o=n(32),i=n(52);r(r.S,\"Promise\",{try:function(t){var e=o.f(this),n=i(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){var r,o;!function(i,u){\"use strict\";r=u,void 0!==(o=\"function\"==typeof r?r.call(e,n,e,t):r)&&(t.exports=o)}(0,function(){\"use strict\";function bindMethod(t,e){var n=t[e];if(\"function\"==typeof n.bind)return n.bind(t);try{return Function.prototype.bind.call(n,t)}catch(e){return function(){return Function.prototype.apply.apply(n,[t,arguments])}}}function realMethod(n){return\"debug\"===n&&(n=\"log\"),typeof console!==e&&(void 0!==console[n]?bindMethod(console,n):void 0!==console.log?bindMethod(console,\"log\"):t)}function replaceLoggingMethods(e,r){for(var o=0;o<n.length;o++){var i=n[o];this[i]=o<e?t:this.methodFactory(i,e,r)}this.log=this.debug}function enableLoggingWhenConsoleArrives(t,n,r){return function(){typeof console!==e&&(replaceLoggingMethods.call(this,n,r),this[t].apply(this,arguments))}}function defaultMethodFactory(t,e,n){return realMethod(t)||enableLoggingWhenConsoleArrives.apply(this,arguments)}function Logger(t,r,o){function persistLevelIfPossible(t){var r=(n[t]||\"silent\").toUpperCase();if(typeof window!==e){try{return void(window.localStorage[s]=r)}catch(t){}try{window.document.cookie=encodeURIComponent(s)+\"=\"+r+\";\"}catch(t){}}}function getPersistedLevel(){var t;if(typeof window!==e){try{t=window.localStorage[s]}catch(t){}if(typeof t===e)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(s)+\"=\");-1!==r&&(t=/^([^;]+)/.exec(n.slice(r))[1])}catch(t){}return void 0===u.levels[t]&&(t=void 0),t}}var i,u=this,s=\"loglevel\";t&&(s+=\":\"+t),u.name=t,u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},u.methodFactory=o||defaultMethodFactory,u.getLevel=function(){return i},u.setLevel=function(n,r){if(\"string\"==typeof n&&void 0!==u.levels[n.toUpperCase()]&&(n=u.levels[n.toUpperCase()]),!(\"number\"==typeof n&&n>=0&&n<=u.levels.SILENT))throw\"log.setLevel() called with invalid level: \"+n;if(i=n,!1!==r&&persistLevelIfPossible(n),replaceLoggingMethods.call(u,n,t),typeof console===e&&n<u.levels.SILENT)return\"No console available for logging\"},u.setDefaultLevel=function(t){getPersistedLevel()||u.setLevel(t,!1)},u.enableAll=function(t){u.setLevel(u.levels.TRACE,t)},u.disableAll=function(t){u.setLevel(u.levels.SILENT,t)};var c=getPersistedLevel();null==c&&(c=null==r?\"WARN\":r),u.setLevel(c,!1)}var t=function(){},e=\"undefined\",n=[\"trace\",\"debug\",\"info\",\"warn\",\"error\"],r=new Logger,o={};r.getLogger=function(t){if(\"string\"!=typeof t||\"\"===t)throw new TypeError(\"You must supply a name when creating a logger.\");var e=o[t];return e||(e=o[t]=new Logger(t,r.getLevel(),r.methodFactory)),e};var i=typeof window!==e?window.log:void 0;return r.noConflict=function(){return typeof window!==e&&window.log===r&&(window.log=i),r},r.getLoggers=function(){return o},r})},function(t,e,n){n(89),t.exports=n(0).Object.getPrototypeOf},function(t,e,n){var r=n(30),o=n(47);n(39)(\"getPrototypeOf\",function(){return function(t){return o(r(t))}})},function(t,e,n){t.exports={default:n(91),__esModule:!0}},function(t,e,n){n(43),n(48),t.exports=n(33).f(\"iterator\")},function(t,e,n){t.exports={default:n(93),__esModule:!0}},function(t,e,n){n(94),n(42),n(99),n(100),t.exports=n(0).Symbol},function(t,e,n){\"use strict\";var r=n(1),o=n(8),i=n(5),u=n(3),s=n(45),c=n(95).KEY,f=n(13),a=n(28),l=n(24),p=n(20),v=n(2),d=n(33),h=n(34),y=n(96),_=n(97),b=n(4),g=n(6),m=n(10),w=n(26),x=n(19),O=n(31),M=n(98),P=n(40),S=n(7),L=n(21),j=P.f,k=S.f,E=M.f,R=r.Symbol,T=r.JSON,C=T&&T.stringify,A=v(\"_hidden\"),D=v(\"toPrimitive\"),F={}.propertyIsEnumerable,q=a(\"symbol-registry\"),I=a(\"symbols\"),N=a(\"op-symbols\"),B=Object.prototype,W=\"function\"==typeof R,G=r.QObject,U=!G||!G.prototype||!G.prototype.findChild,V=i&&f(function(){return 7!=O(k({},\"a\",{get:function(){return k(this,\"a\",{value:7}).a}})).a})?function(t,e,n){var r=j(B,e);r&&delete B[e],k(t,e,n),r&&t!==B&&k(B,e,r)}:k,H=function(t){var e=I[t]=O(R.prototype);return e._k=t,e},K=W&&\"symbol\"==typeof R.iterator?function(t){return\"symbol\"==typeof t}:function(t){return t instanceof R},J=function(t,e,n){return t===B&&J(N,e,n),b(t),e=w(e,!0),b(n),o(I,e)?(n.enumerable?(o(t,A)&&t[A][e]&&(t[A][e]=!1),n=O(n,{enumerable:x(0,!1)})):(o(t,A)||k(t,A,x(1,{})),t[A][e]=!0),V(t,e,n)):k(t,e,n)},z=function(t,e){b(t);for(var n,r=y(e=m(e)),o=0,i=r.length;i>o;)J(t,n=r[o++],e[n]);return t},Y=function(t,e){return void 0===e?O(t):z(O(t),e)},Q=function(t){var e=F.call(this,t=w(t,!0));return!(this===B&&o(I,t)&&!o(N,t))&&(!(e||!o(this,t)||!o(I,t)||o(this,A)&&this[A][t])||e)},X=function(t,e){if(t=m(t),e=w(e,!0),t!==B||!o(I,e)||o(N,e)){var n=j(t,e);return!n||!o(I,e)||o(t,A)&&t[A][e]||(n.enumerable=!0),n}},Z=function(t){for(var e,n=E(m(t)),r=[],i=0;n.length>i;)o(I,e=n[i++])||e==A||e==c||r.push(e);return r},$=function(t){for(var e,n=t===B,r=E(n?N:m(t)),i=[],u=0;r.length>u;)!o(I,e=r[u++])||n&&!o(B,e)||i.push(I[e]);return i};W||(R=function(){if(this instanceof R)throw TypeError(\"Symbol is not a constructor!\");var t=p(arguments.length>0?arguments[0]:void 0),e=function(n){this===B&&e.call(N,n),o(this,A)&&o(this[A],t)&&(this[A][t]=!1),V(this,t,x(1,n))};return i&&U&&V(B,t,{configurable:!0,set:e}),H(t)},s(R.prototype,\"toString\",function(){return this._k}),P.f=X,S.f=J,n(56).f=M.f=Z,n(35).f=Q,n(55).f=$,i&&!n(14)&&s(B,\"propertyIsEnumerable\",Q,!0),d.f=function(t){return H(v(t))}),u(u.G+u.W+u.F*!W,{Symbol:R});for(var tt=\"hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables\".split(\",\"),et=0;tt.length>et;)v(tt[et++]);for(var nt=L(v.store),rt=0;nt.length>rt;)h(nt[rt++]);u(u.S+u.F*!W,\"Symbol\",{for:function(t){return o(q,t+=\"\")?q[t]:q[t]=R(t)},keyFor:function(t){if(!K(t))throw TypeError(t+\" is not a symbol!\");for(var e in q)if(q[e]===t)return e},useSetter:function(){U=!0},useSimple:function(){U=!1}}),u(u.S+u.F*!W,\"Object\",{create:Y,defineProperty:J,defineProperties:z,getOwnPropertyDescriptor:X,getOwnPropertyNames:Z,getOwnPropertySymbols:$}),T&&u(u.S+u.F*(!W||f(function(){var t=R();return\"[null]\"!=C([t])||\"{}\"!=C({a:t})||\"{}\"!=C(Object(t))})),\"JSON\",{stringify:function(t){for(var e,n,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);if(n=e=r[1],(g(e)||void 0!==t)&&!K(t))return _(e)||(e=function(t,e){if(\"function\"==typeof n&&(e=n.call(this,t,e)),!K(e))return e}),r[1]=e,C.apply(T,r)}}),R.prototype[D]||n(9)(R.prototype,D,R.prototype.valueOf),l(R,\"Symbol\"),l(Math,\"Math\",!0),l(r.JSON,\"JSON\",!0)},function(t,e,n){var r=n(20)(\"meta\"),o=n(6),i=n(8),u=n(7).f,s=0,c=Object.isExtensible||function(){return!0},f=!n(13)(function(){return c(Object.preventExtensions({}))}),a=function(t){u(t,r,{value:{i:\"O\"+ ++s,w:{}}})},l=function(t,e){if(!o(t))return\"symbol\"==typeof t?t:(\"string\"==typeof t?\"S\":\"P\")+t;if(!i(t,r)){if(!c(t))return\"F\";if(!e)return\"E\";a(t)}return t[r].i},p=function(t,e){if(!i(t,r)){if(!c(t))return!0;if(!e)return!1;a(t)}return t[r].w},v=function(t){return f&&d.NEED&&c(t)&&!i(t,r)&&a(t),t},d=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:p,onFreeze:v}},function(t,e,n){var r=n(21),o=n(55),i=n(35);t.exports=function(t){var e=r(t),n=o.f;if(n)for(var u,s=n(t),c=i.f,f=0;s.length>f;)c.call(t,u=s[f++])&&e.push(u);return e}},function(t,e,n){var r=n(16);t.exports=Array.isArray||function(t){return\"Array\"==r(t)}},function(t,e,n){var r=n(10),o=n(56).f,i={}.toString,u=\"object\"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return o(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&\"[object Window]\"==i.call(t)?s(t):o(r(t))}},function(t,e,n){n(34)(\"asyncIterator\")},function(t,e,n){n(34)(\"observable\")},function(t,e,n){t.exports={default:n(102),__esModule:!0}},function(t,e,n){n(103),t.exports=n(0).Object.setPrototypeOf},function(t,e,n){var r=n(3);r(r.S,\"Object\",{setPrototypeOf:n(104).set})},function(t,e,n){var r=n(6),o=n(4),i=function(t,e){if(o(t),!r(e)&&null!==e)throw TypeError(e+\": can't set as prototype!\")};t.exports={set:Object.setPrototypeOf||(\"__proto__\"in{}?function(t,e,r){try{r=n(15)(Function.call,n(40).f(Object.prototype,\"__proto__\").set,2),r(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return i(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:i}},function(t,e,n){t.exports={default:n(106),__esModule:!0}},function(t,e,n){n(107);var r=n(0).Object;t.exports=function(t,e){return r.create(t,e)}},function(t,e,n){var r=n(3);r(r.S,\"Object\",{create:n(31)})},,,,,,,,,function(t,e,n){\"use strict\";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0});var r=n(63),o=_interopRequireDefault(r),i=n(11),u=_interopRequireDefault(i),s=n(12),c=_interopRequireDefault(s),f=n(64),a=_interopRequireDefault(f),l=n(65),p=_interopRequireDefault(l),v=n(117),d=_interopRequireDefault(v),h=function(t){function MiniBus(){return(0,u.default)(this,MiniBus),(0,a.default)(this,(MiniBus.__proto__||(0,o.default)(MiniBus)).call(this))}return(0,p.default)(MiniBus,t),(0,c.default)(MiniBus,[{key:\"postMessage\",value:function(t,e,n){var r=this;return r._genId(t),r._responseCallback(t,e,n),r._onPostMessage(t),t.id}},{key:\"_onMessage\",value:function(t){var e=this;if(!e._onResponse(t)){var n=e._subscriptions[t.to];n?(e._publishOn(n,t),t.to.startsWith(\"hyperty\")||e._publishOnDefault(t)):e._publishOnDefault(t)}}}]),MiniBus}(d.default);e.default=h,t.exports=e.default},function(t,e,n){\"use strict\";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0});var r=n(41),o=_interopRequireDefault(r),i=n(11),u=_interopRequireDefault(i),s=n(12),c=_interopRequireDefault(s),f=n(87),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(f),l=a.getLogger(\"Bus\"),p=function(){function Bus(){(0,u.default)(this,Bus);var t=this;t._msgId=0,t._subscriptions={},t._responseTimeOut=3e4,t._responseCallbacks={},t._registerExternalListener()}return(0,c.default)(Bus,[{key:\"addListener\",value:function(t,e){var n=this,r=new v(n._subscriptions,t,e),o=n._subscriptions[t];return o||(o=[],n._subscriptions[t]=o),o.push(r),r}},{key:\"addResponseListener\",value:function(t,e,n){this._responseCallbacks[t+e]=n}},{key:\"removeResponseListener\",value:function(t,e){delete this._responseCallbacks[t+e]}},{key:\"removeAllListenersOf\",value:function(t){delete this._subscriptions[t]}},{key:\"bind\",value:function(t,e,n){var r=this,o=this;return{thisListener:o.addListener(t,function(t){n.postMessage(t)}),targetListener:n.addListener(e,function(t){o.postMessage(t)}),unbind:function(){r.thisListener.remove(),r.targetListener.remove()}}}},{key:\"_publishOnDefault\",value:function(t){var e=this._subscriptions[\"*\"];e&&this._publishOn(e,t)}},{key:\"_publishOn\",value:function(t,e){t.forEach(function(t){t._callback(e)})}},{key:\"_responseCallback\",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this;if(e){var o=t.from+t.id;r._responseCallbacks[o]=e,n&&setTimeout(function(){var e=r._responseCallbacks[o];if(delete r._responseCallbacks[o],e){e({id:t.id,type:\"response\",body:{code:408,desc:\"Response timeout!\",value:t}})}},r._responseTimeOut)}}},{key:\"_onResponse\",value:function(t){var e=this;if(\"response\"===t.type){var n=t.to+t.id,r=e._responseCallbacks[n];if(t.body.code>=200&&delete e._responseCallbacks[n],r)return r(t),!0}return!1}},{key:\"_onMessage\",value:function(t){var e=this;if(!e._onResponse(t)){var n=e._subscriptions[t.to];n?e._publishOn(n,t):e._publishOnDefault(t)}}},{key:\"_genId\",value:function(t){t.id&&0!==t.id||(this._msgId++,t.id=this._msgId)}},{key:\"postMessage\",value:function(t,e){}},{key:\"postMessageWithRetries\",value:function(t,e,n){var r=this,i=0,u=function(){return new o.default(function(e,o){r.postMessage(t,function(r){408===r.body.code||500===r.body.code?o():(l.info(\"[Bus.postMessageWithRetries] msg delivered: \",t),n(r),e())})})};!function tryAgain(){u().then(function(){},function(){if(l.warn(\"[Bus.postMessageWithRetries] Message Bounced (retry \"+i+\"): '\",t),!(i++<e)){var n=\"[Error] Message Bounced (delivery attempts \"+e+\"): '\";throw new Error(n+t)}tryAgain()})}()}},{key:\"_onPostMessage\",value:function(t){}},{key:\"_registerExternalListener\",value:function(){}}]),Bus}(),v=function(){function MsgListener(t,e,n){(0,u.default)(this,MsgListener);var r=this;r._subscriptions=t,r._url=e,r._callback=n}return(0,c.default)(MsgListener,[{key:\"remove\",value:function(){var t=this,e=t._subscriptions[t._url];if(e){var n=e.indexOf(t);e.splice(n,1),0===e.length&&delete t._subscriptions[t._url]}}},{key:\"url\",get:function(){return this._url}}]),MsgListener}();e.default=p,t.exports=e.default},,,,,,,,,,,,,,,,,,,function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var r=n(116),o=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=o.default,t.exports=e.default}])});","// version: 0.12.0\n// date: Wed Aug 01 2018 09:48:10 GMT+0100 (Western European Summer Time)\n// licence: \n/**\n* Copyright 2016 PT Inovao e Sistemas SA\n* Copyright 2016 INESC-ID\n* Copyright 2016 QUOBIS NETWORKS SL\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n* Copyright 2016 ORANGE SA\n* Copyright 2016 Deutsche Telekom AG\n* Copyright 2016 Apizee\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n**/\n\n\n// version: 0.12.0\n// date: Wed Aug 01 2018 09:48:10 GMT+0100 (Western European Summer Time)\n// licence: \n/**\n* Copyright 2016 PT Inovao e Sistemas SA\n* Copyright 2016 INESC-ID\n* Copyright 2016 QUOBIS NETWORKS SL\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n* Copyright 2016 ORANGE SA\n* Copyright 2016 Deutsche Telekom AG\n* Copyright 2016 Apizee\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n**/\n\n\n!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"sandbox\",[],t):\"object\"==typeof exports?exports.sandbox=t():e.sandbox=t()}(\"undefined\"!=typeof self?self:this,function(){return function(e){function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}var t={};return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,\"a\",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p=\"\",__webpack_require__(__webpack_require__.s=134)}([function(e,t){var n=e.exports={version:\"2.5.7\"};\"number\"==typeof __e&&(__e=n)},function(e,t){var n=e.exports=\"undefined\"!=typeof window&&window.Math==Math?window:\"undefined\"!=typeof self&&self.Math==Math?self:Function(\"return this\")();\"number\"==typeof __g&&(__g=n)},function(e,t,n){var r=n(28)(\"wks\"),o=n(20),i=n(1).Symbol,u=\"function\"==typeof i;(e.exports=function(e){return r[e]||(r[e]=u&&i[e]||(u?i:o)(\"Symbol.\"+e))}).store=r},function(e,t,n){var r=n(1),o=n(0),i=n(15),u=n(9),s=n(8),c=function(e,t,n){var a,f,l,p=e&c.F,d=e&c.G,v=e&c.S,y=e&c.P,_=e&c.B,h=e&c.W,b=d?o:o[t]||(o[t]={}),g=b.prototype,m=d?r:v?r[t]:(r[t]||{}).prototype;d&&(n=t);for(a in n)(f=!p&&m&&void 0!==m[a])&&s(b,a)||(l=f?m[a]:n[a],b[a]=d&&\"function\"!=typeof m[a]?n[a]:_&&f?i(l,r):h&&m[a]==l?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(l):y&&\"function\"==typeof l?i(Function.call,l):l,y&&((b.virtual||(b.virtual={}))[a]=l,e&c.R&&g&&!g[a]&&u(g,a,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){var r=n(6);e.exports=function(e){if(!r(e))throw TypeError(e+\" is not an object!\");return e}},function(e,t,n){e.exports=!n(13)(function(){return 7!=Object.defineProperty({},\"a\",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){return\"object\"==typeof e?null!==e:\"function\"==typeof e}},function(e,t,n){var r=n(4),o=n(36),i=n(26),u=Object.defineProperty;t.f=n(5)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return u(e,t,n)}catch(e){}if(\"get\"in n||\"set\"in n)throw TypeError(\"Accessors not supported!\");return\"value\"in n&&(e[t]=n.value),e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(7),o=n(19);e.exports=n(5)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(57),o=n(23);e.exports=function(e){return r(o(e))}},function(e,t,n){\"use strict\";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}},function(e,t,n){\"use strict\";t.__esModule=!0;var r=n(60),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),(0,o.default)(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}()},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=!0},function(e,t,n){var r=n(18);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports={}},function(e,t){e.exports=function(e){if(\"function\"!=typeof e)throw TypeError(e+\" is not a function!\");return e}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return\"Symbol(\".concat(void 0===e?\"\":e,\")_\",(++n+r).toString(36))}},function(e,t,n){var r=n(37),o=n(29);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError(\"Can't call method on  \"+e);return e}},function(e,t,n){var r=n(7).f,o=n(8),i=n(2)(\"toStringTag\");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t,n){var r=n(6),o=n(1).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t,n){var r=n(6);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&\"function\"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if(\"function\"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&\"function\"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError(\"Can't convert object to primitive value\")}},function(e,t,n){var r=n(28)(\"keys\"),o=n(20);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t,n){var r=n(0),o=n(1),i=o[\"__core-js_shared__\"]||(o[\"__core-js_shared__\"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})(\"versions\",[]).push({version:r.version,mode:n(14)?\"pure\":\"global\",copyright:\" 2018 Denis Pushkarev (zloirock.ru)\"})},function(e,t){e.exports=\"constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf\".split(\",\")},function(e,t,n){var r=n(23);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(4),o=n(69),i=n(29),u=n(27)(\"IE_PROTO\"),s=function(){},c=function(){var e,t=n(25)(\"iframe\"),r=i.length;for(t.style.display=\"none\",n(46).appendChild(t),t.src=\"javascript:\",e=t.contentWindow.document,e.open(),e.write(\"<script>document.F=Object<\\/script>\"),e.close(),c=e.F;r--;)delete c.prototype[i[r]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[u]=e):n=c(),void 0===t?n:o(n,t)}},function(e,t,n){\"use strict\";function PromiseCapability(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError(\"Bad Promise constructor\");t=e,n=r}),this.resolve=r(t),this.reject=r(n)}var r=n(18);e.exports.f=function(e){return new PromiseCapability(e)}},function(e,t,n){t.f=n(2)},function(e,t,n){var r=n(1),o=n(0),i=n(14),u=n(33),s=n(7).f;e.exports=function(e){var t=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});\"_\"==e.charAt(0)||e in t||s(t,e,{value:u.f(e)})}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){e.exports=!n(5)&&!n(13)(function(){return 7!=Object.defineProperty(n(25)(\"div\"),\"a\",{get:function(){return 7}}).a})},function(e,t,n){var r=n(8),o=n(10),i=n(58)(!1),u=n(27)(\"IE_PROTO\");e.exports=function(e,t){var n,s=o(e),c=0,a=[];for(n in s)n!=u&&r(s,n)&&a.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~i(a,n)||a.push(n));return a}},function(e,t,n){var r=n(22),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){var r=n(3),o=n(0),i=n(13);e.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],u={};u[e]=t(n),r(r.S+r.F*i(function(){n(1)}),\"Object\",u)}},function(e,t,n){var r=n(35),o=n(19),i=n(10),u=n(26),s=n(8),c=n(36),a=Object.getOwnPropertyDescriptor;t.f=n(5)?a:function(e,t){if(e=i(e),t=u(t,!0),c)try{return a(e,t)}catch(e){}if(s(e,t))return o(!r.f.call(e,t),e[t])}},function(e,t,n){e.exports={default:n(66),__esModule:!0}},function(e,t){},function(e,t,n){\"use strict\";var r=n(67)(!0);n(44)(String,\"String\",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){\"use strict\";var r=n(14),o=n(3),i=n(45),u=n(9),s=n(17),c=n(68),a=n(24),f=n(47),l=n(2)(\"iterator\"),p=!([].keys&&\"next\"in[].keys()),d=function(){return this};e.exports=function(e,t,n,v,y,_,h){c(n,t,v);var b,g,m,x=function(e){if(!p&&e in M)return M[e];switch(e){case\"keys\":case\"values\":return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+\" Iterator\",O=\"values\"==y,S=!1,M=e.prototype,P=M[l]||M[\"@@iterator\"]||y&&M[y],k=P||x(y),R=y?O?x(\"entries\"):k:void 0,L=\"Array\"==t?M.entries||P:P;if(L&&(m=f(L.call(new e)))!==Object.prototype&&m.next&&(a(m,w,!0),r||\"function\"==typeof m[l]||u(m,l,d)),O&&P&&\"values\"!==P.name&&(S=!0,k=function(){return P.call(this)}),r&&!h||!p&&!S&&M[l]||u(M,l,k),s[t]=k,s[w]=d,y)if(b={values:O?k:x(\"values\"),keys:_?k:x(\"keys\"),entries:R},h)for(g in b)g in M||i(M,g,b[g]);else o(o.P+o.F*(p||S),t,b);return b}},function(e,t,n){e.exports=n(9)},function(e,t,n){var r=n(1).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(8),o=n(30),i=n(27)(\"IE_PROTO\"),u=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,i)?e[i]:\"function\"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?u:null}},function(e,t,n){n(70);for(var r=n(1),o=n(9),i=n(17),u=n(2)(\"toStringTag\"),s=\"CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList\".split(\",\"),c=0;c<s.length;c++){var a=s[c],f=r[a],l=f&&f.prototype;l&&!l[u]&&o(l,u,a),i[a]=i.Array}},function(e,t,n){var r=n(16),o=n(2)(\"toStringTag\"),i=\"Arguments\"==r(function(){return arguments}()),u=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?\"Undefined\":null===e?\"Null\":\"string\"==typeof(n=u(t=Object(e),o))?n:i?r(t):\"Object\"==(s=r(t))&&\"function\"==typeof t.callee?\"Arguments\":s}},function(e,t,n){var r=n(4),o=n(18),i=n(2)(\"species\");e.exports=function(e,t){var n,u=r(e).constructor;return void 0===u||void 0==(n=r(u)[i])?t:o(n)}},function(e,t,n){var r,o,i,u=n(15),s=n(79),c=n(46),a=n(25),f=n(1),l=f.process,p=f.setImmediate,d=f.clearImmediate,v=f.MessageChannel,y=f.Dispatch,_=0,h={},b=function(){var e=+this;if(h.hasOwnProperty(e)){var t=h[e];delete h[e],t()}},g=function(e){b.call(e.data)};p&&d||(p=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return h[++_]=function(){s(\"function\"==typeof e?e:Function(e),t)},r(_),_},d=function(e){delete h[e]},\"process\"==n(16)(l)?r=function(e){l.nextTick(u(b,e,1))}:y&&y.now?r=function(e){y.now(u(b,e,1))}:v?(o=new v,i=o.port2,o.port1.onmessage=g,r=u(i.postMessage,i,1)):f.addEventListener&&\"function\"==typeof postMessage&&!f.importScripts?(r=function(e){f.postMessage(e+\"\",\"*\")},f.addEventListener(\"message\",g,!1)):r=\"onreadystatechange\"in a(\"script\")?function(e){c.appendChild(a(\"script\")).onreadystatechange=function(){c.removeChild(this),b.call(e)}}:function(e){setTimeout(u(b,e,1),0)}),e.exports={set:p,clear:d}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(4),o=n(6),i=n(32);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){\"use strict\";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var r=n(90),o=_interopRequireDefault(r),i=n(92),u=_interopRequireDefault(i),s=\"function\"==typeof u.default&&\"symbol\"==typeof o.default?function(e){return typeof e}:function(e){return e&&\"function\"==typeof u.default&&e.constructor===u.default&&e!==u.default.prototype?\"symbol\":typeof e};t.default=\"function\"==typeof u.default&&\"symbol\"===s(o.default)?function(e){return void 0===e?\"undefined\":s(e)}:function(e){return e&&\"function\"==typeof u.default&&e.constructor===u.default&&e!==u.default.prototype?\"symbol\":void 0===e?\"undefined\":s(e)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(37),o=n(29).concat(\"length\",\"prototype\");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},function(e,t,n){var r=n(16);e.exports=Object(\"z\").propertyIsEnumerable(0)?Object:function(e){return\"String\"==r(e)?e.split(\"\"):Object(e)}},function(e,t,n){var r=n(10),o=n(38),i=n(59);e.exports=function(e){return function(t,n,u){var s,c=r(t),a=o(c.length),f=i(u,a);if(e&&n!=n){for(;a>f;)if((s=c[f++])!=s)return!0}else for(;a>f;f++)if((e||f in c)&&c[f]===n)return e||f||0;return!e&&-1}}},function(e,t,n){var r=n(22),o=Math.max,i=Math.min;e.exports=function(e,t){return e=r(e),e<0?o(e+t,0):i(e,t)}},function(e,t,n){e.exports={default:n(61),__esModule:!0}},function(e,t,n){n(62);var r=n(0).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(3);r(r.S+r.F*!n(5),\"Object\",{defineProperty:n(7).f})},function(e,t,n){e.exports={default:n(88),__esModule:!0}},function(e,t,n){\"use strict\";t.__esModule=!0;var r=n(54),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!==(void 0===t?\"undefined\":(0,o.default)(t))&&\"function\"!=typeof t?e:t}},function(e,t,n){\"use strict\";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var r=n(101),o=_interopRequireDefault(r),i=n(105),u=_interopRequireDefault(i),s=n(54),c=_interopRequireDefault(s);t.default=function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+(void 0===t?\"undefined\":(0,c.default)(t)));e.prototype=(0,u.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}},function(e,t,n){n(42),n(43),n(48),n(73),n(85),n(86),e.exports=n(0).Promise},function(e,t,n){var r=n(22),o=n(23);e.exports=function(e){return function(t,n){var i,u,s=String(o(t)),c=r(n),a=s.length;return c<0||c>=a?e?\"\":void 0:(i=s.charCodeAt(c),i<55296||i>56319||c+1===a||(u=s.charCodeAt(c+1))<56320||u>57343?e?s.charAt(c):i:e?s.slice(c,c+2):u-56320+(i-55296<<10)+65536)}}},function(e,t,n){\"use strict\";var r=n(31),o=n(19),i=n(24),u={};n(9)(u,n(2)(\"iterator\"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(u,{next:o(1,n)}),i(e,t+\" Iterator\")}},function(e,t,n){var r=n(7),o=n(4),i=n(21);e.exports=n(5)?Object.defineProperties:function(e,t){o(e);for(var n,u=i(t),s=u.length,c=0;s>c;)r.f(e,n=u[c++],t[n]);return e}},function(e,t,n){\"use strict\";var r=n(71),o=n(72),i=n(17),u=n(10);e.exports=n(44)(Array,\"Array\",function(e,t){this._t=u(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):\"keys\"==t?o(0,n):\"values\"==t?o(0,e[n]):o(0,[n,e[n]])},\"values\"),i.Arguments=i.Array,r(\"keys\"),r(\"values\"),r(\"entries\")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){\"use strict\";var r,o,i,u,s=n(14),c=n(1),a=n(15),f=n(49),l=n(3),p=n(6),d=n(18),v=n(74),y=n(75),_=n(50),h=n(51).set,b=n(80)(),g=n(32),m=n(52),x=n(81),w=n(53),O=c.TypeError,S=c.process,M=S&&S.versions,P=M&&M.v8||\"\",k=c.Promise,R=\"process\"==f(S),L=function(){},j=o=g.f,D=!!function(){try{var e=k.resolve(1),t=(e.constructor={})[n(2)(\"species\")]=function(e){e(L,L)};return(R||\"function\"==typeof PromiseRejectionEvent)&&e.then(L)instanceof t&&0!==P.indexOf(\"6.6\")&&-1===x.indexOf(\"Chrome/66\")}catch(e){}}(),E=function(e){var t;return!(!p(e)||\"function\"!=typeof(t=e.then))&&t},T=function(e,t){if(!e._n){e._n=!0;var n=e._c;b(function(){for(var r=e._v,o=1==e._s,i=0;n.length>i;)!function(t){var n,i,u,s=o?t.ok:t.fail,c=t.resolve,a=t.reject,f=t.domain;try{s?(o||(2==e._h&&C(e),e._h=1),!0===s?n=r:(f&&f.enter(),n=s(r),f&&(f.exit(),u=!0)),n===t.promise?a(O(\"Promise-chain cycle\")):(i=E(n))?i.call(n,c,a):c(n)):a(r)}catch(e){f&&!u&&f.exit(),a(e)}}(n[i++]);e._c=[],e._n=!1,t&&!e._h&&A(e)})}},A=function(e){h.call(c,function(){var t,n,r,o=e._v,i=q(e);if(i&&(t=m(function(){R?S.emit(\"unhandledRejection\",o,e):(n=c.onunhandledrejection)?n({promise:e,reason:o}):(r=c.console)&&r.error&&r.error(\"Unhandled promise rejection\",o)}),e._h=R||q(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},q=function(e){return 1!==e._h&&0===(e._a||e._c).length},C=function(e){h.call(c,function(){var t;R?S.emit(\"rejectionHandled\",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})})},I=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),T(t,!0))},F=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw O(\"Promise can't be resolved itself\");(t=E(e))?b(function(){var r={_w:n,_d:!1};try{t.call(e,a(F,r,1),a(I,r,1))}catch(e){I.call(r,e)}}):(n._v=e,n._s=1,T(n,!1))}catch(e){I.call({_w:n,_d:!1},e)}}};D||(k=function(e){v(this,k,\"Promise\",\"_h\"),d(e),r.call(this);try{e(a(F,this,1),a(I,this,1))}catch(e){I.call(this,e)}},r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n(82)(k.prototype,{then:function(e,t){var n=j(_(this,k));return n.ok=\"function\"!=typeof e||e,n.fail=\"function\"==typeof t&&t,n.domain=R?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&T(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r;this.promise=e,this.resolve=a(F,e,1),this.reject=a(I,e,1)},g.f=j=function(e){return e===k||e===u?new i(e):o(e)}),l(l.G+l.W+l.F*!D,{Promise:k}),n(24)(k,\"Promise\"),n(83)(\"Promise\"),u=n(0).Promise,l(l.S+l.F*!D,\"Promise\",{reject:function(e){var t=j(this);return(0,t.reject)(e),t.promise}}),l(l.S+l.F*(s||!D),\"Promise\",{resolve:function(e){return w(s&&this===u?k:this,e)}}),l(l.S+l.F*!(D&&n(84)(function(e){k.all(e).catch(L)})),\"Promise\",{all:function(e){var t=this,n=j(t),r=n.resolve,o=n.reject,i=m(function(){var n=[],i=0,u=1;y(e,!1,function(e){var s=i++,c=!1;n.push(void 0),u++,t.resolve(e).then(function(e){c||(c=!0,n[s]=e,--u||r(n))},o)}),--u||r(n)});return i.e&&o(i.v),n.promise},race:function(e){var t=this,n=j(t),r=n.reject,o=m(function(){y(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return o.e&&r(o.v),n.promise}})},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+\": incorrect invocation!\");return e}},function(e,t,n){var r=n(15),o=n(76),i=n(77),u=n(4),s=n(38),c=n(78),a={},f={},t=e.exports=function(e,t,n,l,p){var d,v,y,_,h=p?function(){return e}:c(e),b=r(n,l,t?2:1),g=0;if(\"function\"!=typeof h)throw TypeError(e+\" is not iterable!\");if(i(h)){for(d=s(e.length);d>g;g++)if((_=t?b(u(v=e[g])[0],v[1]):b(e[g]))===a||_===f)return _}else for(y=h.call(e);!(v=y.next()).done;)if((_=o(y,b,v.value,t))===a||_===f)return _};t.BREAK=a,t.RETURN=f},function(e,t,n){var r=n(4);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},function(e,t,n){var r=n(17),o=n(2)(\"iterator\"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||i[o]===e)}},function(e,t,n){var r=n(49),o=n(2)(\"iterator\"),i=n(17);e.exports=n(0).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e[\"@@iterator\"]||i[r(e)]}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(1),o=n(51).set,i=r.MutationObserver||r.WebKitMutationObserver,u=r.process,s=r.Promise,c=\"process\"==n(16)(u);e.exports=function(){var e,t,n,a=function(){var r,o;for(c&&(r=u.domain)&&r.exit();e;){o=e.fn,e=e.next;try{o()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){u.nextTick(a)};else if(!i||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var f=s.resolve(void 0);n=function(){f.then(a)}}else n=function(){o.call(r,a)};else{var l=!0,p=document.createTextNode(\"\");new i(a).observe(p,{characterData:!0}),n=function(){p.data=l=!l}}return function(r){var o={fn:r,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t,n){var r=n(1),o=r.navigator;e.exports=o&&o.userAgent||\"\"},function(e,t,n){var r=n(9);e.exports=function(e,t,n){for(var o in t)n&&e[o]?e[o]=t[o]:r(e,o,t[o]);return e}},function(e,t,n){\"use strict\";var r=n(1),o=n(0),i=n(7),u=n(5),s=n(2)(\"species\");e.exports=function(e){var t=\"function\"==typeof o[e]?o[e]:r[e];u&&t&&!t[s]&&i.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(2)(\"iterator\"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i=[7],u=i[r]();u.next=function(){return{done:n=!0}},i[r]=function(){return u},e(i)}catch(e){}return n}},function(e,t,n){\"use strict\";var r=n(3),o=n(0),i=n(1),u=n(50),s=n(53);r(r.P+r.R,\"Promise\",{finally:function(e){var t=u(this,o.Promise||i.Promise),n=\"function\"==typeof e;return this.then(n?function(n){return s(t,e()).then(function(){return n})}:e,n?function(n){return s(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){\"use strict\";var r=n(3),o=n(32),i=n(52);r(r.S,\"Promise\",{try:function(e){var t=o.f(this),n=i(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){var r,o;!function(i,u){\"use strict\";r=u,void 0!==(o=\"function\"==typeof r?r.call(t,n,t,e):r)&&(e.exports=o)}(0,function(){\"use strict\";function bindMethod(e,t){var n=e[t];if(\"function\"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function realMethod(n){return\"debug\"===n&&(n=\"log\"),typeof console!==t&&(void 0!==console[n]?bindMethod(console,n):void 0!==console.log?bindMethod(console,\"log\"):e)}function replaceLoggingMethods(t,r){for(var o=0;o<n.length;o++){var i=n[o];this[i]=o<t?e:this.methodFactory(i,t,r)}this.log=this.debug}function enableLoggingWhenConsoleArrives(e,n,r){return function(){typeof console!==t&&(replaceLoggingMethods.call(this,n,r),this[e].apply(this,arguments))}}function defaultMethodFactory(e,t,n){return realMethod(e)||enableLoggingWhenConsoleArrives.apply(this,arguments)}function Logger(e,r,o){function persistLevelIfPossible(e){var r=(n[e]||\"silent\").toUpperCase();if(typeof window!==t){try{return void(window.localStorage[s]=r)}catch(e){}try{window.document.cookie=encodeURIComponent(s)+\"=\"+r+\";\"}catch(e){}}}function getPersistedLevel(){var e;if(typeof window!==t){try{e=window.localStorage[s]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(s)+\"=\");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===u.levels[e]&&(e=void 0),e}}var i,u=this,s=\"loglevel\";e&&(s+=\":\"+e),u.name=e,u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},u.methodFactory=o||defaultMethodFactory,u.getLevel=function(){return i},u.setLevel=function(n,r){if(\"string\"==typeof n&&void 0!==u.levels[n.toUpperCase()]&&(n=u.levels[n.toUpperCase()]),!(\"number\"==typeof n&&n>=0&&n<=u.levels.SILENT))throw\"log.setLevel() called with invalid level: \"+n;if(i=n,!1!==r&&persistLevelIfPossible(n),replaceLoggingMethods.call(u,n,e),typeof console===t&&n<u.levels.SILENT)return\"No console available for logging\"},u.setDefaultLevel=function(e){getPersistedLevel()||u.setLevel(e,!1)},u.enableAll=function(e){u.setLevel(u.levels.TRACE,e)},u.disableAll=function(e){u.setLevel(u.levels.SILENT,e)};var c=getPersistedLevel();null==c&&(c=null==r?\"WARN\":r),u.setLevel(c,!1)}var e=function(){},t=\"undefined\",n=[\"trace\",\"debug\",\"info\",\"warn\",\"error\"],r=new Logger,o={};r.getLogger=function(e){if(\"string\"!=typeof e||\"\"===e)throw new TypeError(\"You must supply a name when creating a logger.\");var t=o[e];return t||(t=o[e]=new Logger(e,r.getLevel(),r.methodFactory)),t};var i=typeof window!==t?window.log:void 0;return r.noConflict=function(){return typeof window!==t&&window.log===r&&(window.log=i),r},r.getLoggers=function(){return o},r})},function(e,t,n){n(89),e.exports=n(0).Object.getPrototypeOf},function(e,t,n){var r=n(30),o=n(47);n(39)(\"getPrototypeOf\",function(){return function(e){return o(r(e))}})},function(e,t,n){e.exports={default:n(91),__esModule:!0}},function(e,t,n){n(43),n(48),e.exports=n(33).f(\"iterator\")},function(e,t,n){e.exports={default:n(93),__esModule:!0}},function(e,t,n){n(94),n(42),n(99),n(100),e.exports=n(0).Symbol},function(e,t,n){\"use strict\";var r=n(1),o=n(8),i=n(5),u=n(3),s=n(45),c=n(95).KEY,a=n(13),f=n(28),l=n(24),p=n(20),d=n(2),v=n(33),y=n(34),_=n(96),h=n(97),b=n(4),g=n(6),m=n(10),x=n(26),w=n(19),O=n(31),S=n(98),M=n(40),P=n(7),k=n(21),R=M.f,L=P.f,j=S.f,D=r.Symbol,E=r.JSON,T=E&&E.stringify,A=d(\"_hidden\"),q=d(\"toPrimitive\"),C={}.propertyIsEnumerable,I=f(\"symbol-registry\"),F=f(\"symbols\"),N=f(\"op-symbols\"),B=Object.prototype,W=\"function\"==typeof D,G=r.QObject,U=!G||!G.prototype||!G.prototype.findChild,V=i&&a(function(){return 7!=O(L({},\"a\",{get:function(){return L(this,\"a\",{value:7}).a}})).a})?function(e,t,n){var r=R(B,t);r&&delete B[t],L(e,t,n),r&&e!==B&&L(B,t,r)}:L,H=function(e){var t=F[e]=O(D.prototype);return t._k=e,t},K=W&&\"symbol\"==typeof D.iterator?function(e){return\"symbol\"==typeof e}:function(e){return e instanceof D},J=function(e,t,n){return e===B&&J(N,t,n),b(e),t=x(t,!0),b(n),o(F,t)?(n.enumerable?(o(e,A)&&e[A][t]&&(e[A][t]=!1),n=O(n,{enumerable:w(0,!1)})):(o(e,A)||L(e,A,w(1,{})),e[A][t]=!0),V(e,t,n)):L(e,t,n)},z=function(e,t){b(e);for(var n,r=_(t=m(t)),o=0,i=r.length;i>o;)J(e,n=r[o++],t[n]);return e},Y=function(e,t){return void 0===t?O(e):z(O(e),t)},Q=function(e){var t=C.call(this,e=x(e,!0));return!(this===B&&o(F,e)&&!o(N,e))&&(!(t||!o(this,e)||!o(F,e)||o(this,A)&&this[A][e])||t)},X=function(e,t){if(e=m(e),t=x(t,!0),e!==B||!o(F,t)||o(N,t)){var n=R(e,t);return!n||!o(F,t)||o(e,A)&&e[A][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=j(m(e)),r=[],i=0;n.length>i;)o(F,t=n[i++])||t==A||t==c||r.push(t);return r},$=function(e){for(var t,n=e===B,r=j(n?N:m(e)),i=[],u=0;r.length>u;)!o(F,t=r[u++])||n&&!o(B,t)||i.push(F[t]);return i};W||(D=function(){if(this instanceof D)throw TypeError(\"Symbol is not a constructor!\");var e=p(arguments.length>0?arguments[0]:void 0),t=function(n){this===B&&t.call(N,n),o(this,A)&&o(this[A],e)&&(this[A][e]=!1),V(this,e,w(1,n))};return i&&U&&V(B,e,{configurable:!0,set:t}),H(e)},s(D.prototype,\"toString\",function(){return this._k}),M.f=X,P.f=J,n(56).f=S.f=Z,n(35).f=Q,n(55).f=$,i&&!n(14)&&s(B,\"propertyIsEnumerable\",Q,!0),v.f=function(e){return H(d(e))}),u(u.G+u.W+u.F*!W,{Symbol:D});for(var ee=\"hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables\".split(\",\"),te=0;ee.length>te;)d(ee[te++]);for(var ne=k(d.store),re=0;ne.length>re;)y(ne[re++]);u(u.S+u.F*!W,\"Symbol\",{for:function(e){return o(I,e+=\"\")?I[e]:I[e]=D(e)},keyFor:function(e){if(!K(e))throw TypeError(e+\" is not a symbol!\");for(var t in I)if(I[t]===e)return t},useSetter:function(){U=!0},useSimple:function(){U=!1}}),u(u.S+u.F*!W,\"Object\",{create:Y,defineProperty:J,defineProperties:z,getOwnPropertyDescriptor:X,getOwnPropertyNames:Z,getOwnPropertySymbols:$}),E&&u(u.S+u.F*(!W||a(function(){var e=D();return\"[null]\"!=T([e])||\"{}\"!=T({a:e})||\"{}\"!=T(Object(e))})),\"JSON\",{stringify:function(e){for(var t,n,r=[e],o=1;arguments.length>o;)r.push(arguments[o++]);if(n=t=r[1],(g(t)||void 0!==e)&&!K(e))return h(t)||(t=function(e,t){if(\"function\"==typeof n&&(t=n.call(this,e,t)),!K(t))return t}),r[1]=t,T.apply(E,r)}}),D.prototype[q]||n(9)(D.prototype,q,D.prototype.valueOf),l(D,\"Symbol\"),l(Math,\"Math\",!0),l(r.JSON,\"JSON\",!0)},function(e,t,n){var r=n(20)(\"meta\"),o=n(6),i=n(8),u=n(7).f,s=0,c=Object.isExtensible||function(){return!0},a=!n(13)(function(){return c(Object.preventExtensions({}))}),f=function(e){u(e,r,{value:{i:\"O\"+ ++s,w:{}}})},l=function(e,t){if(!o(e))return\"symbol\"==typeof e?e:(\"string\"==typeof e?\"S\":\"P\")+e;if(!i(e,r)){if(!c(e))return\"F\";if(!t)return\"E\";f(e)}return e[r].i},p=function(e,t){if(!i(e,r)){if(!c(e))return!0;if(!t)return!1;f(e)}return e[r].w},d=function(e){return a&&v.NEED&&c(e)&&!i(e,r)&&f(e),e},v=e.exports={KEY:r,NEED:!1,fastKey:l,getWeak:p,onFreeze:d}},function(e,t,n){var r=n(21),o=n(55),i=n(35);e.exports=function(e){var t=r(e),n=o.f;if(n)for(var u,s=n(e),c=i.f,a=0;s.length>a;)c.call(e,u=s[a++])&&t.push(u);return t}},function(e,t,n){var r=n(16);e.exports=Array.isArray||function(e){return\"Array\"==r(e)}},function(e,t,n){var r=n(10),o=n(56).f,i={}.toString,u=\"object\"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return o(e)}catch(e){return u.slice()}};e.exports.f=function(e){return u&&\"[object Window]\"==i.call(e)?s(e):o(r(e))}},function(e,t,n){n(34)(\"asyncIterator\")},function(e,t,n){n(34)(\"observable\")},function(e,t,n){e.exports={default:n(102),__esModule:!0}},function(e,t,n){n(103),e.exports=n(0).Object.setPrototypeOf},function(e,t,n){var r=n(3);r(r.S,\"Object\",{setPrototypeOf:n(104).set})},function(e,t,n){var r=n(6),o=n(4),i=function(e,t){if(o(e),!r(t)&&null!==t)throw TypeError(t+\": can't set as prototype!\")};e.exports={set:Object.setPrototypeOf||(\"__proto__\"in{}?function(e,t,r){try{r=n(15)(Function.call,n(40).f(Object.prototype,\"__proto__\").set,2),r(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return i(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:i}},function(e,t,n){e.exports={default:n(106),__esModule:!0}},function(e,t,n){n(107);var r=n(0).Object;e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){var r=n(3);r(r.S,\"Object\",{create:n(31)})},function(e,t,n){e.exports={default:n(109),__esModule:!0}},function(e,t,n){n(110),e.exports=n(0).Object.keys},function(e,t,n){var r=n(30),o=n(21);n(39)(\"keys\",function(){return function(e){return o(r(e))}})},,,,,,function(e,t,n){\"use strict\";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(63),o=_interopRequireDefault(r),i=n(11),u=_interopRequireDefault(i),s=n(12),c=_interopRequireDefault(s),a=n(64),f=_interopRequireDefault(a),l=n(65),p=_interopRequireDefault(l),d=n(117),v=_interopRequireDefault(d),y=function(e){function MiniBus(){return(0,u.default)(this,MiniBus),(0,f.default)(this,(MiniBus.__proto__||(0,o.default)(MiniBus)).call(this))}return(0,p.default)(MiniBus,e),(0,c.default)(MiniBus,[{key:\"postMessage\",value:function(e,t,n){var r=this;return r._genId(e),r._responseCallback(e,t,n),r._onPostMessage(e),e.id}},{key:\"_onMessage\",value:function(e){var t=this;if(!t._onResponse(e)){var n=t._subscriptions[e.to];n?(t._publishOn(n,e),e.to.startsWith(\"hyperty\")||t._publishOnDefault(e)):t._publishOnDefault(e)}}}]),MiniBus}(v.default);t.default=y,e.exports=t.default},function(e,t,n){\"use strict\";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(41),o=_interopRequireDefault(r),i=n(11),u=_interopRequireDefault(i),s=n(12),c=_interopRequireDefault(s),a=n(87),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a),l=f.getLogger(\"Bus\"),p=function(){function Bus(){(0,u.default)(this,Bus);var e=this;e._msgId=0,e._subscriptions={},e._responseTimeOut=3e4,e._responseCallbacks={},e._registerExternalListener()}return(0,c.default)(Bus,[{key:\"addListener\",value:function(e,t){var n=this,r=new d(n._subscriptions,e,t),o=n._subscriptions[e];return o||(o=[],n._subscriptions[e]=o),o.push(r),r}},{key:\"addResponseListener\",value:function(e,t,n){this._responseCallbacks[e+t]=n}},{key:\"removeResponseListener\",value:function(e,t){delete this._responseCallbacks[e+t]}},{key:\"removeAllListenersOf\",value:function(e){delete this._subscriptions[e]}},{key:\"bind\",value:function(e,t,n){var r=this,o=this;return{thisListener:o.addListener(e,function(e){n.postMessage(e)}),targetListener:n.addListener(t,function(e){o.postMessage(e)}),unbind:function(){r.thisListener.remove(),r.targetListener.remove()}}}},{key:\"_publishOnDefault\",value:function(e){var t=this._subscriptions[\"*\"];t&&this._publishOn(t,e)}},{key:\"_publishOn\",value:function(e,t){e.forEach(function(e){e._callback(t)})}},{key:\"_responseCallback\",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this;if(t){var o=e.from+e.id;r._responseCallbacks[o]=t,n&&setTimeout(function(){var t=r._responseCallbacks[o];if(delete r._responseCallbacks[o],t){t({id:e.id,type:\"response\",body:{code:408,desc:\"Response timeout!\",value:e}})}},r._responseTimeOut)}}},{key:\"_onResponse\",value:function(e){var t=this;if(\"response\"===e.type){var n=e.to+e.id,r=t._responseCallbacks[n];if(e.body.code>=200&&delete t._responseCallbacks[n],r)return r(e),!0}return!1}},{key:\"_onMessage\",value:function(e){var t=this;if(!t._onResponse(e)){var n=t._subscriptions[e.to];n?t._publishOn(n,e):t._publishOnDefault(e)}}},{key:\"_genId\",value:function(e){e.id&&0!==e.id||(this._msgId++,e.id=this._msgId)}},{key:\"postMessage\",value:function(e,t){}},{key:\"postMessageWithRetries\",value:function(e,t,n){var r=this,i=0,u=function(){return new o.default(function(t,o){r.postMessage(e,function(r){408===r.body.code||500===r.body.code?o():(l.info(\"[Bus.postMessageWithRetries] msg delivered: \",e),n(r),t())})})};!function tryAgain(){u().then(function(){},function(){if(l.warn(\"[Bus.postMessageWithRetries] Message Bounced (retry \"+i+\"): '\",e),!(i++<t)){var n=\"[Error] Message Bounced (delivery attempts \"+t+\"): '\";throw new Error(n+e)}tryAgain()})}()}},{key:\"_onPostMessage\",value:function(e){}},{key:\"_registerExternalListener\",value:function(){}}]),Bus}(),d=function(){function MsgListener(e,t,n){(0,u.default)(this,MsgListener);var r=this;r._subscriptions=e,r._url=t,r._callback=n}return(0,c.default)(MsgListener,[{key:\"remove\",value:function(){var e=this,t=e._subscriptions[e._url];if(t){var n=t.indexOf(e);t.splice(n,1),0===t.length&&delete e._subscriptions[e._url]}}},{key:\"url\",get:function(){return this._url}}]),MsgListener}();t.default=p,e.exports=t.default},function(e,t,n){\"use strict\";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(11),o=_interopRequireDefault(r),i=n(12),u=_interopRequireDefault(i),s=function(){function SandboxRegistry(e){(0,o.default)(this,SandboxRegistry);var t=this;t._bus=e,t._components={},e.addListener(SandboxRegistry.InternalDeployAddress,function(e){switch(e.type){case\"create\":t._onDeploy(e);break;case\"delete\":t._onRemove(e)}})}return(0,u.default)(SandboxRegistry,[{key:\"_responseMsg\",value:function(e,t,n){var r={id:e.id,type:\"response\",from:SandboxRegistry.InternalDeployAddress,to:SandboxRegistry.ExternalDeployAddress},o={};return t&&(o.code=t),n&&(o.desc=n),r.body=o,r}},{key:\"_onDeploy\",value:function(e){var t=this,n=e.body.config,r=e.body.url,o=e.body.sourceCode,i=void 0,u=void 0;if(t._components.hasOwnProperty(r))i=500,u=\"Instance \"+r+\" already exist!\";else try{t._components[r]=t._create(r,o,n),i=200}catch(e){i=500,u=e}var s=t._responseMsg(e,i,u);t._bus.postMessage(s)}},{key:\"_onRemove\",value:function(e){var t=this,n=e.body.url,r=void 0,o=void 0;t._components.hasOwnProperty(n)?(delete t._components[n],t._bus.removeAllListenersOf(n),r=200):(r=500,o=\"Instance \"+n+\" doesn't exist!\");var i=t._responseMsg(e,r,o);t._bus.postMessage(i)}},{key:\"_create\",value:function(e,t,n){}},{key:\"components\",get:function(){return this._components}}]),SandboxRegistry}();s.ExternalDeployAddress=\"hyperty-runtime://sandbox/external\",s.InternalDeployAddress=\"hyperty-runtime://sandbox/internal\",t.default=s,e.exports=t.default},,,,,,,,,,,,,,,,function(e,t,n){\"use strict\";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.SandboxRegistry=t.SandboxType=t.Sandbox=void 0;var r=n(135),o=_interopRequireDefault(r),i=n(118),u=_interopRequireDefault(i);t.Sandbox=o.default,t.SandboxType=r.SandboxType,t.SandboxRegistry=u.default},function(e,t,n){\"use strict\";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.SandboxType=void 0;var r=n(108),o=_interopRequireDefault(r),i=n(41),u=_interopRequireDefault(i),s=n(63),c=_interopRequireDefault(s),a=n(11),f=_interopRequireDefault(a),l=n(12),p=_interopRequireDefault(l),d=n(64),v=_interopRequireDefault(d),y=n(65),_=_interopRequireDefault(y),h=n(118),b=_interopRequireDefault(h),g=n(116),m=_interopRequireDefault(g),x=(t.SandboxType={APP:\"app\",NORMAL:\"normal\",WINDOW:\"window\"},function(e){function Sandbox(e){(0,f.default)(this,Sandbox);var t=(0,v.default)(this,(Sandbox.__proto__||(0,c.default)(Sandbox)).call(this)),n=t;return e&&(n.capabilities=e),t}return(0,_.default)(Sandbox,e),(0,p.default)(Sandbox,[{key:\"deployComponent\",value:function(e,t,n,r){var o=this;return new u.default(function(i,u){var s={type:\"create\",from:b.default.ExternalDeployAddress,to:b.default.InternalDeployAddress,body:{url:t,sourceCode:e,config:n,libs:r}};o.postMessage(s,function(e){200===e.body.code?i(\"deployed\"):u(e.body.desc)})})}},{key:\"removeComponent\",value:function(e){var t=this;return new u.default(function(n,r){var o={type:\"delete\",from:b.default.ExternalDeployAddress,to:b.default.InternalDeployAddress,body:{url:e}};t.postMessage(o,function(e){200===e.body.code?n(\"undeployed\"):r(e.body.desc)})})}},{key:\"matches\",value:function(e){var t=this,n=(0,o.default)(e).filter(function(n){return!(t.capabilities[n]&&t.capabilities[n]===e[n])});return 0===n.length||!e[n]}}]),Sandbox}(m.default));t.default=x}])});","// version: 0.9.0\n// date: Wed Aug 01 2018 09:34:34 GMT+0100 (Western European Summer Time)\n// licence: \n/**\n* Copyright 2016 PT Inovao e Sistemas SA\n* Copyright 2016 INESC-ID\n* Copyright 2016 QUOBIS NETWORKS SL\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n* Copyright 2016 ORANGE SA\n* Copyright 2016 Deutsche Telekom AG\n* Copyright 2016 Apizee\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n**/\n\n\n!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"PersistenceManager\",[],t):\"object\"==typeof exports?exports.PersistenceManager=t():(e[\"\"]=e[\"\"]||{},e[\"\"].PersistenceManager=t())}(\"undefined\"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=183)}({0:function(e,t){var n=e.exports={version:\"2.5.7\"};\"number\"==typeof __e&&(__e=n)},1:function(e,t){var n=e.exports=\"undefined\"!=typeof window&&window.Math==Math?window:\"undefined\"!=typeof self&&self.Math==Math?self:Function(\"return this\")();\"number\"==typeof __g&&(__g=n)},10:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},11:function(e,t,n){var r=n(8),o=n(16);e.exports=n(4)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},13:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},14:function(e,t,n){var r=n(24);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},16:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},183:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(184),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=o.default,e.exports=t.default},184:function(e,t,n){\"use strict\";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(58),u=r(o),i=n(3),f=r(i),c=n(5),a=r(c),l=function(){function e(t){if((0,f.default)(this,e),!t)throw Error(\"The Persistence Manager needs the localStorage\");this.localStorage=t}return(0,a.default)(e,[{key:\"set\",value:function(e,t,n){this.localStorage.setItem(e,(0,u.default)({version:t,value:n}))}},{key:\"get\",value:function(e){var t=this;try{return JSON.parse(t.localStorage.getItem(e)).value}catch(e){}}},{key:\"getVersion\",value:function(e){var t=this;try{return JSON.parse(t.localStorage.getItem(e)).version}catch(e){}}},{key:\"delete\",value:function(e){this.localStorage.removeItem(e)}}]),e}();t.default=l,e.exports=t.default},24:function(e,t){e.exports=function(e){if(\"function\"!=typeof e)throw TypeError(e+\" is not a function!\");return e}},27:function(e,t,n){var r=n(7);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&\"function\"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if(\"function\"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&\"function\"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError(\"Can't convert object to primitive value\")}},28:function(e,t,n){var r=n(7),o=n(1).document,u=r(o)&&r(o.createElement);e.exports=function(e){return u?o.createElement(e):{}}},3:function(e,t,n){\"use strict\";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}},39:function(e,t,n){e.exports=!n(4)&&!n(13)(function(){return 7!=Object.defineProperty(n(28)(\"div\"),\"a\",{get:function(){return 7}}).a})},4:function(e,t,n){e.exports=!n(13)(function(){return 7!=Object.defineProperty({},\"a\",{get:function(){return 7}}).a})},5:function(e,t,n){\"use strict\";t.__esModule=!0;var r=n(59),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),(0,o.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},58:function(e,t,n){e.exports={default:n(76),__esModule:!0}},59:function(e,t,n){e.exports={default:n(61),__esModule:!0}},6:function(e,t,n){var r=n(1),o=n(0),u=n(14),i=n(11),f=n(10),c=function(e,t,n){var a,l,s,p=e&c.F,d=e&c.G,y=e&c.S,v=e&c.P,h=e&c.B,g=e&c.W,x=d?o:o[t]||(o[t]={}),_=x.prototype,b=d?r:y?r[t]:(r[t]||{}).prototype;d&&(n=t);for(a in n)(l=!p&&b&&void 0!==b[a])&&f(x,a)||(s=l?b[a]:n[a],x[a]=d&&\"function\"!=typeof b[a]?n[a]:h&&l?u(s,r):g&&b[a]==s?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(s):v&&\"function\"==typeof s?u(Function.call,s):s,v&&((x.virtual||(x.virtual={}))[a]=s,e&c.R&&_&&!_[a]&&i(_,a,s)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},61:function(e,t,n){n(62);var r=n(0).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},62:function(e,t,n){var r=n(6);r(r.S+r.F*!n(4),\"Object\",{defineProperty:n(8).f})},7:function(e,t){e.exports=function(e){return\"object\"==typeof e?null!==e:\"function\"==typeof e}},76:function(e,t,n){var r=n(0),o=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},8:function(e,t,n){var r=n(9),o=n(39),u=n(27),i=Object.defineProperty;t.f=n(4)?Object.defineProperty:function(e,t,n){if(r(e),t=u(t,!0),r(n),o)try{return i(e,t,n)}catch(e){}if(\"get\"in n||\"set\"in n)throw TypeError(\"Accessors not supported!\");return\"value\"in n&&(e[t]=n.value),e}},9:function(e,t,n){var r=n(7);e.exports=function(e){if(!r(e))throw TypeError(e+\" is not an object!\");return e}}})});","// version: 0.9.0\n// date: Wed Aug 01 2018 09:34:34 GMT+0100 (Western European Summer Time)\n// licence: \n/**\n* Copyright 2016 PT Inovao e Sistemas SA\n* Copyright 2016 INESC-ID\n* Copyright 2016 QUOBIS NETWORKS SL\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n* Copyright 2016 ORANGE SA\n* Copyright 2016 Deutsche Telekom AG\n* Copyright 2016 Apizee\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n**/\n\n\n!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(\"RuntimeCatalogue\",[],e):\"object\"==typeof exports?exports.RuntimeCatalogue=e():(t[\"\"]=t[\"\"]||{},t[\"\"].RuntimeCatalogue=e())}(\"undefined\"!=typeof self?self:this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,\"a\",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=185)}([function(t,e){var r=t.exports={version:\"2.5.7\"};\"number\"==typeof __e&&(__e=r)},function(t,e){var r=t.exports=\"undefined\"!=typeof window&&window.Math==Math?window:\"undefined\"!=typeof self&&self.Math==Math?self:Function(\"return this\")();\"number\"==typeof __g&&(__g=r)},function(t,e,r){var n=r(36)(\"wks\"),i=r(23),o=r(1).Symbol,a=\"function\"==typeof o;(t.exports=function(t){return n[t]||(n[t]=a&&o[t]||(a?o:i)(\"Symbol.\"+t))}).store=n},function(t,e,r){\"use strict\";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}},function(t,e,r){t.exports=!r(13)(function(){return 7!=Object.defineProperty({},\"a\",{get:function(){return 7}}).a})},function(t,e,r){\"use strict\";e.__esModule=!0;var n=r(59),i=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),(0,i.default)(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}()},function(t,e,r){var n=r(1),i=r(0),o=r(14),a=r(11),u=r(10),s=function(t,e,r){var c,l,f,h=t&s.F,p=t&s.G,d=t&s.S,v=t&s.P,y=t&s.B,m=t&s.W,g=p?i:i[e]||(i[e]={}),_=g.prototype,O=p?n:d?n[e]:(n[e]||{}).prototype;p&&(r=e);for(c in r)(l=!h&&O&&void 0!==O[c])&&u(g,c)||(f=l?O[c]:r[c],g[c]=p&&\"function\"!=typeof O[c]?r[c]:y&&l?o(f,n):m&&O[c]==f?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(f):v&&\"function\"==typeof f?o(Function.call,f):f,v&&((g.virtual||(g.virtual={}))[c]=f,t&s.R&&_&&!_[c]&&a(_,c,f)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},function(t,e){t.exports=function(t){return\"object\"==typeof t?null!==t:\"function\"==typeof t}},function(t,e,r){var n=r(9),i=r(39),o=r(27),a=Object.defineProperty;e.f=r(4)?Object.defineProperty:function(t,e,r){if(n(t),e=o(e,!0),n(r),i)try{return a(t,e,r)}catch(t){}if(\"get\"in r||\"set\"in r)throw TypeError(\"Accessors not supported!\");return\"value\"in r&&(t[e]=r.value),t}},function(t,e,r){var n=r(7);t.exports=function(t){if(!n(t))throw TypeError(t+\" is not an object!\");return t}},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var n=r(8),i=r(16);t.exports=r(4)?function(t,e,r){return n.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e,r){var n=r(55),i=r(30);t.exports=function(t){return n(i(t))}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,r){var n=r(24);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=!0},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){t.exports={}},function(t,e,r){t.exports={default:r(102),__esModule:!0}},,function(t,e,r){var n=r(45),i=r(37);t.exports=Object.keys||function(t){return n(t,i)}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e,r){var n,i;!function(o,a){\"use strict\";n=a,void 0!==(i=\"function\"==typeof n?n.call(e,r,e,t):n)&&(t.exports=i)}(0,function(){\"use strict\";function t(t,e){var r=t[e];if(\"function\"==typeof r.bind)return r.bind(t);try{return Function.prototype.bind.call(r,t)}catch(e){return function(){return Function.prototype.apply.apply(r,[t,arguments])}}}function e(e){return\"debug\"===e&&(e=\"log\"),typeof console!==u&&(void 0!==console[e]?t(console,e):void 0!==console.log?t(console,\"log\"):a)}function r(t,e){for(var r=0;r<s.length;r++){var n=s[r];this[n]=r<t?a:this.methodFactory(n,t,e)}this.log=this.debug}function n(t,e,n){return function(){typeof console!==u&&(r.call(this,e,n),this[t].apply(this,arguments))}}function i(t,r,i){return e(t)||n.apply(this,arguments)}function o(t,e,n){function o(t){var e=(s[t]||\"silent\").toUpperCase();if(typeof window!==u){try{return void(window.localStorage[f]=e)}catch(t){}try{window.document.cookie=encodeURIComponent(f)+\"=\"+e+\";\"}catch(t){}}}function a(){var t;if(typeof window!==u){try{t=window.localStorage[f]}catch(t){}if(typeof t===u)try{var e=window.document.cookie,r=e.indexOf(encodeURIComponent(f)+\"=\");-1!==r&&(t=/^([^;]+)/.exec(e.slice(r))[1])}catch(t){}return void 0===l.levels[t]&&(t=void 0),t}}var c,l=this,f=\"loglevel\";t&&(f+=\":\"+t),l.name=t,l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=n||i,l.getLevel=function(){return c},l.setLevel=function(e,n){if(\"string\"==typeof e&&void 0!==l.levels[e.toUpperCase()]&&(e=l.levels[e.toUpperCase()]),!(\"number\"==typeof e&&e>=0&&e<=l.levels.SILENT))throw\"log.setLevel() called with invalid level: \"+e;if(c=e,!1!==n&&o(e),r.call(l,e,t),typeof console===u&&e<l.levels.SILENT)return\"No console available for logging\"},l.setDefaultLevel=function(t){a()||l.setLevel(t,!1)},l.enableAll=function(t){l.setLevel(l.levels.TRACE,t)},l.disableAll=function(t){l.setLevel(l.levels.SILENT,t)};var h=a();null==h&&(h=null==e?\"WARN\":e),l.setLevel(h,!1)}var a=function(){},u=\"undefined\",s=[\"trace\",\"debug\",\"info\",\"warn\",\"error\"],c=new o,l={};c.getLogger=function(t){if(\"string\"!=typeof t||\"\"===t)throw new TypeError(\"You must supply a name when creating a logger.\");var e=l[t];return e||(e=l[t]=new o(t,c.getLevel(),c.methodFactory)),e};var f=typeof window!==u?window.log:void 0;return c.noConflict=function(){return typeof window!==u&&window.log===c&&(window.log=f),c},c.getLoggers=function(){return l},c})},function(t,e){var r=0,n=Math.random();t.exports=function(t){return\"Symbol(\".concat(void 0===t?\"\":t,\")_\",(++r+n).toString(36))}},function(t,e){t.exports=function(t){if(\"function\"!=typeof t)throw TypeError(t+\" is not a function!\");return t}},function(t,e,r){t.exports={default:r(91),__esModule:!0}},function(t,e,r){var n=r(8).f,i=r(10),o=r(2)(\"toStringTag\");t.exports=function(t,e,r){t&&!i(t=r?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},function(t,e,r){var n=r(7);t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&\"function\"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if(\"function\"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&\"function\"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError(\"Can't convert object to primitive value\")}},function(t,e,r){var n=r(7),i=r(1).document,o=n(i)&&n(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError(\"Can't call method on  \"+t);return t}},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},function(t,e,r){var n=r(30);t.exports=function(t){return Object(n(t))}},function(t,e,r){\"use strict\";e.__esModule=!0;var n=r(47),i=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default=function(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!==(void 0===e?\"undefined\":(0,i.default)(e))&&\"function\"!=typeof e?t:e}},function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(93),o=n(i),a=r(97),u=n(a),s=r(47),c=n(s);e.default=function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+(void 0===e?\"undefined\":(0,c.default)(e)));t.prototype=(0,u.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(o.default?(0,o.default)(t,e):t.__proto__=e)}},function(t,e,r){var n=r(36)(\"keys\"),i=r(23);t.exports=function(t){return n[t]||(n[t]=i(t))}},function(t,e,r){var n=r(0),i=r(1),o=i[\"__core-js_shared__\"]||(i[\"__core-js_shared__\"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})(\"versions\",[]).push({version:n.version,mode:r(15)?\"pure\":\"global\",copyright:\" 2018 Denis Pushkarev (zloirock.ru)\"})},function(t,e){t.exports=\"constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf\".split(\",\")},function(t,e,r){var n=r(9),i=r(72),o=r(37),a=r(35)(\"IE_PROTO\"),u=function(){},s=function(){var t,e=r(28)(\"iframe\"),n=o.length;for(e.style.display=\"none\",r(56).appendChild(e),e.src=\"javascript:\",t=e.contentWindow.document,t.open(),t.write(\"<script>document.F=Object<\\/script>\"),t.close(),s=t.F;n--;)delete s.prototype[o[n]];return s()};t.exports=Object.create||function(t,e){var r;return null!==t?(u.prototype=n(t),r=new u,u.prototype=null,r[a]=t):r=s(),void 0===e?r:i(r,e)}},function(t,e,r){t.exports=!r(4)&&!r(13)(function(){return 7!=Object.defineProperty(r(28)(\"div\"),\"a\",{get:function(){return 7}}).a})},function(t,e,r){e.f=r(2)},function(t,e,r){var n=r(1),i=r(0),o=r(15),a=r(40),u=r(8).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});\"_\"==t.charAt(0)||t in e||u(e,t,{value:a.f(t)})}},,function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,r){var n=r(6),i=r(0),o=r(13);t.exports=function(t,e){var r=(i.Object||{})[t]||Object[t],a={};a[t]=e(r),n(n.S+n.F*o(function(){r(1)}),\"Object\",a)}},function(t,e,r){var n=r(10),i=r(12),o=r(64)(!1),a=r(35)(\"IE_PROTO\");t.exports=function(t,e){var r,u=i(t),s=0,c=[];for(r in u)r!=a&&n(u,r)&&c.push(r);for(;e.length>s;)n(u,r=e[s++])&&(~o(c,r)||c.push(r));return c}},function(t,e,r){var n=r(29),i=r(16),o=r(12),a=r(27),u=r(10),s=r(39),c=Object.getOwnPropertyDescriptor;e.f=r(4)?c:function(t,e){if(t=o(t),e=a(e,!0),s)try{return c(t,e)}catch(t){}if(u(t,e))return i(!n.f.call(t,e),t[e])}},function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(79),o=n(i),a=r(81),u=n(a),s=\"function\"==typeof u.default&&\"symbol\"==typeof o.default?function(t){return typeof t}:function(t){return t&&\"function\"==typeof u.default&&t.constructor===u.default&&t!==u.default.prototype?\"symbol\":typeof t};e.default=\"function\"==typeof u.default&&\"symbol\"===s(o.default)?function(t){return void 0===t?\"undefined\":s(t)}:function(t){return t&&\"function\"==typeof u.default&&t.constructor===u.default&&t!==u.default.prototype?\"symbol\":void 0===t?\"undefined\":s(t)}},function(t,e,r){\"use strict\";var n=r(15),i=r(6),o=r(50),a=r(11),u=r(17),s=r(71),c=r(26),l=r(53),f=r(2)(\"iterator\"),h=!([].keys&&\"next\"in[].keys()),p=function(){return this};t.exports=function(t,e,r,d,v,y,m){s(r,e,d);var g,_,O,b=function(t){if(!h&&t in w)return w[t];switch(t){case\"keys\":case\"values\":return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=e+\" Iterator\",P=\"values\"==v,S=!1,w=t.prototype,R=w[f]||w[\"@@iterator\"]||v&&w[v],T=R||b(v),k=v?P?b(\"entries\"):T:void 0,M=\"Array\"==e?w.entries||R:R;if(M&&(O=l(M.call(new t)))!==Object.prototype&&O.next&&(c(O,E,!0),n||\"function\"==typeof O[f]||a(O,f,p)),P&&R&&\"values\"!==R.name&&(S=!0,T=function(){return R.call(this)}),n&&!m||!h&&!S&&w[f]||a(w,f,T),u[e]=T,u[E]=p,v)if(g={values:P?T:b(\"values\"),keys:y?T:b(\"keys\"),entries:k},m)for(_ in g)_ in w||o(w,_,g[_]);else i(i.P+i.F*(h||S),e,g);return g}},function(t,e,r){var n=r(31),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},function(t,e,r){t.exports=r(11)},function(t,e,r){\"use strict\";function n(t){var e,r;this.promise=new t(function(t,n){if(void 0!==e||void 0!==r)throw TypeError(\"Bad Promise constructor\");e=t,r=n}),this.resolve=i(e),this.reject=i(r)}var i=r(24);t.exports.f=function(t){return new n(t)}},function(t,e,r){\"use strict\";var n=r(70)(!0);r(48)(String,\"String\",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})})},function(t,e,r){var n=r(10),i=r(32),o=r(35)(\"IE_PROTO\"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),n(t,o)?t[o]:\"function\"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,r){r(73);for(var n=r(1),i=r(11),o=r(17),a=r(2)(\"toStringTag\"),u=\"CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList\".split(\",\"),s=0;s<u.length;s++){var c=u[s],l=n[c],f=l&&l.prototype;f&&!f[a]&&i(f,a,c),o[c]=o.Array}},function(t,e,r){var n=r(21);t.exports=Object(\"z\").propertyIsEnumerable(0)?Object:function(t){return\"String\"==n(t)?t.split(\"\"):Object(t)}},function(t,e,r){var n=r(1).document;t.exports=n&&n.documentElement},function(t,e,r){var n=r(45),i=r(37).concat(\"length\",\"prototype\");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},function(t,e,r){t.exports={default:r(76),__esModule:!0}},function(t,e,r){t.exports={default:r(61),__esModule:!0}},function(t,e){},function(t,e,r){r(62);var n=r(0).Object;t.exports=function(t,e,r){return n.defineProperty(t,e,r)}},function(t,e,r){var n=r(6);n(n.S+n.F*!r(4),\"Object\",{defineProperty:r(8).f})},function(t,e,r){var n=r(21),i=r(2)(\"toStringTag\"),o=\"Arguments\"==n(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,r,u;return void 0===t?\"Undefined\":null===t?\"Null\":\"string\"==typeof(r=a(e=Object(t),i))?r:o?n(e):\"Object\"==(u=n(e))&&\"function\"==typeof e.callee?\"Arguments\":u}},function(t,e,r){var n=r(12),i=r(49),o=r(65);t.exports=function(t){return function(e,r,a){var u,s=n(e),c=i(s.length),l=o(a,c);if(t&&r!=r){for(;c>l;)if((u=s[l++])!=u)return!0}else for(;c>l;l++)if((t||l in s)&&s[l]===r)return t||l||0;return!t&&-1}}},function(t,e,r){var n=r(31),i=Math.max,o=Math.min;t.exports=function(t,e){return t=n(t),t<0?i(t+e,0):o(t,e)}},function(t,e,r){var n=r(9),i=r(24),o=r(2)(\"species\");t.exports=function(t,e){var r,a=n(t).constructor;return void 0===a||void 0==(r=n(a)[o])?e:i(r)}},function(t,e,r){var n,i,o,a=r(14),u=r(108),s=r(56),c=r(28),l=r(1),f=l.process,h=l.setImmediate,p=l.clearImmediate,d=l.MessageChannel,v=l.Dispatch,y=0,m={},g=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},_=function(t){g.call(t.data)};h&&p||(h=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return m[++y]=function(){u(\"function\"==typeof t?t:Function(t),e)},n(y),y},p=function(t){delete m[t]},\"process\"==r(21)(f)?n=function(t){f.nextTick(a(g,t,1))}:v&&v.now?n=function(t){v.now(a(g,t,1))}:d?(i=new d,o=i.port2,i.port1.onmessage=_,n=a(o.postMessage,o,1)):l.addEventListener&&\"function\"==typeof postMessage&&!l.importScripts?(n=function(t){l.postMessage(t+\"\",\"*\")},l.addEventListener(\"message\",_,!1)):n=\"onreadystatechange\"in c(\"script\")?function(t){s.appendChild(c(\"script\")).onreadystatechange=function(){s.removeChild(this),g.call(t)}}:function(t){setTimeout(a(g,t,1),0)}),t.exports={set:h,clear:p}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,r){var n=r(9),i=r(7),o=r(51);t.exports=function(t,e){if(n(t),i(e)&&e.constructor===t)return e;var r=o.f(t);return(0,r.resolve)(e),r.promise}},function(t,e,r){var n=r(31),i=r(30);t.exports=function(t){return function(e,r){var o,a,u=String(i(e)),s=n(r),c=u.length;return s<0||s>=c?t?\"\":void 0:(o=u.charCodeAt(s),o<55296||o>56319||s+1===c||(a=u.charCodeAt(s+1))<56320||a>57343?t?u.charAt(s):o:t?u.slice(s,s+2):a-56320+(o-55296<<10)+65536)}}},function(t,e,r){\"use strict\";var n=r(38),i=r(16),o=r(26),a={};r(11)(a,r(2)(\"iterator\"),function(){return this}),t.exports=function(t,e,r){t.prototype=n(a,{next:i(1,r)}),o(t,e+\" Iterator\")}},function(t,e,r){var n=r(8),i=r(9),o=r(20);t.exports=r(4)?Object.defineProperties:function(t,e){i(t);for(var r,a=o(e),u=a.length,s=0;u>s;)n.f(t,r=a[s++],e[r]);return t}},function(t,e,r){\"use strict\";var n=r(74),i=r(75),o=r(17),a=r(12);t.exports=r(48)(Array,\"Array\",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):\"keys\"==e?i(0,r):\"values\"==e?i(0,t[r]):i(0,[r,t[r]])},\"values\"),o.Arguments=o.Array,n(\"keys\"),n(\"values\"),n(\"entries\")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,r){var n=r(0),i=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},function(t,e,r){var n=r(23)(\"meta\"),i=r(7),o=r(10),a=r(8).f,u=0,s=Object.isExtensible||function(){return!0},c=!r(13)(function(){return s(Object.preventExtensions({}))}),l=function(t){a(t,n,{value:{i:\"O\"+ ++u,w:{}}})},f=function(t,e){if(!i(t))return\"symbol\"==typeof t?t:(\"string\"==typeof t?\"S\":\"P\")+t;if(!o(t,n)){if(!s(t))return\"F\";if(!e)return\"E\";l(t)}return t[n].i},h=function(t,e){if(!o(t,n)){if(!s(t))return!0;if(!e)return!1;l(t)}return t[n].w},p=function(t){return c&&d.NEED&&s(t)&&!o(t,n)&&l(t),t},d=t.exports={KEY:n,NEED:!1,fastKey:f,getWeak:h,onFreeze:p}},,function(t,e,r){t.exports={default:r(80),__esModule:!0}},function(t,e,r){r(52),r(54),t.exports=r(40).f(\"iterator\")},function(t,e,r){t.exports={default:r(82),__esModule:!0}},function(t,e,r){r(83),r(60),r(87),r(88),t.exports=r(0).Symbol},function(t,e,r){\"use strict\";var n=r(1),i=r(10),o=r(4),a=r(6),u=r(50),s=r(77).KEY,c=r(13),l=r(36),f=r(26),h=r(23),p=r(2),d=r(40),v=r(41),y=r(84),m=r(85),g=r(9),_=r(7),O=r(12),b=r(27),E=r(16),P=r(38),S=r(86),w=r(46),R=r(8),T=r(20),k=w.f,M=R.f,x=S.f,C=n.Symbol,j=n.JSON,A=j&&j.stringify,N=p(\"_hidden\"),I=p(\"toPrimitive\"),U={}.propertyIsEnumerable,L=l(\"symbol-registry\"),D=l(\"symbols\"),F=l(\"op-symbols\"),H=Object.prototype,Y=\"function\"==typeof C,B=n.QObject,K=!B||!B.prototype||!B.prototype.findChild,G=o&&c(function(){return 7!=P(M({},\"a\",{get:function(){return M(this,\"a\",{value:7}).a}})).a})?function(t,e,r){var n=k(H,e);n&&delete H[e],M(t,e,r),n&&t!==H&&M(H,e,n)}:M,J=function(t){var e=D[t]=P(C.prototype);return e._k=t,e},W=Y&&\"symbol\"==typeof C.iterator?function(t){return\"symbol\"==typeof t}:function(t){return t instanceof C},V=function(t,e,r){return t===H&&V(F,e,r),g(t),e=b(e,!0),g(r),i(D,e)?(r.enumerable?(i(t,N)&&t[N][e]&&(t[N][e]=!1),r=P(r,{enumerable:E(0,!1)})):(i(t,N)||M(t,N,E(1,{})),t[N][e]=!0),G(t,e,r)):M(t,e,r)},q=function(t,e){g(t);for(var r,n=y(e=O(e)),i=0,o=n.length;o>i;)V(t,r=n[i++],e[r]);return t},z=function(t,e){return void 0===e?P(t):q(P(t),e)},X=function(t){var e=U.call(this,t=b(t,!0));return!(this===H&&i(D,t)&&!i(F,t))&&(!(e||!i(this,t)||!i(D,t)||i(this,N)&&this[N][t])||e)},$=function(t,e){if(t=O(t),e=b(e,!0),t!==H||!i(D,e)||i(F,e)){var r=k(t,e);return!r||!i(D,e)||i(t,N)&&t[N][e]||(r.enumerable=!0),r}},Q=function(t){for(var e,r=x(O(t)),n=[],o=0;r.length>o;)i(D,e=r[o++])||e==N||e==s||n.push(e);return n},Z=function(t){for(var e,r=t===H,n=x(r?F:O(t)),o=[],a=0;n.length>a;)!i(D,e=n[a++])||r&&!i(H,e)||o.push(D[e]);return o};Y||(C=function(){if(this instanceof C)throw TypeError(\"Symbol is not a constructor!\");var t=h(arguments.length>0?arguments[0]:void 0),e=function(r){this===H&&e.call(F,r),i(this,N)&&i(this[N],t)&&(this[N][t]=!1),G(this,t,E(1,r))};return o&&K&&G(H,t,{configurable:!0,set:e}),J(t)},u(C.prototype,\"toString\",function(){return this._k}),w.f=$,R.f=V,r(57).f=S.f=Q,r(29).f=X,r(43).f=Z,o&&!r(15)&&u(H,\"propertyIsEnumerable\",X,!0),d.f=function(t){return J(p(t))}),a(a.G+a.W+a.F*!Y,{Symbol:C});for(var tt=\"hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables\".split(\",\"),et=0;tt.length>et;)p(tt[et++]);for(var rt=T(p.store),nt=0;rt.length>nt;)v(rt[nt++]);a(a.S+a.F*!Y,\"Symbol\",{for:function(t){return i(L,t+=\"\")?L[t]:L[t]=C(t)},keyFor:function(t){if(!W(t))throw TypeError(t+\" is not a symbol!\");for(var e in L)if(L[e]===t)return e},useSetter:function(){K=!0},useSimple:function(){K=!1}}),a(a.S+a.F*!Y,\"Object\",{create:z,defineProperty:V,defineProperties:q,getOwnPropertyDescriptor:$,getOwnPropertyNames:Q,getOwnPropertySymbols:Z}),j&&a(a.S+a.F*(!Y||c(function(){var t=C();return\"[null]\"!=A([t])||\"{}\"!=A({a:t})||\"{}\"!=A(Object(t))})),\"JSON\",{stringify:function(t){for(var e,r,n=[t],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=e=n[1],(_(e)||void 0!==t)&&!W(t))return m(e)||(e=function(t,e){if(\"function\"==typeof r&&(e=r.call(this,t,e)),!W(e))return e}),n[1]=e,A.apply(j,n)}}),C.prototype[I]||r(11)(C.prototype,I,C.prototype.valueOf),f(C,\"Symbol\"),f(Math,\"Math\",!0),f(n.JSON,\"JSON\",!0)},function(t,e,r){var n=r(20),i=r(43),o=r(29);t.exports=function(t){var e=n(t),r=i.f;if(r)for(var a,u=r(t),s=o.f,c=0;u.length>c;)s.call(t,a=u[c++])&&e.push(a);return e}},function(t,e,r){var n=r(21);t.exports=Array.isArray||function(t){return\"Array\"==n(t)}},function(t,e,r){var n=r(12),i=r(57).f,o={}.toString,a=\"object\"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],u=function(t){try{return i(t)}catch(t){return a.slice()}};t.exports.f=function(t){return a&&\"[object Window]\"==o.call(t)?u(t):i(n(t))}},function(t,e,r){r(41)(\"asyncIterator\")},function(t,e,r){r(41)(\"observable\")},,,function(t,e,r){r(92),t.exports=r(0).Object.getPrototypeOf},function(t,e,r){var n=r(32),i=r(53);r(44)(\"getPrototypeOf\",function(){return function(t){return i(n(t))}})},function(t,e,r){t.exports={default:r(94),__esModule:!0}},function(t,e,r){r(95),t.exports=r(0).Object.setPrototypeOf},function(t,e,r){var n=r(6);n(n.S,\"Object\",{setPrototypeOf:r(96).set})},function(t,e,r){var n=r(7),i=r(9),o=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+\": can't set as prototype!\")};t.exports={set:Object.setPrototypeOf||(\"__proto__\"in{}?function(t,e,n){try{n=r(14)(Function.call,r(46).f(Object.prototype,\"__proto__\").set,2),n(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,r){return o(t,r),e?t.__proto__=r:n(t,r),t}}({},!1):void 0),check:o}},function(t,e,r){t.exports={default:r(98),__esModule:!0}},function(t,e,r){r(99);var n=r(0).Object;t.exports=function(t,e){return n.create(t,e)}},function(t,e,r){var n=r(6);n(n.S,\"Object\",{create:r(38)})},,function(t,e,r){var n=r(63),i=r(2)(\"iterator\"),o=r(17);t.exports=r(0).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t[\"@@iterator\"]||o[n(t)]}},function(t,e,r){r(60),r(52),r(54),r(103),r(114),r(115),t.exports=r(0).Promise},function(t,e,r){\"use strict\";var n,i,o,a,u=r(15),s=r(1),c=r(14),l=r(63),f=r(6),h=r(7),p=r(24),d=r(104),v=r(105),y=r(66),m=r(67).set,g=r(109)(),_=r(51),O=r(68),b=r(110),E=r(69),P=s.TypeError,S=s.process,w=S&&S.versions,R=w&&w.v8||\"\",T=s.Promise,k=\"process\"==l(S),M=function(){},x=i=_.f,C=!!function(){try{var t=T.resolve(1),e=(t.constructor={})[r(2)(\"species\")]=function(t){t(M,M)};return(k||\"function\"==typeof PromiseRejectionEvent)&&t.then(M)instanceof e&&0!==R.indexOf(\"6.6\")&&-1===b.indexOf(\"Chrome/66\")}catch(t){}}(),j=function(t){var e;return!(!h(t)||\"function\"!=typeof(e=t.then))&&e},A=function(t,e){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var n=t._v,i=1==t._s,o=0;r.length>o;)!function(e){var r,o,a,u=i?e.ok:e.fail,s=e.resolve,c=e.reject,l=e.domain;try{u?(i||(2==t._h&&U(t),t._h=1),!0===u?r=n:(l&&l.enter(),r=u(n),l&&(l.exit(),a=!0)),r===e.promise?c(P(\"Promise-chain cycle\")):(o=j(r))?o.call(r,s,c):s(r)):c(n)}catch(t){l&&!a&&l.exit(),c(t)}}(r[o++]);t._c=[],t._n=!1,e&&!t._h&&N(t)})}},N=function(t){m.call(s,function(){var e,r,n,i=t._v,o=I(t);if(o&&(e=O(function(){k?S.emit(\"unhandledRejection\",i,t):(r=s.onunhandledrejection)?r({promise:t,reason:i}):(n=s.console)&&n.error&&n.error(\"Unhandled promise rejection\",i)}),t._h=k||I(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},I=function(t){return 1!==t._h&&0===(t._a||t._c).length},U=function(t){m.call(s,function(){var e;k?S.emit(\"rejectionHandled\",t):(e=s.onrejectionhandled)&&e({promise:t,reason:t._v})})},L=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),A(e,!0))},D=function(t){var e,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw P(\"Promise can't be resolved itself\");(e=j(t))?g(function(){var n={_w:r,_d:!1};try{e.call(t,c(D,n,1),c(L,n,1))}catch(t){L.call(n,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){L.call({_w:r,_d:!1},t)}}};C||(T=function(t){d(this,T,\"Promise\",\"_h\"),p(t),n.call(this);try{t(c(D,this,1),c(L,this,1))}catch(t){L.call(this,t)}},n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},n.prototype=r(111)(T.prototype,{then:function(t,e){var r=x(y(this,T));return r.ok=\"function\"!=typeof t||t,r.fail=\"function\"==typeof e&&e,r.domain=k?S.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new n;this.promise=t,this.resolve=c(D,t,1),this.reject=c(L,t,1)},_.f=x=function(t){return t===T||t===a?new o(t):i(t)}),f(f.G+f.W+f.F*!C,{Promise:T}),r(26)(T,\"Promise\"),r(112)(\"Promise\"),a=r(0).Promise,f(f.S+f.F*!C,\"Promise\",{reject:function(t){var e=x(this);return(0,e.reject)(t),e.promise}}),f(f.S+f.F*(u||!C),\"Promise\",{resolve:function(t){return E(u&&this===a?T:this,t)}}),f(f.S+f.F*!(C&&r(113)(function(t){T.all(t).catch(M)})),\"Promise\",{all:function(t){var e=this,r=x(e),n=r.resolve,i=r.reject,o=O(function(){var r=[],o=0,a=1;v(t,!1,function(t){var u=o++,s=!1;r.push(void 0),a++,e.resolve(t).then(function(t){s||(s=!0,r[u]=t,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(t){var e=this,r=x(e),n=r.reject,i=O(function(){v(t,!1,function(t){e.resolve(t).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}})},function(t,e){t.exports=function(t,e,r,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(r+\": incorrect invocation!\");return t}},function(t,e,r){var n=r(14),i=r(106),o=r(107),a=r(9),u=r(49),s=r(101),c={},l={},e=t.exports=function(t,e,r,f,h){var p,d,v,y,m=h?function(){return t}:s(t),g=n(r,f,e?2:1),_=0;if(\"function\"!=typeof m)throw TypeError(t+\" is not iterable!\");if(o(m)){for(p=u(t.length);p>_;_++)if((y=e?g(a(d=t[_])[0],d[1]):g(t[_]))===c||y===l)return y}else for(v=m.call(t);!(d=v.next()).done;)if((y=i(v,g,d.value,e))===c||y===l)return y};e.BREAK=c,e.RETURN=l},function(t,e,r){var n=r(9);t.exports=function(t,e,r,i){try{return i?e(n(r)[0],r[1]):e(r)}catch(e){var o=t.return;throw void 0!==o&&n(o.call(t)),e}}},function(t,e,r){var n=r(17),i=r(2)(\"iterator\"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||o[i]===t)}},function(t,e){t.exports=function(t,e,r){var n=void 0===r;switch(e.length){case 0:return n?t():t.call(r);case 1:return n?t(e[0]):t.call(r,e[0]);case 2:return n?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)}},function(t,e,r){var n=r(1),i=r(67).set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,u=n.Promise,s=\"process\"==r(21)(a);t.exports=function(){var t,e,r,c=function(){var n,i;for(s&&(n=a.domain)&&n.exit();t;){i=t.fn,t=t.next;try{i()}catch(n){throw t?r():e=void 0,n}}e=void 0,n&&n.enter()};if(s)r=function(){a.nextTick(c)};else if(!o||n.navigator&&n.navigator.standalone)if(u&&u.resolve){var l=u.resolve(void 0);r=function(){l.then(c)}}else r=function(){i.call(n,c)};else{var f=!0,h=document.createTextNode(\"\");new o(c).observe(h,{characterData:!0}),r=function(){h.data=f=!f}}return function(n){var i={fn:n,next:void 0};e&&(e.next=i),t||(t=i,r()),e=i}}},function(t,e,r){var n=r(1),i=n.navigator;t.exports=i&&i.userAgent||\"\"},function(t,e,r){var n=r(11);t.exports=function(t,e,r){for(var i in e)r&&t[i]?t[i]=e[i]:n(t,i,e[i]);return t}},function(t,e,r){\"use strict\";var n=r(1),i=r(0),o=r(8),a=r(4),u=r(2)(\"species\");t.exports=function(t){var e=\"function\"==typeof i[t]?i[t]:n[t];a&&e&&!e[u]&&o.f(e,u,{configurable:!0,get:function(){return this}})}},function(t,e,r){var n=r(2)(\"iterator\"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},t(o)}catch(t){}return r}},function(t,e,r){\"use strict\";var n=r(6),i=r(0),o=r(1),a=r(66),u=r(69);n(n.P+n.R,\"Promise\",{finally:function(t){var e=a(this,i.Promise||o.Promise),r=\"function\"==typeof t;return this.then(r?function(r){return u(e,t()).then(function(){return r})}:t,r?function(r){return u(e,t()).then(function(){throw r})}:t)}})},function(t,e,r){\"use strict\";var n=r(6),i=r(51),o=r(68);n(n.S,\"Promise\",{try:function(t){var e=i.f(this),r=o(t);return(r.e?e.reject:e.resolve)(r.v),e.promise}})},function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0}),e.DataObjectSourceLanguage=e.CatalogueObjectType=void 0;var i=r(25),o=n(i),a=r(3),u=n(a),s=r(5),c=n(s),l=r(33),f=n(l),h=r(34),p=n(h),d=r(136),v=n(d),y=function(t){function e(t,r,n,i,a,s,c){(0,u.default)(this,e);var l=(0,f.default)(this,(e.__proto__||(0,o.default)(e)).call(this));return l._guid=t,l._type=r,l._version=n,l._objectName=i,l._description=a,l._language=s,l._sourcePackageURL=c,l._signature=null,l._sourcePackage=null,l}return(0,p.default)(e,t),(0,c.default)(e,[{key:\"guid\",get:function(){return this._guid},set:function(t){t&&(this._guid=t)}},{key:\"type\",get:function(){return this._type},set:function(t){t&&(this._type=t)}},{key:\"version\",get:function(){return this._version},set:function(t){t&&(this._version=t)}},{key:\"objectName\",get:function(){return this._objectName},set:function(t){t&&(this._objectName=t)}},{key:\"description\",get:function(){return this._description},set:function(t){t&&(this._description=t)}},{key:\"language\",get:function(){return this._language},set:function(t){t&&(this._language=t)}},{key:\"signature\",get:function(){return this._signature},set:function(t){t&&(this._signature=t)}},{key:\"sourcePackage\",get:function(){return this._sourcePackage},set:function(t){t&&(this._sourcePackage=t)}},{key:\"sourcePackageURL\",get:function(){return this._sourcePackageURL},set:function(t){t&&(this._sourcePackageURL=t)}}]),e}(v.default);e.CatalogueObjectType={HYPERTY:\"hyperty\",PROTOSTUB:\"protostub\",HYPERTY_RUNTIME:\"hyperty_runtime\",HYPERTY_INTERCEPTOR:\"hyperty_inspector\",HYPERTY_DATA_OBJECT:\"hyperty_data_object\"},e.DataObjectSourceLanguage={JAVASCRIPT_ECMA6:\"javascript_ecma6\",JAVASCRIPT_ECMA5:\"javascript_ecma5\",JSON_SCHEMA_V4:\"json_schema_v4\",PYTHON:\"python\",TYPESCRIPT:\"typescript\"};e.default=y},,,,,,,,,,,,,,,,,,,,function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0}),e.RethinkObject=void 0;var i=r(58),o=n(i),a=r(3),u=n(a),s=r(5),c=n(s),l=r(137),f=n(l),h=e.RethinkObject=function(){function t(){(0,u.default)(this,t)}return(0,c.default)(t,[{key:\"validate\",value:function(t){f.default.addSchema(t.id,t);var e=f.default.validateMultiple(JSON.parse((0,o.default)(this)),t);return e.errors.forEach(function(t){delete t.stack}),(!e.valid||e.missing.length>0)&&(console.warn(\"Object validation \"+(e.valid?\"succeeded, but schema contained references:\":\"failed:\"),(0,o.default)(e,null,2)),console.log(\"Object:\",(0,o.default)(this,null,2))),e.valid}}]),t}();e.default=h},function(t,e,r){var n,i,o;!function(r,a){i=[],n=a,void 0!==(o=\"function\"==typeof n?n.apply(e,i):n)&&(t.exports=o)}(0,function(){function t(t){return encodeURI(t).replace(/%25[0-9][0-9]/g,function(t){return\"%\"+t.substring(3)})}function e(e){var r=\"\";h[e.charAt(0)]&&(r=e.charAt(0),e=e.substring(1));var n=\"\",i=\"\",o=!0,a=!1,u=!1;\"+\"===r?o=!1:\".\"===r?(i=\".\",n=\".\"):\"/\"===r?(i=\"/\",n=\"/\"):\"#\"===r?(i=\"#\",o=!1):\";\"===r?(i=\";\",n=\";\",a=!0,u=!0):\"?\"===r?(i=\"?\",n=\"&\",a=!0):\"&\"===r&&(i=\"&\",n=\"&\",a=!0);for(var s=[],c=e.split(\",\"),l=[],f={},d=0;d<c.length;d++){var v=c[d],y=null;if(-1!==v.indexOf(\":\")){var m=v.split(\":\");v=m[0],y=parseInt(m[1],10)}for(var g={};p[v.charAt(v.length-1)];)g[v.charAt(v.length-1)]=!0,v=v.substring(0,v.length-1);var _={truncate:y,name:v,suffices:g};l.push(_),f[v]=_,s.push(v)}var O=function(e){for(var r=\"\",s=0,c=0;c<l.length;c++){var f=l[c],h=e(f.name);if(null===h||void 0===h||Array.isArray(h)&&0===h.length||\"object\"==typeof h&&0===Object.keys(h).length)s++;else if(r+=c===s?i:n||\",\",Array.isArray(h)){a&&(r+=f.name+\"=\");for(var p=0;p<h.length;p++)p>0&&(r+=f.suffices[\"*\"]?n||\",\":\",\",f.suffices[\"*\"]&&a&&(r+=f.name+\"=\")),r+=o?encodeURIComponent(h[p]).replace(/!/g,\"%21\"):t(h[p])}else if(\"object\"==typeof h){a&&!f.suffices[\"*\"]&&(r+=f.name+\"=\");var d=!0;for(var v in h)d||(r+=f.suffices[\"*\"]?n||\",\":\",\"),d=!1,r+=o?encodeURIComponent(v).replace(/!/g,\"%21\"):t(v),r+=f.suffices[\"*\"]?\"=\":\",\",r+=o?encodeURIComponent(h[v]).replace(/!/g,\"%21\"):t(h[v])}else a&&(r+=f.name,u&&\"\"===h||(r+=\"=\")),null!=f.truncate&&(h=h.substring(0,f.truncate)),r+=o?encodeURIComponent(h).replace(/!/g,\"%21\"):t(h)}return r};return O.varNames=s,{prefix:i,substitution:O}}function r(t){if(!(this instanceof r))return new r(t);for(var n=t.split(\"{\"),i=[n.shift()],o=[],a=[],u=[];n.length>0;){var s=n.shift(),c=s.split(\"}\")[0],l=s.substring(c.length+1),f=e(c);a.push(f.substitution),o.push(f.prefix),i.push(l),u=u.concat(f.substitution.varNames)}this.fill=function(t){for(var e=i[0],r=0;r<a.length;r++){e+=(0,a[r])(t),e+=i[r+1]}return e},this.varNames=u,this.template=t}function n(t,e){if(t===e)return!0;if(t&&e&&\"object\"==typeof t&&\"object\"==typeof e){if(Array.isArray(t)!==Array.isArray(e))return!1;if(Array.isArray(t)){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!n(t[r],e[r]))return!1}else{var i;for(i in t)if(void 0===e[i]&&void 0!==t[i])return!1;for(i in e)if(void 0===t[i]&&void 0!==e[i])return!1;for(i in t)if(!n(t[i],e[i]))return!1}return!0}return!1}function i(t){var e=String(t).replace(/^\\s+|\\s+$/g,\"\").match(/^([^:\\/?#]+:)?(\\/\\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\\/?#]*)(?::(\\d*))?))?([^?#]*)(\\?[^#]*)?(#[\\s\\S]*)?/);return e?{href:e[0]||\"\",protocol:e[1]||\"\",authority:e[2]||\"\",host:e[3]||\"\",hostname:e[4]||\"\",port:e[5]||\"\",pathname:e[6]||\"\",search:e[7]||\"\",hash:e[8]||\"\"}:null}function o(t,e){return e=i(e||\"\"),t=i(t||\"\"),e&&t?(e.protocol||t.protocol)+(e.protocol||e.authority?e.authority:t.authority)+function(t){var e=[];return t.replace(/^(\\.\\.?(\\/|$))+/,\"\").replace(/\\/(\\.(\\/|$))+/g,\"/\").replace(/\\/\\.\\.$/,\"/../\").replace(/\\/?[^\\/]*/g,function(t){\"/..\"===t?e.pop():e.push(t)}),e.join(\"\").replace(/^\\//,\"/\"===t.charAt(0)?\"/\":\"\")}(e.protocol||e.authority||\"/\"===e.pathname.charAt(0)?e.pathname:e.pathname?(t.authority&&!t.pathname?\"/\":\"\")+t.pathname.slice(0,t.pathname.lastIndexOf(\"/\")+1)+e.pathname:t.pathname)+(e.protocol||e.authority||e.pathname?e.search:e.search||t.search)+e.hash:null}function a(t){return t.split(\"#\")[0]}function u(t,e){if(t&&\"object\"==typeof t)if(void 0===e?e=t.id:\"string\"==typeof t.id&&(e=o(e,t.id),t.id=e),Array.isArray(t))for(var r=0;r<t.length;r++)u(t[r],e);else{\"string\"==typeof t.$ref&&(t.$ref=o(e,t.$ref));for(var n in t)\"enum\"!==n&&u(t[n],e)}}function s(t){t=t||\"en\";var e=b[t];return function(t){var r=e[t.code]||O[t.code];if(\"string\"!=typeof r)return\"Unknown error code \"+t.code+\": \"+JSON.stringify(t.messageParams);var n=t.params;return r.replace(/\\{([^{}]*)\\}/g,function(t,e){var r=n[e];return\"string\"==typeof r||\"number\"==typeof r?r:t})}}function c(t,e,r,n,i){if(Error.call(this),void 0===t)throw new Error(\"No error code supplied: \"+n);this.message=\"\",this.params=e,this.code=t,this.dataPath=r||\"\",this.schemaPath=n||\"\",this.subErrors=i||null;var o=new Error(this.message);if(this.stack=o.stack||o.stacktrace,!this.stack)try{throw o}catch(o){this.stack=o.stack||o.stacktrace}}function l(t,e){if(e.substring(0,t.length)===t){var r=e.substring(t.length);if(e.length>0&&\"/\"===e.charAt(t.length-1)||\"#\"===r.charAt(0)||\"?\"===r.charAt(0))return!0}return!1}function f(t){var e,r,n=new d,i={setErrorReporter:function(t){return\"string\"==typeof t?this.language(t):(r=t,!0)},addFormat:function(){n.addFormat.apply(n,arguments)},language:function(t){return t?(b[t]||(t=t.split(\"-\")[0]),!!b[t]&&(e=t,t)):e},addLanguage:function(t,e){var r;for(r in m)e[r]&&!e[m[r]]&&(e[m[r]]=e[r]);var n=t.split(\"-\")[0];if(b[n]){b[t]=Object.create(b[n]);for(r in e)void 0===b[n][r]&&(b[n][r]=e[r]),b[t][r]=e[r]}else b[t]=e,b[n]=e;return this},freshApi:function(t){var e=f();return t&&e.language(t),e},validate:function(t,i,o,a){var u=s(e),c=r?function(t,e,n){return r(t,e,n)||u(t,e,n)}:u,l=new d(n,!1,c,o,a);\"string\"==typeof i&&(i={$ref:i}),l.addSchema(\"\",i);var f=l.validateAll(t,i,null,null,\"\");return!f&&a&&(f=l.banUnknownProperties(t,i)),this.error=f,this.missing=l.missing,this.valid=null===f,this.valid},validateResult:function(){var t={toString:function(){return this.valid?\"valid\":this.error.message}};return this.validate.apply(t,arguments),t},validateMultiple:function(t,i,o,a){var u=s(e),c=r?function(t,e,n){return r(t,e,n)||u(t,e,n)}:u,l=new d(n,!0,c,o,a);\"string\"==typeof i&&(i={$ref:i}),l.addSchema(\"\",i),l.validateAll(t,i,null,null,\"\"),a&&l.banUnknownProperties(t,i);var f={toString:function(){return this.valid?\"valid\":this.error.message}};return f.errors=l.errors,f.missing=l.missing,f.valid=0===f.errors.length,f},addSchema:function(){return n.addSchema.apply(n,arguments)},getSchema:function(){return n.getSchema.apply(n,arguments)},getSchemaMap:function(){return n.getSchemaMap.apply(n,arguments)},getSchemaUris:function(){return n.getSchemaUris.apply(n,arguments)},getMissingUris:function(){return n.getMissingUris.apply(n,arguments)},dropSchemas:function(){n.dropSchemas.apply(n,arguments)},defineKeyword:function(){n.defineKeyword.apply(n,arguments)},defineError:function(t,e,r){if(\"string\"!=typeof t||!/^[A-Z]+(_[A-Z]+)*$/.test(t))throw new Error(\"Code name must be a string in UPPER_CASE_WITH_UNDERSCORES\");if(\"number\"!=typeof e||e%1!=0||e<1e4)throw new Error(\"Code number must be an integer > 10000\");if(void 0!==m[t])throw new Error(\"Error already defined: \"+t+\" as \"+m[t]);if(void 0!==g[e])throw new Error(\"Error code already used: \"+g[e]+\" as \"+e);m[t]=e,g[e]=t,O[t]=O[e]=r;for(var n in b){var i=b[n];i[t]&&(i[e]=i[e]||i[t])}},reset:function(){n.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:u,resolveUrl:o,getDocumentUri:a,errorCodes:m};return i.language(t||\"en\"),i}Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable(\"toString\"),r=[\"toString\",\"toLocaleString\",\"valueOf\",\"hasOwnProperty\",\"isPrototypeOf\",\"propertyIsEnumerable\",\"constructor\"],n=r.length;return function(i){if(\"object\"!=typeof i&&\"function\"!=typeof i||null===i)throw new TypeError(\"Object.keys called on non-object\");var o=[];for(var a in i)t.call(i,a)&&o.push(a);if(e)for(var u=0;u<n;u++)t.call(i,r[u])&&o.push(r[u]);return o}}()),Object.create||(Object.create=function(){function t(){}return function(e){if(1!==arguments.length)throw new Error(\"Object.create implementation only accepts one parameter.\");return t.prototype=e,new t}}()),Array.isArray||(Array.isArray=function(t){return\"[object Array]\"===Object.prototype.toString.call(t)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(null===this)throw new TypeError;var e=Object(this),r=e.length>>>0;if(0===r)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=r)return-1;for(var i=n>=0?n:Math.max(r-Math.abs(n),0);i<r;i++)if(i in e&&e[i]===t)return i;return-1}),Object.isFrozen||(Object.isFrozen=function(t){for(var e=\"tv4_test_frozen_key\";t.hasOwnProperty(e);)e+=Math.random();try{return t[e]=!0,delete t[e],!1}catch(t){return!0}});var h={\"+\":!0,\"#\":!0,\".\":!0,\"/\":!0,\";\":!0,\"?\":!0,\"&\":!0},p={\"*\":!0};r.prototype={toString:function(){return this.template},fillFromObject:function(t){return this.fill(function(e){return t[e]})}};var d=function(t,e,r,n,i){if(this.missing=[],this.missingMap={},this.formatValidators=t?Object.create(t.formatValidators):{},this.schemas=t?Object.create(t.schemas):{},this.collectMultiple=e,this.errors=[],this.handleError=e?this.collectError:this.returnError,n&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey=\"tv4_validation_id\",this.validationErrorsKey=\"tv4_validation_errors_id\"),i&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorReporter=r||s(\"en\"),\"string\"==typeof this.errorReporter)throw new Error(\"debug\");if(this.definedKeywords={},t)for(var o in t.definedKeywords)this.definedKeywords[o]=t.definedKeywords[o].slice(0)};d.prototype.defineKeyword=function(t,e){this.definedKeywords[t]=this.definedKeywords[t]||[],this.definedKeywords[t].push(e)},d.prototype.createError=function(t,e,r,n,i,o,a){var u=new c(t,e,r,n,i);return u.message=this.errorReporter(u,o,a),u},d.prototype.returnError=function(t){return t},d.prototype.collectError=function(t){return t&&this.errors.push(t),null},d.prototype.prefixErrors=function(t,e,r){for(var n=t;n<this.errors.length;n++)this.errors[n]=this.errors[n].prefixWith(e,r);return this},d.prototype.banUnknownProperties=function(t,e){for(var r in this.unknownPropertyPaths){var n=this.createError(m.UNKNOWN_PROPERTY,{path:r},r,\"\",null,t,e),i=this.handleError(n);if(i)return i}return null},d.prototype.addFormat=function(t,e){if(\"object\"==typeof t){for(var r in t)this.addFormat(r,t[r]);return this}this.formatValidators[t]=e},d.prototype.resolveRefs=function(t,e){if(void 0!==t.$ref){if(e=e||{},e[t.$ref])return this.createError(m.CIRCULAR_REFERENCE,{urls:Object.keys(e).join(\", \")},\"\",\"\",null,void 0,t);e[t.$ref]=!0,t=this.getSchema(t.$ref,e)}return t},d.prototype.getSchema=function(t,e){var r;if(void 0!==this.schemas[t])return r=this.schemas[t],this.resolveRefs(r,e);var n=t,i=\"\";if(-1!==t.indexOf(\"#\")&&(i=t.substring(t.indexOf(\"#\")+1),n=t.substring(0,t.indexOf(\"#\"))),\"object\"==typeof this.schemas[n]){r=this.schemas[n];var o=decodeURIComponent(i);if(\"\"===o)return this.resolveRefs(r,e);if(\"/\"!==o.charAt(0))return;for(var a=o.split(\"/\").slice(1),u=0;u<a.length;u++){var s=a[u].replace(/~1/g,\"/\").replace(/~0/g,\"~\");if(void 0===r[s]){r=void 0;break}r=r[s]}if(void 0!==r)return this.resolveRefs(r,e)}void 0===this.missing[n]&&(this.missing.push(n),this.missing[n]=n,this.missingMap[n]=n)},d.prototype.searchSchemas=function(t,e){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.searchSchemas(t[r],e);else if(t&&\"object\"==typeof t){\"string\"==typeof t.id&&l(e,t.id)&&void 0===this.schemas[t.id]&&(this.schemas[t.id]=t);for(var n in t)if(\"enum\"!==n)if(\"object\"==typeof t[n])this.searchSchemas(t[n],e);else if(\"$ref\"===n){var i=a(t[n]);i&&void 0===this.schemas[i]&&void 0===this.missingMap[i]&&(this.missingMap[i]=i)}}},d.prototype.addSchema=function(t,e){if(\"string\"!=typeof t||void 0===e){if(\"object\"!=typeof t||\"string\"!=typeof t.id)return;e=t,t=e.id}t===a(t)+\"#\"&&(t=a(t)),this.schemas[t]=e,delete this.missingMap[t],u(e,t),this.searchSchemas(e,t)},d.prototype.getSchemaMap=function(){var t={};for(var e in this.schemas)t[e]=this.schemas[e];return t},d.prototype.getSchemaUris=function(t){var e=[];for(var r in this.schemas)t&&!t.test(r)||e.push(r);return e},d.prototype.getMissingUris=function(t){var e=[];for(var r in this.missingMap)t&&!t.test(r)||e.push(r);return e},d.prototype.dropSchemas=function(){this.schemas={},this.reset()},d.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},d.prototype.validateAll=function(t,e,r,n,i){var o;if(!(e=this.resolveRefs(e)))return null;if(e instanceof c)return this.errors.push(e),e;var a,u=this.errors.length,s=null,l=null;if(this.checkRecursive&&t&&\"object\"==typeof t){if(o=!this.scanned.length,t[this.validatedSchemasKey]){var f=t[this.validatedSchemasKey].indexOf(e);if(-1!==f)return this.errors=this.errors.concat(t[this.validationErrorsKey][f]),null}if(Object.isFrozen(t)&&-1!==(a=this.scannedFrozen.indexOf(t))){var h=this.scannedFrozenSchemas[a].indexOf(e);if(-1!==h)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[a][h]),null}if(this.scanned.push(t),Object.isFrozen(t))-1===a&&(a=this.scannedFrozen.length,this.scannedFrozen.push(t),this.scannedFrozenSchemas.push([])),s=this.scannedFrozenSchemas[a].length,this.scannedFrozenSchemas[a][s]=e,this.scannedFrozenValidationErrors[a][s]=[];else{if(!t[this.validatedSchemasKey])try{Object.defineProperty(t,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(t,this.validationErrorsKey,{value:[],configurable:!0})}catch(e){t[this.validatedSchemasKey]=[],t[this.validationErrorsKey]=[]}l=t[this.validatedSchemasKey].length,t[this.validatedSchemasKey][l]=e,t[this.validationErrorsKey][l]=[]}}var p=this.errors.length,d=this.validateBasic(t,e,i)||this.validateNumeric(t,e,i)||this.validateString(t,e,i)||this.validateArray(t,e,i)||this.validateObject(t,e,i)||this.validateCombinations(t,e,i)||this.validateHypermedia(t,e,i)||this.validateFormat(t,e,i)||this.validateDefinedKeywords(t,e,i)||null;if(o){for(;this.scanned.length;){delete this.scanned.pop()[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(d||p!==this.errors.length)for(;r&&r.length||n&&n.length;){var v=r&&r.length?\"\"+r.pop():null,y=n&&n.length?\"\"+n.pop():null;d&&(d=d.prefixWith(v,y)),this.prefixErrors(p,v,y)}return null!==s?this.scannedFrozenValidationErrors[a][s]=this.errors.slice(u):null!==l&&(t[this.validationErrorsKey][l]=this.errors.slice(u)),this.handleError(d)},d.prototype.validateFormat=function(t,e){if(\"string\"!=typeof e.format||!this.formatValidators[e.format])return null;var r=this.formatValidators[e.format].call(null,t,e);return\"string\"==typeof r||\"number\"==typeof r?this.createError(m.FORMAT_CUSTOM,{message:r},\"\",\"/format\",null,t,e):r&&\"object\"==typeof r?this.createError(m.FORMAT_CUSTOM,{message:r.message||\"?\"},r.dataPath||\"\",r.schemaPath||\"/format\",null,t,e):null},d.prototype.validateDefinedKeywords=function(t,e,r){for(var n in this.definedKeywords)if(void 0!==e[n])for(var i=this.definedKeywords[n],o=0;o<i.length;o++){var a=i[o],u=a(t,e[n],e,r);if(\"string\"==typeof u||\"number\"==typeof u)return this.createError(m.KEYWORD_CUSTOM,{key:n,message:u},\"\",\"\",null,t,e).prefixWith(null,n);if(u&&\"object\"==typeof u){var s=u.code;if(\"string\"==typeof s){if(!m[s])throw new Error(\"Undefined error code (use defineError): \"+s);s=m[s]}else\"number\"!=typeof s&&(s=m.KEYWORD_CUSTOM);var c=\"object\"==typeof u.message?u.message:{key:n,message:u.message||\"?\"},l=u.schemaPath||\"/\"+n.replace(/~/g,\"~0\").replace(/\\//g,\"~1\");return this.createError(s,c,u.dataPath||null,l,null,t,e)}}return null},d.prototype.validateBasic=function(t,e,r){var n;return(n=this.validateType(t,e,r))?n.prefixWith(null,\"type\"):(n=this.validateEnum(t,e,r))?n.prefixWith(null,\"type\"):null},d.prototype.validateType=function(t,e){if(void 0===e.type)return null;var r=typeof t;null===t?r=\"null\":Array.isArray(t)&&(r=\"array\");var n=e.type;Array.isArray(n)||(n=[n]);for(var i=0;i<n.length;i++){var o=n[i];if(o===r||\"integer\"===o&&\"number\"===r&&t%1==0)return null}return this.createError(m.INVALID_TYPE,{type:r,expected:n.join(\"/\")},\"\",\"\",null,t,e)},d.prototype.validateEnum=function(t,e){if(void 0===e.enum)return null;for(var r=0;r<e.enum.length;r++){if(n(t,e.enum[r]))return null}return this.createError(m.ENUM_MISMATCH,{value:\"undefined\"!=typeof JSON?JSON.stringify(t):t},\"\",\"\",null,t,e)},d.prototype.validateNumeric=function(t,e,r){return this.validateMultipleOf(t,e,r)||this.validateMinMax(t,e,r)||this.validateNaN(t,e,r)||null};var v=Math.pow(2,-51),y=1-v;d.prototype.validateMultipleOf=function(t,e){var r=e.multipleOf||e.divisibleBy;if(void 0===r)return null;if(\"number\"==typeof t){var n=t/r%1;if(n>=v&&n<y)return this.createError(m.NUMBER_MULTIPLE_OF,{value:t,multipleOf:r},\"\",\"\",null,t,e)}return null},d.prototype.validateMinMax=function(t,e){if(\"number\"!=typeof t)return null;if(void 0!==e.minimum){if(t<e.minimum)return this.createError(m.NUMBER_MINIMUM,{value:t,minimum:e.minimum},\"\",\"/minimum\",null,t,e);if(e.exclusiveMinimum&&t===e.minimum)return this.createError(m.NUMBER_MINIMUM_EXCLUSIVE,{value:t,minimum:e.minimum},\"\",\"/exclusiveMinimum\",null,t,e)}if(void 0!==e.maximum){if(t>e.maximum)return this.createError(m.NUMBER_MAXIMUM,{value:t,maximum:e.maximum},\"\",\"/maximum\",null,t,e);if(e.exclusiveMaximum&&t===e.maximum)return this.createError(m.NUMBER_MAXIMUM_EXCLUSIVE,{value:t,maximum:e.maximum},\"\",\"/exclusiveMaximum\",null,t,e)}return null},d.prototype.validateNaN=function(t,e){return\"number\"!=typeof t?null:!0===isNaN(t)||t===1/0||t===-1/0?this.createError(m.NUMBER_NOT_A_NUMBER,{value:t},\"\",\"/type\",null,t,e):null},d.prototype.validateString=function(t,e,r){return this.validateStringLength(t,e,r)||this.validateStringPattern(t,e,r)||null},d.prototype.validateStringLength=function(t,e){return\"string\"!=typeof t?null:void 0!==e.minLength&&t.length<e.minLength?this.createError(m.STRING_LENGTH_SHORT,{length:t.length,minimum:e.minLength},\"\",\"/minLength\",null,t,e):void 0!==e.maxLength&&t.length>e.maxLength?this.createError(m.STRING_LENGTH_LONG,{length:t.length,maximum:e.maxLength},\"\",\"/maxLength\",null,t,e):null},d.prototype.validateStringPattern=function(t,e){if(\"string\"!=typeof t||\"string\"!=typeof e.pattern&&!(e.pattern instanceof RegExp))return null;var r;if(e.pattern instanceof RegExp)r=e.pattern;else{var n,i=\"\",o=e.pattern.match(/^\\/(.+)\\/([img]*)$/);o?(n=o[1],i=o[2]):n=e.pattern,r=new RegExp(n,i)}return r.test(t)?null:this.createError(m.STRING_PATTERN,{pattern:e.pattern},\"\",\"/pattern\",null,t,e)},d.prototype.validateArray=function(t,e,r){return Array.isArray(t)?this.validateArrayLength(t,e,r)||this.validateArrayUniqueItems(t,e,r)||this.validateArrayItems(t,e,r)||null:null},d.prototype.validateArrayLength=function(t,e){var r;return void 0!==e.minItems&&t.length<e.minItems&&(r=this.createError(m.ARRAY_LENGTH_SHORT,{length:t.length,minimum:e.minItems},\"\",\"/minItems\",null,t,e),this.handleError(r))?r:void 0!==e.maxItems&&t.length>e.maxItems&&(r=this.createError(m.ARRAY_LENGTH_LONG,{length:t.length,maximum:e.maxItems},\"\",\"/maxItems\",null,t,e),this.handleError(r))?r:null},d.prototype.validateArrayUniqueItems=function(t,e){if(e.uniqueItems)for(var r=0;r<t.length;r++)for(var i=r+1;i<t.length;i++)if(n(t[r],t[i])){var o=this.createError(m.ARRAY_UNIQUE,{match1:r,match2:i},\"\",\"/uniqueItems\",null,t,e);if(this.handleError(o))return o}return null},d.prototype.validateArrayItems=function(t,e,r){if(void 0===e.items)return null;var n,i;if(Array.isArray(e.items)){for(i=0;i<t.length;i++)if(i<e.items.length){if(n=this.validateAll(t[i],e.items[i],[i],[\"items\",i],r+\"/\"+i))return n}else if(void 0!==e.additionalItems)if(\"boolean\"==typeof e.additionalItems){if(!e.additionalItems&&(n=this.createError(m.ARRAY_ADDITIONAL_ITEMS,{},\"/\"+i,\"/additionalItems\",null,t,e),this.handleError(n)))return n}else if(n=this.validateAll(t[i],e.additionalItems,[i],[\"additionalItems\"],r+\"/\"+i))return n}else for(i=0;i<t.length;i++)if(n=this.validateAll(t[i],e.items,[i],[\"items\"],r+\"/\"+i))return n;return null},d.prototype.validateObject=function(t,e,r){return\"object\"!=typeof t||null===t||Array.isArray(t)?null:this.validateObjectMinMaxProperties(t,e,r)||this.validateObjectRequiredProperties(t,e,r)||this.validateObjectProperties(t,e,r)||this.validateObjectDependencies(t,e,r)||null},d.prototype.validateObjectMinMaxProperties=function(t,e){var r,n=Object.keys(t);return void 0!==e.minProperties&&n.length<e.minProperties&&(r=this.createError(m.OBJECT_PROPERTIES_MINIMUM,{propertyCount:n.length,minimum:e.minProperties},\"\",\"/minProperties\",null,t,e),this.handleError(r))?r:void 0!==e.maxProperties&&n.length>e.maxProperties&&(r=this.createError(m.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:n.length,maximum:e.maxProperties},\"\",\"/maxProperties\",null,t,e),this.handleError(r))?r:null},d.prototype.validateObjectRequiredProperties=function(t,e){if(void 0!==e.required)for(var r=0;r<e.required.length;r++){var n=e.required[r];if(void 0===t[n]){var i=this.createError(m.OBJECT_REQUIRED,{key:n},\"\",\"/required/\"+r,null,t,e);if(this.handleError(i))return i}}return null},d.prototype.validateObjectProperties=function(t,e,r){var n;for(var i in t){var o=r+\"/\"+i.replace(/~/g,\"~0\").replace(/\\//g,\"~1\"),a=!1;if(void 0!==e.properties&&void 0!==e.properties[i]&&(a=!0,n=this.validateAll(t[i],e.properties[i],[i],[\"properties\",i],o)))return n;if(void 0!==e.patternProperties)for(var u in e.patternProperties){var s=new RegExp(u);if(s.test(i)&&(a=!0,n=this.validateAll(t[i],e.patternProperties[u],[i],[\"patternProperties\",u],o)))return n}if(a)this.trackUnknownProperties&&(this.knownPropertyPaths[o]=!0,delete this.unknownPropertyPaths[o]);else if(void 0!==e.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[o]=!0,delete this.unknownPropertyPaths[o]),\"boolean\"==typeof e.additionalProperties){if(!e.additionalProperties&&(n=this.createError(m.OBJECT_ADDITIONAL_PROPERTIES,{key:i},\"\",\"/additionalProperties\",null,t,e).prefixWith(i,null),this.handleError(n)))return n}else if(n=this.validateAll(t[i],e.additionalProperties,[i],[\"additionalProperties\"],o))return n}else this.trackUnknownProperties&&!this.knownPropertyPaths[o]&&(this.unknownPropertyPaths[o]=!0)}return null},d.prototype.validateObjectDependencies=function(t,e,r){var n;if(void 0!==e.dependencies)for(var i in e.dependencies)if(void 0!==t[i]){var o=e.dependencies[i];if(\"string\"==typeof o){if(void 0===t[o]&&(n=this.createError(m.OBJECT_DEPENDENCY_KEY,{key:i,missing:o},\"\",\"\",null,t,e).prefixWith(null,i).prefixWith(null,\"dependencies\"),this.handleError(n)))return n}else if(Array.isArray(o))for(var a=0;a<o.length;a++){var u=o[a];if(void 0===t[u]&&(n=this.createError(m.OBJECT_DEPENDENCY_KEY,{key:i,missing:u},\"\",\"/\"+a,null,t,e).prefixWith(null,i).prefixWith(null,\"dependencies\"),this.handleError(n)))return n}else if(n=this.validateAll(t,o,[],[\"dependencies\",i],r))return n}return null},d.prototype.validateCombinations=function(t,e,r){return this.validateAllOf(t,e,r)||this.validateAnyOf(t,e,r)||this.validateOneOf(t,e,r)||this.validateNot(t,e,r)||null},d.prototype.validateAllOf=function(t,e,r){if(void 0===e.allOf)return null;for(var n,i=0;i<e.allOf.length;i++){var o=e.allOf[i];if(n=this.validateAll(t,o,[],[\"allOf\",i],r))return n}return null},d.prototype.validateAnyOf=function(t,e,r){if(void 0===e.anyOf)return null;var n,i,o=[],a=this.errors.length;this.trackUnknownProperties&&(n=this.unknownPropertyPaths,i=this.knownPropertyPaths);for(var u=!0,s=0;s<e.anyOf.length;s++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var c=e.anyOf[s],l=this.errors.length,f=this.validateAll(t,c,[],[\"anyOf\",s],r);if(null===f&&l===this.errors.length){if(this.errors=this.errors.slice(0,a),this.trackUnknownProperties){for(var h in this.knownPropertyPaths)i[h]=!0,delete n[h];for(var p in this.unknownPropertyPaths)i[p]||(n[p]=!0);u=!1;continue}return null}f&&o.push(f.prefixWith(null,\"\"+s).prefixWith(null,\"anyOf\"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=n,this.knownPropertyPaths=i),u?(o=o.concat(this.errors.slice(a)),this.errors=this.errors.slice(0,a),this.createError(m.ANY_OF_MISSING,{},\"\",\"/anyOf\",o,t,e)):void 0},d.prototype.validateOneOf=function(t,e,r){if(void 0===e.oneOf)return null;var n,i,o=null,a=[],u=this.errors.length;this.trackUnknownProperties&&(n=this.unknownPropertyPaths,i=this.knownPropertyPaths);for(var s=0;s<e.oneOf.length;s++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var c=e.oneOf[s],l=this.errors.length,f=this.validateAll(t,c,[],[\"oneOf\",s],r);if(null===f&&l===this.errors.length){if(null!==o)return this.errors=this.errors.slice(0,u),this.createError(m.ONE_OF_MULTIPLE,{index1:o,index2:s},\"\",\"/oneOf\",null,t,e);if(o=s,this.trackUnknownProperties){for(var h in this.knownPropertyPaths)i[h]=!0,delete n[h];for(var p in this.unknownPropertyPaths)i[p]||(n[p]=!0)}}else f&&a.push(f)}return this.trackUnknownProperties&&(this.unknownPropertyPaths=n,this.knownPropertyPaths=i),null===o?(a=a.concat(this.errors.slice(u)),this.errors=this.errors.slice(0,u),this.createError(m.ONE_OF_MISSING,{},\"\",\"/oneOf\",a,t,e)):(this.errors=this.errors.slice(0,u),null)},d.prototype.validateNot=function(t,e,r){if(void 0===e.not)return null;var n,i,o=this.errors.length;this.trackUnknownProperties&&(n=this.unknownPropertyPaths,i=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var a=this.validateAll(t,e.not,null,null,r),u=this.errors.slice(o);return this.errors=this.errors.slice(0,o),this.trackUnknownProperties&&(this.unknownPropertyPaths=n,this.knownPropertyPaths=i),null===a&&0===u.length?this.createError(m.NOT_PASSED,{},\"\",\"/not\",null,t,e):null},d.prototype.validateHypermedia=function(t,e,n){if(!e.links)return null;for(var i,o=0;o<e.links.length;o++){var a=e.links[o];if(\"describedby\"===a.rel){for(var u=new r(a.href),s=!0,c=0;c<u.varNames.length;c++)if(!(u.varNames[c]in t)){s=!1;break}if(s){var l=u.fillFromObject(t),f={$ref:l};if(i=this.validateAll(t,f,[],[\"links\",o],n))return i}}}};var m={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},g={};for(var _ in m)g[m[_]]=_;var O={INVALID_TYPE:\"Invalid type: {type} (expected {expected})\",ENUM_MISMATCH:\"No enum match for: {value}\",ANY_OF_MISSING:'Data does not match any schemas from \"anyOf\"',ONE_OF_MISSING:'Data does not match any schemas from \"oneOf\"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from \"oneOf\": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from \"not\"',NUMBER_MULTIPLE_OF:\"Value {value} is not a multiple of {multipleOf}\",NUMBER_MINIMUM:\"Value {value} is less than minimum {minimum}\",NUMBER_MINIMUM_EXCLUSIVE:\"Value {value} is equal to exclusive minimum {minimum}\",NUMBER_MAXIMUM:\"Value {value} is greater than maximum {maximum}\",NUMBER_MAXIMUM_EXCLUSIVE:\"Value {value} is equal to exclusive maximum {maximum}\",NUMBER_NOT_A_NUMBER:\"Value {value} is not a valid number\",STRING_LENGTH_SHORT:\"String is too short ({length} chars), minimum {minimum}\",STRING_LENGTH_LONG:\"String is too long ({length} chars), maximum {maximum}\",STRING_PATTERN:\"String does not match pattern: {pattern}\",OBJECT_PROPERTIES_MINIMUM:\"Too few properties defined ({propertyCount}), minimum {minimum}\",OBJECT_PROPERTIES_MAXIMUM:\"Too many properties defined ({propertyCount}), maximum {maximum}\",OBJECT_REQUIRED:\"Missing required property: {key}\",OBJECT_ADDITIONAL_PROPERTIES:\"Additional properties not allowed\",OBJECT_DEPENDENCY_KEY:\"Dependency failed - key must exist: {missing} (due to key: {key})\",ARRAY_LENGTH_SHORT:\"Array is too short ({length}), minimum {minimum}\",ARRAY_LENGTH_LONG:\"Array is too long ({length}), maximum {maximum}\",ARRAY_UNIQUE:\"Array items are not unique (indices {match1} and {match2})\",ARRAY_ADDITIONAL_ITEMS:\"Additional items not allowed\",FORMAT_CUSTOM:\"Format validation failed ({message})\",KEYWORD_CUSTOM:\"Keyword failed: {key} ({message})\",CIRCULAR_REFERENCE:\"Circular $refs: {urls}\",UNKNOWN_PROPERTY:\"Unknown property (not in schema)\"};c.prototype=Object.create(Error.prototype),c.prototype.constructor=c,c.prototype.name=\"ValidationError\",c.prototype.prefixWith=function(t,e){if(null!==t&&(t=t.replace(/~/g,\"~0\").replace(/\\//g,\"~1\"),this.dataPath=\"/\"+t+this.dataPath),null!==e&&(e=e.replace(/~/g,\"~0\").replace(/\\//g,\"~1\"),this.schemaPath=\"/\"+e+this.schemaPath),null!==this.subErrors)for(var r=0;r<this.subErrors.length;r++)this.subErrors[r].prefixWith(t,e);return this};var b={},E=f();return E.addLanguage(\"en-gb\",O),E.tv4=E,E})},,,function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0});var i=r(3),o=n(i),a=r(5),u=n(a),s=function(){function t(e,r){(0,o.default)(this,t),this._sourceCode=r,this._sourceCodeClassname=e,this._encoding=null,this._signature=null}return(0,u.default)(t,[{key:\"sourceCode\",get:function(){return this._sourceCode},set:function(t){t&&(this._sourceCode=t)}},{key:\"sourceCodeClassname\",get:function(){return this._sourceCodeClassname},set:function(t){t&&(this._sourceCodeClassname=t)}},{key:\"encoding\",get:function(){return this._encoding},set:function(t){t&&(this._encoding=t)}},{key:\"signature\",get:function(){return this._signature},set:function(t){t&&(this._signature=t)}}]),t}();e.default=s,t.exports=e.default},function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0}),e.HypertyResourceType=e.HypertyType=e.RuntimeHypertyCapabilityType=void 0;var i=r(25),o=n(i),a=r(3),u=n(a),s=r(5),c=n(s),l=r(33),f=n(l),h=r(34),p=n(h),d=r(116),v=n(d),y=function(t){function e(t,r,n,i,a,s,c,l,h){(0,u.default)(this,e);var p=(0,f.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,r,n,i,a,s,c));return p._configuration={},p._constraints={},p._policies={},p._messageSchema=null,p._hypertyType=l,p._dataObjects=h,p}return(0,p.default)(e,t),(0,c.default)(e,[{key:\"hypertyType\",get:function(){return this._hypertyType},set:function(t){t&&(this._hypertyType=t)}},{key:\"dataObjects\",get:function(){return this._dataObjects},set:function(t){t&&(this._dataObjects=t)}},{key:\"configuration\",get:function(){return this._configuration},set:function(t){t&&(this._configuration=t)}},{key:\"constraints\",get:function(){return this._constraints},set:function(t){t&&(this._constraints=t)}},{key:\"messageSchema\",get:function(){return this._messageSchema},set:function(t){t&&(this._messageSchema=t)}},{key:\"policies\",get:function(){return this._policies},set:function(t){t&&(this._policies=t)}}]),e}(v.default);e.RuntimeHypertyCapabilityType={},e.HypertyType={COMMUNICATOR:\"communicator\",IDENTITY:\"identity\",CONTEXT:\"context\"},e.HypertyResourceType={chat:\"CHAT\",audio:\"Audio\",video:\"Video\",av:\"AV\",screen:\"SCREEN\",file:\"FILe\",midi:\"MIDI\"};e.default=y},function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0});var i=r(25),o=n(i),a=r(3),u=n(a),s=r(5),c=n(s),l=r(33),f=n(l),h=r(34),p=n(h),d=r(116),v=n(d),y=function(t){function e(t,r,n,i,a,s,c,l,h,p,d,v,y,m,g){(0,u.default)(this,e);var _=(0,f.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,r,n,i,a,s,c));return _._messageSchemas=l,_._configuration=h||{},_._constraints=p||{},_._hypertyType=d,_._dataObjects=v||[],_._interworking=y,_._idpProxy=m,_._mutualAuthentication=g,_}return(0,p.default)(e,t),(0,c.default)(e,[{key:\"messageSchemas\",get:function(){return this._messageSchemas},set:function(t){t&&(this._messageSchemas=t)}},{key:\"constraints\",get:function(){return this._constraints},set:function(t){t&&(this._constraints=t)}},{key:\"configuration\",get:function(){return this._configuration},set:function(t){t&&(this._configuration=t)}},{key:\"hypertyType\",get:function(){return this._hypertyType},set:function(t){this._hypertyType=t}},{key:\"dataObjects\",get:function(){return this._dataObjects},set:function(t){this._dataObjects=t}},{key:\"interworking\",get:function(){return this._interworking},set:function(t){this._interworking=t}},{key:\"idpProxy\",get:function(){return this._idpProxy},set:function(t){this._idpProxy=t}},{key:\"mutualAuthentication\",get:function(){return this._mutualAuthentication},set:function(t){this._mutualAuthentication=t}}]),e}(v.default);e.default=y,t.exports=e.default},,function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0});var i=r(3),o=n(i),a=r(5),u=n(a),s=r(116),c=n(s),l=r(140),f=n(l),h=r(141),p=n(h),d=r(142),v=n(d),y=r(145),m=n(y),g=r(146),_=n(g),O=r(147),b=function(){function t(){(0,o.default)(this,t)}return(0,u.default)(t,[{key:\"createCatalogueDataObject\",value:function(t,e,r,n,i,o,a){if(void 0===t||void 0===e||void 0===r||void 0===n||void 0===i||void 0===o||void 0===a)throw new Error(\"Invalid parameters!\");return new c.default(t,e,r,n,i,o,a)}},{key:\"createHypertyDescriptorObject\",value:function(t,e,r,n,i,o,a,u){if(void 0===t||void 0===e||void 0===r||void 0===n||void 0===i||void 0===o||void 0===a||void 0===u)throw new Error(\"Invalid parameters!\");return new p.default(t,s.CatalogueObjectType.HYPERTY,e,r,n,i,o,a,u)}},{key:\"createProtoStubDescriptorObject\",value:function(t,e,r,n,i,o,a,u,c,l,f,h,p,d){if(void 0===t||void 0===e||void 0===r||void 0===n||void 0===i||void 0===o||void 0===a||void 0===u||void 0===c)throw new Error(\"Invalid parameters!\");return new v.default(t,s.CatalogueObjectType.PROTOSTUB,e,r,n,i,o,a,u,c,l,f,h,p,d)}},{key:\"createHypertyRuntimeDescriptorObject\",value:function(t,e,r,n,i,o,a,u,c,l,f){if(void 0===t||void 0===e||void 0===r||void 0===n||void 0===i||void 0===o||void 0===a)throw new Error(\"Invalid parameters!\");return new m.default(t,s.CatalogueObjectType.HYPERTY_RUNTIME,e,r,n,i,o,a,u,c,l,f)}},{key:\"createHypertyInterceptorDescriptorObject\",value:function(t,e,r,n,i,o,a,u){if(void 0===t||void 0===e||void 0===r||void 0===n||void 0===i||void 0===o)throw new Error(\"Invalid parameters!\");return new _.default(t,s.CatalogueObjectType.HYPERTY_INTERCEPTOR,e,r,n,i,o,a,u)}},{key:\"createDataObjectSchema\",value:function(t,e,r,n,i,o){if(void 0===t||void 0===e||void 0===r||void 0===n||void 0===i||void 0===o)throw new Error(\"Invalid parameters!\");return new O.DataObjectSchema(t,s.CatalogueObjectType.HYPERTY_DATA_OBJECT,e,r,n,i,o)}},{key:\"createMessageDataObjectSchema\",value:function(t,e,r,n,i,o){if(void 0===t||void 0===e||void 0===r||void 0===n||void 0===i||void 0===o)throw new Error(\"Invalid parameters!\");return new O.DataObjectSchema(t,s.CatalogueObjectType.HYPERTY_DATA_OBJECT,e,r,n,i,o)}},{key:\"createHypertyDataObjectSchema\",value:function(t,e,r,n,i,o,a,u){if(void 0===t||void 0===e||void 0===r||void 0===n||void 0===i||void 0===o||void 0===u||void 0===a)throw new Error(\"Invalid parameters!\");return u===O.DataUrlScheme.COMM?new O.CommunicationDataObjectSchema(t,s.CatalogueObjectType.HYPERTY_DATA_OBJECT,e,r,n,i,o,u,a):u===O.DataUrlScheme.CONNECTION?new O.ConnectionDataObjectSchema(t,s.CatalogueObjectType.HYPERTY_DATA_OBJECT,e,r,n,i,o,u,a):u===O.DataUrlScheme.CTXT?new O.ContextDataObjectSchema(t,s.CatalogueObjectType.HYPERTY_DATA_OBJECT,e,r,n,i,o,u,a):u===O.DataUrlScheme.IDENTITY?new O.IdentityDataObjectSchema(t,s.CatalogueObjectType.HYPERTY_DATA_OBJECT,e,r,n,i,o,u,a):void 0}},{key:\"createSourcePackage\",value:function(t,e){if(void 0===e||void 0===t)throw new Error(\"Invalid parameters!\");return new f.default(t,e)}}]),t}();e.default=b,t.exports=e.default},function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0}),e.RuntimeType=e.RuntimeProtocolCapability=e.RuntimeHypertyCapability=void 0;var i=r(58),o=n(i),a=r(25),u=n(a),s=r(3),c=n(s),l=r(5),f=n(l),h=r(33),p=n(h),d=r(34),v=n(d),y=r(116),m=n(y),g=function(t){function e(t,r,n,i,o,a,s,l,f,h,d,v){(0,c.default)(this,e);var y=(0,p.default)(this,(e.__proto__||(0,u.default)(e)).call(this,t,r,n,i,o,a,s));return y._runtimeType=l,y._hypertyCapabilities=f||new _(!0,!1,!1,!1,!1),y._protocolCapabilities=h||new O(!0,!1,!0,!1,!1,!1),y._p2pHandlerStub=d,y._p2pRequesterStub=v,y}return(0,v.default)(e,t),(0,f.default)(e,[{key:\"runtimeType\",get:function(){return this._runtimeType},set:function(t){t&&(this._runtimeType=t)}},{key:\"hypertyCapabilities\",get:function(){return this._hypertyCapabilities},set:function(t){t&&(this._hypertyCapabilities=t)}},{key:\"protocolCapabilities\",get:function(){return this._hypertyCapabilities},set:function(t){t&&(this._protocolCapabilities=t)}},{key:\"p2pHandlerStub\",get:function(){return this._p2pHandlerStub},set:function(t){this._p2pHandlerStub=t}},{key:\"p2pRequesterStub\",get:function(){return this._p2pRequesterStub},set:function(t){this._p2pRequesterStub=t}}]),e}(m.default),_=e.RuntimeHypertyCapability=function(){function t(e,r,n,i,o){(0,c.default)(this,t),this._isWebRTC=e,this._isMic=r,this._isCamera=n,this._isSensor=i,this._isORTC=o}return(0,f.default)(t,[{key:\"getCapabilitySet\",value:function(){return(0,o.default)(this)}},{key:\"isMic\",get:function(){return this._isMic}},{key:\"isCamera\",get:function(){return this._isCamera}},{key:\"isSensor\",get:function(){return this._isSensor}},{key:\"isWebRTC\",get:function(){return this._isWebRTC}},{key:\"isORTCS\",get:function(){return this._isORTC}}]),t}(),O=e.RuntimeProtocolCapability=function(){function t(e,r,n,i,o,a){(0,c.default)(this,t),this._isHttp=e,this._isHttps=r,this._isWS=n,this._isWSS=i,this._isCoap=o,this._isDataChannel=a}return(0,f.default)(t,[{key:\"isHttp\",value:function(){return this._isHttp}},{key:\"isHttps\",value:function(){return this._isHttps}},{key:\"isWS\",value:function(){return this._isWS}},{key:\"isSensorSupported\",value:function(){return this._isSensor}},{key:\"isWSS\",value:function(){return this._isWSS}},{key:\"isCoap\",value:function(){return this._isCoap}},{key:\"isDataChannel\",value:function(){return this._isDataChannel}},{key:\"getCapabilitySet\",value:function(){return(0,o.default)(this)}}]),t}();e.RuntimeType={BROWSER:\"browser\",STANDALONE:\"standalone\",SERVER:\"server\",GATEWAY:\"gateway\"};e.default=g},function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0});var i=r(25),o=n(i),a=r(3),u=n(a),s=r(5),c=n(s),l=r(33),f=n(l),h=r(34),p=n(h),d=r(116),v=n(d),y=function(t){function e(t,r,n,i,a,s,c,l,h){(0,u.default)(this,e);var p=(0,f.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,r,n,i,a,s,c));return p._configuration=l,p._policies=h,p}return(0,p.default)(e,t),(0,c.default)(e,[{key:\"configuration\",get:function(){return this._configuration},set:function(t){this._configuration=t}},{key:\"policies\",get:function(){return this._policies},set:function(t){this._policies=t}}]),e}(v.default);e.default=y,t.exports=e.default},function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0}),e.DataUrlScheme=e.ContextDataObjectSchema=e.IdentityDataObjectSchema=e.ConnectionDataObjectSchema=e.CommunicationDataObjectSchema=e.HypertyDataObjectSchema=e.MessageDataObjectSchema=e.DataObjectSchema=void 0;var i=r(25),o=n(i),a=r(3),u=n(a),s=r(33),c=n(s),l=r(34),f=n(l),h=r(116),p=n(h),d=e.DataObjectSchema=function(t){function e(t,r,n,i,a,s,l){return(0,u.default)(this,e),(0,c.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,r,n,i,a,s,l))}return(0,f.default)(e,t),e}(p.default),v=(e.MessageDataObjectSchema=function(t){function e(t,r,n,i,a,s,l){return(0,u.default)(this,e),(0,c.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,r,n,i,a,s,l))}return(0,f.default)(e,t),e}(d),e.HypertyDataObjectSchema=function(t){function e(t,r,n,i,a,s,l,f,h){(0,u.default)(this,e);var p=(0,c.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,r,n,i,a,s,l));return p._accessControlPolicy=f,p._scheme=h,p}return(0,f.default)(e,t),e}(d));e.CommunicationDataObjectSchema=function(t){function e(t,r,n,i,a,s,l,f){return(0,u.default)(this,e),(0,c.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,r,n,i,a,s,l,f))}return(0,f.default)(e,t),e}(v),e.ConnectionDataObjectSchema=function(t){function e(t,r,n,i,a,s,l,f){return(0,u.default)(this,e),(0,c.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,r,n,i,a,s,l,f))}return(0,f.default)(e,t),e}(v),e.IdentityDataObjectSchema=function(t){function e(t,r,n,i,a,s,l,f){return(0,u.default)(this,e),(0,c.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,r,n,i,a,s,l,f))}return(0,f.default)(e,t),e}(v),e.ContextDataObjectSchema=function(t){function e(t,r,n,i,a,s,l,f){return(0,u.default)(this,e),(0,c.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,r,n,i,a,s,l,f))}return(0,f.default)(e,t),e}(v),e.DataUrlScheme={COMM:\"COMM\",CONNECTION:\"CONNECTION\",CTXT:\"CTXT\",IDENTITY:\"IDENTITY\"};e.default=d},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.RuntimeCatalogue=void 0;var n=r(22),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(n),o=r(186),a=function(t){return t&&t.__esModule?t:{default:t}}(o);i.getLogger(\"RuntimeCatalogue\").setLevel(0),e.RuntimeCatalogue=a.default},function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0});var i=r(187),o=n(i),a=r(58),u=n(a),s=r(18),c=n(s),l=r(3),f=n(l),h=r(5),p=n(h),d=r(22),v=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(d),y=r(144),m=n(y),g=v.getLogger(\"RuntimeCatalogue\"),_=function(){function t(e,r,n){if((0,f.default)(this,t),!e)throw Error(\"The catalogue needs the runtimeFactory\");this._factory=new m.default,this.httpRequest=e.createHttpRequest(),this.atob=e.atob?e.atob:atob;var i=r||\"runtimeCatalogue\",o=n||\"&cguid, accessControlPolicy, constraints, dataObjects, hypertyType, objectName, sourcePackage, version\",a={};a[i]=o,this.storageManager=e.storageManager(i,a)}return(0,p.default)(t,[{key:\"getDescriptor\",value:function(t,e){var r=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments[3];g.info(\"[RuntimeCatalogue] - getting descriptor from: \",t,\" with constraints: \",i);var a=!1,s=!1,l=void 0;l=void 0!=i?c.default.all([this.httpRequest.post(t+\"/version\",{body:(0,u.default)(i)}),this.httpRequest.post(t+\"/cguid\",{body:(0,u.default)(i)})]):c.default.all([this.httpRequest.get(t+\"/version\"),this.httpRequest.get(t+\"/cguid\")]),l=l.then(function(e){var n=(0,o.default)(e,2),s=n[0],c=n[1];return g.info(\"[RuntimeCatalogue] - got version (\"+s+\") and cguid (\"+c+\") for descriptor \"+t),r.storageManager.getVersion(\"cguid\",c).then(function(e){return e>=s?(g.warn(\"storageManager contains saved version that is the same or newer than requested\"),a=!0,r.storageManager.get(\"cguid\",c)):(g.warn(\"storageManager does not contain saved version\"),(void 0!=i?r.httpRequest.post(t,{body:(0,u.default)(i)}):r.httpRequest.get(t)).then(function(t){if(t=JSON.parse(t),t.ERROR)throw new Error(t);return t}))})}).catch(function(e){var r=\"Unable to get descriptor for \"+t+(void 0!=i?\" with constraints \"+i:\"\")+\": \"+e;throw g.error(r),new Error(r)});var f=l;return n&&(g.log(\"adding promise to attach sourcePackage\"),f=l.then(function(t){return t.sourcePackage?(s=!0,t):(s=!1,r.attachRawSourcePackage(t))})),f=f.then(function(t){return(!a||a&&!s&&n)&&r.storageManager.set(t.cguid,t.version,t),e.apply(r,[t,i])})}},{key:\"attachRawSourcePackage\",value:function(t,e){var r=this;return g.log(\"attaching raw sourcePackage from:\",t.sourcePackageURL),new c.default(function(n,i){(void 0!=e?r.httpRequest.post(t.sourcePackageURL,{body:(0,u.default)(e)}):r.httpRequest.get(t.sourcePackageURL)).then(function(e){e=JSON.parse(e),t.sourcePackage=e,n(t)}).catch(function(t){i(t)})})}},{key:\"getHypertyDescriptor\",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments[2];return this.getDescriptor(t,this.createHyperty,e,r)}},{key:\"getStubDescriptor\",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments[2];return this.getDescriptor(t,this.createStub,e,r)}},{key:\"getRuntimeDescriptor\",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments[2];return this.getDescriptor(t,this.createRuntimeDescriptor,e,r)}},{key:\"getDataSchemaDescriptor\",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments[2];return this.getDescriptor(t,this.createDataSchema,e,r)}},{key:\"getIdpProxyDescriptor\",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments[2];return this.getDescriptor(t,this.createIdpProxy,e,r)}},{key:\"createHyperty\",value:function(t){var e=this._factory.createHypertyDescriptorObject(t.cguid,t.version,t.objectName,t.description,t.language,t.sourcePackageURL,t.type||t.hypertyType,t.dataObjects);e.configuration=t.configuration,e.constraints=t.constraints,e.messageSchema=t.messageSchema,e.policies=t.policies,e.signature=t.signature;var r=t.sourcePackage;return r&&(e.sourcePackage=this.createSourcePackage(r)),e}},{key:\"createStub\",value:function(t){var e=this._factory.createProtoStubDescriptorObject(t.cguid,t.version,t.objectName,t.description,t.language,t.sourcePackageURL,t.messageSchemas,t.configuration,t.constraints,t.hypertyType,t.dataObjects,t.interworking,t.idpProxy,t.mutualAuthentication);e.signature=t.signature;var r=t.sourcePackage;return r&&(e.sourcePackage=this.createSourcePackage(r)),e}},{key:\"createRuntimeDescriptor\",value:function(t){try{t.hypertyCapabilities=JSON.parse(t.hypertyCapabilities),t.protocolCapabilities=JSON.parse(t.protocolCapabilities)}catch(t){}var e=this._factory.createHypertyRuntimeDescriptorObject(t.cguid,t.version,t.objectName,t.description,t.language,t.sourcePackageURL,t.type||t.runtimeType,t.hypertyCapabilities,t.protocolCapabilities,t.p2pHandlerStub,t.p2pRequesterStub);e.signature=t.signature;var r=t.sourcePackage;return r&&(e.sourcePackage=this.createSourcePackage(r)),e}},{key:\"createDataSchema\",value:function(t){var e=void 0;e=t.accessControlPolicy&&t.scheme?this._factory.createHypertyDataObjectSchema(t.cguid,t.version,t.objectName,t.description,t.language,t.sourcePackageURL,t.accessControlPolicy,t.scheme):this._factory.createMessageDataObjectSchema(t.cguid,t.version,t.objectName,t.description,t.language,t.sourcePackageURL),e.signature=t.signature;var r=t.sourcePackage;if(r){e.sourcePackage=this.createSourcePackage(r);try{e.sourcePackage.sourceCode=JSON.parse(e.sourcePackage.sourceCode)}catch(t){g.log(\"DataSchema Source code is already parsed\")}return e}return e}},{key:\"createIdpProxy\",value:function(t){var e=this._factory.createProtoStubDescriptorObject(t.cguid,t.version,t.objectName,t.description,t.language,t.sourcePackageURL,t.messageSchemas,t.configuration,t.constraints,t.hypertyType,t.dataObjects,t.interworking,t.idpProxy,t.mutualAuthentication);e.signature=t.signature;var r=t.sourcePackage;return r&&(r=this.createSourcePackage(r),e.sourcePackage=r),e}},{key:\"createSourcePackage\",value:function(t){\"base64\"===t.encoding&&(t.sourceCode=this.atob(t.sourceCode),t.encoding=\"utf-8\");var e=this._factory.createSourcePackage(t.sourceCodeClassname,t.sourceCode);return t.encoding&&(e.encoding=t.encoding),t.signature&&(e.signature=t.signature),e}},{key:\"getSourcePackageFromURL\",value:function(t){var e=this;return g.log(\"getting sourcePackage from:\",t),new c.default(function(r,n){e.httpRequest.get(t).then(function(t){if(t.ERROR)n(t);else{t=JSON.parse(t);var i=e.createSourcePackage(t);r(i)}}).catch(function(t){n(t)})})}},{key:\"getSourceCodeFromDescriptor\",value:function(t){var e=this;return new c.default(function(r,n){t.sourcePackage?r(t.sourcePackage.sourceCode):e.storageManager.getVersion(t.sourcePackageURL+\"/sourceCode\").then(function(i){i>=t.version?(g.log(\"returning cached version from storageManager\"),e.storageManager.get(t.sourcePackageURL+\"/sourceCode\").then(function(t){r(t)}).catch(function(t){n(t)})):e.httpRequest.get(t.sourcePackageURL+\"/sourceCode\").then(function(i){i.ERROR?n(i):(e.storageManager.set(t.sourcePackageURL+\"/sourceCode\",t.version,i),r(i))}).catch(function(t){n(t)})}).catch(function(t){n(t)})})}},{key:\"getTypeList\",value:function(t,e){var r=this;return new c.default(function(n,i){(void 0!=e?r.httpRequest.post(t,{body:(0,u.default)(e)}):r.httpRequest.get(t)).then(function(t){t=JSON.parse(t),n(t)}).catch(function(t){i(t)})})}},{key:\"deleteFromPM\",value:function(t){return this.storageManager.delete(t)}},{key:\"runtimeURL\",set:function(t){this._runtimeURL=t},get:function(){return this._runtimeURL}}]),t}();e.default=_,t.exports=e.default},function(t,e,r){\"use strict\";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(188),o=n(i),a=r(191),u=n(a);e.default=function(){function t(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=(0,u.default)(t);!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if((0,o.default)(Object(e)))return t(e,r);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}()},function(t,e,r){t.exports={default:r(189),__esModule:!0}},function(t,e,r){r(54),r(52),t.exports=r(190)},function(t,e,r){var n=r(63),i=r(2)(\"iterator\"),o=r(17);t.exports=r(0).isIterable=function(t){var e=Object(t);return void 0!==e[i]||\"@@iterator\"in e||o.hasOwnProperty(n(e))}},function(t,e,r){t.exports={default:r(192),__esModule:!0}},function(t,e,r){r(54),r(52),t.exports=r(193)},function(t,e,r){var n=r(9),i=r(101);t.exports=r(0).getIterator=function(t){var e=i(t);if(\"function\"!=typeof e)throw TypeError(t+\" is not iterable!\");return n(e.call(t))}}])});","// version: 0.9.0\n// date: Wed Aug 01 2018 09:34:34 GMT+0100 (Western European Summer Time)\n// licence: \n/**\n* Copyright 2016 PT Inovao e Sistemas SA\n* Copyright 2016 INESC-ID\n* Copyright 2016 QUOBIS NETWORKS SL\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n* Copyright 2016 ORANGE SA\n* Copyright 2016 Deutsche Telekom AG\n* Copyright 2016 Apizee\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n**/\n\n\n!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(\"StorageManager\",[],e):\"object\"==typeof exports?exports.StorageManager=e():(t[\"\"]=t[\"\"]||{},t[\"\"].StorageManager=e())}(\"undefined\"!=typeof self?self:this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\"a\",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=153)}([function(t,e){var n=t.exports={version:\"2.5.7\"};\"number\"==typeof __e&&(__e=n)},function(t,e){var n=t.exports=\"undefined\"!=typeof window&&window.Math==Math?window:\"undefined\"!=typeof self&&self.Math==Math?self:Function(\"return this\")();\"number\"==typeof __g&&(__g=n)},function(t,e,n){var r=n(36)(\"wks\"),o=n(23),i=n(1).Symbol,u=\"function\"==typeof i;(t.exports=function(t){return r[t]||(r[t]=u&&i[t]||(u?i:o)(\"Symbol.\"+t))}).store=r},function(t,e,n){\"use strict\";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}},function(t,e,n){t.exports=!n(13)(function(){return 7!=Object.defineProperty({},\"a\",{get:function(){return 7}}).a})},function(t,e,n){\"use strict\";e.__esModule=!0;var r=n(59),o=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),(0,o.default)(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()},function(t,e,n){var r=n(1),o=n(0),i=n(14),u=n(11),f=n(10),c=function(t,e,n){var a,s,l,p=t&c.F,v=t&c.G,y=t&c.S,d=t&c.P,h=t&c.B,g=t&c.W,b=v?o:o[e]||(o[e]={}),m=b.prototype,w=v?r:y?r[e]:(r[e]||{}).prototype;v&&(n=e);for(a in n)(s=!p&&w&&void 0!==w[a])&&f(b,a)||(l=s?w[a]:n[a],b[a]=v&&\"function\"!=typeof w[a]?n[a]:h&&s?i(l,r):g&&w[a]==l?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):d&&\"function\"==typeof l?i(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&c.R&&m&&!m[a]&&u(m,a,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,e){t.exports=function(t){return\"object\"==typeof t?null!==t:\"function\"==typeof t}},function(t,e,n){var r=n(9),o=n(39),i=n(27),u=Object.defineProperty;e.f=n(4)?Object.defineProperty:function(t,e,n){if(r(t),e=i(e,!0),r(n),o)try{return u(t,e,n)}catch(t){}if(\"get\"in n||\"set\"in n)throw TypeError(\"Accessors not supported!\");return\"value\"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(7);t.exports=function(t){if(!r(t))throw TypeError(t+\" is not an object!\");return t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(8),o=n(16);t.exports=n(4)?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(55),o=n(30);t.exports=function(t){return r(o(t))}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(24);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=!0},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){t.exports={}},,,function(t,e,n){var r=n(45),o=n(37);t.exports=Object.keys||function(t){return r(t,o)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var r,o;!function(i,u){\"use strict\";r=u,void 0!==(o=\"function\"==typeof r?r.call(e,n,e,t):r)&&(t.exports=o)}(0,function(){\"use strict\";function t(t,e){var n=t[e];if(\"function\"==typeof n.bind)return n.bind(t);try{return Function.prototype.bind.call(n,t)}catch(e){return function(){return Function.prototype.apply.apply(n,[t,arguments])}}}function e(e){return\"debug\"===e&&(e=\"log\"),typeof console!==f&&(void 0!==console[e]?t(console,e):void 0!==console.log?t(console,\"log\"):u)}function n(t,e){for(var n=0;n<c.length;n++){var r=c[n];this[r]=n<t?u:this.methodFactory(r,t,e)}this.log=this.debug}function r(t,e,r){return function(){typeof console!==f&&(n.call(this,e,r),this[t].apply(this,arguments))}}function o(t,n,o){return e(t)||r.apply(this,arguments)}function i(t,e,r){function i(t){var e=(c[t]||\"silent\").toUpperCase();if(typeof window!==f){try{return void(window.localStorage[l]=e)}catch(t){}try{window.document.cookie=encodeURIComponent(l)+\"=\"+e+\";\"}catch(t){}}}function u(){var t;if(typeof window!==f){try{t=window.localStorage[l]}catch(t){}if(typeof t===f)try{var e=window.document.cookie,n=e.indexOf(encodeURIComponent(l)+\"=\");-1!==n&&(t=/^([^;]+)/.exec(e.slice(n))[1])}catch(t){}return void 0===s.levels[t]&&(t=void 0),t}}var a,s=this,l=\"loglevel\";t&&(l+=\":\"+t),s.name=t,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=r||o,s.getLevel=function(){return a},s.setLevel=function(e,r){if(\"string\"==typeof e&&void 0!==s.levels[e.toUpperCase()]&&(e=s.levels[e.toUpperCase()]),!(\"number\"==typeof e&&e>=0&&e<=s.levels.SILENT))throw\"log.setLevel() called with invalid level: \"+e;if(a=e,!1!==r&&i(e),n.call(s,e,t),typeof console===f&&e<s.levels.SILENT)return\"No console available for logging\"},s.setDefaultLevel=function(t){u()||s.setLevel(t,!1)},s.enableAll=function(t){s.setLevel(s.levels.TRACE,t)},s.disableAll=function(t){s.setLevel(s.levels.SILENT,t)};var p=u();null==p&&(p=null==e?\"WARN\":e),s.setLevel(p,!1)}var u=function(){},f=\"undefined\",c=[\"trace\",\"debug\",\"info\",\"warn\",\"error\"],a=new i,s={};a.getLogger=function(t){if(\"string\"!=typeof t||\"\"===t)throw new TypeError(\"You must supply a name when creating a logger.\");var e=s[t];return e||(e=s[t]=new i(t,a.getLevel(),a.methodFactory)),e};var l=typeof window!==f?window.log:void 0;return a.noConflict=function(){return typeof window!==f&&window.log===a&&(window.log=l),a},a.getLoggers=function(){return s},a})},function(t,e){var n=0,r=Math.random();t.exports=function(t){return\"Symbol(\".concat(void 0===t?\"\":t,\")_\",(++n+r).toString(36))}},function(t,e){t.exports=function(t){if(\"function\"!=typeof t)throw TypeError(t+\" is not a function!\");return t}},,function(t,e,n){var r=n(8).f,o=n(10),i=n(2)(\"toStringTag\");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,i)&&r(t,i,{configurable:!0,value:e})}},function(t,e,n){var r=n(7);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&\"function\"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if(\"function\"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&\"function\"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError(\"Can't convert object to primitive value\")}},function(t,e,n){var r=n(7),o=n(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError(\"Can't call method on  \"+t);return t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(30);t.exports=function(t){return Object(r(t))}},,,function(t,e,n){var r=n(36)(\"keys\"),o=n(23);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,e,n){var r=n(0),o=n(1),i=o[\"__core-js_shared__\"]||(o[\"__core-js_shared__\"]={});(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})(\"versions\",[]).push({version:r.version,mode:n(15)?\"pure\":\"global\",copyright:\" 2018 Denis Pushkarev (zloirock.ru)\"})},function(t,e){t.exports=\"constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf\".split(\",\")},function(t,e,n){var r=n(9),o=n(72),i=n(37),u=n(35)(\"IE_PROTO\"),f=function(){},c=function(){var t,e=n(28)(\"iframe\"),r=i.length;for(e.style.display=\"none\",n(56).appendChild(e),e.src=\"javascript:\",t=e.contentWindow.document,t.open(),t.write(\"<script>document.F=Object<\\/script>\"),t.close(),c=t.F;r--;)delete c.prototype[i[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(f.prototype=r(t),n=new f,f.prototype=null,n[u]=t):n=c(),void 0===e?n:o(n,e)}},function(t,e,n){t.exports=!n(4)&&!n(13)(function(){return 7!=Object.defineProperty(n(28)(\"div\"),\"a\",{get:function(){return 7}}).a})},function(t,e,n){e.f=n(2)},function(t,e,n){var r=n(1),o=n(0),i=n(15),u=n(40),f=n(8).f;t.exports=function(t){var e=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});\"_\"==t.charAt(0)||t in e||f(e,t,{value:u.f(t)})}},function(t,e,n){t.exports={default:n(89),__esModule:!0}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(6),o=n(0),i=n(13);t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],u={};u[t]=e(n),r(r.S+r.F*i(function(){n(1)}),\"Object\",u)}},function(t,e,n){var r=n(10),o=n(12),i=n(64)(!1),u=n(35)(\"IE_PROTO\");t.exports=function(t,e){var n,f=o(t),c=0,a=[];for(n in f)n!=u&&r(f,n)&&a.push(n);for(;e.length>c;)r(f,n=e[c++])&&(~i(a,n)||a.push(n));return a}},function(t,e,n){var r=n(29),o=n(16),i=n(12),u=n(27),f=n(10),c=n(39),a=Object.getOwnPropertyDescriptor;e.f=n(4)?a:function(t,e){if(t=i(t),e=u(e,!0),c)try{return a(t,e)}catch(t){}if(f(t,e))return o(!r.f.call(t,e),t[e])}},function(t,e,n){\"use strict\";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=n(79),i=r(o),u=n(81),f=r(u),c=\"function\"==typeof f.default&&\"symbol\"==typeof i.default?function(t){return typeof t}:function(t){return t&&\"function\"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?\"symbol\":typeof t};e.default=\"function\"==typeof f.default&&\"symbol\"===c(i.default)?function(t){return void 0===t?\"undefined\":c(t)}:function(t){return t&&\"function\"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?\"symbol\":void 0===t?\"undefined\":c(t)}},function(t,e,n){\"use strict\";var r=n(15),o=n(6),i=n(50),u=n(11),f=n(17),c=n(71),a=n(26),s=n(53),l=n(2)(\"iterator\"),p=!([].keys&&\"next\"in[].keys()),v=function(){return this};t.exports=function(t,e,n,y,d,h,g){c(n,e,y);var b,m,w,O=function(t){if(!p&&t in j)return j[t];switch(t){case\"keys\":case\"values\":return function(){return new n(this,t)}}return function(){return new n(this,t)}},S=e+\" Iterator\",_=\"values\"==d,x=!1,j=t.prototype,P=j[l]||j[\"@@iterator\"]||d&&j[d],M=P||O(d),L=d?_?O(\"entries\"):M:void 0,T=\"Array\"==e?j.entries||P:P;if(T&&(w=s(T.call(new t)))!==Object.prototype&&w.next&&(a(w,S,!0),r||\"function\"==typeof w[l]||u(w,l,v)),_&&P&&\"values\"!==P.name&&(x=!0,M=function(){return P.call(this)}),r&&!g||!p&&!x&&j[l]||u(j,l,M),f[e]=M,f[S]=v,d)if(b={values:_?M:O(\"values\"),keys:h?M:O(\"keys\"),entries:L},g)for(m in b)m in j||i(j,m,b[m]);else o(o.P+o.F*(p||x),e,b);return b}},function(t,e,n){var r=n(31),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e,n){t.exports=n(11)},,function(t,e,n){\"use strict\";var r=n(70)(!0);n(48)(String,\"String\",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){var r=n(10),o=n(32),i=n(35)(\"IE_PROTO\"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:\"function\"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,e,n){n(73);for(var r=n(1),o=n(11),i=n(17),u=n(2)(\"toStringTag\"),f=\"CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList\".split(\",\"),c=0;c<f.length;c++){var a=f[c],s=r[a],l=s&&s.prototype;l&&!l[u]&&o(l,u,a),i[a]=i.Array}},function(t,e,n){var r=n(21);t.exports=Object(\"z\").propertyIsEnumerable(0)?Object:function(t){return\"String\"==r(t)?t.split(\"\"):Object(t)}},function(t,e,n){var r=n(1).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(45),o=n(37).concat(\"length\",\"prototype\");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},,function(t,e,n){t.exports={default:n(61),__esModule:!0}},function(t,e){},function(t,e,n){n(62);var r=n(0).Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},function(t,e,n){var r=n(6);r(r.S+r.F*!n(4),\"Object\",{defineProperty:n(8).f})},,function(t,e,n){var r=n(12),o=n(49),i=n(65);t.exports=function(t){return function(e,n,u){var f,c=r(e),a=o(c.length),s=i(u,a);if(t&&n!=n){for(;a>s;)if((f=c[s++])!=f)return!0}else for(;a>s;s++)if((t||s in c)&&c[s]===n)return t||s||0;return!t&&-1}}},function(t,e,n){var r=n(31),o=Math.max,i=Math.min;t.exports=function(t,e){return t=r(t),t<0?o(t+e,0):i(t,e)}},,,,,function(t,e,n){var r=n(31),o=n(30);t.exports=function(t){return function(e,n){var i,u,f=String(o(e)),c=r(n),a=f.length;return c<0||c>=a?t?\"\":void 0:(i=f.charCodeAt(c),i<55296||i>56319||c+1===a||(u=f.charCodeAt(c+1))<56320||u>57343?t?f.charAt(c):i:t?f.slice(c,c+2):u-56320+(i-55296<<10)+65536)}}},function(t,e,n){\"use strict\";var r=n(38),o=n(16),i=n(26),u={};n(11)(u,n(2)(\"iterator\"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(u,{next:o(1,n)}),i(t,e+\" Iterator\")}},function(t,e,n){var r=n(8),o=n(9),i=n(20);t.exports=n(4)?Object.defineProperties:function(t,e){o(t);for(var n,u=i(e),f=u.length,c=0;f>c;)r.f(t,n=u[c++],e[n]);return t}},function(t,e,n){\"use strict\";var r=n(74),o=n(75),i=n(17),u=n(12);t.exports=n(48)(Array,\"Array\",function(t,e){this._t=u(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,o(1)):\"keys\"==e?o(0,n):\"values\"==e?o(0,t[n]):o(0,[n,t[n]])},\"values\"),i.Arguments=i.Array,r(\"keys\"),r(\"values\"),r(\"entries\")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},,function(t,e,n){var r=n(23)(\"meta\"),o=n(7),i=n(10),u=n(8).f,f=0,c=Object.isExtensible||function(){return!0},a=!n(13)(function(){return c(Object.preventExtensions({}))}),s=function(t){u(t,r,{value:{i:\"O\"+ ++f,w:{}}})},l=function(t,e){if(!o(t))return\"symbol\"==typeof t?t:(\"string\"==typeof t?\"S\":\"P\")+t;if(!i(t,r)){if(!c(t))return\"F\";if(!e)return\"E\";s(t)}return t[r].i},p=function(t,e){if(!i(t,r)){if(!c(t))return!0;if(!e)return!1;s(t)}return t[r].w},v=function(t){return a&&y.NEED&&c(t)&&!i(t,r)&&s(t),t},y=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:p,onFreeze:v}},function(t,e,n){t.exports={default:n(119),__esModule:!0}},function(t,e,n){t.exports={default:n(80),__esModule:!0}},function(t,e,n){n(52),n(54),t.exports=n(40).f(\"iterator\")},function(t,e,n){t.exports={default:n(82),__esModule:!0}},function(t,e,n){n(83),n(60),n(87),n(88),t.exports=n(0).Symbol},function(t,e,n){\"use strict\";var r=n(1),o=n(10),i=n(4),u=n(6),f=n(50),c=n(77).KEY,a=n(13),s=n(36),l=n(26),p=n(23),v=n(2),y=n(40),d=n(41),h=n(84),g=n(85),b=n(9),m=n(7),w=n(12),O=n(27),S=n(16),_=n(38),x=n(86),j=n(46),P=n(8),M=n(20),L=j.f,T=P.f,E=x.f,k=r.Symbol,A=r.JSON,F=A&&A.stringify,N=v(\"_hidden\"),C=v(\"toPrimitive\"),I={}.propertyIsEnumerable,R=s(\"symbol-registry\"),D=s(\"symbols\"),G=s(\"op-symbols\"),K=Object.prototype,V=\"function\"==typeof k,W=r.QObject,U=!W||!W.prototype||!W.prototype.findChild,q=i&&a(function(){return 7!=_(T({},\"a\",{get:function(){return T(this,\"a\",{value:7}).a}})).a})?function(t,e,n){var r=L(K,e);r&&delete K[e],T(t,e,n),r&&t!==K&&T(K,e,r)}:T,B=function(t){var e=D[t]=_(k.prototype);return e._k=t,e},H=V&&\"symbol\"==typeof k.iterator?function(t){return\"symbol\"==typeof t}:function(t){return t instanceof k},J=function(t,e,n){return t===K&&J(G,e,n),b(t),e=O(e,!0),b(n),o(D,e)?(n.enumerable?(o(t,N)&&t[N][e]&&(t[N][e]=!1),n=_(n,{enumerable:S(0,!1)})):(o(t,N)||T(t,N,S(1,{})),t[N][e]=!0),q(t,e,n)):T(t,e,n)},Y=function(t,e){b(t);for(var n,r=h(e=w(e)),o=0,i=r.length;i>o;)J(t,n=r[o++],e[n]);return t},z=function(t,e){return void 0===e?_(t):Y(_(t),e)},Q=function(t){var e=I.call(this,t=O(t,!0));return!(this===K&&o(D,t)&&!o(G,t))&&(!(e||!o(this,t)||!o(D,t)||o(this,N)&&this[N][t])||e)},X=function(t,e){if(t=w(t),e=O(e,!0),t!==K||!o(D,e)||o(G,e)){var n=L(t,e);return!n||!o(D,e)||o(t,N)&&t[N][e]||(n.enumerable=!0),n}},Z=function(t){for(var e,n=E(w(t)),r=[],i=0;n.length>i;)o(D,e=n[i++])||e==N||e==c||r.push(e);return r},$=function(t){for(var e,n=t===K,r=E(n?G:w(t)),i=[],u=0;r.length>u;)!o(D,e=r[u++])||n&&!o(K,e)||i.push(D[e]);return i};V||(k=function(){if(this instanceof k)throw TypeError(\"Symbol is not a constructor!\");var t=p(arguments.length>0?arguments[0]:void 0),e=function(n){this===K&&e.call(G,n),o(this,N)&&o(this[N],t)&&(this[N][t]=!1),q(this,t,S(1,n))};return i&&U&&q(K,t,{configurable:!0,set:e}),B(t)},f(k.prototype,\"toString\",function(){return this._k}),j.f=X,P.f=J,n(57).f=x.f=Z,n(29).f=Q,n(43).f=$,i&&!n(15)&&f(K,\"propertyIsEnumerable\",Q,!0),y.f=function(t){return B(v(t))}),u(u.G+u.W+u.F*!V,{Symbol:k});for(var tt=\"hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables\".split(\",\"),et=0;tt.length>et;)v(tt[et++]);for(var nt=M(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!V,\"Symbol\",{for:function(t){return o(R,t+=\"\")?R[t]:R[t]=k(t)},keyFor:function(t){if(!H(t))throw TypeError(t+\" is not a symbol!\");for(var e in R)if(R[e]===t)return e},useSetter:function(){U=!0},useSimple:function(){U=!1}}),u(u.S+u.F*!V,\"Object\",{create:z,defineProperty:J,defineProperties:Y,getOwnPropertyDescriptor:X,getOwnPropertyNames:Z,getOwnPropertySymbols:$}),A&&u(u.S+u.F*(!V||a(function(){var t=k();return\"[null]\"!=F([t])||\"{}\"!=F({a:t})||\"{}\"!=F(Object(t))})),\"JSON\",{stringify:function(t){for(var e,n,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);if(n=e=r[1],(m(e)||void 0!==t)&&!H(t))return g(e)||(e=function(t,e){if(\"function\"==typeof n&&(e=n.call(this,t,e)),!H(e))return e}),r[1]=e,F.apply(A,r)}}),k.prototype[C]||n(11)(k.prototype,C,k.prototype.valueOf),l(k,\"Symbol\"),l(Math,\"Math\",!0),l(r.JSON,\"JSON\",!0)},function(t,e,n){var r=n(20),o=n(43),i=n(29);t.exports=function(t){var e=r(t),n=o.f;if(n)for(var u,f=n(t),c=i.f,a=0;f.length>a;)c.call(t,u=f[a++])&&e.push(u);return e}},function(t,e,n){var r=n(21);t.exports=Array.isArray||function(t){return\"Array\"==r(t)}},function(t,e,n){var r=n(12),o=n(57).f,i={}.toString,u=\"object\"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(t){try{return o(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&\"[object Window]\"==i.call(t)?f(t):o(r(t))}},function(t,e,n){n(41)(\"asyncIterator\")},function(t,e,n){n(41)(\"observable\")},function(t,e,n){n(90),t.exports=n(0).Object.keys},function(t,e,n){var r=n(32),o=n(20);n(44)(\"keys\",function(){return function(t){return o(r(t))}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){n(120),t.exports=n(0).Object.assign},function(t,e,n){var r=n(6);r(r.S+r.F,\"Object\",{assign:n(121)})},function(t,e,n){\"use strict\";var r=n(20),o=n(43),i=n(29),u=n(32),f=n(55),c=Object.assign;t.exports=!c||n(13)(function(){var t={},e={},n=Symbol(),r=\"abcdefghijklmnopqrst\";return t[n]=7,r.split(\"\").forEach(function(t){e[t]=t}),7!=c({},t)[n]||Object.keys(c({},e)).join(\"\")!=r})?function(t,e){for(var n=u(t),c=arguments.length,a=1,s=o.f,l=i.f;c>a;)for(var p,v=f(arguments[a++]),y=s?r(v).concat(s(v)):r(v),d=y.length,h=0;d>h;)l.call(v,p=y[h++])&&(n[p]=v[p]);return n}:c},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var r=n(22),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),i=n(154),u=function(t){return t&&t.__esModule?t:{default:t}}(i);o.getLogger(\"StorageManager\").setLevel(0),e.default=u.default,t.exports=e.default},function(t,e,n){\"use strict\";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,\"__esModule\",{value:!0});var o=n(155),i=r(o),u=n(42),f=r(u),c=n(47),a=r(c),s=n(78),l=r(s),p=n(3),v=r(p),y=n(5),d=r(y),h=n(22),g=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(h),b=g.getLogger(\"StorageManager\"),m=function(){function t(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if((0,v.default)(this,t),!e)throw Error(\"The Storage Manager needs the database instance\");if(!n)throw Error(\"The Storage Manager needs the storage name\");var i={};r?i=r:i[n]=\"key,version,value\",e.version(o).stores(i),e.open().then(function(t){b.info(\"Found database name \"+t.name+\" with version no: \"+t.verno)}).catch(b.error),this.db=e,this.storageName=n}return(0,d.default)(t,[{key:\"_checkKey\",value:function(t){return\"string\"!=typeof t?t.toString():t}},{key:\"_getTable\",value:function(t){var e=void 0;try{e=this.db.table(this.storageName).name}catch(n){e=this.db.table(t).name}return e}},{key:\"_getPrimaryKey\",value:function(t){return this.db.table(t).schema.primKey.name}},{key:\"_isDefaultSchema\",value:function(t){var e=this._getTable(t),n=this.db[e].schema.instanceTemplate;return n.hasOwnProperty(\"value\")&&n.hasOwnProperty(\"version\")&&n.hasOwnProperty(\"key\")}},{key:\"set\",value:function(t,e,n,r){b.info(\"[StorageManager] - set \",t,n),r=r||t;var o=this._getTable(r),i=this._getPrimaryKey(o),u=n;if(this._isDefaultSchema(r))u={key:t,version:e,value:n};else{var f={};f[i]=t,(0,l.default)(u,f)}return this.db[o].put(u)}},{key:\"get\",value:function(t,e,n){var r=this;console.info(\"[StorageManager] - get \",t,e),n=n||t;var o=this._getTable(n),u=this._getPrimaryKey(o);return this.db.transaction(\"rw!\",this.db[o],function(){if(!t&&!e)return r.db[o].toArray().then(function(t){return t.reduce(function(t,e){return t[e[u]]=e,t},{})});if(!e)return r.db[o].where(u).equals(t).first().then(function(t){return t&&t.hasOwnProperty(\"value\")?t.value:t});var n=void 0===e?\"undefined\":(0,a.default)(e);switch(Array.isArray(e)&&(n=\"array\"),n){case\"string\":return r.db[o].where(t).equals(e).first().then(function(t){return t&&t.hasOwnProperty(\"value\")?t.value:t});case\"object\":var c=\"value.\"+(0,f.default)(e).toString(),s=(0,i.default)(e);return console.log(c,s),r.db[o].where(c).anyOf(s).first().then(function(t){return t&&t.hasOwnProperty(\"value\")?t.value:t});case\"array\":return console.log(\"ARRAY:\",e),r.db[o].where(e).then(function(t){return t&&t.hasOwnProperty(\"value\")?t.value:t})}})}},{key:\"getVersion\",value:function(t,e,n){var r=this;b.info(\"[StorageManager] - getVersion for key \",t),n=n||t;var o=this._getTable(n),i=this._getPrimaryKey(o),u=e;return e||(u=t),this.db.transaction(\"rw!\",this.db[o],function(){return r.db[o].where(i).equals(u).first().then(function(t){return t&&t.hasOwnProperty(\"version\")?t.version:t}).catch(function(e){b.info(\"error getting the version for \",t,\" with error: \",e)})})}},{key:\"delete\",value:function(t,e,n){n=n||t;var r=this._getTable(n),o=this._getPrimaryKey(r),i=e;return e||(i=t),this.db[r].where(o).equals(i).delete()}}]),t}();e.default=m,t.exports=e.default},function(t,e,n){t.exports={default:n(156),__esModule:!0}},function(t,e,n){n(157),t.exports=n(0).Object.values},function(t,e,n){var r=n(6),o=n(158)(!1);r(r.S,\"Object\",{values:function(t){return o(t)}})},function(t,e,n){var r=n(20),o=n(12),i=n(29).f;t.exports=function(t){return function(e){for(var n,u=o(e),f=r(u),c=f.length,a=0,s=[];c>a;)i.call(u,n=f[a++])&&s.push(t?[n,u[n]]:u[n]);return s}}}])});","var nextTick = require('process/browser.js').nextTick;\nvar apply = Function.prototype.apply;\nvar slice = Array.prototype.slice;\nvar immediateIds = {};\nvar nextImmediateId = 0;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) { timeout.close(); };\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(window, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// That's not how node.js implements it but the exposed api is the same.\nexports.setImmediate = typeof setImmediate === \"function\" ? setImmediate : function(fn) {\n  var id = nextImmediateId++;\n  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n\n  immediateIds[id] = true;\n\n  nextTick(function onNextTick() {\n    if (immediateIds[id]) {\n      // fn.call() is faster so we optimize for the common use-case\n      // @see http://jsperf.com/call-apply-segu\n      if (args) {\n        fn.apply(null, args);\n      } else {\n        fn.call(null);\n      }\n      // Prevent ids from leaking\n      exports.clearImmediate(id);\n    }\n  });\n\n  return id;\n};\n\nexports.clearImmediate = typeof clearImmediate === \"function\" ? clearImmediate : function(id) {\n  delete immediateIds[id];\n};","/*!\n * URI.js - Mutating URLs\n * IPv6 Support\n *\n * Version: 1.19.1\n *\n * Author: Rodney Rehm\n * Web: http://medialize.github.io/URI.js/\n *\n * Licensed under\n *   MIT License http://www.opensource.org/licenses/mit-license\n *\n */\n\n(function (root, factory) {\n  'use strict';\n  // https://github.com/umdjs/umd/blob/master/returnExports.js\n  if (typeof module === 'object' && module.exports) {\n    // Node\n    module.exports = factory();\n  } else if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(factory);\n  } else {\n    // Browser globals (root is window)\n    root.IPv6 = factory(root);\n  }\n}(this, function (root) {\n  'use strict';\n\n  /*\n  var _in = \"fe80:0000:0000:0000:0204:61ff:fe9d:f156\";\n  var _out = IPv6.best(_in);\n  var _expected = \"fe80::204:61ff:fe9d:f156\";\n\n  console.log(_in, _out, _expected, _out === _expected);\n  */\n\n  // save current IPv6 variable, if any\n  var _IPv6 = root && root.IPv6;\n\n  function bestPresentation(address) {\n    // based on:\n    // Javascript to test an IPv6 address for proper format, and to\n    // present the \"best text representation\" according to IETF Draft RFC at\n    // http://tools.ietf.org/html/draft-ietf-6man-text-addr-representation-04\n    // 8 Feb 2010 Rich Brown, Dartware, LLC\n    // Please feel free to use this code as long as you provide a link to\n    // http://www.intermapper.com\n    // http://intermapper.com/support/tools/IPV6-Validator.aspx\n    // http://download.dartware.com/thirdparty/ipv6validator.js\n\n    var _address = address.toLowerCase();\n    var segments = _address.split(':');\n    var length = segments.length;\n    var total = 8;\n\n    // trim colons (:: or ::a:b:c or a:b:c::)\n    if (segments[0] === '' && segments[1] === '' && segments[2] === '') {\n      // must have been ::\n      // remove first two items\n      segments.shift();\n      segments.shift();\n    } else if (segments[0] === '' && segments[1] === '') {\n      // must have been ::xxxx\n      // remove the first item\n      segments.shift();\n    } else if (segments[length - 1] === '' && segments[length - 2] === '') {\n      // must have been xxxx::\n      segments.pop();\n    }\n\n    length = segments.length;\n\n    // adjust total segments for IPv4 trailer\n    if (segments[length - 1].indexOf('.') !== -1) {\n      // found a \".\" which means IPv4\n      total = 7;\n    }\n\n    // fill empty segments them with \"0000\"\n    var pos;\n    for (pos = 0; pos < length; pos++) {\n      if (segments[pos] === '') {\n        break;\n      }\n    }\n\n    if (pos < total) {\n      segments.splice(pos, 1, '0000');\n      while (segments.length < total) {\n        segments.splice(pos, 0, '0000');\n      }\n    }\n\n    // strip leading zeros\n    var _segments;\n    for (var i = 0; i < total; i++) {\n      _segments = segments[i].split('');\n      for (var j = 0; j < 3 ; j++) {\n        if (_segments[0] === '0' && _segments.length > 1) {\n          _segments.splice(0,1);\n        } else {\n          break;\n        }\n      }\n\n      segments[i] = _segments.join('');\n    }\n\n    // find longest sequence of zeroes and coalesce them into one segment\n    var best = -1;\n    var _best = 0;\n    var _current = 0;\n    var current = -1;\n    var inzeroes = false;\n    // i; already declared\n\n    for (i = 0; i < total; i++) {\n      if (inzeroes) {\n        if (segments[i] === '0') {\n          _current += 1;\n        } else {\n          inzeroes = false;\n          if (_current > _best) {\n            best = current;\n            _best = _current;\n          }\n        }\n      } else {\n        if (segments[i] === '0') {\n          inzeroes = true;\n          current = i;\n          _current = 1;\n        }\n      }\n    }\n\n    if (_current > _best) {\n      best = current;\n      _best = _current;\n    }\n\n    if (_best > 1) {\n      segments.splice(best, _best, '');\n    }\n\n    length = segments.length;\n\n    // assemble remaining segments\n    var result = '';\n    if (segments[0] === '')  {\n      result = ':';\n    }\n\n    for (i = 0; i < length; i++) {\n      result += segments[i];\n      if (i === length - 1) {\n        break;\n      }\n\n      result += ':';\n    }\n\n    if (segments[length - 1] === '') {\n      result += ':';\n    }\n\n    return result;\n  }\n\n  function noConflict() {\n    /*jshint validthis: true */\n    if (root.IPv6 === this) {\n      root.IPv6 = _IPv6;\n    }\n\n    return this;\n  }\n\n  return {\n    best: bestPresentation,\n    noConflict: noConflict\n  };\n}));\n","/*!\n * URI.js - Mutating URLs\n * Second Level Domain (SLD) Support\n *\n * Version: 1.19.1\n *\n * Author: Rodney Rehm\n * Web: http://medialize.github.io/URI.js/\n *\n * Licensed under\n *   MIT License http://www.opensource.org/licenses/mit-license\n *\n */\n\n(function (root, factory) {\n  'use strict';\n  // https://github.com/umdjs/umd/blob/master/returnExports.js\n  if (typeof module === 'object' && module.exports) {\n    // Node\n    module.exports = factory();\n  } else if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(factory);\n  } else {\n    // Browser globals (root is window)\n    root.SecondLevelDomains = factory(root);\n  }\n}(this, function (root) {\n  'use strict';\n\n  // save current SecondLevelDomains variable, if any\n  var _SecondLevelDomains = root && root.SecondLevelDomains;\n\n  var SLD = {\n    // list of known Second Level Domains\n    // converted list of SLDs from https://github.com/gavingmiller/second-level-domains\n    // ----\n    // publicsuffix.org is more current and actually used by a couple of browsers internally.\n    // downside is it also contains domains like \"dyndns.org\" - which is fine for the security\n    // issues browser have to deal with (SOP for cookies, etc) - but is way overboard for URI.js\n    // ----\n    list: {\n      'ac':' com gov mil net org ',\n      'ae':' ac co gov mil name net org pro sch ',\n      'af':' com edu gov net org ',\n      'al':' com edu gov mil net org ',\n      'ao':' co ed gv it og pb ',\n      'ar':' com edu gob gov int mil net org tur ',\n      'at':' ac co gv or ',\n      'au':' asn com csiro edu gov id net org ',\n      'ba':' co com edu gov mil net org rs unbi unmo unsa untz unze ',\n      'bb':' biz co com edu gov info net org store tv ',\n      'bh':' biz cc com edu gov info net org ',\n      'bn':' com edu gov net org ',\n      'bo':' com edu gob gov int mil net org tv ',\n      'br':' adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ',\n      'bs':' com edu gov net org ',\n      'bz':' du et om ov rg ',\n      'ca':' ab bc mb nb nf nl ns nt nu on pe qc sk yk ',\n      'ck':' biz co edu gen gov info net org ',\n      'cn':' ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ',\n      'co':' com edu gov mil net nom org ',\n      'cr':' ac c co ed fi go or sa ',\n      'cy':' ac biz com ekloges gov ltd name net org parliament press pro tm ',\n      'do':' art com edu gob gov mil net org sld web ',\n      'dz':' art asso com edu gov net org pol ',\n      'ec':' com edu fin gov info med mil net org pro ',\n      'eg':' com edu eun gov mil name net org sci ',\n      'er':' com edu gov ind mil net org rochest w ',\n      'es':' com edu gob nom org ',\n      'et':' biz com edu gov info name net org ',\n      'fj':' ac biz com info mil name net org pro ',\n      'fk':' ac co gov net nom org ',\n      'fr':' asso com f gouv nom prd presse tm ',\n      'gg':' co net org ',\n      'gh':' com edu gov mil org ',\n      'gn':' ac com gov net org ',\n      'gr':' com edu gov mil net org ',\n      'gt':' com edu gob ind mil net org ',\n      'gu':' com edu gov net org ',\n      'hk':' com edu gov idv net org ',\n      'hu':' 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ',\n      'id':' ac co go mil net or sch web ',\n      'il':' ac co gov idf k12 muni net org ',\n      'in':' ac co edu ernet firm gen gov i ind mil net nic org res ',\n      'iq':' com edu gov i mil net org ',\n      'ir':' ac co dnssec gov i id net org sch ',\n      'it':' edu gov ',\n      'je':' co net org ',\n      'jo':' com edu gov mil name net org sch ',\n      'jp':' ac ad co ed go gr lg ne or ',\n      'ke':' ac co go info me mobi ne or sc ',\n      'kh':' com edu gov mil net org per ',\n      'ki':' biz com de edu gov info mob net org tel ',\n      'km':' asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ',\n      'kn':' edu gov net org ',\n      'kr':' ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ',\n      'kw':' com edu gov net org ',\n      'ky':' com edu gov net org ',\n      'kz':' com edu gov mil net org ',\n      'lb':' com edu gov net org ',\n      'lk':' assn com edu gov grp hotel int ltd net ngo org sch soc web ',\n      'lr':' com edu gov net org ',\n      'lv':' asn com conf edu gov id mil net org ',\n      'ly':' com edu gov id med net org plc sch ',\n      'ma':' ac co gov m net org press ',\n      'mc':' asso tm ',\n      'me':' ac co edu gov its net org priv ',\n      'mg':' com edu gov mil nom org prd tm ',\n      'mk':' com edu gov inf name net org pro ',\n      'ml':' com edu gov net org presse ',\n      'mn':' edu gov org ',\n      'mo':' com edu gov net org ',\n      'mt':' com edu gov net org ',\n      'mv':' aero biz com coop edu gov info int mil museum name net org pro ',\n      'mw':' ac co com coop edu gov int museum net org ',\n      'mx':' com edu gob net org ',\n      'my':' com edu gov mil name net org sch ',\n      'nf':' arts com firm info net other per rec store web ',\n      'ng':' biz com edu gov mil mobi name net org sch ',\n      'ni':' ac co com edu gob mil net nom org ',\n      'np':' com edu gov mil net org ',\n      'nr':' biz com edu gov info net org ',\n      'om':' ac biz co com edu gov med mil museum net org pro sch ',\n      'pe':' com edu gob mil net nom org sld ',\n      'ph':' com edu gov i mil net ngo org ',\n      'pk':' biz com edu fam gob gok gon gop gos gov net org web ',\n      'pl':' art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ',\n      'pr':' ac biz com edu est gov info isla name net org pro prof ',\n      'ps':' com edu gov net org plo sec ',\n      'pw':' belau co ed go ne or ',\n      'ro':' arts com firm info nom nt org rec store tm www ',\n      'rs':' ac co edu gov in org ',\n      'sb':' com edu gov net org ',\n      'sc':' com edu gov net org ',\n      'sh':' co com edu gov net nom org ',\n      'sl':' com edu gov net org ',\n      'st':' co com consulado edu embaixada gov mil net org principe saotome store ',\n      'sv':' com edu gob org red ',\n      'sz':' ac co org ',\n      'tr':' av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ',\n      'tt':' aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ',\n      'tw':' club com ebiz edu game gov idv mil net org ',\n      'mu':' ac co com gov net or org ',\n      'mz':' ac co edu gov org ',\n      'na':' co com ',\n      'nz':' ac co cri geek gen govt health iwi maori mil net org parliament school ',\n      'pa':' abo ac com edu gob ing med net nom org sld ',\n      'pt':' com edu gov int net nome org publ ',\n      'py':' com edu gov mil net org ',\n      'qa':' com edu gov mil net org ',\n      're':' asso com nom ',\n      'ru':' ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ',\n      'rw':' ac co com edu gouv gov int mil net ',\n      'sa':' com edu gov med net org pub sch ',\n      'sd':' com edu gov info med net org tv ',\n      'se':' a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ',\n      'sg':' com edu gov idn net org per ',\n      'sn':' art com edu gouv org perso univ ',\n      'sy':' com edu gov mil net news org ',\n      'th':' ac co go in mi net or ',\n      'tj':' ac biz co com edu go gov info int mil name net nic org test web ',\n      'tn':' agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ',\n      'tz':' ac co go ne or ',\n      'ua':' biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ',\n      'ug':' ac co go ne or org sc ',\n      'uk':' ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ',\n      'us':' dni fed isa kids nsn ',\n      'uy':' com edu gub mil net org ',\n      've':' co com edu gob info mil net org web ',\n      'vi':' co com k12 net org ',\n      'vn':' ac biz com edu gov health info int name net org pro ',\n      'ye':' co com gov ltd me net org plc ',\n      'yu':' ac co edu gov org ',\n      'za':' ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ',\n      'zm':' ac co com edu gov net org sch ',\n      // https://en.wikipedia.org/wiki/CentralNic#Second-level_domains\n      'com': 'ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ',\n      'net': 'gb jp se uk ',\n      'org': 'ae',\n      'de': 'com '\n    },\n    // gorhill 2013-10-25: Using indexOf() instead Regexp(). Significant boost\n    // in both performance and memory footprint. No initialization required.\n    // http://jsperf.com/uri-js-sld-regex-vs-binary-search/4\n    // Following methods use lastIndexOf() rather than array.split() in order\n    // to avoid any memory allocations.\n    has: function(domain) {\n      var tldOffset = domain.lastIndexOf('.');\n      if (tldOffset <= 0 || tldOffset >= (domain.length-1)) {\n        return false;\n      }\n      var sldOffset = domain.lastIndexOf('.', tldOffset-1);\n      if (sldOffset <= 0 || sldOffset >= (tldOffset-1)) {\n        return false;\n      }\n      var sldList = SLD.list[domain.slice(tldOffset+1)];\n      if (!sldList) {\n        return false;\n      }\n      return sldList.indexOf(' ' + domain.slice(sldOffset+1, tldOffset) + ' ') >= 0;\n    },\n    is: function(domain) {\n      var tldOffset = domain.lastIndexOf('.');\n      if (tldOffset <= 0 || tldOffset >= (domain.length-1)) {\n        return false;\n      }\n      var sldOffset = domain.lastIndexOf('.', tldOffset-1);\n      if (sldOffset >= 0) {\n        return false;\n      }\n      var sldList = SLD.list[domain.slice(tldOffset+1)];\n      if (!sldList) {\n        return false;\n      }\n      return sldList.indexOf(' ' + domain.slice(0, tldOffset) + ' ') >= 0;\n    },\n    get: function(domain) {\n      var tldOffset = domain.lastIndexOf('.');\n      if (tldOffset <= 0 || tldOffset >= (domain.length-1)) {\n        return null;\n      }\n      var sldOffset = domain.lastIndexOf('.', tldOffset-1);\n      if (sldOffset <= 0 || sldOffset >= (tldOffset-1)) {\n        return null;\n      }\n      var sldList = SLD.list[domain.slice(tldOffset+1)];\n      if (!sldList) {\n        return null;\n      }\n      if (sldList.indexOf(' ' + domain.slice(sldOffset+1, tldOffset) + ' ') < 0) {\n        return null;\n      }\n      return domain.slice(sldOffset+1);\n    },\n    noConflict: function(){\n      if (root.SecondLevelDomains === this) {\n        root.SecondLevelDomains = _SecondLevelDomains;\n      }\n      return this;\n    }\n  };\n\n  return SLD;\n}));\n","/*!\n * URI.js - Mutating URLs\n *\n * Version: 1.19.1\n *\n * Author: Rodney Rehm\n * Web: http://medialize.github.io/URI.js/\n *\n * Licensed under\n *   MIT License http://www.opensource.org/licenses/mit-license\n *\n */\n(function (root, factory) {\n  'use strict';\n  // https://github.com/umdjs/umd/blob/master/returnExports.js\n  if (typeof module === 'object' && module.exports) {\n    // Node\n    module.exports = factory(require('./punycode'), require('./IPv6'), require('./SecondLevelDomains'));\n  } else if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(['./punycode', './IPv6', './SecondLevelDomains'], factory);\n  } else {\n    // Browser globals (root is window)\n    root.URI = factory(root.punycode, root.IPv6, root.SecondLevelDomains, root);\n  }\n}(this, function (punycode, IPv6, SLD, root) {\n  'use strict';\n  /*global location, escape, unescape */\n  // FIXME: v2.0.0 renamce non-camelCase properties to uppercase\n  /*jshint camelcase: false */\n\n  // save current URI variable, if any\n  var _URI = root && root.URI;\n\n  function URI(url, base) {\n    var _urlSupplied = arguments.length >= 1;\n    var _baseSupplied = arguments.length >= 2;\n\n    // Allow instantiation without the 'new' keyword\n    if (!(this instanceof URI)) {\n      if (_urlSupplied) {\n        if (_baseSupplied) {\n          return new URI(url, base);\n        }\n\n        return new URI(url);\n      }\n\n      return new URI();\n    }\n\n    if (url === undefined) {\n      if (_urlSupplied) {\n        throw new TypeError('undefined is not a valid argument for URI');\n      }\n\n      if (typeof location !== 'undefined') {\n        url = location.href + '';\n      } else {\n        url = '';\n      }\n    }\n\n    if (url === null) {\n      if (_urlSupplied) {\n        throw new TypeError('null is not a valid argument for URI');\n      }\n    }\n\n    this.href(url);\n\n    // resolve to base according to http://dvcs.w3.org/hg/url/raw-file/tip/Overview.html#constructor\n    if (base !== undefined) {\n      return this.absoluteTo(base);\n    }\n\n    return this;\n  }\n\n  function isInteger(value) {\n    return /^[0-9]+$/.test(value);\n  }\n\n  URI.version = '1.19.1';\n\n  var p = URI.prototype;\n  var hasOwn = Object.prototype.hasOwnProperty;\n\n  function escapeRegEx(string) {\n    // https://github.com/medialize/URI.js/commit/85ac21783c11f8ccab06106dba9735a31a86924d#commitcomment-821963\n    return string.replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g, '\\\\$1');\n  }\n\n  function getType(value) {\n    // IE8 doesn't return [Object Undefined] but [Object Object] for undefined value\n    if (value === undefined) {\n      return 'Undefined';\n    }\n\n    return String(Object.prototype.toString.call(value)).slice(8, -1);\n  }\n\n  function isArray(obj) {\n    return getType(obj) === 'Array';\n  }\n\n  function filterArrayValues(data, value) {\n    var lookup = {};\n    var i, length;\n\n    if (getType(value) === 'RegExp') {\n      lookup = null;\n    } else if (isArray(value)) {\n      for (i = 0, length = value.length; i < length; i++) {\n        lookup[value[i]] = true;\n      }\n    } else {\n      lookup[value] = true;\n    }\n\n    for (i = 0, length = data.length; i < length; i++) {\n      /*jshint laxbreak: true */\n      var _match = lookup && lookup[data[i]] !== undefined\n        || !lookup && value.test(data[i]);\n      /*jshint laxbreak: false */\n      if (_match) {\n        data.splice(i, 1);\n        length--;\n        i--;\n      }\n    }\n\n    return data;\n  }\n\n  function arrayContains(list, value) {\n    var i, length;\n\n    // value may be string, number, array, regexp\n    if (isArray(value)) {\n      // Note: this can be optimized to O(n) (instead of current O(m * n))\n      for (i = 0, length = value.length; i < length; i++) {\n        if (!arrayContains(list, value[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    var _type = getType(value);\n    for (i = 0, length = list.length; i < length; i++) {\n      if (_type === 'RegExp') {\n        if (typeof list[i] === 'string' && list[i].match(value)) {\n          return true;\n        }\n      } else if (list[i] === value) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function arraysEqual(one, two) {\n    if (!isArray(one) || !isArray(two)) {\n      return false;\n    }\n\n    // arrays can't be equal if they have different amount of content\n    if (one.length !== two.length) {\n      return false;\n    }\n\n    one.sort();\n    two.sort();\n\n    for (var i = 0, l = one.length; i < l; i++) {\n      if (one[i] !== two[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  function trimSlashes(text) {\n    var trim_expression = /^\\/+|\\/+$/g;\n    return text.replace(trim_expression, '');\n  }\n\n  URI._parts = function() {\n    return {\n      protocol: null,\n      username: null,\n      password: null,\n      hostname: null,\n      urn: null,\n      port: null,\n      path: null,\n      query: null,\n      fragment: null,\n      // state\n      preventInvalidHostname: URI.preventInvalidHostname,\n      duplicateQueryParameters: URI.duplicateQueryParameters,\n      escapeQuerySpace: URI.escapeQuerySpace\n    };\n  };\n  // state: throw on invalid hostname\n  // see https://github.com/medialize/URI.js/pull/345\n  // and https://github.com/medialize/URI.js/issues/354\n  URI.preventInvalidHostname = false;\n  // state: allow duplicate query parameters (a=1&a=1)\n  URI.duplicateQueryParameters = false;\n  // state: replaces + with %20 (space in query strings)\n  URI.escapeQuerySpace = true;\n  // static properties\n  URI.protocol_expression = /^[a-z][a-z0-9.+-]*$/i;\n  URI.idn_expression = /[^a-z0-9\\._-]/i;\n  URI.punycode_expression = /(xn--)/i;\n  // well, 333.444.555.666 matches, but it sure ain't no IPv4 - do we care?\n  URI.ip4_expression = /^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/;\n  // credits to Rich Brown\n  // source: http://forums.intermapper.com/viewtopic.php?p=1096#1096\n  // specification: http://www.ietf.org/rfc/rfc4291.txt\n  URI.ip6_expression = /^\\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?\\s*$/;\n  // expression used is \"gruber revised\" (@gruber v2) determined to be the\n  // best solution in a regex-golf we did a couple of ages ago at\n  // * http://mathiasbynens.be/demo/url-regex\n  // * http://rodneyrehm.de/t/url-regex.html\n  URI.find_uri_expression = /\\b((?:[a-z][\\w-]+:(?:\\/{1,3}|[a-z0-9%])|www\\d{0,3}[.]|[a-z0-9.\\-]+[.][a-z]{2,4}\\/)(?:[^\\s()<>]+|\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\))+(?:\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\)|[^\\s`!()\\[\\]{};:'\".,<>?]))/ig;\n  URI.findUri = {\n    // valid \"scheme://\" or \"www.\"\n    start: /\\b(?:([a-z][a-z0-9.+-]*:\\/\\/)|www\\.)/gi,\n    // everything up to the next whitespace\n    end: /[\\s\\r\\n]|$/,\n    // trim trailing punctuation captured by end RegExp\n    trim: /[`!()\\[\\]{};:'\".,<>?]+$/,\n    // balanced parens inclusion (), [], {}, <>\n    parens: /(\\([^\\)]*\\)|\\[[^\\]]*\\]|\\{[^}]*\\}|<[^>]*>)/g,\n  };\n  // http://www.iana.org/assignments/uri-schemes.html\n  // http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers#Well-known_ports\n  URI.defaultPorts = {\n    http: '80',\n    https: '443',\n    ftp: '21',\n    gopher: '70',\n    ws: '80',\n    wss: '443'\n  };\n  // list of protocols which always require a hostname\n  URI.hostProtocols = [\n    'http',\n    'https'\n  ];\n\n  // allowed hostname characters according to RFC 3986\n  // ALPHA DIGIT \"-\" \".\" \"_\" \"~\" \"!\" \"$\" \"&\" \"'\" \"(\" \")\" \"*\" \"+\" \",\" \";\" \"=\" %encoded\n  // I've never seen a (non-IDN) hostname other than: ALPHA DIGIT . - _\n  URI.invalid_hostname_characters = /[^a-zA-Z0-9\\.\\-:_]/;\n  // map DOM Elements to their URI attribute\n  URI.domAttributes = {\n    'a': 'href',\n    'blockquote': 'cite',\n    'link': 'href',\n    'base': 'href',\n    'script': 'src',\n    'form': 'action',\n    'img': 'src',\n    'area': 'href',\n    'iframe': 'src',\n    'embed': 'src',\n    'source': 'src',\n    'track': 'src',\n    'input': 'src', // but only if type=\"image\"\n    'audio': 'src',\n    'video': 'src'\n  };\n  URI.getDomAttribute = function(node) {\n    if (!node || !node.nodeName) {\n      return undefined;\n    }\n\n    var nodeName = node.nodeName.toLowerCase();\n    // <input> should only expose src for type=\"image\"\n    if (nodeName === 'input' && node.type !== 'image') {\n      return undefined;\n    }\n\n    return URI.domAttributes[nodeName];\n  };\n\n  function escapeForDumbFirefox36(value) {\n    // https://github.com/medialize/URI.js/issues/91\n    return escape(value);\n  }\n\n  // encoding / decoding according to RFC3986\n  function strictEncodeURIComponent(string) {\n    // see https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent\n    return encodeURIComponent(string)\n      .replace(/[!'()*]/g, escapeForDumbFirefox36)\n      .replace(/\\*/g, '%2A');\n  }\n  URI.encode = strictEncodeURIComponent;\n  URI.decode = decodeURIComponent;\n  URI.iso8859 = function() {\n    URI.encode = escape;\n    URI.decode = unescape;\n  };\n  URI.unicode = function() {\n    URI.encode = strictEncodeURIComponent;\n    URI.decode = decodeURIComponent;\n  };\n  URI.characters = {\n    pathname: {\n      encode: {\n        // RFC3986 2.1: For consistency, URI producers and normalizers should\n        // use uppercase hexadecimal digits for all percent-encodings.\n        expression: /%(24|26|2B|2C|3B|3D|3A|40)/ig,\n        map: {\n          // -._~!'()*\n          '%24': '$',\n          '%26': '&',\n          '%2B': '+',\n          '%2C': ',',\n          '%3B': ';',\n          '%3D': '=',\n          '%3A': ':',\n          '%40': '@'\n        }\n      },\n      decode: {\n        expression: /[\\/\\?#]/g,\n        map: {\n          '/': '%2F',\n          '?': '%3F',\n          '#': '%23'\n        }\n      }\n    },\n    reserved: {\n      encode: {\n        // RFC3986 2.1: For consistency, URI producers and normalizers should\n        // use uppercase hexadecimal digits for all percent-encodings.\n        expression: /%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,\n        map: {\n          // gen-delims\n          '%3A': ':',\n          '%2F': '/',\n          '%3F': '?',\n          '%23': '#',\n          '%5B': '[',\n          '%5D': ']',\n          '%40': '@',\n          // sub-delims\n          '%21': '!',\n          '%24': '$',\n          '%26': '&',\n          '%27': '\\'',\n          '%28': '(',\n          '%29': ')',\n          '%2A': '*',\n          '%2B': '+',\n          '%2C': ',',\n          '%3B': ';',\n          '%3D': '='\n        }\n      }\n    },\n    urnpath: {\n      // The characters under `encode` are the characters called out by RFC 2141 as being acceptable\n      // for usage in a URN. RFC2141 also calls out \"-\", \".\", and \"_\" as acceptable characters, but\n      // these aren't encoded by encodeURIComponent, so we don't have to call them out here. Also\n      // note that the colon character is not featured in the encoding map; this is because URI.js\n      // gives the colons in URNs semantic meaning as the delimiters of path segements, and so it\n      // should not appear unencoded in a segment itself.\n      // See also the note above about RFC3986 and capitalalized hex digits.\n      encode: {\n        expression: /%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/ig,\n        map: {\n          '%21': '!',\n          '%24': '$',\n          '%27': '\\'',\n          '%28': '(',\n          '%29': ')',\n          '%2A': '*',\n          '%2B': '+',\n          '%2C': ',',\n          '%3B': ';',\n          '%3D': '=',\n          '%40': '@'\n        }\n      },\n      // These characters are the characters called out by RFC2141 as \"reserved\" characters that\n      // should never appear in a URN, plus the colon character (see note above).\n      decode: {\n        expression: /[\\/\\?#:]/g,\n        map: {\n          '/': '%2F',\n          '?': '%3F',\n          '#': '%23',\n          ':': '%3A'\n        }\n      }\n    }\n  };\n  URI.encodeQuery = function(string, escapeQuerySpace) {\n    var escaped = URI.encode(string + '');\n    if (escapeQuerySpace === undefined) {\n      escapeQuerySpace = URI.escapeQuerySpace;\n    }\n\n    return escapeQuerySpace ? escaped.replace(/%20/g, '+') : escaped;\n  };\n  URI.decodeQuery = function(string, escapeQuerySpace) {\n    string += '';\n    if (escapeQuerySpace === undefined) {\n      escapeQuerySpace = URI.escapeQuerySpace;\n    }\n\n    try {\n      return URI.decode(escapeQuerySpace ? string.replace(/\\+/g, '%20') : string);\n    } catch(e) {\n      // we're not going to mess with weird encodings,\n      // give up and return the undecoded original string\n      // see https://github.com/medialize/URI.js/issues/87\n      // see https://github.com/medialize/URI.js/issues/92\n      return string;\n    }\n  };\n  // generate encode/decode path functions\n  var _parts = {'encode':'encode', 'decode':'decode'};\n  var _part;\n  var generateAccessor = function(_group, _part) {\n    return function(string) {\n      try {\n        return URI[_part](string + '').replace(URI.characters[_group][_part].expression, function(c) {\n          return URI.characters[_group][_part].map[c];\n        });\n      } catch (e) {\n        // we're not going to mess with weird encodings,\n        // give up and return the undecoded original string\n        // see https://github.com/medialize/URI.js/issues/87\n        // see https://github.com/medialize/URI.js/issues/92\n        return string;\n      }\n    };\n  };\n\n  for (_part in _parts) {\n    URI[_part + 'PathSegment'] = generateAccessor('pathname', _parts[_part]);\n    URI[_part + 'UrnPathSegment'] = generateAccessor('urnpath', _parts[_part]);\n  }\n\n  var generateSegmentedPathFunction = function(_sep, _codingFuncName, _innerCodingFuncName) {\n    return function(string) {\n      // Why pass in names of functions, rather than the function objects themselves? The\n      // definitions of some functions (but in particular, URI.decode) will occasionally change due\n      // to URI.js having ISO8859 and Unicode modes. Passing in the name and getting it will ensure\n      // that the functions we use here are \"fresh\".\n      var actualCodingFunc;\n      if (!_innerCodingFuncName) {\n        actualCodingFunc = URI[_codingFuncName];\n      } else {\n        actualCodingFunc = function(string) {\n          return URI[_codingFuncName](URI[_innerCodingFuncName](string));\n        };\n      }\n\n      var segments = (string + '').split(_sep);\n\n      for (var i = 0, length = segments.length; i < length; i++) {\n        segments[i] = actualCodingFunc(segments[i]);\n      }\n\n      return segments.join(_sep);\n    };\n  };\n\n  // This takes place outside the above loop because we don't want, e.g., encodeUrnPath functions.\n  URI.decodePath = generateSegmentedPathFunction('/', 'decodePathSegment');\n  URI.decodeUrnPath = generateSegmentedPathFunction(':', 'decodeUrnPathSegment');\n  URI.recodePath = generateSegmentedPathFunction('/', 'encodePathSegment', 'decode');\n  URI.recodeUrnPath = generateSegmentedPathFunction(':', 'encodeUrnPathSegment', 'decode');\n\n  URI.encodeReserved = generateAccessor('reserved', 'encode');\n\n  URI.parse = function(string, parts) {\n    var pos;\n    if (!parts) {\n      parts = {\n        preventInvalidHostname: URI.preventInvalidHostname\n      };\n    }\n    // [protocol\"://\"[username[\":\"password]\"@\"]hostname[\":\"port]\"/\"?][path][\"?\"querystring][\"#\"fragment]\n\n    // extract fragment\n    pos = string.indexOf('#');\n    if (pos > -1) {\n      // escaping?\n      parts.fragment = string.substring(pos + 1) || null;\n      string = string.substring(0, pos);\n    }\n\n    // extract query\n    pos = string.indexOf('?');\n    if (pos > -1) {\n      // escaping?\n      parts.query = string.substring(pos + 1) || null;\n      string = string.substring(0, pos);\n    }\n\n    // extract protocol\n    if (string.substring(0, 2) === '//') {\n      // relative-scheme\n      parts.protocol = null;\n      string = string.substring(2);\n      // extract \"user:pass@host:port\"\n      string = URI.parseAuthority(string, parts);\n    } else {\n      pos = string.indexOf(':');\n      if (pos > -1) {\n        parts.protocol = string.substring(0, pos) || null;\n        if (parts.protocol && !parts.protocol.match(URI.protocol_expression)) {\n          // : may be within the path\n          parts.protocol = undefined;\n        } else if (string.substring(pos + 1, pos + 3) === '//') {\n          string = string.substring(pos + 3);\n\n          // extract \"user:pass@host:port\"\n          string = URI.parseAuthority(string, parts);\n        } else {\n          string = string.substring(pos + 1);\n          parts.urn = true;\n        }\n      }\n    }\n\n    // what's left must be the path\n    parts.path = string;\n\n    // and we're done\n    return parts;\n  };\n  URI.parseHost = function(string, parts) {\n    if (!string) {\n      string = '';\n    }\n\n    // Copy chrome, IE, opera backslash-handling behavior.\n    // Back slashes before the query string get converted to forward slashes\n    // See: https://github.com/joyent/node/blob/386fd24f49b0e9d1a8a076592a404168faeecc34/lib/url.js#L115-L124\n    // See: https://code.google.com/p/chromium/issues/detail?id=25916\n    // https://github.com/medialize/URI.js/pull/233\n    string = string.replace(/\\\\/g, '/');\n\n    // extract host:port\n    var pos = string.indexOf('/');\n    var bracketPos;\n    var t;\n\n    if (pos === -1) {\n      pos = string.length;\n    }\n\n    if (string.charAt(0) === '[') {\n      // IPv6 host - http://tools.ietf.org/html/draft-ietf-6man-text-addr-representation-04#section-6\n      // I claim most client software breaks on IPv6 anyways. To simplify things, URI only accepts\n      // IPv6+port in the format [2001:db8::1]:80 (for the time being)\n      bracketPos = string.indexOf(']');\n      parts.hostname = string.substring(1, bracketPos) || null;\n      parts.port = string.substring(bracketPos + 2, pos) || null;\n      if (parts.port === '/') {\n        parts.port = null;\n      }\n    } else {\n      var firstColon = string.indexOf(':');\n      var firstSlash = string.indexOf('/');\n      var nextColon = string.indexOf(':', firstColon + 1);\n      if (nextColon !== -1 && (firstSlash === -1 || nextColon < firstSlash)) {\n        // IPv6 host contains multiple colons - but no port\n        // this notation is actually not allowed by RFC 3986, but we're a liberal parser\n        parts.hostname = string.substring(0, pos) || null;\n        parts.port = null;\n      } else {\n        t = string.substring(0, pos).split(':');\n        parts.hostname = t[0] || null;\n        parts.port = t[1] || null;\n      }\n    }\n\n    if (parts.hostname && string.substring(pos).charAt(0) !== '/') {\n      pos++;\n      string = '/' + string;\n    }\n\n    if (parts.preventInvalidHostname) {\n      URI.ensureValidHostname(parts.hostname, parts.protocol);\n    }\n\n    if (parts.port) {\n      URI.ensureValidPort(parts.port);\n    }\n\n    return string.substring(pos) || '/';\n  };\n  URI.parseAuthority = function(string, parts) {\n    string = URI.parseUserinfo(string, parts);\n    return URI.parseHost(string, parts);\n  };\n  URI.parseUserinfo = function(string, parts) {\n    // extract username:password\n    var firstSlash = string.indexOf('/');\n    var pos = string.lastIndexOf('@', firstSlash > -1 ? firstSlash : string.length - 1);\n    var t;\n\n    // authority@ must come before /path\n    if (pos > -1 && (firstSlash === -1 || pos < firstSlash)) {\n      t = string.substring(0, pos).split(':');\n      parts.username = t[0] ? URI.decode(t[0]) : null;\n      t.shift();\n      parts.password = t[0] ? URI.decode(t.join(':')) : null;\n      string = string.substring(pos + 1);\n    } else {\n      parts.username = null;\n      parts.password = null;\n    }\n\n    return string;\n  };\n  URI.parseQuery = function(string, escapeQuerySpace) {\n    if (!string) {\n      return {};\n    }\n\n    // throw out the funky business - \"?\"[name\"=\"value\"&\"]+\n    string = string.replace(/&+/g, '&').replace(/^\\?*&*|&+$/g, '');\n\n    if (!string) {\n      return {};\n    }\n\n    var items = {};\n    var splits = string.split('&');\n    var length = splits.length;\n    var v, name, value;\n\n    for (var i = 0; i < length; i++) {\n      v = splits[i].split('=');\n      name = URI.decodeQuery(v.shift(), escapeQuerySpace);\n      // no \"=\" is null according to http://dvcs.w3.org/hg/url/raw-file/tip/Overview.html#collect-url-parameters\n      value = v.length ? URI.decodeQuery(v.join('='), escapeQuerySpace) : null;\n\n      if (hasOwn.call(items, name)) {\n        if (typeof items[name] === 'string' || items[name] === null) {\n          items[name] = [items[name]];\n        }\n\n        items[name].push(value);\n      } else {\n        items[name] = value;\n      }\n    }\n\n    return items;\n  };\n\n  URI.build = function(parts) {\n    var t = '';\n\n    if (parts.protocol) {\n      t += parts.protocol + ':';\n    }\n\n    if (!parts.urn && (t || parts.hostname)) {\n      t += '//';\n    }\n\n    t += (URI.buildAuthority(parts) || '');\n\n    if (typeof parts.path === 'string') {\n      if (parts.path.charAt(0) !== '/' && typeof parts.hostname === 'string') {\n        t += '/';\n      }\n\n      t += parts.path;\n    }\n\n    if (typeof parts.query === 'string' && parts.query) {\n      t += '?' + parts.query;\n    }\n\n    if (typeof parts.fragment === 'string' && parts.fragment) {\n      t += '#' + parts.fragment;\n    }\n    return t;\n  };\n  URI.buildHost = function(parts) {\n    var t = '';\n\n    if (!parts.hostname) {\n      return '';\n    } else if (URI.ip6_expression.test(parts.hostname)) {\n      t += '[' + parts.hostname + ']';\n    } else {\n      t += parts.hostname;\n    }\n\n    if (parts.port) {\n      t += ':' + parts.port;\n    }\n\n    return t;\n  };\n  URI.buildAuthority = function(parts) {\n    return URI.buildUserinfo(parts) + URI.buildHost(parts);\n  };\n  URI.buildUserinfo = function(parts) {\n    var t = '';\n\n    if (parts.username) {\n      t += URI.encode(parts.username);\n    }\n\n    if (parts.password) {\n      t += ':' + URI.encode(parts.password);\n    }\n\n    if (t) {\n      t += '@';\n    }\n\n    return t;\n  };\n  URI.buildQuery = function(data, duplicateQueryParameters, escapeQuerySpace) {\n    // according to http://tools.ietf.org/html/rfc3986 or http://labs.apache.org/webarch/uri/rfc/rfc3986.html\n    // being -._~!$&'()*+,;=:@/? %HEX and alnum are allowed\n    // the RFC explicitly states ?/foo being a valid use case, no mention of parameter syntax!\n    // URI.js treats the query string as being application/x-www-form-urlencoded\n    // see http://www.w3.org/TR/REC-html40/interact/forms.html#form-content-type\n\n    var t = '';\n    var unique, key, i, length;\n    for (key in data) {\n      if (hasOwn.call(data, key) && key) {\n        if (isArray(data[key])) {\n          unique = {};\n          for (i = 0, length = data[key].length; i < length; i++) {\n            if (data[key][i] !== undefined && unique[data[key][i] + ''] === undefined) {\n              t += '&' + URI.buildQueryParameter(key, data[key][i], escapeQuerySpace);\n              if (duplicateQueryParameters !== true) {\n                unique[data[key][i] + ''] = true;\n              }\n            }\n          }\n        } else if (data[key] !== undefined) {\n          t += '&' + URI.buildQueryParameter(key, data[key], escapeQuerySpace);\n        }\n      }\n    }\n\n    return t.substring(1);\n  };\n  URI.buildQueryParameter = function(name, value, escapeQuerySpace) {\n    // http://www.w3.org/TR/REC-html40/interact/forms.html#form-content-type -- application/x-www-form-urlencoded\n    // don't append \"=\" for null values, according to http://dvcs.w3.org/hg/url/raw-file/tip/Overview.html#url-parameter-serialization\n    return URI.encodeQuery(name, escapeQuerySpace) + (value !== null ? '=' + URI.encodeQuery(value, escapeQuerySpace) : '');\n  };\n\n  URI.addQuery = function(data, name, value) {\n    if (typeof name === 'object') {\n      for (var key in name) {\n        if (hasOwn.call(name, key)) {\n          URI.addQuery(data, key, name[key]);\n        }\n      }\n    } else if (typeof name === 'string') {\n      if (data[name] === undefined) {\n        data[name] = value;\n        return;\n      } else if (typeof data[name] === 'string') {\n        data[name] = [data[name]];\n      }\n\n      if (!isArray(value)) {\n        value = [value];\n      }\n\n      data[name] = (data[name] || []).concat(value);\n    } else {\n      throw new TypeError('URI.addQuery() accepts an object, string as the name parameter');\n    }\n  };\n\n  URI.setQuery = function(data, name, value) {\n    if (typeof name === 'object') {\n      for (var key in name) {\n        if (hasOwn.call(name, key)) {\n          URI.setQuery(data, key, name[key]);\n        }\n      }\n    } else if (typeof name === 'string') {\n      data[name] = value === undefined ? null : value;\n    } else {\n      throw new TypeError('URI.setQuery() accepts an object, string as the name parameter');\n    }\n  };\n\n  URI.removeQuery = function(data, name, value) {\n    var i, length, key;\n\n    if (isArray(name)) {\n      for (i = 0, length = name.length; i < length; i++) {\n        data[name[i]] = undefined;\n      }\n    } else if (getType(name) === 'RegExp') {\n      for (key in data) {\n        if (name.test(key)) {\n          data[key] = undefined;\n        }\n      }\n    } else if (typeof name === 'object') {\n      for (key in name) {\n        if (hasOwn.call(name, key)) {\n          URI.removeQuery(data, key, name[key]);\n        }\n      }\n    } else if (typeof name === 'string') {\n      if (value !== undefined) {\n        if (getType(value) === 'RegExp') {\n          if (!isArray(data[name]) && value.test(data[name])) {\n            data[name] = undefined;\n          } else {\n            data[name] = filterArrayValues(data[name], value);\n          }\n        } else if (data[name] === String(value) && (!isArray(value) || value.length === 1)) {\n          data[name] = undefined;\n        } else if (isArray(data[name])) {\n          data[name] = filterArrayValues(data[name], value);\n        }\n      } else {\n        data[name] = undefined;\n      }\n    } else {\n      throw new TypeError('URI.removeQuery() accepts an object, string, RegExp as the first parameter');\n    }\n  };\n  URI.hasQuery = function(data, name, value, withinArray) {\n    switch (getType(name)) {\n      case 'String':\n        // Nothing to do here\n        break;\n\n      case 'RegExp':\n        for (var key in data) {\n          if (hasOwn.call(data, key)) {\n            if (name.test(key) && (value === undefined || URI.hasQuery(data, key, value))) {\n              return true;\n            }\n          }\n        }\n\n        return false;\n\n      case 'Object':\n        for (var _key in name) {\n          if (hasOwn.call(name, _key)) {\n            if (!URI.hasQuery(data, _key, name[_key])) {\n              return false;\n            }\n          }\n        }\n\n        return true;\n\n      default:\n        throw new TypeError('URI.hasQuery() accepts a string, regular expression or object as the name parameter');\n    }\n\n    switch (getType(value)) {\n      case 'Undefined':\n        // true if exists (but may be empty)\n        return name in data; // data[name] !== undefined;\n\n      case 'Boolean':\n        // true if exists and non-empty\n        var _booly = Boolean(isArray(data[name]) ? data[name].length : data[name]);\n        return value === _booly;\n\n      case 'Function':\n        // allow complex comparison\n        return !!value(data[name], name, data);\n\n      case 'Array':\n        if (!isArray(data[name])) {\n          return false;\n        }\n\n        var op = withinArray ? arrayContains : arraysEqual;\n        return op(data[name], value);\n\n      case 'RegExp':\n        if (!isArray(data[name])) {\n          return Boolean(data[name] && data[name].match(value));\n        }\n\n        if (!withinArray) {\n          return false;\n        }\n\n        return arrayContains(data[name], value);\n\n      case 'Number':\n        value = String(value);\n        /* falls through */\n      case 'String':\n        if (!isArray(data[name])) {\n          return data[name] === value;\n        }\n\n        if (!withinArray) {\n          return false;\n        }\n\n        return arrayContains(data[name], value);\n\n      default:\n        throw new TypeError('URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter');\n    }\n  };\n\n\n  URI.joinPaths = function() {\n    var input = [];\n    var segments = [];\n    var nonEmptySegments = 0;\n\n    for (var i = 0; i < arguments.length; i++) {\n      var url = new URI(arguments[i]);\n      input.push(url);\n      var _segments = url.segment();\n      for (var s = 0; s < _segments.length; s++) {\n        if (typeof _segments[s] === 'string') {\n          segments.push(_segments[s]);\n        }\n\n        if (_segments[s]) {\n          nonEmptySegments++;\n        }\n      }\n    }\n\n    if (!segments.length || !nonEmptySegments) {\n      return new URI('');\n    }\n\n    var uri = new URI('').segment(segments);\n\n    if (input[0].path() === '' || input[0].path().slice(0, 1) === '/') {\n      uri.path('/' + uri.path());\n    }\n\n    return uri.normalize();\n  };\n\n  URI.commonPath = function(one, two) {\n    var length = Math.min(one.length, two.length);\n    var pos;\n\n    // find first non-matching character\n    for (pos = 0; pos < length; pos++) {\n      if (one.charAt(pos) !== two.charAt(pos)) {\n        pos--;\n        break;\n      }\n    }\n\n    if (pos < 1) {\n      return one.charAt(0) === two.charAt(0) && one.charAt(0) === '/' ? '/' : '';\n    }\n\n    // revert to last /\n    if (one.charAt(pos) !== '/' || two.charAt(pos) !== '/') {\n      pos = one.substring(0, pos).lastIndexOf('/');\n    }\n\n    return one.substring(0, pos + 1);\n  };\n\n  URI.withinString = function(string, callback, options) {\n    options || (options = {});\n    var _start = options.start || URI.findUri.start;\n    var _end = options.end || URI.findUri.end;\n    var _trim = options.trim || URI.findUri.trim;\n    var _parens = options.parens || URI.findUri.parens;\n    var _attributeOpen = /[a-z0-9-]=[\"']?$/i;\n\n    _start.lastIndex = 0;\n    while (true) {\n      var match = _start.exec(string);\n      if (!match) {\n        break;\n      }\n\n      var start = match.index;\n      if (options.ignoreHtml) {\n        // attribut(e=[\"']?$)\n        var attributeOpen = string.slice(Math.max(start - 3, 0), start);\n        if (attributeOpen && _attributeOpen.test(attributeOpen)) {\n          continue;\n        }\n      }\n\n      var end = start + string.slice(start).search(_end);\n      var slice = string.slice(start, end);\n      // make sure we include well balanced parens\n      var parensEnd = -1;\n      while (true) {\n        var parensMatch = _parens.exec(slice);\n        if (!parensMatch) {\n          break;\n        }\n\n        var parensMatchEnd = parensMatch.index + parensMatch[0].length;\n        parensEnd = Math.max(parensEnd, parensMatchEnd);\n      }\n\n      if (parensEnd > -1) {\n        slice = slice.slice(0, parensEnd) + slice.slice(parensEnd).replace(_trim, '');\n      } else {\n        slice = slice.replace(_trim, '');\n      }\n\n      if (slice.length <= match[0].length) {\n        // the extract only contains the starting marker of a URI,\n        // e.g. \"www\" or \"http://\"\n        continue;\n      }\n\n      if (options.ignore && options.ignore.test(slice)) {\n        continue;\n      }\n\n      end = start + slice.length;\n      var result = callback(slice, start, end, string);\n      if (result === undefined) {\n        _start.lastIndex = end;\n        continue;\n      }\n\n      result = String(result);\n      string = string.slice(0, start) + result + string.slice(end);\n      _start.lastIndex = start + result.length;\n    }\n\n    _start.lastIndex = 0;\n    return string;\n  };\n\n  URI.ensureValidHostname = function(v, protocol) {\n    // Theoretically URIs allow percent-encoding in Hostnames (according to RFC 3986)\n    // they are not part of DNS and therefore ignored by URI.js\n\n    var hasHostname = !!v; // not null and not an empty string\n    var hasProtocol = !!protocol;\n    var rejectEmptyHostname = false;\n\n    if (hasProtocol) {\n      rejectEmptyHostname = arrayContains(URI.hostProtocols, protocol);\n    }\n\n    if (rejectEmptyHostname && !hasHostname) {\n      throw new TypeError('Hostname cannot be empty, if protocol is ' + protocol);\n    } else if (v && v.match(URI.invalid_hostname_characters)) {\n      // test punycode\n      if (!punycode) {\n        throw new TypeError('Hostname \"' + v + '\" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');\n      }\n      if (punycode.toASCII(v).match(URI.invalid_hostname_characters)) {\n        throw new TypeError('Hostname \"' + v + '\" contains characters other than [A-Z0-9.-:_]');\n      }\n    }\n  };\n\n  URI.ensureValidPort = function (v) {\n    if (!v) {\n      return;\n    }\n\n    var port = Number(v);\n    if (isInteger(port) && (port > 0) && (port < 65536)) {\n      return;\n    }\n\n    throw new TypeError('Port \"' + v + '\" is not a valid port');\n  };\n\n  // noConflict\n  URI.noConflict = function(removeAll) {\n    if (removeAll) {\n      var unconflicted = {\n        URI: this.noConflict()\n      };\n\n      if (root.URITemplate && typeof root.URITemplate.noConflict === 'function') {\n        unconflicted.URITemplate = root.URITemplate.noConflict();\n      }\n\n      if (root.IPv6 && typeof root.IPv6.noConflict === 'function') {\n        unconflicted.IPv6 = root.IPv6.noConflict();\n      }\n\n      if (root.SecondLevelDomains && typeof root.SecondLevelDomains.noConflict === 'function') {\n        unconflicted.SecondLevelDomains = root.SecondLevelDomains.noConflict();\n      }\n\n      return unconflicted;\n    } else if (root.URI === this) {\n      root.URI = _URI;\n    }\n\n    return this;\n  };\n\n  p.build = function(deferBuild) {\n    if (deferBuild === true) {\n      this._deferred_build = true;\n    } else if (deferBuild === undefined || this._deferred_build) {\n      this._string = URI.build(this._parts);\n      this._deferred_build = false;\n    }\n\n    return this;\n  };\n\n  p.clone = function() {\n    return new URI(this);\n  };\n\n  p.valueOf = p.toString = function() {\n    return this.build(false)._string;\n  };\n\n\n  function generateSimpleAccessor(_part){\n    return function(v, build) {\n      if (v === undefined) {\n        return this._parts[_part] || '';\n      } else {\n        this._parts[_part] = v || null;\n        this.build(!build);\n        return this;\n      }\n    };\n  }\n\n  function generatePrefixAccessor(_part, _key){\n    return function(v, build) {\n      if (v === undefined) {\n        return this._parts[_part] || '';\n      } else {\n        if (v !== null) {\n          v = v + '';\n          if (v.charAt(0) === _key) {\n            v = v.substring(1);\n          }\n        }\n\n        this._parts[_part] = v;\n        this.build(!build);\n        return this;\n      }\n    };\n  }\n\n  p.protocol = generateSimpleAccessor('protocol');\n  p.username = generateSimpleAccessor('username');\n  p.password = generateSimpleAccessor('password');\n  p.hostname = generateSimpleAccessor('hostname');\n  p.port = generateSimpleAccessor('port');\n  p.query = generatePrefixAccessor('query', '?');\n  p.fragment = generatePrefixAccessor('fragment', '#');\n\n  p.search = function(v, build) {\n    var t = this.query(v, build);\n    return typeof t === 'string' && t.length ? ('?' + t) : t;\n  };\n  p.hash = function(v, build) {\n    var t = this.fragment(v, build);\n    return typeof t === 'string' && t.length ? ('#' + t) : t;\n  };\n\n  p.pathname = function(v, build) {\n    if (v === undefined || v === true) {\n      var res = this._parts.path || (this._parts.hostname ? '/' : '');\n      return v ? (this._parts.urn ? URI.decodeUrnPath : URI.decodePath)(res) : res;\n    } else {\n      if (this._parts.urn) {\n        this._parts.path = v ? URI.recodeUrnPath(v) : '';\n      } else {\n        this._parts.path = v ? URI.recodePath(v) : '/';\n      }\n      this.build(!build);\n      return this;\n    }\n  };\n  p.path = p.pathname;\n  p.href = function(href, build) {\n    var key;\n\n    if (href === undefined) {\n      return this.toString();\n    }\n\n    this._string = '';\n    this._parts = URI._parts();\n\n    var _URI = href instanceof URI;\n    var _object = typeof href === 'object' && (href.hostname || href.path || href.pathname);\n    if (href.nodeName) {\n      var attribute = URI.getDomAttribute(href);\n      href = href[attribute] || '';\n      _object = false;\n    }\n\n    // window.location is reported to be an object, but it's not the sort\n    // of object we're looking for:\n    // * location.protocol ends with a colon\n    // * location.query != object.search\n    // * location.hash != object.fragment\n    // simply serializing the unknown object should do the trick\n    // (for location, not for everything...)\n    if (!_URI && _object && href.pathname !== undefined) {\n      href = href.toString();\n    }\n\n    if (typeof href === 'string' || href instanceof String) {\n      this._parts = URI.parse(String(href), this._parts);\n    } else if (_URI || _object) {\n      var src = _URI ? href._parts : href;\n      for (key in src) {\n        if (key === 'query') { continue; }\n        if (hasOwn.call(this._parts, key)) {\n          this._parts[key] = src[key];\n        }\n      }\n      if (src.query) {\n        this.query(src.query, false);\n      }\n    } else {\n      throw new TypeError('invalid input');\n    }\n\n    this.build(!build);\n    return this;\n  };\n\n  // identification accessors\n  p.is = function(what) {\n    var ip = false;\n    var ip4 = false;\n    var ip6 = false;\n    var name = false;\n    var sld = false;\n    var idn = false;\n    var punycode = false;\n    var relative = !this._parts.urn;\n\n    if (this._parts.hostname) {\n      relative = false;\n      ip4 = URI.ip4_expression.test(this._parts.hostname);\n      ip6 = URI.ip6_expression.test(this._parts.hostname);\n      ip = ip4 || ip6;\n      name = !ip;\n      sld = name && SLD && SLD.has(this._parts.hostname);\n      idn = name && URI.idn_expression.test(this._parts.hostname);\n      punycode = name && URI.punycode_expression.test(this._parts.hostname);\n    }\n\n    switch (what.toLowerCase()) {\n      case 'relative':\n        return relative;\n\n      case 'absolute':\n        return !relative;\n\n      // hostname identification\n      case 'domain':\n      case 'name':\n        return name;\n\n      case 'sld':\n        return sld;\n\n      case 'ip':\n        return ip;\n\n      case 'ip4':\n      case 'ipv4':\n      case 'inet4':\n        return ip4;\n\n      case 'ip6':\n      case 'ipv6':\n      case 'inet6':\n        return ip6;\n\n      case 'idn':\n        return idn;\n\n      case 'url':\n        return !this._parts.urn;\n\n      case 'urn':\n        return !!this._parts.urn;\n\n      case 'punycode':\n        return punycode;\n    }\n\n    return null;\n  };\n\n  // component specific input validation\n  var _protocol = p.protocol;\n  var _port = p.port;\n  var _hostname = p.hostname;\n\n  p.protocol = function(v, build) {\n    if (v) {\n      // accept trailing ://\n      v = v.replace(/:(\\/\\/)?$/, '');\n\n      if (!v.match(URI.protocol_expression)) {\n        throw new TypeError('Protocol \"' + v + '\" contains characters other than [A-Z0-9.+-] or doesn\\'t start with [A-Z]');\n      }\n    }\n\n    return _protocol.call(this, v, build);\n  };\n  p.scheme = p.protocol;\n  p.port = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v !== undefined) {\n      if (v === 0) {\n        v = null;\n      }\n\n      if (v) {\n        v += '';\n        if (v.charAt(0) === ':') {\n          v = v.substring(1);\n        }\n\n        URI.ensureValidPort(v);\n      }\n    }\n    return _port.call(this, v, build);\n  };\n  p.hostname = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v !== undefined) {\n      var x = { preventInvalidHostname: this._parts.preventInvalidHostname };\n      var res = URI.parseHost(v, x);\n      if (res !== '/') {\n        throw new TypeError('Hostname \"' + v + '\" contains characters other than [A-Z0-9.-]');\n      }\n\n      v = x.hostname;\n      if (this._parts.preventInvalidHostname) {\n        URI.ensureValidHostname(v, this._parts.protocol);\n      }\n    }\n\n    return _hostname.call(this, v, build);\n  };\n\n  // compound accessors\n  p.origin = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined) {\n      var protocol = this.protocol();\n      var authority = this.authority();\n      if (!authority) {\n        return '';\n      }\n\n      return (protocol ? protocol + '://' : '') + this.authority();\n    } else {\n      var origin = URI(v);\n      this\n        .protocol(origin.protocol())\n        .authority(origin.authority())\n        .build(!build);\n      return this;\n    }\n  };\n  p.host = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined) {\n      return this._parts.hostname ? URI.buildHost(this._parts) : '';\n    } else {\n      var res = URI.parseHost(v, this._parts);\n      if (res !== '/') {\n        throw new TypeError('Hostname \"' + v + '\" contains characters other than [A-Z0-9.-]');\n      }\n\n      this.build(!build);\n      return this;\n    }\n  };\n  p.authority = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined) {\n      return this._parts.hostname ? URI.buildAuthority(this._parts) : '';\n    } else {\n      var res = URI.parseAuthority(v, this._parts);\n      if (res !== '/') {\n        throw new TypeError('Hostname \"' + v + '\" contains characters other than [A-Z0-9.-]');\n      }\n\n      this.build(!build);\n      return this;\n    }\n  };\n  p.userinfo = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined) {\n      var t = URI.buildUserinfo(this._parts);\n      return t ? t.substring(0, t.length -1) : t;\n    } else {\n      if (v[v.length-1] !== '@') {\n        v += '@';\n      }\n\n      URI.parseUserinfo(v, this._parts);\n      this.build(!build);\n      return this;\n    }\n  };\n  p.resource = function(v, build) {\n    var parts;\n\n    if (v === undefined) {\n      return this.path() + this.search() + this.hash();\n    }\n\n    parts = URI.parse(v);\n    this._parts.path = parts.path;\n    this._parts.query = parts.query;\n    this._parts.fragment = parts.fragment;\n    this.build(!build);\n    return this;\n  };\n\n  // fraction accessors\n  p.subdomain = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    // convenience, return \"www\" from \"www.example.org\"\n    if (v === undefined) {\n      if (!this._parts.hostname || this.is('IP')) {\n        return '';\n      }\n\n      // grab domain and add another segment\n      var end = this._parts.hostname.length - this.domain().length - 1;\n      return this._parts.hostname.substring(0, end) || '';\n    } else {\n      var e = this._parts.hostname.length - this.domain().length;\n      var sub = this._parts.hostname.substring(0, e);\n      var replace = new RegExp('^' + escapeRegEx(sub));\n\n      if (v && v.charAt(v.length - 1) !== '.') {\n        v += '.';\n      }\n\n      if (v.indexOf(':') !== -1) {\n        throw new TypeError('Domains cannot contain colons');\n      }\n\n      if (v) {\n        URI.ensureValidHostname(v, this._parts.protocol);\n      }\n\n      this._parts.hostname = this._parts.hostname.replace(replace, v);\n      this.build(!build);\n      return this;\n    }\n  };\n  p.domain = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (typeof v === 'boolean') {\n      build = v;\n      v = undefined;\n    }\n\n    // convenience, return \"example.org\" from \"www.example.org\"\n    if (v === undefined) {\n      if (!this._parts.hostname || this.is('IP')) {\n        return '';\n      }\n\n      // if hostname consists of 1 or 2 segments, it must be the domain\n      var t = this._parts.hostname.match(/\\./g);\n      if (t && t.length < 2) {\n        return this._parts.hostname;\n      }\n\n      // grab tld and add another segment\n      var end = this._parts.hostname.length - this.tld(build).length - 1;\n      end = this._parts.hostname.lastIndexOf('.', end -1) + 1;\n      return this._parts.hostname.substring(end) || '';\n    } else {\n      if (!v) {\n        throw new TypeError('cannot set domain empty');\n      }\n\n      if (v.indexOf(':') !== -1) {\n        throw new TypeError('Domains cannot contain colons');\n      }\n\n      URI.ensureValidHostname(v, this._parts.protocol);\n\n      if (!this._parts.hostname || this.is('IP')) {\n        this._parts.hostname = v;\n      } else {\n        var replace = new RegExp(escapeRegEx(this.domain()) + '$');\n        this._parts.hostname = this._parts.hostname.replace(replace, v);\n      }\n\n      this.build(!build);\n      return this;\n    }\n  };\n  p.tld = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (typeof v === 'boolean') {\n      build = v;\n      v = undefined;\n    }\n\n    // return \"org\" from \"www.example.org\"\n    if (v === undefined) {\n      if (!this._parts.hostname || this.is('IP')) {\n        return '';\n      }\n\n      var pos = this._parts.hostname.lastIndexOf('.');\n      var tld = this._parts.hostname.substring(pos + 1);\n\n      if (build !== true && SLD && SLD.list[tld.toLowerCase()]) {\n        return SLD.get(this._parts.hostname) || tld;\n      }\n\n      return tld;\n    } else {\n      var replace;\n\n      if (!v) {\n        throw new TypeError('cannot set TLD empty');\n      } else if (v.match(/[^a-zA-Z0-9-]/)) {\n        if (SLD && SLD.is(v)) {\n          replace = new RegExp(escapeRegEx(this.tld()) + '$');\n          this._parts.hostname = this._parts.hostname.replace(replace, v);\n        } else {\n          throw new TypeError('TLD \"' + v + '\" contains characters other than [A-Z0-9]');\n        }\n      } else if (!this._parts.hostname || this.is('IP')) {\n        throw new ReferenceError('cannot set TLD on non-domain host');\n      } else {\n        replace = new RegExp(escapeRegEx(this.tld()) + '$');\n        this._parts.hostname = this._parts.hostname.replace(replace, v);\n      }\n\n      this.build(!build);\n      return this;\n    }\n  };\n  p.directory = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined || v === true) {\n      if (!this._parts.path && !this._parts.hostname) {\n        return '';\n      }\n\n      if (this._parts.path === '/') {\n        return '/';\n      }\n\n      var end = this._parts.path.length - this.filename().length - 1;\n      var res = this._parts.path.substring(0, end) || (this._parts.hostname ? '/' : '');\n\n      return v ? URI.decodePath(res) : res;\n\n    } else {\n      var e = this._parts.path.length - this.filename().length;\n      var directory = this._parts.path.substring(0, e);\n      var replace = new RegExp('^' + escapeRegEx(directory));\n\n      // fully qualifier directories begin with a slash\n      if (!this.is('relative')) {\n        if (!v) {\n          v = '/';\n        }\n\n        if (v.charAt(0) !== '/') {\n          v = '/' + v;\n        }\n      }\n\n      // directories always end with a slash\n      if (v && v.charAt(v.length - 1) !== '/') {\n        v += '/';\n      }\n\n      v = URI.recodePath(v);\n      this._parts.path = this._parts.path.replace(replace, v);\n      this.build(!build);\n      return this;\n    }\n  };\n  p.filename = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (typeof v !== 'string') {\n      if (!this._parts.path || this._parts.path === '/') {\n        return '';\n      }\n\n      var pos = this._parts.path.lastIndexOf('/');\n      var res = this._parts.path.substring(pos+1);\n\n      return v ? URI.decodePathSegment(res) : res;\n    } else {\n      var mutatedDirectory = false;\n\n      if (v.charAt(0) === '/') {\n        v = v.substring(1);\n      }\n\n      if (v.match(/\\.?\\//)) {\n        mutatedDirectory = true;\n      }\n\n      var replace = new RegExp(escapeRegEx(this.filename()) + '$');\n      v = URI.recodePath(v);\n      this._parts.path = this._parts.path.replace(replace, v);\n\n      if (mutatedDirectory) {\n        this.normalizePath(build);\n      } else {\n        this.build(!build);\n      }\n\n      return this;\n    }\n  };\n  p.suffix = function(v, build) {\n    if (this._parts.urn) {\n      return v === undefined ? '' : this;\n    }\n\n    if (v === undefined || v === true) {\n      if (!this._parts.path || this._parts.path === '/') {\n        return '';\n      }\n\n      var filename = this.filename();\n      var pos = filename.lastIndexOf('.');\n      var s, res;\n\n      if (pos === -1) {\n        return '';\n      }\n\n      // suffix may only contain alnum characters (yup, I made this up.)\n      s = filename.substring(pos+1);\n      res = (/^[a-z0-9%]+$/i).test(s) ? s : '';\n      return v ? URI.decodePathSegment(res) : res;\n    } else {\n      if (v.charAt(0) === '.') {\n        v = v.substring(1);\n      }\n\n      var suffix = this.suffix();\n      var replace;\n\n      if (!suffix) {\n        if (!v) {\n          return this;\n        }\n\n        this._parts.path += '.' + URI.recodePath(v);\n      } else if (!v) {\n        replace = new RegExp(escapeRegEx('.' + suffix) + '$');\n      } else {\n        replace = new RegExp(escapeRegEx(suffix) + '$');\n      }\n\n      if (replace) {\n        v = URI.recodePath(v);\n        this._parts.path = this._parts.path.replace(replace, v);\n      }\n\n      this.build(!build);\n      return this;\n    }\n  };\n  p.segment = function(segment, v, build) {\n    var separator = this._parts.urn ? ':' : '/';\n    var path = this.path();\n    var absolute = path.substring(0, 1) === '/';\n    var segments = path.split(separator);\n\n    if (segment !== undefined && typeof segment !== 'number') {\n      build = v;\n      v = segment;\n      segment = undefined;\n    }\n\n    if (segment !== undefined && typeof segment !== 'number') {\n      throw new Error('Bad segment \"' + segment + '\", must be 0-based integer');\n    }\n\n    if (absolute) {\n      segments.shift();\n    }\n\n    if (segment < 0) {\n      // allow negative indexes to address from the end\n      segment = Math.max(segments.length + segment, 0);\n    }\n\n    if (v === undefined) {\n      /*jshint laxbreak: true */\n      return segment === undefined\n        ? segments\n        : segments[segment];\n      /*jshint laxbreak: false */\n    } else if (segment === null || segments[segment] === undefined) {\n      if (isArray(v)) {\n        segments = [];\n        // collapse empty elements within array\n        for (var i=0, l=v.length; i < l; i++) {\n          if (!v[i].length && (!segments.length || !segments[segments.length -1].length)) {\n            continue;\n          }\n\n          if (segments.length && !segments[segments.length -1].length) {\n            segments.pop();\n          }\n\n          segments.push(trimSlashes(v[i]));\n        }\n      } else if (v || typeof v === 'string') {\n        v = trimSlashes(v);\n        if (segments[segments.length -1] === '') {\n          // empty trailing elements have to be overwritten\n          // to prevent results such as /foo//bar\n          segments[segments.length -1] = v;\n        } else {\n          segments.push(v);\n        }\n      }\n    } else {\n      if (v) {\n        segments[segment] = trimSlashes(v);\n      } else {\n        segments.splice(segment, 1);\n      }\n    }\n\n    if (absolute) {\n      segments.unshift('');\n    }\n\n    return this.path(segments.join(separator), build);\n  };\n  p.segmentCoded = function(segment, v, build) {\n    var segments, i, l;\n\n    if (typeof segment !== 'number') {\n      build = v;\n      v = segment;\n      segment = undefined;\n    }\n\n    if (v === undefined) {\n      segments = this.segment(segment, v, build);\n      if (!isArray(segments)) {\n        segments = segments !== undefined ? URI.decode(segments) : undefined;\n      } else {\n        for (i = 0, l = segments.length; i < l; i++) {\n          segments[i] = URI.decode(segments[i]);\n        }\n      }\n\n      return segments;\n    }\n\n    if (!isArray(v)) {\n      v = (typeof v === 'string' || v instanceof String) ? URI.encode(v) : v;\n    } else {\n      for (i = 0, l = v.length; i < l; i++) {\n        v[i] = URI.encode(v[i]);\n      }\n    }\n\n    return this.segment(segment, v, build);\n  };\n\n  // mutating query string\n  var q = p.query;\n  p.query = function(v, build) {\n    if (v === true) {\n      return URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n    } else if (typeof v === 'function') {\n      var data = URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n      var result = v.call(this, data);\n      this._parts.query = URI.buildQuery(result || data, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace);\n      this.build(!build);\n      return this;\n    } else if (v !== undefined && typeof v !== 'string') {\n      this._parts.query = URI.buildQuery(v, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace);\n      this.build(!build);\n      return this;\n    } else {\n      return q.call(this, v, build);\n    }\n  };\n  p.setQuery = function(name, value, build) {\n    var data = URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n\n    if (typeof name === 'string' || name instanceof String) {\n      data[name] = value !== undefined ? value : null;\n    } else if (typeof name === 'object') {\n      for (var key in name) {\n        if (hasOwn.call(name, key)) {\n          data[key] = name[key];\n        }\n      }\n    } else {\n      throw new TypeError('URI.addQuery() accepts an object, string as the name parameter');\n    }\n\n    this._parts.query = URI.buildQuery(data, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace);\n    if (typeof name !== 'string') {\n      build = value;\n    }\n\n    this.build(!build);\n    return this;\n  };\n  p.addQuery = function(name, value, build) {\n    var data = URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n    URI.addQuery(data, name, value === undefined ? null : value);\n    this._parts.query = URI.buildQuery(data, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace);\n    if (typeof name !== 'string') {\n      build = value;\n    }\n\n    this.build(!build);\n    return this;\n  };\n  p.removeQuery = function(name, value, build) {\n    var data = URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n    URI.removeQuery(data, name, value);\n    this._parts.query = URI.buildQuery(data, this._parts.duplicateQueryParameters, this._parts.escapeQuerySpace);\n    if (typeof name !== 'string') {\n      build = value;\n    }\n\n    this.build(!build);\n    return this;\n  };\n  p.hasQuery = function(name, value, withinArray) {\n    var data = URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace);\n    return URI.hasQuery(data, name, value, withinArray);\n  };\n  p.setSearch = p.setQuery;\n  p.addSearch = p.addQuery;\n  p.removeSearch = p.removeQuery;\n  p.hasSearch = p.hasQuery;\n\n  // sanitizing URLs\n  p.normalize = function() {\n    if (this._parts.urn) {\n      return this\n        .normalizeProtocol(false)\n        .normalizePath(false)\n        .normalizeQuery(false)\n        .normalizeFragment(false)\n        .build();\n    }\n\n    return this\n      .normalizeProtocol(false)\n      .normalizeHostname(false)\n      .normalizePort(false)\n      .normalizePath(false)\n      .normalizeQuery(false)\n      .normalizeFragment(false)\n      .build();\n  };\n  p.normalizeProtocol = function(build) {\n    if (typeof this._parts.protocol === 'string') {\n      this._parts.protocol = this._parts.protocol.toLowerCase();\n      this.build(!build);\n    }\n\n    return this;\n  };\n  p.normalizeHostname = function(build) {\n    if (this._parts.hostname) {\n      if (this.is('IDN') && punycode) {\n        this._parts.hostname = punycode.toASCII(this._parts.hostname);\n      } else if (this.is('IPv6') && IPv6) {\n        this._parts.hostname = IPv6.best(this._parts.hostname);\n      }\n\n      this._parts.hostname = this._parts.hostname.toLowerCase();\n      this.build(!build);\n    }\n\n    return this;\n  };\n  p.normalizePort = function(build) {\n    // remove port of it's the protocol's default\n    if (typeof this._parts.protocol === 'string' && this._parts.port === URI.defaultPorts[this._parts.protocol]) {\n      this._parts.port = null;\n      this.build(!build);\n    }\n\n    return this;\n  };\n  p.normalizePath = function(build) {\n    var _path = this._parts.path;\n    if (!_path) {\n      return this;\n    }\n\n    if (this._parts.urn) {\n      this._parts.path = URI.recodeUrnPath(this._parts.path);\n      this.build(!build);\n      return this;\n    }\n\n    if (this._parts.path === '/') {\n      return this;\n    }\n\n    _path = URI.recodePath(_path);\n\n    var _was_relative;\n    var _leadingParents = '';\n    var _parent, _pos;\n\n    // handle relative paths\n    if (_path.charAt(0) !== '/') {\n      _was_relative = true;\n      _path = '/' + _path;\n    }\n\n    // handle relative files (as opposed to directories)\n    if (_path.slice(-3) === '/..' || _path.slice(-2) === '/.') {\n      _path += '/';\n    }\n\n    // resolve simples\n    _path = _path\n      .replace(/(\\/(\\.\\/)+)|(\\/\\.$)/g, '/')\n      .replace(/\\/{2,}/g, '/');\n\n    // remember leading parents\n    if (_was_relative) {\n      _leadingParents = _path.substring(1).match(/^(\\.\\.\\/)+/) || '';\n      if (_leadingParents) {\n        _leadingParents = _leadingParents[0];\n      }\n    }\n\n    // resolve parents\n    while (true) {\n      _parent = _path.search(/\\/\\.\\.(\\/|$)/);\n      if (_parent === -1) {\n        // no more ../ to resolve\n        break;\n      } else if (_parent === 0) {\n        // top level cannot be relative, skip it\n        _path = _path.substring(3);\n        continue;\n      }\n\n      _pos = _path.substring(0, _parent).lastIndexOf('/');\n      if (_pos === -1) {\n        _pos = _parent;\n      }\n      _path = _path.substring(0, _pos) + _path.substring(_parent + 3);\n    }\n\n    // revert to relative\n    if (_was_relative && this.is('relative')) {\n      _path = _leadingParents + _path.substring(1);\n    }\n\n    this._parts.path = _path;\n    this.build(!build);\n    return this;\n  };\n  p.normalizePathname = p.normalizePath;\n  p.normalizeQuery = function(build) {\n    if (typeof this._parts.query === 'string') {\n      if (!this._parts.query.length) {\n        this._parts.query = null;\n      } else {\n        this.query(URI.parseQuery(this._parts.query, this._parts.escapeQuerySpace));\n      }\n\n      this.build(!build);\n    }\n\n    return this;\n  };\n  p.normalizeFragment = function(build) {\n    if (!this._parts.fragment) {\n      this._parts.fragment = null;\n      this.build(!build);\n    }\n\n    return this;\n  };\n  p.normalizeSearch = p.normalizeQuery;\n  p.normalizeHash = p.normalizeFragment;\n\n  p.iso8859 = function() {\n    // expect unicode input, iso8859 output\n    var e = URI.encode;\n    var d = URI.decode;\n\n    URI.encode = escape;\n    URI.decode = decodeURIComponent;\n    try {\n      this.normalize();\n    } finally {\n      URI.encode = e;\n      URI.decode = d;\n    }\n    return this;\n  };\n\n  p.unicode = function() {\n    // expect iso8859 input, unicode output\n    var e = URI.encode;\n    var d = URI.decode;\n\n    URI.encode = strictEncodeURIComponent;\n    URI.decode = unescape;\n    try {\n      this.normalize();\n    } finally {\n      URI.encode = e;\n      URI.decode = d;\n    }\n    return this;\n  };\n\n  p.readable = function() {\n    var uri = this.clone();\n    // removing username, password, because they shouldn't be displayed according to RFC 3986\n    uri.username('').password('').normalize();\n    var t = '';\n    if (uri._parts.protocol) {\n      t += uri._parts.protocol + '://';\n    }\n\n    if (uri._parts.hostname) {\n      if (uri.is('punycode') && punycode) {\n        t += punycode.toUnicode(uri._parts.hostname);\n        if (uri._parts.port) {\n          t += ':' + uri._parts.port;\n        }\n      } else {\n        t += uri.host();\n      }\n    }\n\n    if (uri._parts.hostname && uri._parts.path && uri._parts.path.charAt(0) !== '/') {\n      t += '/';\n    }\n\n    t += uri.path(true);\n    if (uri._parts.query) {\n      var q = '';\n      for (var i = 0, qp = uri._parts.query.split('&'), l = qp.length; i < l; i++) {\n        var kv = (qp[i] || '').split('=');\n        q += '&' + URI.decodeQuery(kv[0], this._parts.escapeQuerySpace)\n          .replace(/&/g, '%26');\n\n        if (kv[1] !== undefined) {\n          q += '=' + URI.decodeQuery(kv[1], this._parts.escapeQuerySpace)\n            .replace(/&/g, '%26');\n        }\n      }\n      t += '?' + q.substring(1);\n    }\n\n    t += URI.decodeQuery(uri.hash(), true);\n    return t;\n  };\n\n  // resolving relative and absolute URLs\n  p.absoluteTo = function(base) {\n    var resolved = this.clone();\n    var properties = ['protocol', 'username', 'password', 'hostname', 'port'];\n    var basedir, i, p;\n\n    if (this._parts.urn) {\n      throw new Error('URNs do not have any generally defined hierarchical components');\n    }\n\n    if (!(base instanceof URI)) {\n      base = new URI(base);\n    }\n\n    if (resolved._parts.protocol) {\n      // Directly returns even if this._parts.hostname is empty.\n      return resolved;\n    } else {\n      resolved._parts.protocol = base._parts.protocol;\n    }\n\n    if (this._parts.hostname) {\n      return resolved;\n    }\n\n    for (i = 0; (p = properties[i]); i++) {\n      resolved._parts[p] = base._parts[p];\n    }\n\n    if (!resolved._parts.path) {\n      resolved._parts.path = base._parts.path;\n      if (!resolved._parts.query) {\n        resolved._parts.query = base._parts.query;\n      }\n    } else {\n      if (resolved._parts.path.substring(-2) === '..') {\n        resolved._parts.path += '/';\n      }\n\n      if (resolved.path().charAt(0) !== '/') {\n        basedir = base.directory();\n        basedir = basedir ? basedir : base.path().indexOf('/') === 0 ? '/' : '';\n        resolved._parts.path = (basedir ? (basedir + '/') : '') + resolved._parts.path;\n        resolved.normalizePath();\n      }\n    }\n\n    resolved.build();\n    return resolved;\n  };\n  p.relativeTo = function(base) {\n    var relative = this.clone().normalize();\n    var relativeParts, baseParts, common, relativePath, basePath;\n\n    if (relative._parts.urn) {\n      throw new Error('URNs do not have any generally defined hierarchical components');\n    }\n\n    base = new URI(base).normalize();\n    relativeParts = relative._parts;\n    baseParts = base._parts;\n    relativePath = relative.path();\n    basePath = base.path();\n\n    if (relativePath.charAt(0) !== '/') {\n      throw new Error('URI is already relative');\n    }\n\n    if (basePath.charAt(0) !== '/') {\n      throw new Error('Cannot calculate a URI relative to another relative URI');\n    }\n\n    if (relativeParts.protocol === baseParts.protocol) {\n      relativeParts.protocol = null;\n    }\n\n    if (relativeParts.username !== baseParts.username || relativeParts.password !== baseParts.password) {\n      return relative.build();\n    }\n\n    if (relativeParts.protocol !== null || relativeParts.username !== null || relativeParts.password !== null) {\n      return relative.build();\n    }\n\n    if (relativeParts.hostname === baseParts.hostname && relativeParts.port === baseParts.port) {\n      relativeParts.hostname = null;\n      relativeParts.port = null;\n    } else {\n      return relative.build();\n    }\n\n    if (relativePath === basePath) {\n      relativeParts.path = '';\n      return relative.build();\n    }\n\n    // determine common sub path\n    common = URI.commonPath(relativePath, basePath);\n\n    // If the paths have nothing in common, return a relative URL with the absolute path.\n    if (!common) {\n      return relative.build();\n    }\n\n    var parents = baseParts.path\n      .substring(common.length)\n      .replace(/[^\\/]*$/, '')\n      .replace(/.*?\\//g, '../');\n\n    relativeParts.path = (parents + relativeParts.path.substring(common.length)) || './';\n\n    return relative.build();\n  };\n\n  // comparing URIs\n  p.equals = function(uri) {\n    var one = this.clone();\n    var two = new URI(uri);\n    var one_map = {};\n    var two_map = {};\n    var checked = {};\n    var one_query, two_query, key;\n\n    one.normalize();\n    two.normalize();\n\n    // exact match\n    if (one.toString() === two.toString()) {\n      return true;\n    }\n\n    // extract query string\n    one_query = one.query();\n    two_query = two.query();\n    one.query('');\n    two.query('');\n\n    // definitely not equal if not even non-query parts match\n    if (one.toString() !== two.toString()) {\n      return false;\n    }\n\n    // query parameters have the same length, even if they're permuted\n    if (one_query.length !== two_query.length) {\n      return false;\n    }\n\n    one_map = URI.parseQuery(one_query, this._parts.escapeQuerySpace);\n    two_map = URI.parseQuery(two_query, this._parts.escapeQuerySpace);\n\n    for (key in one_map) {\n      if (hasOwn.call(one_map, key)) {\n        if (!isArray(one_map[key])) {\n          if (one_map[key] !== two_map[key]) {\n            return false;\n          }\n        } else if (!arraysEqual(one_map[key], two_map[key])) {\n          return false;\n        }\n\n        checked[key] = true;\n      }\n    }\n\n    for (key in two_map) {\n      if (hasOwn.call(two_map, key)) {\n        if (!checked[key]) {\n          // two contains a parameter not present in one\n          return false;\n        }\n      }\n    }\n\n    return true;\n  };\n\n  // state\n  p.preventInvalidHostname = function(v) {\n    this._parts.preventInvalidHostname = !!v;\n    return this;\n  };\n\n  p.duplicateQueryParameters = function(v) {\n    this._parts.duplicateQueryParameters = !!v;\n    return this;\n  };\n\n  p.escapeQuerySpace = function(v) {\n    this._parts.escapeQuerySpace = !!v;\n    return this;\n  };\n\n  return URI;\n}));\n","/*! https://mths.be/punycode v1.4.0 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.3.2',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","/**\n * Copyright 2016 PT Inovao e Sistemas SA\n * Copyright 2016 INESC-ID\n * Copyright 2016 QUOBIS NETWORKS SL\n * Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n * Copyright 2016 ORANGE SA\n * Copyright 2016 Deutsche Telekom AG\n * Copyright 2016 Apizee\n * Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n **/\nconst methods = {GET: 'get', POST: 'post'}\n/**\n * @typedef {Object} Request\n * @desc Bridge to make HTTP requests\n * @property {function(url:string, options:Object):string} get\n * @property {function(url:string, options:Object):string} post\n */\n\n/**\n * Bridge to make HTTP requests\n */\nclass Request {\n\n\tconstructor() {\n\t\tlet _this = this\n\n\t\tObject.keys(methods).forEach(function(method) {\n\t\t\t_this[methods[method]] = function(url, options) {\n\t\t\t\treturn new Promise(function(resolve, reject) {\n\t\t\t\t\t_this._makeLocalRequest(methods[method].toUpperCase(), url, options).then(function(result) {\n\t\t\t\t\t\tresolve(result)\n\t\t\t\t\t}).catch(function(reason) {\n\t\t\t\t\t\treject(reason)\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t}\n\n\t_makeLocalRequest(method, url, options) {\n\t\tlet _this = this\n\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\turl = _this._mapProtocol(url)\n\t\t\tlet xhr = new XMLHttpRequest()\n\n\t\t\txhr.open(method, url, true)\n\n\t\t\txhr.onreadystatechange = function(event) {\n\t\t\t\tlet xhr = event.currentTarget\n\t\t\t\tif (xhr.readyState === 4) {\n\t\t\t\t\tif (xhr.status >= 200 || xhr.status <= 299) {\n\t\t\t\t\t\tresolve(xhr.responseText)\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(xhr.responseText)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(options && options.headers) {\n\t\t\t\tfor(let prop in options.headers) {\n\t\t\t\t\txhr.setRequestHeader(prop, options.headers[prop])\n\t\t\t\t}\n\t\t\t}\n\n\t\t\txhr.send(options?options.body:null)\n\t\t})\n\n\t}\n\n\t_mapProtocol(url) {\n\t\tlet protocolmap = {\n\t\t\t'localhost://': 'https://',\n\t\t\t'undefined://': 'https://',\n\t\t\t'hyperty-catalogue://': 'https://',\n\t\t\t'https://': 'https://',\n\t\t\t'http://': 'http://'\n\t\t}\n\n\t\tlet foundProtocol = false\n\t\tfor (let protocol in protocolmap) {\n\t\t\tif (url.slice(0, protocol.length) === protocol) {\n\t\t\t\turl = protocolmap[protocol] + url.slice(protocol.length, url.length)\n\t\t\t\tfoundProtocol = true\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tif (!foundProtocol) {\n\t\t\tthrow new Error('Invalid protocol of url: ' + url)\n\t\t}\n\n\t\treturn url\n\t}\n}\n\nexport default Request\n","// TODO: import and extend the class of the service-framework\n// service-framework/dist/RuntimeCapabilities;\n\nclass RuntimeCapabilities {\n\n  constructor(storageManager) {\n    if (!storageManager) throw new Error('The Runtime Capabilities need the storageManager');\n\n    this.storageManager = storageManager;\n  }\n\n  /**\n   * Returns as a promise RuntimeCapabilities json object with all available capabilities of the runtime.\n   * If it was not yet persisted in the Storage Manager it collects all required info from the platform and saves in the storage manager.\n   * @returns {Promise<object>}\n   */\n  getRuntimeCapabilities() {\n\n    return new Promise((resolve, reject) => {\n\n      Promise.all([this._getEnvironment(), this._getMediaDevices()]).then((result) => {\n        let capabilities = {};\n        result.forEach((capability) => {\n          Object.assign(capabilities, capability);\n        });\n\n        this.storageManager.set('capabilities', '1', capabilities);\n\n        resolve(capabilities);\n      }).catch((error) => {\n        reject(error);\n      });\n\n    });\n\n  }\n\n  /**\n   * returns as a promise a boolean according to available capabilities.\n   * @returns {Promise<boolean>}\n   */\n  isAvailable(capability) {\n    return new Promise((resolve) => {\n\n      this.storageManager.get('capabilities').then((capabilities) => {\n\n        console.log('Capability ' + capability + ' is available? ', capabilities.hasOwnProperty(capability) && capabilities[capability]);\n        if (capabilities.hasOwnProperty(capability) && capabilities[capability]) {\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      });\n\n    });\n  }\n\n  /**\n   * it refreshes previously collected capabilities and updates the storage manager\n   */\n  update() {\n    return new Promise((resolve, reject) => {\n      this.getRuntimeCapabilities().then(resolve).catch(reject);\n    });\n  }\n\n  // TODO: organize the code in separated files\n  _getEnvironment() {\n\n    // TODO: this should be more effective and check the environment\n    return {\n      browser: !!(window && navigator),\n      node: !!!(window && navigator)\n    };\n  }\n\n  // TODO: organize the code in separated files\n  _getMediaDevices() {\n    return new Promise((resolve) => {\n\n      let capability = {};\n\n      if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {\n        console.log('enumerateDevices() not supported.');\n        resolve(capability);\n        return;\n      }\n\n      // List cameras and microphones.\n      navigator.mediaDevices.enumerateDevices()\n      .then((devices) => {\n        devices.forEach((device) => {\n          // console.log('Devices:', device.kind, device.label, device.deviceId);\n          if (device.kind === 'audioinput') {\n            capability.mic = true;\n          }\n\n          if (device.kind === 'videoinput') {\n            capability.camera = true;\n\t    capability.windowSandbox = true;\n          }\n        });\n        resolve(capability);\n      })\n      .catch((err) => {\n        resolve(capability);\n        console.log(err.name + ': ' + err.message);\n      });\n    });\n  }\n\n}\n\nexport default RuntimeCapabilities;\n","/**\n* Copyright 2016 PT Inovao e Sistemas SA\n* Copyright 2016 INESC-ID\n* Copyright 2016 QUOBIS NETWORKS SL\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n* Copyright 2016 ORANGE SA\n* Copyright 2016 Deutsche Telekom AG\n* Copyright 2016 Apizee\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n**/\nimport PersistenceManager from 'service-framework/dist/PersistenceManager';\nimport { createSandbox } from './Sandboxes';\nimport SandboxApp from './SandboxApp';\nimport Request from './Request';\nimport RuntimeCapabilities from './RuntimeCapabilities';\nimport StorageManager from 'service-framework/dist/StorageManager';\nimport Dexie from 'dexie';\nimport { RuntimeCatalogue } from 'service-framework/dist/RuntimeCatalogue';\n\n/**\n * Is a bridge to isolate the runtime from the specific platform\n * @typedef {Object} RuntimeFactory\n * @property {function():Sandbox} createSandbox Creates a new Sandbox\n * @property {function():SandboxApp} createAppSandbox Creates a new SandboxApp\n * @property {function():Request} createHttpRequest Creates a new Request object\n * @property {function():RuntimeCatalogue} createRuntimeCatalogue Creates a new RuntimeCatalogue\n * @property {function(Encoded data: string):string} atob Returns the string decoded\n * @property {function():PersistenceManager} persistenceManager Returns a new PersistenceManager\n * @property {function():StorageManager} storageManager Returns a new StorageManager\n * @property {function():RuntimeCapabilities} runtimeCapabilities Returns a new RuntimeCapabilities\n */\nexport default {\n  createSandbox(constraints) {\n    return createSandbox(constraints);\n  },\n\n  createAppSandbox() {\n    return new SandboxApp();\n  },\n\n  createHttpRequest() {\n    let request = new Request();\n    return request;\n  },\n\n  createRuntimeCatalogue() {\n    if (!this.catalogue) { this.catalogue = new RuntimeCatalogue(this); }\n\n    return this.catalogue;\n  },\n\n  atob(b64) {\n    return atob(b64);\n  },\n\n  persistenceManager() {\n    let localStorage = window.localStorage;\n    return new PersistenceManager(localStorage);\n  },\n  storageManager(name, schemas) {\n\n    if (!this.databases) { this.databases = {}; }\n    if (!this.storeManager) { this.storeManager = {}; }\n\n    // To make the storage persitent and now allow the system clear the storage when is under pressure;\n    if (navigator && navigator.storage && navigator.storage.persist) {\n      navigator.storage.persist().then(function(persistent) {\n        if (persistent) { console.log('Storage will not be cleared except by explicit user action'); } else { console.log('Storage may be cleared by the UA under storage pressure.'); }\n      });\n    }\n\n    // Using the implementation of Service Framework\n    // Dexie is the IndexDB Wrapper\n    if (!this.databases.hasOwnProperty(name)) {\n      this.databases[name] = new Dexie(name);\n    }\n\n    if (!this.storeManager.hasOwnProperty(name)) {\n      this.storeManager[name] = new StorageManager(this.databases[name], name, schemas);\n    }\n\n    return this.storeManager[name];\n  },\n\n  runtimeCapabilities() {\n\n    if (!this.capabilitiesManager) {\n      let storageManager = this.storageManager('capabilities');\n      this.capabilitiesManager = new RuntimeCapabilities(storageManager);\n    }\n\n    return this.capabilitiesManager;\n  }\n};\n","/**\n* Copyright 2016 PT Inovao e Sistemas SA\n* Copyright 2016 INESC-ID\n* Copyright 2016 QUOBIS NETWORKS SL\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n* Copyright 2016 ORANGE SA\n* Copyright 2016 Deutsche Telekom AG\n* Copyright 2016 Apizee\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n**/\nimport { Sandbox, SandboxType } from 'runtime-core/dist/sandbox';\nimport MiniBus from 'runtime-core/dist/minibus';\n\n/**\n * Proxy for the Application context\n * */\nexport default class SandboxApp extends Sandbox {\n  constructor() {\n    super();\n\n    /**\n\t\t * @type {runtime-core/dist/sandbox/SandboxType}\n\t\t */\n    this.type = SandboxType.NORMAL;\n    window.addEventListener('message', function(e) {\n      if (!this.origin) {\n        /**\n\t\t\t\t * @type {Window}\n\t\t\t\t */\n        this.origin = e.source;\n      }\n\n      if (typeof e.data === 'string') {\n        return;\n      }\n\n      if (e.data.hasOwnProperty('to') && e.data.to.startsWith('core:')) { return; }\n\n      // this._onMessage(JSON.parse(JSON.stringify(e.data)));\n      this._onMessage(e.data);\n    }.bind(this));\n\n    window.addEventListener('error', function(error) {\n      console.error('[SANDBOX APP] - Error', error);\n      throw error;\n    }.bind(this));\n\n  }\n\n  _onPostMessage(msg) {\n    this.origin.postMessage(msg, '*');\n  }\n}\n","/**\n* Copyright 2016 PT Inovao e Sistemas SA\n* Copyright 2016 INESC-ID\n* Copyright 2016 QUOBIS NETWORKS SL\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n* Copyright 2016 ORANGE SA\n* Copyright 2016 Deutsche Telekom AG\n* Copyright 2016 Apizee\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n**/\nimport { Sandbox, SandboxType } from 'runtime-core/dist/sandbox';\nimport MiniBus from 'runtime-core/dist/minibus';\nimport RuntimeFactory from './RuntimeFactory';\n\n/**\n * Proxy for a WebWorker\n * */\nexport class SandboxWorker extends Sandbox {\n  static capabilities() {\n    return RuntimeFactory.runtimeCapabilities().getRuntimeCapabilities()\n      .then(capabilities =>Object.assign(capabilities, { mic: false, camera: false, windowSandbox: false }));\n  }\n\n  static new(capabilities) {\n    return new SandboxWorker(capabilities, './context-service.js');\n  }\n\n  /**\n\t * @param {string} script - Script that will be loaded in the web worker\n\t */\n  constructor(capabilities, script) {\n    super(capabilities);\n\n    /**\n\t\t * @type {runtime-core/dist/sandbox/SandboxType}\n\t\t */\n    this.type = SandboxType.NORMAL;\n    if (Worker) {\n      this._worker = new Worker(script);\n      this._worker.addEventListener('message', function(e) {\n        this._onMessage(e.data);\n      }.bind(this));\n\n      this._worker.addEventListener('error', function(error) {\n        console.log('[Sandbox Worker] - Error: ', error);\n        throw JSON.stringify(error);\n      }.bind(this));\n\n      this._worker.postMessage('');\n    } else {\n      throw new Error('Your environment does not support worker \\n');\n    }\n  }\n\n  _onPostMessage(msg) {\n    this._worker.postMessage(msg);\n  }\n}\n\nexport class SandboxWindow extends Sandbox {\n  static capabilities() {\n    return RuntimeFactory.runtimeCapabilities().getRuntimeCapabilities();\n  }\n\n  static new(capabilities) {\n    return new SandboxWindow(capabilities);\n  }\n\n  constructor(capabilities) {\n    super(capabilities);\n\n    this.type = SandboxType.WINDOW;\n    this.channel = new MessageChannel();\n\n    this.channel.port1.onmessage = function(e) {\n      this._onMessage(e.data);\n    }.bind(this);\n\n    parent.postMessage({ to: 'runtime:createSandboxWindow' }, '*', [this.channel.port2]);\n  }\n\n  _onPostMessage(msg) {\n    this.channel.port1.postMessage(msg);\n  }\n}\n\nexport function createSandbox(constraints) {\n  const sandboxes = [SandboxWorker, SandboxWindow];\n  let diff = (a, b) => Object.keys(a).filter(x => a[x] !== b[x]);\n\n  return Promise.all(sandboxes.map(s => s.capabilities().then(c=>{ return {capabilities: c, sandbox: s}; })))\n    .then(sbs => {\n      let i = 0;\n      while (i < sbs.length) {\n        if (diff(constraints, sbs[i].capabilities).length === 0) {\n          let capabilities = sbs[i].capabilities;\n          let sandbox = sbs[i].sandbox.new(capabilities);\n          return sandbox;\n        }\n\n        i++;\n      }\n      throw new Error('None of supported sandboxes match your constraints');\n    });\n}\n","// jshint browser:true, jquery: true\n\nclass IdentitiesGUI {\n\n  constructor(guiURL, idmURL, messageBus) {\n    console.log('IdentitiesGUI', this);\n    //if (!identityModule) throw Error('Identity Module not set!');\n    if (!messageBus) throw Error('Message Bus not set!');\n    let _this = this;\n    _this._guiURL = guiURL;\n    _this._idmURL = idmURL;\n    _this._messageBus = messageBus;\n    _this._alreadyReLogin = false;\n    _this._alreadyLogin = false;\n\n    this.callIdentityModuleFunc('deployGUI', {}).then((result) => {\n      return this._buildDrawer();\n    }).then((result) => {\n      console.log('READY:', result);\n    });\n\n    this.isLogged = false;\n\n    const drawerEl = document.querySelector('.mdc-temporary-drawer');\n    const MDCTemporaryDrawer = mdc.drawer.MDCTemporaryDrawer;\n    const drawer = new MDCTemporaryDrawer(drawerEl);\n\n    this._drawerEl = drawerEl;\n    this._drawer = drawer;\n\n    document.querySelector('.settings-btn').addEventListener('click', function() {\n      drawer.open = true;\n    });\n\n    drawerEl.addEventListener('MDCTemporaryDrawer:open', () => {\n      console.log('Received MDCTemporaryDrawer:open');\n      this._isDrawerOpen = true;\n      parent.postMessage({ body: { method: 'showAdminPage' }, to: 'runtime:gui-manager' }, '*');\n    });\n\n    drawerEl.addEventListener('MDCTemporaryDrawer:close', () => {\n      console.log('Received MDCTemporaryDrawer:close');\n      this._isDrawerOpen = false;\n      parent.postMessage({ body: { method: 'hideAdminPage' }, to: 'runtime:gui-manager' }, '*');\n    });\n\n  }\n\n  logOut() {\n    let _this = this;\n    console.log('IdentitiesGUI: logging out');\n    return new Promise((resolve, reject) => {\n\n      console.log('Building drawer');\n      _this._buildDrawer();\n\n      resolve('Gui reset');\n\n\n    });\n  }\n\n  _buildDrawer() {\n\n    const guiURL = this._guiURL;\n\n    this._messageBus.addListener(guiURL, msg => {\n\n      const funcName = msg.body.method;\n\n      if (msg.type !== 'response') {\n\n\n        if (!this.isLogged) {\n\n          const clickClose = new MouseEvent('click');\n          document.querySelector('.settings-btn').dispatchEvent(clickClose);\n\n        }\n\n      }\n\n      if (funcName === 'openPopup') {\n\n        this.openPopup().then(() => {\n\n          let urlreceived = msg.body.params.urlreceived;\n          this.openPopup(urlreceived).then((returnedValue) => {\n            let value = {type: 'execute', value: returnedValue, code: 200};\n            let replyMsg = {id: msg.id, type: 'response', to: msg.from, from: msg.to, body: value};\n            this._messageBus.postMessage(replyMsg);\n          });\n\n        });\n\n        return;\n\n      }\n\n      const callback = (identityInfo) => {\n\n        this.isLogged = true;\n\n        this._buildMessage(msg, identityInfo);\n\n      };\n\n      this.callback = callback;\n\n      this._getIdentities(callback, true);\n\n    });\n\n    this._getIdentities();\n\n  }\n\n  _buildMessage(msg, identityInfo) {\n    let replyMsg;\n    let value;\n\n    const from = msg ? msg.from : this._guiURL;\n    const to = msg ? msg.to : this._idmURL;\n\n    console.log('chosen identity: ', identityInfo);\n\n    switch (identityInfo.type) {\n      case 'idp':\n        value = { type: 'idp', value: identityInfo.value, code: 200 };\n        break;\n\n      case 'identity':\n        value = { type: 'identity', value: identityInfo.value, code: 200 };\n        break;\n\n      default:\n        value = { type: 'error', value: 'Error on identity GUI', code: 400 };\n    }\n\n    replyMsg = {id: msg.id, type: 'response', to: from, from: to, body: value };\n\n    this._messageBus.postMessage(replyMsg);\n  }\n\n  _getIdentities(callback, oPenDrawer) {\n\n    return this.callIdentityModuleFunc('getIdentitiesToChoose', {}).then((resultObject) => {\n      if (callback) {\n        return Promise.all([this.showIdps(resultObject.idps, callback), this.showDefaultIdentity(resultObject.defaultIdentity), this.showIdentities(resultObject, callback, oPenDrawer)]);\n      } else {\n        return Promise.all([this.showIdps(resultObject.idps), this.showDefaultIdentity(resultObject.defaultIdentity), this.showIdentities(resultObject)]);\n      }\n    });\n\n  }\n\n  // _openDrawer() {\n\n  //   let _this = this;\n  //   const guiURL = _this._guiURL;\n\n  //   _this.resultURL  = undefined;\n\n  //   _this._messageBus.addListener(guiURL, msg => {\n  //     let identityInfo = msg.body.value;\n  //     let funcName = msg.body.method;\n  //     let value;\n  //     console.log('[IdentitiesGUI] received msg: ', msg);\n\n  //     _this.showIdentitiesGUI(msg.body.value).then((identityInfo) => {\n\n  //       let replyMsg;\n  //       console.log('[IdentitiesGUI] identityInfo from GUI: ', identityInfo);\n\n  //       //hide config page with the identity GUI\n  //       parent.postMessage({ body: { method: 'hideAdminPage' }, to: 'runtime:gui-manager' }, '*');\n  //       $('.admin-page').addClass('hide');\n\n  //       // document.getElementsByTagName('body')[0].style = 'background-color:transparent';\n  //       $('.identities-section').addClass('hide');\n  //       $('.policies-section').addClass('hide');\n\n  //       switch (identityInfo.type) {\n  //         case 'idp':\n  //           value = { type: 'idp', value: identityInfo.value, code: 200 };\n  //           replyMsg = { id: msg.id, type: 'response', to: msg.from, from: msg.to, body: value };\n  //           _this._messageBus.postMessage(replyMsg);\n  //           break;\n\n  //         case 'identity':\n  //           value = { type: 'identity', value: identityInfo.value, code: 200 };\n  //           replyMsg = { id: msg.id, type: 'response', to: msg.from, from: msg.to, body: value };\n  //           _this._messageBus.postMessage(replyMsg);\n  //           break;\n\n  //         default:\n  //           value = { type: 'error', value: 'Error on identity GUI', code: 400 };\n  //           replyMsg = { id: msg.id, type: 'response', to: msg.from, from: msg.to, body: value };\n  //           _this._messageBus.postMessage(replyMsg);\n  //       }\n  //     });\n\n  //     if (funcName === 'openPopup') {\n  //       let urlreceived = msg.body.params.urlreceived;\n  //       _this.openPopup(urlreceived).then((returnedValue) => {\n  //         let value = {type: 'execute', value: returnedValue, code: 200};\n  //         let replyMsg = {id: msg.id, type: 'response', to: msg.from, from: msg.to, body: value};\n  //         _this._messageBus.postMessage(replyMsg);\n  //       });\n  //       return; // this avoids getting stuck in the identities page\n  //     }\n\n  //     // unhide the config page with the identity GUI\n  //     // document.getElementsByTagName('body')[0].style = 'background-color:white;';\n  //     parent.postMessage({ body: { method: 'showAdminPage' }, to: 'runtime:gui-manager' }, '*');\n\n  //     const clickOpen = new MouseEvent('click');\n  //     document.querySelector('.settings-btn').dispatchEvent(clickOpen);\n\n  //     $('.admin-page').removeClass('hide');\n\n  //   });\n  // }\n\n  callIdentityModuleFunc(methodName, parameters) {\n    let _this = this;\n\n    return new Promise((resolve, reject) => {\n      const message = { type: 'execute', to: _this._idmURL, from: _this._guiURL,\n        body: { resource: 'identity', method: methodName, params: parameters }};\n\n      this._messageBus.postMessage(message, (res) => {\n        let result = res.body.value;\n        resolve(result);\n      });\n\n    });\n  }\n\n  openPopup(urlreceived) {\n\n    \n\n    return new Promise((resolve, reject) => {\n\n      function wait(ms) {\n        var start = new Date().getTime();\n        var end = start;\n        while (end < start + ms) {\n          end = new Date().getTime();\n        }\n      }\n\n      let win;\n      if (!urlreceived) {\n        win = window.open('', 'openIDrequest', 'location=1,status=1');\n        this.win = win;\n        resolve();\n      } else {\n        wait(1000);  \n        win = this.win;\n        win.location.href = urlreceived;\n      }\n\n      // let win = window.open(urlreceived, 'openIDrequest', 'location=1,status=1,scrollbars=1');\n      if (window.cordova) {\n        win.addEventListener('loadstart', function(e) {\n          let url = e.url;\n          let code = /\\&code=(.+)$/.exec(url);\n          let error = /\\&error=(.+)$/.exec(url);\n\n          if (code || error) {\n            win.close();\n            return resolve(url);\n          } else {\n            return reject('openPopup error 1 - should not happen');\n          }\n        });\n      } else {\n\n        let pollTimer = setInterval(function() {\n          try {\n            if (win.closed) {\n              clearInterval(pollTimer);\n\n              // return reject('Some error occured when trying to get identity.');\n            }\n\n            if ((win.document.URL.indexOf('access_token') !== -1 || win.document.URL.indexOf('code') !== -1) && win.document.URL.indexOf(location.origin) !== -1) {\n              window.clearInterval(pollTimer);\n              let url =   win.document.URL;\n\n              resolve(url);\n              return win.close();\n            }\n          } catch (e) {\n            //return reject('openPopup error 2 - should not happen');\n            // console.log(e);\n          }\n\n        }, 500);\n      }\n\n    });\n  }\n\n  // showIdentitiesGUI(receivedInfo) {\n  //   let _this = this;\n\n  //   return new Promise((resolve, reject) => {\n  //     console.log('[IdentitiesGUI.showIdentitiesGUI] receivedInfo: ', receivedInfo);\n\n  //     let identityInfo;\n  //     let toRemoveID;\n\n  //     let callback = (value) => {\n  //       console.log('chosen identity: ', value);\n\n  //       const clickClose = new MouseEvent('click');\n  //       document.querySelector('.settings-btn').dispatchEvent(clickClose);\n\n  //       resolve({type: 'identity', value: value});\n  //     };\n\n  //     _this._checkReceivedInfo(receivedInfo).then((resultObject) => {\n  //       identityInfo = resultObject.identityInfo;\n  //       toRemoveID = resultObject.toRemoveID;\n\n  //       $('.policies-section').addClass('hide');\n  //       $('.identities-section').removeClass('hide');\n\n  //       _this.showIdps(receivedInfo.idps, callback);\n\n  //       _this.showIdentities(identityInfo.identities, toRemoveID).then((identity) => {\n  //         console.log('chosen identity: ', identity);\n  //         resolve({type: 'identity', value: identity});\n  //       });\n\n  //       let idps = [];\n  //       let idpsObjects = identityInfo.idps;\n\n  //       idpsObjects.forEach(function(entry) {\n  //         if(entry.type && entry.type == 'idToken') {\n  //           idps.push(entry.domain);\n  //         }\n  //       });\n\n  //       $('#idproviders').html(_this._getList(idps));\n  //       $('#idproviders').off();\n  //       // $('#idproviders').on('click', (event) => _this.obtainNewIdentity(event, callback, toRemoveID));\n  //       //$('.back').on('click', (event) => _this.goHome());\n  //       $('.identities-reset').off();\n  //       // $('.identities-reset').on('click', (event) => _this._resetIdentities(callback));\n  //     });\n  //   });\n  // }\n\n  _checkReceivedInfo(receivedInfo) {\n    let _this = this;\n    return new Promise((resolve, reject) => {\n\n      let identityInfo;\n      let toRemoveID;\n\n      if (receivedInfo) {\n        identityInfo = receivedInfo;\n        toRemoveID = false;\n        resolve({identityInfo: identityInfo, toRemoveID: toRemoveID});\n      } else {\n        toRemoveID = true;\n        _this.callIdentityModuleFunc('getIdentitiesToChoose', {}).then((result) => {\n          resolve({identityInfo: result, toRemoveID: toRemoveID});\n        });\n      }\n    });\n  }\n\n  showIdps(idps) {\n\n    console.log('[IdentitiesGUI.showIdps] : ', idps);\n\n    let idpsListEl = document.getElementById('idps-list');\n\n    const clickEvent = (event) => {\n      const el = event.currentTarget;\n      const idp = el.getAttribute('data-idp');\n\n      this.loginWithIDP(idp).then((result) => {\n        // console.log('value here: ', result.value);\n        // result.value = result.value.userURL\n\n        if (this.callback) {\n          this.callback(result);\n        }\n\n      });\n    };\n\n    idps.forEach((key) => {\n\n      let linkEl = document.getElementById('link-' + key.domain);\n\n      if (!linkEl) {\n        linkEl = document.createElement('a');\n        linkEl.setAttribute('id', 'link-' + key.domain);\n        linkEl.setAttribute('data-idp', key.domain);\n        linkEl.classList = 'mdc-list-item link-' + key.domain;\n        linkEl.href = '#';\n\n        const linkElText = document.createTextNode(key.domain);\n\n        let name = key.domain;\n        if (name.indexOf('.') !== -1) {\n          name = name.substring(0, name.indexOf('.'));\n        } else {\n          name = 'question';\n        }\n\n        const imgEl = document.createElement('img');\n        imgEl.classList = 'mdc-list-item__start-detail';\n        imgEl.src = './assets/' + name + '.svg';\n        imgEl.width = 30;\n        imgEl.height = 30;\n\n        imgEl.onerror = (e) => { e.srcElement.src = './assets/question.svg'; };\n\n        linkEl.appendChild(imgEl);\n        linkEl.appendChild(linkElText);\n\n        idpsListEl.appendChild(linkEl);\n      } else {\n        linkEl.removeEventListener('click', clickEvent);\n      }\n\n      linkEl.addEventListener('click', clickEvent);\n\n    });\n\n  }\n\n  showDefaultIdentity(identity) {\n\n    if (identity) {\n\n      this.isLogged = true;\n\n      const header = document.querySelector('.mdc-list--avatar-list');\n\n      let itemEl = document.getElementById('item-' + identity.userProfile.userURL);\n\n      if (!itemEl) {\n\n        itemEl = document.createElement('li');\n        itemEl.id = 'item-' + identity.userProfile.userURL;\n        itemEl.classList = 'mdc-list-item item-' + identity.userProfile.userURL;\n        itemEl.setAttribute('data-userURL', identity.userProfile.userURL);\n\n        const profileImage = document.createElement('img');\n        profileImage.classList = 'mdc-list-item__start-detail';\n        profileImage.width = 56;\n        profileImage.height = 56;\n        profileImage.alt = identity.userProfile.name;\n        profileImage.src = identity.userProfile.picture;\n        itemEl.appendChild(profileImage);\n\n        const text1 = document.createElement('span');\n        text1.classList = 'name mdc-list-item__text';\n        text1.textContent = identity.userProfile.name;\n\n        const text2 = document.createElement('span');\n        text2.classList = 'email mdc-list-item__secondary-text';\n        text2.textContent = identity.userProfile.email;\n\n        text1.appendChild(text2);\n        itemEl.appendChild(text1);\n        header.appendChild(itemEl);\n\n      }\n\n    }\n\n  }\n\n  showIdentities(iDs, callback, oPenDrawer = false) {\n\n    return new Promise((resolve, reject) => {\n\n      console.log('[IdentitiesGUI.showMyIdentities] : ', iDs.identities, iDs.defaultIdentity);\n\n      const identities = iDs.identities;\n      const current = iDs.defaultIdentity ? iDs.defaultIdentity.userURL : '';\n\n      let activeIdentities = document.getElementById('active-identities');\n\n      Object.keys(identities).forEach((key) => {\n\n        const exist = document.getElementById('link-' + key);\n        if (exist) { return; }\n\n        const linkEl = document.createElement('a');\n        linkEl.href = '#';\n        linkEl.id = 'link-' + key;\n        linkEl.classList = 'mdc-list-item';\n        linkEl.setAttribute('data-userURL', key);\n\n        if (key === current) {\n          linkEl.classList += ' mdc-temporary-drawer--selected';\n        }\n\n        linkEl.addEventListener('click', (event) => {\n\n          event.preventDefault();\n\n          const el = event.currentTarget;\n          const userURL = el.getAttribute('data-userURL');\n\n          console.log('userURL:', userURL, callback, el);\n\n          if (callback) {\n            callback(userURL);\n          }\n\n        });\n\n        const profileImage = document.createElement('img');\n        profileImage.classList = 'mdc-list-item__start-detail';\n        profileImage.width = 40;\n        profileImage.height = 40;\n        profileImage.alt = identities[key].userProfile.name;\n        profileImage.src = identities[key].userProfile.picture;\n        profileImage.onerror = (e) => { e.srcElement.src = './assets/question.svg'; };\n\n        const text1 = document.createElement('span');\n        text1.classList = 'name mdc-list-item__text';\n        text1.textContent = identities[key].userProfile.name;\n\n        const text2 = document.createElement('span');\n        text2.classList = 'email mdc-list-item__secondary-text';\n        text2.textContent = identities[key].userProfile.email;\n\n        text1.appendChild(text2);\n\n        linkEl.appendChild(profileImage);\n        linkEl.appendChild(text1);\n\n        activeIdentities.appendChild(linkEl);\n\n      });\n\n      if (oPenDrawer && (!this._alreadyReLogin)) {\n        this._drawer.open = true\n      }\n\n      if (oPenDrawer && (!this._alreadyReLogin) && (!this._alreadyLogin)) {\n        this._alreadyReLogin = true;\n        parent.postMessage({ body: { method: 'tokenExpired' }, to: 'runtime:gui-manager' }, '*');\n      }\n\n\n\n\n/*\n      if (Object.keys(identities).length === 1) {\n\n        if (callback) {\n          callback({type: 'identity', value: current});\n        }\n\n        return resolve({type: 'identity', value: current});\n      }*/\n\n\n      // let callback = (identity) => {\n      //   resolve(identity);\n      // };\n\n      // if (!toRemoveID) {\n      //   $('.clickable-cell').on('click', (event) => _this.changeID(event, callback));\n      // }\n\n      // $('.remove-id').on('click', (event) => _this.removeID(iDs));\n\n    });\n  }\n\n  removeID(event, emails) {\n    let _this = this;\n    let row = event.target.parentNode.parentNode;\n    let idToRemove = row.children[0].textContent;\n    let domain = row.children[1].textContent;\n\n    _this.callIdentityModuleFunc('unregisterIdentity', { email: idToRemove }).then(() => {\n      let numEmails = emails.length;\n      for (let i = 0; i < numEmails; i++) {\n        if (emails[i].email === idToRemove) {\n          emails.splice(i, 1);\n          break;\n        }\n      }\n\n      // -------------------------------------------------------------------------//\n      _this.showIdentities(emails, true);\n    });\n\n    //_this.identityModule.unregisterIdentity(idToRemove);\n\n  }\n\n  authorise(idp, resource) {\n\n\n    return this.openPopup()\n      .then((res) => {\n        const data = { scope: resource, idpDomain: idp };\n        return this.callIdentityModuleFunc('getAccessTokenAuthorisationEndpoint', data);\n      })\n      .then((value) => {\n        console.log('[IdentitiesGUI.authorise] receivedURL from idp Proxy: ' + value);\n\n        return this.openPopup(value);\n      }).then((result) => {\n\n        console.log('[IdentitiesGUI.authorise.openPopup.result]', result);\n\n        // resource as array\n\n\n        const data = { resources: [resource], idpDomain: idp, login: result };\n        return this.callIdentityModuleFunc('getAccessToken', data);\n      }).then((result) => {\n\n        console.log('[IdentitiesGUI.authorise.getAccessToken.result]', result);\n        return this.callIdentityModuleFunc('addAccessToken', result);\n      }).then((value) => {\n        this._drawer.open = false;\n        return value;\n      });\n\n  }\n\n  loginWithIDP(idp) {\n\n\n    let _publicKey;\n\n    return this.openPopup()\n      .then((result) => {\n        return this.callIdentityModuleFunc('getMyPublicKey', {});\n      }).then((publicKey) => {\n        _publicKey = publicKey;\n        const data = { contents: publicKey, origin: 'origin', usernameHint: undefined, idpDomain: idp };\n        return this.callIdentityModuleFunc('sendGenerateMessage', data);\n      })\n      .then((value) => {\n        console.log('[IdentitiesGUI.obtainNewIdentity] receivedURL from idp Proxy: ' + value.loginUrl.substring(0, 20) + '...');\n\n        let url = value.loginUrl;\n        let finalURL;\n\n        //check if the receivedURL contains the redirect field and replace it\n        if (url.indexOf('redirect_uri') !== -1) {\n          let firstPart = url.substring(0, url.indexOf('redirect_uri'));\n          let secondAuxPart = url.substring(url.indexOf('redirect_uri'), url.length);\n\n          let secondPart = secondAuxPart.substring(secondAuxPart.indexOf('&'), url.length);\n\n          //check if the reddirect field is the last field of the URL\n          if (secondPart.indexOf('&') !== -1) {\n            finalURL = firstPart + 'redirect_uri=' + location.origin + secondPart;\n          } else {\n            finalURL = firstPart + 'redirect_uri=' + location.origin;\n          }\n        }\n\n        this.resultURL = finalURL || url;\n\n        console.log('[IdentitiesGUI.openPopup]', this.resultURL);\n        return this.openPopup(this.resultURL);\n      }).then((identity) => {\n\n        console.log('[IdentitiesGUI.openPopup.result]', identity);\n\n        const data = { contents: _publicKey, origin: 'origin', usernameHint: identity, idpDomain: idp };\n        return this.callIdentityModuleFunc('sendGenerateMessage', data);\n      }).then((result) => {\n\n        console.log('[IdentitiesGUI.sendGenerateMessage.result]', result);\n        return this.callIdentityModuleFunc('addAssertion', result);\n      }).then((value) => {\n\n        this._drawer.open = false;\n        const userURL = {type: 'identity', value: value.userProfile.userURL};\n        // const userIdentity = {type: 'identity', value: value.userProfile};\n\n        console.log('[IdentitiesGUI.loginWithIDP final]', value);\n        this._alreadyLogin = true;\n        return userURL;\n        // return userIdentity;\n      });\n\n  }\n\n  // obtainNewIdentity(event, callback, toRemoveID) {\n  //   let _this = this;\n  //   let idProvider = event.target.textContent;\n  //   let idProvider2 = event.target.text;\n\n  //   _this.callIdentityModuleFunc('getMyPublicKey', {}).then((publicKey) => {\n  //     // let publicKey = btoa(keyPair.public);\n\n  //     _this.callIdentityModuleFunc('sendGenerateMessage',\n  //       { contents: publicKey, origin: 'origin', usernameHint: undefined, idpDomain: idProvider, }).then((value) => {\n  //       console.log('[IdentitiesGUI.obtainNewIdentity] receivedURL from idp Proxy: ' + value.loginUrl.substring(0, 20) + '...');\n\n  //       let url = value.loginUrl;\n  //       let finalURL;\n\n  //       //check if the receivedURL contains the redirect field and replace it\n  //       if (url.indexOf('redirect_uri') !== -1) {\n  //         let firstPart = url.substring(0, url.indexOf('redirect_uri'));\n  //         let secondAuxPart = url.substring(url.indexOf('redirect_uri'), url.length);\n\n  //         let secondPart = secondAuxPart.substring(secondAuxPart.indexOf('&'), url.length);\n\n  //         //check if the reddirect field is the last field of the URL\n  //         if (secondPart.indexOf('&') !== -1) {\n  //           finalURL = firstPart + 'redirect_uri=' + location.origin + secondPart;\n  //         } else {\n  //           finalURL = firstPart + 'redirect_uri=' + location.origin;\n  //         }\n  //       }\n\n  //       _this.resultURL = finalURL || url;\n\n  //       $('.login-idp').html('<p>Chosen IDP: ' + idProvider + '</p>');\n  //       $('.login').removeClass('hide');\n  //       $('.login-btn').off();\n  //       $('.login-btn').on('click', (event) => {\n  //         $('.login').addClass('hide');\n  //         // _this._authenticateUser(publicKey, value, 'origin', idProvider).then((email) => {\n  //         //   callback(email);\n  //         //   _this.showIdentitiesGUI();\n  //         // });\n  //       });\n  //     });\n  //   }).catch(err => console.log('obtanin new identity', err));\n\n  // }\n\n  _getList(items) {\n    let list = '';\n    let numItems = items.length;\n\n    for (let i = 0; i < numItems; i++) {\n      list += '<li class=\"divider\"></li>';\n      list += '<li><a class=\"center-align\">' + items[i] + '</a></li>';\n    }\n\n    return list;\n  }\n\n  _authenticateUser(publicKey, value, origin, idProvider) {\n    let _this = this;\n    let url = _this.resultURL;\n\n    return new Promise((resolve, reject) => {\n\n      _this.openPopup(url).then((identity) => {\n\n        _this.callIdentityModuleFunc('sendGenerateMessage',\n          { contents: publicKey, origin: origin, usernameHint: identity, idpDomain: idProvider }).then((result) => {\n\n          if (result) {\n\n            //_this.identityModule.storeIdentity(result, keyPair).then((value) => {\n            _this.callIdentityModuleFunc('addAssertion', result).then((value) => {\n              resolve(value.userProfile.userURL);\n            }, (err) => {\n              reject(err);\n            });\n\n          } else {\n            reject('error on obtaining identity information');\n          }\n\n        });\n      }, (err) => {\n        reject(err);\n      });\n    });\n  }\n\n  _resetIdentities() {\n    console.log('_resetIdentities');\n  }\n\n\n}\n\nexport default IdentitiesGUI;\n","import PoliciesManager from './PoliciesManager';\n\nclass PoliciesGUI {\n\n  constructor(pepGuiURL, pepURL, messageBus) {\n    let _this = this;\n    _this.policiesManager = new PoliciesManager(pepGuiURL, pepURL, messageBus);\n    // assume prepareAttributes is called after this\n  }\n\n  prepareAttributes() {\n    let _this = this;\n    return new Promise((resolve, reject) => {\n      _this.policiesManager.prepareAttributes().then(() => {\n        _this.elements = _this._setElements();\n        _this._setListeners();\n        resolve();\n      });\n    });\n  }\n\n  _addMember() {\n    let _this = this;\n    let group = event.target.id;\n    $('.member-new-intro').html('<h5>Add a member to a group</h5><p>Insert a user email below to add to the \"' + group + '\" group.</p>');\n    $('.member-new-modal').openModal();\n    $('.member-new-ok').off();\n    $('.member-new-ok').on('click', (event) => {\n      let member = $('#member-new').val();\n      $('#member-new').val('');\n      _this.policiesManager.addToGroup(group, member).then(() => {\n        $('.member-new-modal').closeModal();\n        _this._manageGroups();\n      });\n    });\n  }\n\n  _createGroup() {\n    let _this = this;\n    $('#group-new-name').val('');\n    $('.group-new-modal').openModal();\n    $('.group-new-ok').on('click', (event) => {\n      let groupName = $('#group-new-name').val();\n      _this.policiesManager.createGroup(groupName).then(() => {\n        _this._manageGroups();\n      });\n    });\n  }\n\n  _addPolicy() {\n    let _this = this;\n    $('#policy-new-title').val('');\n    $('.combining').html('');\n    let algorithms = ['Block overrides', 'Allow overrides', 'First applicable'];\n    $('.combining').append(this._getOptions('comb-algorithm', 'Choose a combining algorithm', algorithms));\n    $('.policy-new').openModal();\n\n    $('.policy-new-ok').off();\n    $('.policy-new-ok').on('click', (event) => {\n      let policyTitle = $('#policy-new-title').val();\n      if (!policyTitle) {\n        Materialize.toast('Invalid policy title', 4000);\n      } else {\n        let combiningAlgorithm = $('#comb-algorithm').val();\n        _this.policiesManager.addPolicy(policyTitle, combiningAlgorithm).then(() => {\n          $('.help-menu').addClass('hide');\n          $('.policy-new').closeModal();\n          _this._goHome();\n        });\n      }\n    });\n    $('.help-btn').off();\n    $('.help-btn').on('click', (event) => {\n      $('.help-menu').removeClass('hide');\n    });\n  }\n\n  _decreaseRulePriority() {\n    let _this = this;\n    let id = event.target.closest('tr').id;\n    let splitId = id.split(':');\n    let thisPriority = parseInt(splitId[splitId.length - 1]);\n    splitId.pop();\n    let policyTitle = splitId.join(':');\n    _this.policiesManager.getPolicy(policyTitle).then((policy) => {\n      let lastPriority = policy.getLastPriority();\n      if (lastPriority != thisPriority) {\n        let newPriority = parseInt(thisPriority + 1);\n        _this.policiesManager.decreaseRulePriority(policyTitle, thisPriority, newPriority).then(() => {\n          _this._goHome();\n        });\n      }\n    });\n  }\n\n  _deleteMember() {\n    let _this = this;\n    let id = event.target.closest('tr').id;\n    let splitId = id.split('::');\n    let member = splitId[splitId.length - 1];\n    splitId.pop();\n    let group = splitId.join('::');\n    _this.policiesManager.removeFromGroup(group, member).then(() => {\n      _this._manageGroups();\n    });\n  }\n\n  _deleteGroup() {\n    let _this = this;\n    let groupName = event.target.closest('tr').children[0].id;\n    _this.policiesManager.deleteGroup(groupName).then(() => {\n      _this._manageGroups();\n    });\n  }\n\n  _deletePolicy() {\n    let _this = this;\n    let policyTitle = event.target.closest('tr').id;\n    _this.policiesManager.deletePolicy(policyTitle).then(() => {\n      _this._goHome();\n    });\n  }\n\n  _deleteRule() {\n    let _this = this;\n    let id = event.target.closest('tr').id;\n    let splitId = id.split(':');\n    let priority = splitId[splitId.length - 1];\n    splitId.pop();\n    let policyTitle = splitId.join(':');\n    let rule = _this.policiesManager.getRuleOfPolicy(policyTitle, priority);\n\n    _this.policiesManager.deleteRule(policyTitle, rule).then(() => {\n      _this._goHome();\n    });\n  }\n\n  _getActivePolicy() {\n    let _this = this;\n    _this.policiesManager.getActivePolicy().then((activeUserPolicy) => {\n      $('.policy-active').html('');\n      _this.policiesManager.getPoliciesTitles().then((policies) => {\n        policies.push('Deactivate all policies');\n\n        $('.policy-active').append(_this._getOptions('policies-list', 'Click to activate a policy', policies, activeUserPolicy));\n\n        $('#policies-list').on('click', (event) => {\n          let policyTitle = $('#policies-list').find(\":selected\")[0].textContent;\n          if (policyTitle === 'Deactivate all policies') {\n            policyTitle = undefined;\n          }\n          _this.policiesManager.updateActivePolicy(policyTitle);\n        });\n      });\n    });\n  }\n\n  _getGroupOptions(title, keys, scopes, lists) {\n    let list = '<option disabled selected>' + title + '</option>';\n\n    for (let i in keys) {\n      list += '<optgroup label=' + keys[i] + '>';\n      for (let j in lists[i]) {\n        list += '<option id=\"' + scopes[i] + '\">' + lists[i][j] + '</option>';\n      }\n    }\n\n    return list;\n  }\n\n  _getInfo(variable) {\n    let info;\n\n    switch(variable) {\n      case 'Date':\n        info = $('.config').find('input').val();\n        if (info.indexOf(',') !== -1) { //20 July, 2016\n          let splitInfo = info.split(' '); //['20', 'July,',' '2016']\n          splitInfo[1] = splitInfo[1].substring(0, splitInfo[1].length - 1); //'July'\n          let months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\n          info = splitInfo[0] + '/' + (months.indexOf(splitInfo[1]) + 1) + '/' + splitInfo[2];\n        } else { // 2016-07-20\n          let splitInfo = info.split('-');\n          info = splitInfo[2] + '/' + splitInfo[1] + '/' + splitInfo[0];\n        }\n        break;\n      case 'Group of users':\n        info = $('#group').find(\":selected\").text();\n        break;\n      case 'Subscription preferences':\n        if (info = $(\"input[name='rule-new-subscription']:checked\")[0] !== undefined) {\n          info = $(\"input[name='rule-new-subscription']:checked\")[0].id;\n        }\n        break;\n      case 'Weekday':\n        info = $('#weekday').find(\":selected\").text();\n        break;\n      default:\n        info = $('.config').find('input').val();\n        break;\n    }\n\n    return info;\n  }\n\n  _getList(items) {\n      let list = '';\n      let numItems = items.length;\n\n      for (let i = 0; i < numItems; i++) {\n        list += '<li class=\"divider\"></li>';\n        list += '<li><a class=\"center-align\">' + items[i] + '</a></li>';\n      }\n\n      return list;\n    }\n\n  _getOptions(id, title, list, selected) {\n    let options = '<select id=\"' + id + '\" class=\"browser-default\"><option disabled selected>' + title + '</option>';\n    for (let i in list) {\n      if (selected !== undefined & selected === list[i]) {\n        options += '<option selected id=\"' + id + '\">' + list[i] + '</option>';\n      } else {\n        options += '<option id=\"' + id + '\">' + list[i] + '</option>';\n      }\n    }\n    options += '</select>';\n\n    return options;\n  }\n\n  _getPoliciesTable() {\n    let _this = this;\n\n    _this.policiesManager.getFormattedPolicies().then((policies) => {\n      $('.policies-no').addClass('hide');\n      $('.policies-current').html('');\n\n      let policiesTitles = [];\n      let rulesTitles = [];\n      let ids = [];\n\n      for (let i in policies) {\n        policiesTitles.push(policies[i].title);\n        rulesTitles.push(policies[i].rulesTitles);\n        ids.push(policies[i].ids);\n      }\n\n      let table = '<table>';\n      let isEmpty = policiesTitles.length === 0;\n\n      for (let i in policiesTitles) {\n        table += '<thead><tr id=\"' + policiesTitles[i] + '\"><td></td><td></td><th class=\"center-align\">' + policiesTitles[i] + '</th><td><i class=\"material-icons clickable-cell policy-delete\" style=\"cursor: pointer; vertical-align: middle\">delete_forever</i></td></tr></thead><tbody>';\n\n        for (let j in rulesTitles[i]) {\n          table += '<tr id=\"' + ids[i][j] + '\" ><td><i class=\"material-icons clickable-cell rule-priority-increase\" style=\"cursor: pointer; vertical-align: middle\">arrow_upward</i></td><td><i class=\"material-icons clickable-cell rule-priority-decrease\" style=\"cursor: pointer; vertical-align: middle\">arrow_downward</i></td><td class=\"rule-show clickable-cell\" style=\"cursor: pointer\">' + rulesTitles[i][j] + '</td><td><i class=\"material-icons clickable-cell rule-delete\" style=\"cursor: pointer; vertical-align: middle\">clear</i></td></tr>';\n        }\n        table += '<tr id=\"' + policiesTitles[i] + '\"></td><td></td><td></td><td style=\"text-align:center\"><i class=\"material-icons clickable-cell center-align rule-add\" style=\"cursor: pointer\">add_circle</i></td></tr>';\n      }\n      if (!isEmpty) {\n        table += '</tbody></table>';\n        $('.policies-current').append(table);\n      } else {\n        $('.policies-no').removeClass('hide');\n      }\n      $('.rule-add').on('click', (event) => { _this._showVariablesTypes(); });\n      $('.rule-delete').on('click', (event) => { _this._deleteRule(); });\n      $('.rule-show').on('click', (event) => { _this._showRule(); });\n      $('.rule-priority-increase').on('click', (event) => { _this._increaseRulePriority(); });\n      $('.rule-priority-decrease').on('click', (event) => { _this._decreaseRulePriority(); });\n      $('.policy-add').off();\n      $('.policy-add').on('click', (event) => { _this._addPolicy(); });\n      $('.policy-delete').on('click', (event) => { _this._deletePolicy(); });\n    });\n  }\n\n  _goHome() {\n    this._getActivePolicy();\n    this._getPoliciesTable();\n  }\n\n  _increaseRulePriority() {\n    let _this = this;\n    let id = event.target.closest('tr').id;\n    let splitId = id.split(':');\n    let thisPriority = parseInt(splitId[splitId.length - 1]);\n    if (thisPriority !== 0) {\n      splitId.pop();\n      let policyTitle = splitId.join(':');\n      let newPriority = thisPriority - 1;\n\n      _this.policiesManager.increaseRulePriority(policyTitle, thisPriority, newPriority).then(() => {\n        _this._goHome();\n      });\n    }\n  }\n\n  _manageGroups() {\n    let _this = this;\n    _this.policiesManager.getGroups().then((groupsPE) => {\n      $('.groups-current').html('');\n      let groups = groupsPE.groupsNames;\n      let members = groupsPE.members;\n      let ids = groupsPE.ids;\n\n      let table = '<table>';\n      let isEmpty = groups.length === 0;\n\n      for (let i in groups) {\n        table += '<thead><tr><th id=\"' + groups[i] + '\">' + groups[i] + '</th><td style=\"text-align:right\"><i class=\"material-icons clickable-cell group-delete\" style=\"cursor: pointer; vertical-align: middle\">delete_forever</i></td></tr></thead><tbody>';\n        for (let j in members[i]) {\n          table += '<tr id=\"' + ids[i][j] + '\" ><td style=\"cursor: pointer\">' + members[i][j] + '</td><td style=\"text-align:right\"><i class=\"material-icons clickable-cell member-delete\" style=\"cursor: pointer; vertical-align: middle\">clear</i></td></tr>';\n        }\n\n        table += '<tr id=\"' + groups[i] + '\"><td><i class=\"material-icons clickable-cell member-add\" id=\"' + groups[i] + '\" style=\"cursor: pointer\">add_circle</i></td></tr>';\n      }\n\n      if (!isEmpty) {\n        table += '</tbody></table>';\n        $('.groups-current').append(table);\n      } else {\n        $('.groups-current').append('<p>There are no groups set.</p>');\n      }\n\n      $('.member-add').off();\n      $('.member-add').on('click', (event) => { _this._addMember(); });\n      $('.member-delete').on('click', (event) => { _this._deleteMember(); });\n      $('.group-add').off();\n      $('.group-add').on('click', (event) => { _this._createGroup(); });\n      $('.group-delete').on('click', (event) => { _this._deleteGroup(); });\n    });\n  }\n\n  _parseFileContent(content) {\n    let parsedContent = JSON.parse(content);\n    for (let i in parsedContent) {\n      this.policiesManager.addPolicy(i, undefined, parsedContent[i]);\n    }\n    $('.policy-new').closeModal();\n  }\n\n  _setElements() {\n    return {\n      date: (params) => { return '<input type=\"date\" class=\"datepicker\">'; },\n      select: (params) => { return this._getOptions(params[0], params[1], params[2]); },\n      form: (params) => { return '<form><input type=\"text\" placeholder=\"' + params + '\"></input></form>'; }\n    };\n  }\n\n  _showNewConfigurationPanel(policyTitle) {\n    let variable = event.target.text;\n    $('.variable').html(this._getNewConfiguration(policyTitle, variable));\n    $('.scopes').empty().html('');\n\n    let keys = ['Email', 'Hyperty', 'All'];\n    let scopes = ['identity', 'hyperty', 'global'];\n    let lists = [];\n\n    this.policiesManager.getMyEmails().then((emails) => {\n      lists.push(emails);\n      this.policiesManager.getMyHyperties().then((hyperties) => {\n        lists.push(hyperties);\n        lists.push(['All identities and hyperties']);\n        $('.scopes').append(this._getGroupOptions('Apply this configuration to:', keys, scopes, lists));\n        $('.variable').removeClass('hide');\n      });\n    });\n  }\n\n  _showVariablesTypes(event) {\n    let policyTitle = event.target.closest('tr').id;\n\n    $('#variables-types').empty().html('');\n    let variables = this.policiesManager.getVariables();\n    $('#variables-types').append(this._getList(variables));\n    $('.variable').addClass('hide');\n    $('.rule-new').openModal();\n    $('#variables-types').off();\n    $('#variables-types').on('click', (event) => { this._showNewConfigurationPanel(policyTitle); });\n  }\n\n  _getNewConfiguration(policyTitle, variable) {\n    let _this = this;\n    let info = _this.policiesManager.getVariableInfo(variable);\n    $('.rule-new-title').html(info.title);\n    $('.description').html(info.description);\n    $('.config').html('');\n\n    if (variable === 'Subscription preferences') {\n      $('.subscription-type').removeClass('hide');\n    } else {\n      $('.subscription-type').addClass('hide');\n      let tags = info.input;\n      for (let i in tags) {\n        _this.policiesManager.getGroupsNames().then((groupsNames) => {\n          if (variable === 'Group of users') {\n            tags[i][1].push(groupsNames);\n          }\n          $('.config').append(_this.elements[tags[i][0]](tags[i][1]));\n          if (variable === 'Group of users') {\n            tags[i][1].pop();\n          }\n        });\n      }\n      if (variable ==='date') {\n        $('.datepicker').pickadate({\n          selectMonths: true,\n          selectYears: 15\n        });\n      }\n    }\n    document.getElementById('allow').checked = false;\n    document.getElementById('block').checked = false;\n    $('.ok-btn').off();\n    $('.ok-btn').on('click', (event) => {\n      if ($(\"input[name='rule-new-decision']:checked\")[0] !== undefined) {\n        let info = _this._getInfo(variable);\n        let decision = $(\"input[name='rule-new-decision']:checked\")[0].id;\n        decision = decision === 'allow';\n        let scope = $('.scopes').find(\":selected\")[0].id;\n        let target = $('.scopes').find(\":selected\")[0].textContent;\n        target = (target === 'All identities and hyperties') ? 'global' : target;\n        _this.policiesManager.setInfo(variable, policyTitle, info, decision, scope, target).then(() => {\n          $('.rule-new').closeModal();\n          _this._goHome();\n        });\n      } else {\n        throw Error('INFORMATION MISSING: please specify an authorisation decision.');\n      }\n    });\n  }\n\n  _deleteInfo(resourceType) {\n    let id = event.target.closest('tr').id;\n    let splitId = id.split(':');\n    let scope = splitId[0];\n    splitId.shift();\n    let target = splitId.join('');\n    let condition = event.target.closest('tr').children[0].id;\n    this.policiesManager.deleteInfo(resourceType, scope, target, condition);\n    this._goHome();\n  }\n\n  _setListeners() {\n    $('.settings-btn').on('click', (event) => {\n      parent.postMessage({ body: { method: 'showAdminPage' }, to: 'runtime:gui-manager' }, '*');\n      $('.admin-page').removeClass('hide');\n      // document.getElementsByTagName('body')[0].style = 'background-color:white;';\n    });\n\n    $('.policies-page-show').on('click', (event) => {\n      $('.policies-section').removeClass('hide');\n      $('.identities-section').addClass('hide');\n      this._goHome();\n      this._manageGroups();\n    });\n\n    $('.admin-page-exit').on('click', (event) => {\n      parent.postMessage({ body: { method: 'hideAdminPage' }, to: 'runtime:gui-manager' }, '*');\n      $('.admin-page').addClass('hide');\n      // document.getElementsByTagName('body')[0].style = 'background-color:transparent;';\n    });\n\n    $('.exit-btn').on('click', (event) => {\n      $('.subscription-type').addClass('hide');\n      $('.help-menu').addClass('hide');\n    });\n\n    $('#policy-file').on('change', (event) => {\n      let file = event.target.files[0];\n      let reader = new FileReader();\n      reader.readAsText(file, \"UTF-8\");\n      reader.onload = (event) => {\n        this._parseFileContent(event.target.result);\n        this._goHome();\n      }\n      reader.onerror = (event) => {\n        throw Error(\"Error reading the file\");\n      }\n    });\n  }\n\n  _showRule(event) {\n    let ruleTitle = event.target.textContent;\n    let id = event.target.closest('tr').id;\n    let splitId = id.split(':');\n    let priority = splitId[splitId.length - 1];\n    splitId.pop();\n    let policyTitle = splitId.join(':');\n    this.policiesManager.getRuleOfPolicy(policyTitle, priority).then((rule) => {\n      if (rule.condition.attribute === 'subscription' && rule.condition.params === 'preauthorised') {\n        $('.authorise-btns').addClass('hide');\n      } else {\n        let element;\n        if (rule.decision) {\n          element = document.getElementById('btn-allow');\n        } else {\n          element = document.getElementById('btn-block');\n        }\n        element.checked = true;\n        $('.authorise-btns').removeClass('hide');\n      }\n      $('.member-add').addClass('hide');\n      $('.member-new-btn').addClass('hide');\n\n      $('.rule-details').openModal();\n      $('.rule-title').html('<h5><b>' + ruleTitle + '</b></h5>');\n      if (rule.condition.attribute === 'subscription') {\n        $('.subscription-type').removeClass('hide');\n      }\n      $('.subscription-decision').on('click', (event) => { this._updateRule('subscription', policyTitle, rule); });\n      $('.decision').off();\n      $('.decision').on('click', (event) => { this._updateRule('authorisation', policyTitle, rule);});\n    });\n  }\n\n  _updateRule(type, policyTitle, rule) {\n    let _this = this;\n    let title = $('.rule-title').text();\n    let splitTitle = title.split(' ');\n    let index = splitTitle.indexOf('is');\n    if (index === -1) {\n      index = splitTitle.indexOf('are');\n    }\n    switch (type) {\n      case 'authorisation':\n        let newDecision = $(\"input[name='rule-update-decision']:checked\")[0].id;\n\n        if (newDecision === 'btn-allow') {\n          splitTitle[index + 1] = 'allowed';\n          newDecision = true;\n        } else {\n          splitTitle[index + 1] = 'blocked';\n          newDecision = false;\n        }\n        title = splitTitle.join(' ');\n        $('.rule-title').html('<h5><b>' + title + '</b></h5>');\n        _this.policiesManager.updatePolicy(policyTitle, rule, newDecision).then(() => {\n          _this._goHome();\n        });\n        break;\n      case 'subscription':\n        let newSubscriptionType = event.target.labels[0].textContent;\n\n        let decision = splitTitle[index + 1];\n        splitTitle = title.split('hyperties are');\n        if (newSubscriptionType === 'All subscribers') {\n          $('.authorise-btns').removeClass('hide');\n          newDecision = rule.decision;\n          newSubscriptionType = '*';\n          title = 'Subscriptions from all hyperties are' + splitTitle[1];\n        } else {\n          $('.authorise-btns').addClass('hide');\n          newDecision = true;\n          newSubscriptionType = 'preauthorised';\n          title = 'Subscriptions from previously authorised hyperties are' + splitTitle[1];\n        }\n\n        $('.rule-title').html('<h5><b>' + title + '</b></h5>');\n        _this.policiesManager.updatePolicy(policyTitle, rule, newDecision, newSubscriptionType).then(() => {\n          _this._goHome();\n        });\n        break;\n    }\n  }\n}\n\nexport default PoliciesGUI;\n","class PoliciesManager {\n\n  constructor(pepGuiURL, pepURL, messageBus) {\n    let _this = this;\n    _this._guiURL = pepGuiURL;\n    _this._pepURL = pepURL;\n    _this._messageBus = messageBus;\n\n    // assume prepare attributes is called after this\n  }\n\n  callPolicyEngineFunc(methodName, parameters) {\n    let _this = this;\n    let message;\n\n    return new Promise((resolve, reject) => {\n      message = { type: 'execute', to: _this._pepURL, from: _this._guiURL,\n        body: { resource: 'policy', method: methodName, params: parameters }, };\n      _this._messageBus.postMessage(message, (res) => {\n        let result = res.body.value;\n        resolve(result);\n      });\n    });\n  }\n\n  prepareAttributes() {\n    return new Promise((resolve, reject) => {\n      let _this = this;\n      _this.callPolicyEngineFunc('userPolicies', {}).then((userPolicies) => {\n        _this.policies = userPolicies;\n        _this.variables = _this.setVariables();\n        _this.addition = _this.setAdditionMethods();\n        _this.validation = _this.setValidationMethods();\n        resolve();\n      });\n    });\n  }\n\n  addToGroup(groupName, user) {\n    return this.callPolicyEngineFunc('addToGroup', {groupName: groupName, userEmail: user});\n  }\n\n  createGroup(groupName) {\n    return this.callPolicyEngineFunc('createGroup', {groupName: groupName});\n  }\n\n  addPolicy(title, combiningAlgorithm, policy) {\n    if (policy === undefined) {\n      switch (combiningAlgorithm) {\n        case 'Block overrides':\n          combiningAlgorithm = 'blockOverrides';\n          break;\n        case 'Allow overrides':\n          combiningAlgorithm = 'allowOverrides';\n          break;\n        case 'First applicable':\n          combiningAlgorithm = 'firstApplicable';\n          break;\n        default:\n          combiningAlgorithm = undefined;\n      }\n    }\n\n    return this.callPolicyEngineFunc('addPolicy',\n      {source: 'USER', key: title, policy: policy, combiningAlgorithm: combiningAlgorithm});\n  }\n\n  decreaseRulePriority(policyTitle, thisPriority, newPriority) {\n    this.getRuleOfPolicy(policyTitle, newPriority).priority = thisPriority;\n    this.getRuleOfPolicy(policyTitle, thisPriority).priority = newPriority;\n    return this.callPolicyEngineFunc('savePolicies', {source: 'USER'});\n  }\n\n  deleteGroup(groupName) {\n    return this.callPolicyEngineFunc('deleteGroup', {groupName: groupName});\n  }\n\n  deletePolicy(title) {\n    return this.callPolicyEngineFunc('removePolicy', {source: 'USER', key: title});\n  }\n\n  deleteRule(policyTitle, rule) {\n    let _this = this;\n\n    return new Promise((resolve, reject) => {\n      _this.callPolicyEngineFunc('userPolicies', {}).then((userPolicies) => {\n        userPolicies[policyTitle].deleteRule(rule);\n        _this.callPolicyEngineFunc('savePolicies', {source: 'USER'}).then(() => {\n          resolve();\n        });\n      });\n    });\n  }\n\n  getActivePolicy() {\n    return this.callPolicyEngineFunc('activeUserPolicy', {});\n  }\n\n  getPolicy(key) {\n    return this.callPolicyEngineFunc('userPolicy', {key: key});\n  }\n\n  getPoliciesTitles() {\n    let _this = this;\n    return new Promise((resolve, reject) => {\n      _this.callPolicyEngineFunc('userPolicies', {}).then((policies) => {\n        let titles = [];\n\n        for (let i in policies) {\n          titles.push(i);\n        }\n\n        resolve(titles);\n      });\n    });\n  }\n\n  getTargets(scope) {\n    let targets = [];\n\n    for (let i in this.policies[scope]) {\n      if (targets.indexOf(i) === -1) {\n        targets.push(i);\n      }\n    }\n\n    return targets;\n  }\n\n  increaseRulePriority(policyTitle, thisPriority, newPriority) {\n    let _this = this;\n    _this.getRuleOfPolicy(policyTitle, thisPriority).priority = newPriority;\n    _this.getRuleOfPolicy(policyTitle, newPriority).priority = thisPriority;\n    return _this.callPolicyEngineFunc('savePolicies', {source: 'USER'});\n  }\n\n  setVariables() {\n    return {\n      'Date': {\n        title: '<br><h5>Updating date related configurations</h5><p>Incoming communications in the introduced date will be allowed or blocked according to your configurations, which can be changed in the preferences page.</p><br>',\n        description: '<p>Date:</p>',\n        input: [\n          ['date', []]\n        ]\n      },\n      'Domain': {\n        title: '<br><h5>Updating domain configurations</h5><p>Incoming communications from a user whose identity is from the introduced domain allowed or blocked according to your configurations, which can be changed in the preferences page.</p><br>',\n        description: '<p>Domain:</p>',\n        input: [\n          ['form', []]\n        ]\n      },\n      'Group of users': {\n        title: '<br><h5>Updating groups configurations</h5><p>Incoming communications from a user whose identity is in the introduced group will be allowed or blocked according to your configurations, which can be changed in the preferences page.</p><br>',\n        description: '<p>Group name:</p>',\n        input: [\n          ['select', ['group', 'Select a group:']]\n        ]\n      },\n      'Subscription preferences': {\n        title: '<br><h5>Updating subscriptions configurations</h5><p>The acceptance of subscriptions to your hyperties will be allowed or blocked according to your configurations, which can be changed in the preferences page.</p><br>',\n        input: []\n      },\n      'Time of the day': {\n        title: '<br><h5>Updating time configurations</h5><p>Incoming communications in the introduced timeslot will be blocked, but this can be changed in the preferences page.</p><p>Please introduce a new timeslot in the following format:</p><p class=\"center-align\">&lt;START-HOUR&gt;:&lt;START-MINUTES&gt; to &lt;END-HOUR&gt;:&lt;END-MINUTES&gt;</p><br>',\n        description: '<p>Timeslot:</p>',\n        input: [\n          ['form', []]\n        ]\n      },\n      Weekday: {\n        title: '<br><h5>Updating weekday configurations</h5><p>Incoming communications in the introduced weekday will be allowed or blocked according to your configurations, which can be changed in the preferences page.</p><br>',\n        description: '<p>Weekday:</p>',\n        input: [\n          ['select', ['weekday', 'Select a weekday:', ['Saturday', 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday']]]\n        ]\n      }\n    };\n  }\n\n  setAdditionMethods() {\n    let _this = this;\n    return {\n      Date: (params) => {\n        return new Promise((resolve, reject) => {\n          let policyTitle = params[0];\n          _this.callPolicyEngineFunc('userPolicies', {}).then((userPolicies) => {\n            userPolicies[policyTitle].createRule(params[4], { attribute: 'date', operator: 'equals', params: params[3] }, params[1], params[2]);\n            _this.callPolicyEngineFunc('savePolicies', {source: 'USER'}).then(() => {\n              resolve();\n            });\n          });\n        });\n      },\n      Domain: (params) => {\n        return new Promise((resolve, reject) => {\n          let policyTitle = params[0];\n          _this.callPolicyEngineFunc('userPolicies', {}).then((userPolicies) => {\n            userPolicies[policyTitle].createRule(params[4], { attribute: 'domain', operator: 'equals', params: params[3] }, params[1], params[2]);\n            _this.callPolicyEngineFunc('savePolicies', {source: 'USER'}).then(() => {\n              resolve();\n            });\n          });\n        });\n      },\n      'Group of users': (params) => {\n        return new Promise((resolve, reject) => {\n          let policyTitle = params[0];\n          _this.callPolicyEngineFunc('userPolicies', {}).then((userPolicies) => {\n            userPolicies[policyTitle].createRule(params[4], { attribute: 'source', operator: 'in', params: params[3] }, params[1], params[2]);\n            _this.callPolicyEngineFunc('savePolicies', {source: 'USER'}).then(() => {\n              resolve();\n            });\n          });\n        });\n      },\n      'Subscription preferences': (params) => {\n        return new Promise((resolve, reject) => {\n          let policyTitle = params[0];\n          _this.callPolicyEngineFunc('userPolicies', {}).then((userPolicies) => {\n            let operator = 'equals';\n            if (params[3] === 'preauthorised') {\n              operator = 'in';\n            }\n\n            // TIAGO: this is giving me an error...\n            userPolicies[policyTitle].createRule(params[4], { attribute: 'subscription', operator: operator, params: params[3] }, params[1], params[2]);\n            _this.callPolicyEngineFunc('savePolicies', {source: 'USER'}).then(() => {\n              resolve();\n            });\n          });\n        });\n      },\n      'Time of the day': (params) => {\n        return new Promise((resolve, reject) => {\n          let policyTitle = params[0];\n          _this.callPolicyEngineFunc('userPolicies', {}).then((userPolicies) => {\n            params[3] = params[3].split(' to ');\n            let start = params[3][0].split(':');\n            start = start.join('');\n            let end = params[3][1].split(':');\n            end = end.join('');\n            userPolicies[policyTitle].createRule(params[4], { attribute: 'time', operator: 'between', params: [start, end] }, params[1], params[2]);\n            _this.callPolicyEngineFunc('savePolicies', {source: 'USER'}).then(() => {\n              resolve();\n            });\n          });\n        });\n      },\n\n      Weekday: (params) => {\n        return new Promise((resolve, reject) => {\n          let weekdays = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n          params[3] = weekdays.indexOf(params[3]);\n          let policyTitle = params[0];\n          _this.callPolicyEngineFunc('userPolicies', {}).then((userPolicies) => {\n            userPolicies[policyTitle].createRule(params[4], { attribute: 'weekday', operator: 'equals', params: params[3] }, params[1], params[2]);\n            _this.callPolicyEngineFunc('savePolicies', {source: 'USER'}).then(() => {\n              resolve();\n            });\n          });\n        });\n      }\n    };\n  }\n\n  setValidationMethods() {\n    return {\n      Date: (scope, info) => { return this.isValidDate(info) & this.isValidScope(scope); },\n      'Group of users': (scope, info) => { return this.isValidString(info) & this.isValidScope(scope); },\n      Domain: (scope, info) => { return this.isValidDomain(info) & this.isValidScope(scope); },\n      Weekday: (scope, info) => { return true & this.isValidScope(scope); },\n      'Subscription preferences': (scope, info) => { return this.isValidSubscriptionType(info) & this.isValidScope(scope); },\n      'Time of the day': (scope, info) => { return this.isValidTimeslot(info) & this.isValidScope(scope); }\n    };\n  }\n\n  updateActivePolicy(title) {\n    let _this = this;\n    return new Promise((resolve, reject) => {\n      _this.callPolicyEngineFunc('activeUserPolicy', {userPolicy: title}).then(() => {\n        _this.callPolicyEngineFunc('saveActivePolicy', {}).then(() => {\n          resolve();\n        });\n      });\n    });\n  }\n\n  isValidEmail(info) {\n    let pattern = /[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,3}$/;\n    return pattern.test(info);\n  }\n\n  isValidDomain(info) {\n    let pattern = /[a-z0-9.-]+\\.[a-z]{2,3}$/;\n    return pattern.test(info);\n  }\n\n  isValidString(info) {\n    let pattern = /[a-z0-9.-]$/;\n    return pattern.test(info);\n  }\n\n  isValidSubscriptionType(info) {\n    return true;\n  }\n\n  isValidDate(info) {\n    let infoSplit = info.split('/');\n    let day = parseInt(infoSplit[0]);\n    let month = parseInt(infoSplit[1]);\n    let year = parseInt(infoSplit[2]);\n\n    let date = new Date(year, month-1, day);\n    let isValidFormat = date.getFullYear() === year && date.getMonth() + 1 === month && date.getDate() === day;\n    let formattedDate = date.getDate() + '/' + (date.getMonth() + 1) + '/' + date.getFullYear()\n    let now = new Date();\n    let today = now.getDate() + '/' + (now.getMonth() + 1) + '/' + now.getFullYear();\n\n    let isFuture = false;\n    if (date.getFullYear() > now.getFullYear()) {\n      isFuture = true;\n    } else {\n      if (date.getFullYear() == now.getFullYear()) {\n        if ((date.getMonth() + 1) > (now.getMonth() + 1)) {\n          isFuture = true;\n        } else {\n          if ((date.getMonth() + 1) == (now.getMonth() + 1)) {\n            if (date.getDate() >= (now.getDate())) {\n              isFuture = true;\n            }\n          }\n        }\n      }\n    }\n\n    return (isValidFormat && isFuture);\n  }\n\n  isValidScope(scope) {\n    return scope !== '';\n  }\n\n  isValidTimeslot(info) {\n    if (!info) {\n      return false;\n    }\n    let splitInfo = info.split(' to '); // [12:00, 13:00]\n    let twoTimes = splitInfo.length === 2;\n    if (!twoTimes) {\n      return false;\n    }\n    let splitStart = splitInfo[0].split(':'); // [12, 00]\n    let splitEnd = splitInfo[1].split(':'); // [13, 00]\n    if (splitStart.length !== 2 || splitEnd.length !== 2) {\n      return false;\n    }\n    let okSize = (splitStart[0].length === 2) && (splitStart[1].length === 2) && (splitEnd[0].length === 2) && (splitEnd[1].length === 2);\n    let areIntegers = (splitStart[0] == parseInt(splitStart[0], 10)) && (splitStart[1] == parseInt(splitStart[1], 10)) && (splitEnd[0] == parseInt(splitEnd[0], 10)) && (splitEnd[1] == parseInt(splitEnd[1], 10));\n    return twoTimes && okSize && areIntegers;\n  }\n\n  getFormattedPolicies() {\n    let _this = this;\n    return new Promise((resolve, reject) => {\n      _this.callPolicyEngineFunc('userPolicies', {}).then((policiesPE) => {\n        let policiesGUI = [];\n\n        for (let i in policiesPE) {\n          let policy = {\n            title: policiesPE[i].key,\n            rulesTitles: [],\n            ids: []\n          }\n\n          if (policiesPE[i].rules.length !== 0) {\n            policiesPE[i].rules = policiesPE[i].sortRules();\n            for (let j in policiesPE[i].rules) {\n              let title = _this._getTitle(policiesPE[i].rules[j]);\n              policy.rulesTitles.push(title);\n              policy.ids.push(policy.title + ':' + policiesPE[i].rules[j].priority);\n            }\n          }\n\n          policiesGUI.push(policy);\n        }\n\n        resolve(policiesGUI);\n      });\n    });\n  }\n\n  getRuleOfPolicy(title, priority) {\n    let _this = this;\n    return new Promise((resolve, reject) => {\n      _this.callPolicyEngineFunc('userPolicies', {}).then((policies) => {\n        let policy = policies[title];\n        resolve(policy.getRuleByPriority(priority));\n      });\n    });\n  }\n\n  _getTitle(rule) {\n    let condition = rule.condition;\n    let authorise = (rule.decision) ? 'allowed' : 'blocked';\n    let target = rule.target === 'global' ? 'All identities and hyperties' : rule.target;\n    let attribute = condition.attribute;\n    switch(attribute) {\n      case 'date':\n        return 'Date ' + condition.params + ' is ' + authorise + ' (' + target + ')';\n      case 'domain':\n        return 'Domain \\\"' + condition.params + '\\\" is ' + authorise + ' (' + target + ')';\n      case 'source':\n        if (condition.operator === 'in') {\n          return 'Group \\\"' + condition.params + '\\\" is ' + authorise + ' (' + target + ')';\n        } else {\n          if (condition.operator === 'equals') {\n            return 'User ' + condition.params + ' is ' + authorise + ' (' + target + ')';\n          }\n        }\n      case 'subscription':\n        if (condition.params === '*') {\n          return 'Subscriptions from all hyperties are ' + authorise + ' (' + target + ')';\n        } else {\n          if (condition.params === 'preauthorised') {\n            return 'Subscriptions from previously authorised hyperties are allowed (' + target + ')';\n          }\n        }\n      case 'time':\n        let start = condition.params[0][0] + condition.params[0][1] + ':' + condition.params[0][2] + condition.params[0][3];\n        let end = condition.params[1][0] + condition.params[1][1] + ':' + condition.params[1][2] + condition.params[1][3];\n        return 'Timeslot from ' + start + ' to ' + end + ' is ' + authorise + ' (' + target + ')';\n      case 'weekday':\n        let weekdays = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n        let weekdayID = condition.params;\n        return 'Weekday \\\"' + weekdays[weekdayID] + '\\\" is ' + authorise + ' (' + target + ')';\n      default:\n        return 'Rule ' + rule.priority + ' is ' + authorise + ' (' + target + ')';\n    }\n  }\n\n  getVariables() {\n    let variablesTitles = [];\n    for (let i in this.variables) {\n      variablesTitles.push(i);\n    }\n    return variablesTitles;\n  }\n\n  getVariableInfo(variable) {\n    return this.variables[variable];\n  }\n\n  getMyEmails() {\n    return this.callPolicyEngineFunc('getMyEmails', {});\n  }\n\n  getMyHyperties() {\n    return this.callPolicyEngineFunc('getMyHyperties', {});\n  }\n\n  //TODO If there is a problem with the input, show it to the user\n  setInfo(variable, policyTitle, info, authorise, scope, target) {\n    let _this = this;\n    return new Promise((resolve, reject) => {\n      if (_this.validation[variable](scope, info)) {\n        _this.addition[variable]([policyTitle, scope, target, info, authorise]).then(() => {\n          resolve();\n        });\n      } else {\n        reject('Invalid configuration');\n      }\n    });\n  }\n\n  deleteInfo(variable, scope, target, info) {\n    let params = [scope, target, info];\n    if (variable === 'member') {\n      let conditionSplit = info.split(' ');\n      let groupName = conditionSplit[2];\n      params = [scope, groupName, info];\n    }\n    this.deletion[variable](params);\n  }\n\n  getGroups() {\n    let _this = this;\n    return new Promise((resolve, reject) => {\n      _this.callPolicyEngineFunc('groups', {}).then((groups) => {\n        let groupsGUI = {\n          groupsNames: [],\n          members: [],\n          ids: []\n        };\n\n        for (let i in groups) {\n          groupsGUI.groupsNames.push(i);\n          groupsGUI.members.push(groups[i]);\n          let ids = [];\n          for (let j in groups[i]) {\n            ids.push(i + '::' + groups[i][j]);\n          }\n          groupsGUI.ids.push(ids);\n        }\n\n        //console.log('TIAGO groups', groupsGUI)\n        resolve(groupsGUI);\n      });\n    });\n  }\n\n  getGroupsNames() {\n    return this.callPolicyEngineFunc('getGroupsNames', {});\n  }\n\n  removeFromGroup(groupName, user) {\n    return this.callPolicyEngineFunc('removeFromGroup', {groupName: groupName, userEmail: user});\n  }\n\n  updatePolicy(policyTitle, rule, newDecision, newSubscriptionType) {\n    let _this = this;\n    return new Promise((resolve, reject) => {\n      _this.callPolicyEngineFunc('userPolicies', {}).then((userPolicies) => {\n        userPolicies[policyTitle].deleteRule(rule);\n        if (!newSubscriptionType) {\n          userPolicies[policyTitle].createRule(newDecision, rule.condition, rule.scope, rule.target, rule.priority);\n        } else {\n          let operator = (newSubscriptionType === '*') ? 'equals' : 'in';\n          userPolicies[policyTitle].createRule(newDecision, [{ attribute: 'subscription', opeator: operator, params: newSubscriptionType }], rule.scope, rule.target, rule.priority);\n        }\n\n        _this.callPolicyEngineFunc('saveActivePolicy', {}).then(() => {\n          resolve();\n        });\n      });\n    });\n  }\n\n}\n\nexport default PoliciesManager;\n","/**\n* Copyright 2016 PT Inovao e Sistemas SA\n* Copyright 2016 INESC-ID\n* Copyright 2016 QUOBIS NETWORKS SL\n* Copyright 2016 FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V\n* Copyright 2016 ORANGE SA\n* Copyright 2016 Deutsche Telekom AG\n* Copyright 2016 Apizee\n* Copyright 2016 TECHNISCHE UNIVERSITAT BERLIN\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n**/\nimport URI from 'urijs';\nimport IdentitiesGUI from './admin/IdentitiesGUI';\nimport PoliciesGUI from './admin/PoliciesGUI';\nimport RuntimeFactory from './RuntimeFactory';\n\ntry {\n  window.cordova = parent.cordova !== undefined;\n  if (window.cordova) { window.open = function(url) { return parent.cordova.InAppBrowser.open(url, '_blank', 'location=no,toolbar=no'); }; }\n} catch (err) { console.log('cordova not supported'); }\n\nfunction returnHyperty(source, hyperty) {\n  source.postMessage({to: 'runtime:loadedHyperty', body: hyperty}, '*');\n}\n\nfunction searchHyperty(runtime, descriptor) {\n  let hyperty = undefined;\n  let index = 0;\n  while (!hyperty && index < runtime.registry.hypertiesList.length) {\n    if (runtime.registry.hypertiesList[index].descriptor === descriptor) { hyperty = runtime.registry.hypertiesList[index]; }\n\n    index++;\n  }\n\n  return hyperty;\n}\n\nlet parameters = new URI(window.location).search(true);\nlet runtimeURL = parameters.runtime;\nlet domain = parameters.domain;\nlet development = parameters.development === 'true';\nlet catalogue = RuntimeFactory.createRuntimeCatalogue(development);\nlet runtimeDescriptor;\ncatalogue.getRuntimeDescriptor(runtimeURL)\n  .then(function(descriptor) {\n    runtimeDescriptor = descriptor;\n    let sourcePackageURL = descriptor.sourcePackageURL;\n    if (sourcePackageURL === '/sourcePackage') {\n      return descriptor.sourcePackage;\n    }\n    return catalogue.getSourcePackageFromURL(sourcePackageURL);\n  })\n  .then(function(sourcePackage) {\n    eval.apply(window, [sourcePackage.sourceCode]);\n\n    //let runtime = new Runtime(RuntimeFactory, window.location.host);\n    if (!domain) domain = window.location.host;\n    let runtime = new Runtime(runtimeDescriptor, RuntimeFactory, domain);\n    window.runtime = runtime;\n    runtime.init().then(function(result) {\n\n      // TIAGO\n      if (!runtime.policyEngine) throw Error('Policy Engine is not set!');\n      let pepGuiURL = runtime.policyEngine.context.guiURL;\n      let pepURL = runtime.policyEngine.context.pepURL;\n      let pepGUI = new PoliciesGUI(pepGuiURL, pepURL, runtime.policyEngine.messageBus, runtime.policyEngine);\n\n      pepGUI.prepareAttributes().then(() => {\n        let idmGuiURL = runtime.identityModule._runtimeURL + '/identity-gui';\n        let idmURL = runtime.identityModule._runtimeURL + '/idm';\n        let identitiesGUI = new IdentitiesGUI(idmGuiURL, idmURL, runtime.identityModule.messageBus);\n\n        window.addEventListener('message', function(event) {\n          if (event.data.to === 'core:loadHyperty') {\n            let descriptor = event.data.body.descriptor;\n            let reuseAddress = event.data.body.reuseAddress;\n            let requireHypertyID = event.data.body.id;\n\n            let hyperty = searchHyperty(runtime, descriptor);\n\n            if (hyperty) {\n              returnHyperty(event.source, { runtimeHypertyURL: hyperty.hypertyURL, id: requireHypertyID});\n            } else {\n              runtime.loadHyperty(descriptor, reuseAddress).then(function(hyperty) {\n                hyperty.id = requireHypertyID;\n                returnHyperty(event.source, hyperty);\n              });\n            }\n          } else if (event.data.to === 'core:loadStub') {\n            runtime.loadStub(event.data.body.domain).then((result) => {\n              console.log('Stub Loaded: ', result);\n            }).catch((error) => {\n              console.error('Stub error:', error);\n            });\n          } else if (event.data.to === 'core:close') {\n            runtime.close(event.data.body.logOut).then((result)=>{\n                event.source.postMessage({to: 'runtime:runtimeClosed', body: result}, '*')\n              })\n              .catch((result)=>{\n                event.source.postMessage({to: 'runtime:runtimeClosed', body: result}, '*')\n              });\n\n            //  send logout\n            identitiesGUI.logOut().then((result) => {\n              console.log(result);\n            });\n\n          } else if (event.data.to === 'core:reset') {\n            runtime.reset().then(function(result) {\n                event.source.postMessage({to: 'runtime:runtimeReset', body: result}, '*')\n              });\n\n            //  send logout\n            identitiesGUI.logOut().then((result) => {\n              console.log(result);\n            });\n\n          } else if (event.data.to === 'core:login') {\n            console.log('core: logging with ', event.data.body.idp);\n            identitiesGUI.loginWithIDP(event.data.body.idp).then((result) => {\n              event.source.postMessage({to: 'runtime:loggedIn', body: result}, '*');\n            });\n          } else if (event.data.to === 'core:authorise') {\n            console.log('core:authorise ', event.data.body.idp, event.data.body.scope);\n            identitiesGUI.authorise(event.data.body.idp, event.data.body.scope).then((result) => {\n              event.source.postMessage({ to: 'runtime:authorised', body: JSON.stringify(result) }, '*');\n            });\n          }\n\n\n        }, false);\n\n        window.addEventListener('beforeunload', (e) => {\n          runtime.close();\n        });\n\n        parent.postMessage({to: 'runtime:installed', body: {}}, '*');\n\n      });\n    });\n  });\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvZGV4aWUvZGlzdC9kZXhpZS5qcyIsIm5vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanMiLCJub2RlX21vZHVsZXMvcnVudGltZS1jb3JlL2Rpc3QvbWluaWJ1cy5qcyIsIm5vZGVfbW9kdWxlcy9ydW50aW1lLWNvcmUvZGlzdC9zYW5kYm94LmpzIiwibm9kZV9tb2R1bGVzL3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvUGVyc2lzdGVuY2VNYW5hZ2VyLmpzIiwibm9kZV9tb2R1bGVzL3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvUnVudGltZUNhdGFsb2d1ZS5qcyIsIm5vZGVfbW9kdWxlcy9zZXJ2aWNlLWZyYW1ld29yay9kaXN0L1N0b3JhZ2VNYW5hZ2VyLmpzIiwibm9kZV9tb2R1bGVzL3RpbWVycy1icm93c2VyaWZ5L21haW4uanMiLCJub2RlX21vZHVsZXMvdXJpanMvc3JjL0lQdjYuanMiLCJub2RlX21vZHVsZXMvdXJpanMvc3JjL1NlY29uZExldmVsRG9tYWlucy5qcyIsIm5vZGVfbW9kdWxlcy91cmlqcy9zcmMvVVJJLmpzIiwibm9kZV9tb2R1bGVzL3VyaWpzL3NyYy9wdW55Y29kZS5qcyIsInNyYy9SZXF1ZXN0LmpzIiwic3JjL1J1bnRpbWVDYXBhYmlsaXRpZXMuanMiLCJzcmMvUnVudGltZUZhY3RvcnkuanMiLCJzcmMvU2FuZGJveEFwcC5qcyIsInNyYy9TYW5kYm94ZXMuanMiLCJzcmMvYWRtaW4vSWRlbnRpdGllc0dVSS5qcyIsInNyYy9hZG1pbi9Qb2xpY2llc0dVSS5qcyIsInNyYy9hZG1pbi9Qb2xpY2llc01hbmFnZXIuanMiLCJzcmMvY29yZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUM1L0lBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3REQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDM0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNseUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QUFiLENBQXlCLEVBQUUsSUFBSSxvQkFBTixFQUE0QixNQUFNLEtBQUssU0FBTCxDQUFlLE1BQWYsQ0FBbEMsRUFBekIsRUFBcUYsR0FBckY7QUFDRCxXQUZEO0FBR0Q7QUFHRixPQTFERCxFQTBERyxLQTFESDs7QUE0REEsYUFBTyxnQkFBUCxDQUF3QixjQUF4QixFQUF3QyxVQUFDLENBQUQsRUFBTztBQUM3QyxnQkFBUSxLQUFSO0FBQ0QsT0FGRDs7QUFJQSxhQUFPLFdBQVAsQ0FBbUIsRUFBQyxJQUFJLG1CQUFMLEVBQTBCLE1BQU0sRUFBaEMsRUFBbkIsRUFBd0QsR0FBeEQ7QUFFRCxLQXZFRDtBQXdFRCxHQWhGRDtBQWlGRCxDQWpHSCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIihmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG4gICB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6XG4gICB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOlxuICAgKGdsb2JhbC5EZXhpZSA9IGZhY3RvcnkoKSk7XG59KHRoaXMsIChmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuLypcclxuKiBEZXhpZS5qcyAtIGEgbWluaW1hbGlzdGljIHdyYXBwZXIgZm9yIEluZGV4ZWREQlxyXG4qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbipcclxuKiBCeSBEYXZpZCBGYWhsYW5kZXIsIGRhdmlkLmZhaGxhbmRlckBnbWFpbC5jb21cclxuKlxyXG4qIFZlcnNpb24gMS41LjEsIFR1ZSBOb3YgMDEgMjAxNlxyXG4qIHd3dy5kZXhpZS5jb21cclxuKiBBcGFjaGUgTGljZW5zZSBWZXJzaW9uIDIuMCwgSmFudWFyeSAyMDA0LCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvXHJcbiovXG52YXIga2V5cyA9IE9iamVjdC5rZXlzO1xudmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5O1xudmFyIF9nbG9iYWwgPSB0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiBnbG9iYWw7XG5cbmZ1bmN0aW9uIGV4dGVuZChvYmosIGV4dGVuc2lvbikge1xuICAgIGlmICh0eXBlb2YgZXh0ZW5zaW9uICE9PSAnb2JqZWN0JykgcmV0dXJuIG9iajtcbiAgICBrZXlzKGV4dGVuc2lvbikuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIG9ialtrZXldID0gZXh0ZW5zaW9uW2tleV07XG4gICAgfSk7XG4gICAgcmV0dXJuIG9iajtcbn1cblxudmFyIGdldFByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mO1xudmFyIF9oYXNPd24gPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbmZ1bmN0aW9uIGhhc093bihvYmosIHByb3ApIHtcbiAgICByZXR1cm4gX2hhc093bi5jYWxsKG9iaiwgcHJvcCk7XG59XG5cbmZ1bmN0aW9uIHByb3BzKHByb3RvLCBleHRlbnNpb24pIHtcbiAgICBpZiAodHlwZW9mIGV4dGVuc2lvbiA9PT0gJ2Z1bmN0aW9uJykgZXh0ZW5zaW9uID0gZXh0ZW5zaW9uKGdldFByb3RvKHByb3RvKSk7XG4gICAga2V5cyhleHRlbnNpb24pLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICBzZXRQcm9wKHByb3RvLCBrZXksIGV4dGVuc2lvbltrZXldKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gc2V0UHJvcChvYmosIHByb3AsIGZ1bmN0aW9uT3JHZXRTZXQsIG9wdGlvbnMpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBwcm9wLCBleHRlbmQoZnVuY3Rpb25PckdldFNldCAmJiBoYXNPd24oZnVuY3Rpb25PckdldFNldCwgXCJnZXRcIikgJiYgdHlwZW9mIGZ1bmN0aW9uT3JHZXRTZXQuZ2V0ID09PSAnZnVuY3Rpb24nID8geyBnZXQ6IGZ1bmN0aW9uT3JHZXRTZXQuZ2V0LCBzZXQ6IGZ1bmN0aW9uT3JHZXRTZXQuc2V0LCBjb25maWd1cmFibGU6IHRydWUgfSA6IHsgdmFsdWU6IGZ1bmN0aW9uT3JHZXRTZXQsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSwgb3B0aW9ucykpO1xufVxuXG5mdW5jdGlvbiBkZXJpdmUoQ2hpbGQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBmcm9tOiBmdW5jdGlvbiAoUGFyZW50KSB7XG4gICAgICAgICAgICBDaGlsZC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBhcmVudC5wcm90b3R5cGUpO1xuICAgICAgICAgICAgc2V0UHJvcChDaGlsZC5wcm90b3R5cGUsIFwiY29uc3RydWN0b3JcIiwgQ2hpbGQpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBleHRlbmQ6IHByb3BzLmJpbmQobnVsbCwgQ2hpbGQucHJvdG90eXBlKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH07XG59XG5cbnZhciBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO1xuXG5mdW5jdGlvbiBnZXRQcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBwcm9wKSB7XG4gICAgdmFyIHBkID0gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwgcHJvcCksXG4gICAgICAgIHByb3RvO1xuICAgIHJldHVybiBwZCB8fCAocHJvdG8gPSBnZXRQcm90byhvYmopKSAmJiBnZXRQcm9wZXJ0eURlc2NyaXB0b3IocHJvdG8sIHByb3ApO1xufVxuXG52YXIgX3NsaWNlID0gW10uc2xpY2U7XG5mdW5jdGlvbiBzbGljZShhcmdzLCBzdGFydCwgZW5kKSB7XG4gICAgcmV0dXJuIF9zbGljZS5jYWxsKGFyZ3MsIHN0YXJ0LCBlbmQpO1xufVxuXG5mdW5jdGlvbiBvdmVycmlkZShvcmlnRnVuYywgb3ZlcnJpZGVkRmFjdG9yeSkge1xuICAgIHJldHVybiBvdmVycmlkZWRGYWN0b3J5KG9yaWdGdW5jKTtcbn1cblxuZnVuY3Rpb24gZG9GYWtlQXV0b0NvbXBsZXRlKGZuKSB7XG4gICAgdmFyIHRvID0gc2V0VGltZW91dChmbiwgMTAwMCk7XG4gICAgY2xlYXJUaW1lb3V0KHRvKTtcbn1cblxuZnVuY3Rpb24gYXNzZXJ0KGIpIHtcbiAgICBpZiAoIWIpIHRocm93IG5ldyBFcnJvcihcIkFzc2VydGlvbiBGYWlsZWRcIik7XG59XG5cbmZ1bmN0aW9uIGFzYXAoZm4pIHtcbiAgICBpZiAoX2dsb2JhbC5zZXRJbW1lZGlhdGUpIHNldEltbWVkaWF0ZShmbik7ZWxzZSBzZXRUaW1lb3V0KGZuLCAwKTtcbn1cblxuXG5cbi8qKiBHZW5lcmF0ZSBhbiBvYmplY3QgKGhhc2ggbWFwKSBiYXNlZCBvbiBnaXZlbiBhcnJheS5cclxuICogQHBhcmFtIGV4dHJhY3RvciBGdW5jdGlvbiB0YWtpbmcgYW4gYXJyYXkgaXRlbSBhbmQgaXRzIGluZGV4IGFuZCByZXR1cm5pbmcgYW4gYXJyYXkgb2YgMiBpdGVtcyAoW2tleSwgdmFsdWVdKSB0b1xyXG4gKiAgICAgICAgaW5zdGVydCBvbiB0aGUgcmVzdWx0aW5nIG9iamVjdCBmb3IgZWFjaCBpdGVtIGluIHRoZSBhcnJheS4gSWYgdGhpcyBmdW5jdGlvbiByZXR1cm5zIGEgZmFsc3kgdmFsdWUsIHRoZVxyXG4gKiAgICAgICAgY3VycmVudCBpdGVtIHdvbnQgYWZmZWN0IHRoZSByZXN1bHRpbmcgb2JqZWN0LlxyXG4gKi9cbmZ1bmN0aW9uIGFycmF5VG9PYmplY3QoYXJyYXksIGV4dHJhY3Rvcikge1xuICAgIHJldHVybiBhcnJheS5yZWR1Y2UoZnVuY3Rpb24gKHJlc3VsdCwgaXRlbSwgaSkge1xuICAgICAgICB2YXIgbmFtZUFuZFZhbHVlID0gZXh0cmFjdG9yKGl0ZW0sIGkpO1xuICAgICAgICBpZiAobmFtZUFuZFZhbHVlKSByZXN1bHRbbmFtZUFuZFZhbHVlWzBdXSA9IG5hbWVBbmRWYWx1ZVsxXTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LCB7fSk7XG59XG5cbmZ1bmN0aW9uIHRyeWNhdGNoZXIoZm4sIHJlamVjdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiB0cnlDYXRjaChmbiwgb25lcnJvciwgYXJncykge1xuICAgIHRyeSB7XG4gICAgICAgIGZuLmFwcGx5KG51bGwsIGFyZ3MpO1xuICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICAgIG9uZXJyb3IgJiYgb25lcnJvcihleCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXRCeUtleVBhdGgob2JqLCBrZXlQYXRoKSB7XG4gICAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIvSW5kZXhlZERCLyNzdGVwcy1mb3ItZXh0cmFjdGluZy1hLWtleS1mcm9tLWEtdmFsdWUtdXNpbmctYS1rZXktcGF0aFxuICAgIGlmIChoYXNPd24ob2JqLCBrZXlQYXRoKSkgcmV0dXJuIG9ialtrZXlQYXRoXTsgLy8gVGhpcyBsaW5lIGlzIG1vdmVkIGZyb20gbGFzdCB0byBmaXJzdCBmb3Igb3B0aW1pemF0aW9uIHB1cnBvc2UuXG4gICAgaWYgKCFrZXlQYXRoKSByZXR1cm4gb2JqO1xuICAgIGlmICh0eXBlb2Yga2V5UGF0aCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdmFyIHJ2ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0ga2V5UGF0aC5sZW5ndGg7IGkgPCBsOyArK2kpIHtcbiAgICAgICAgICAgIHZhciB2YWwgPSBnZXRCeUtleVBhdGgob2JqLCBrZXlQYXRoW2ldKTtcbiAgICAgICAgICAgIHJ2LnB1c2godmFsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcnY7XG4gICAgfVxuICAgIHZhciBwZXJpb2QgPSBrZXlQYXRoLmluZGV4T2YoJy4nKTtcbiAgICBpZiAocGVyaW9kICE9PSAtMSkge1xuICAgICAgICB2YXIgaW5uZXJPYmogPSBvYmpba2V5UGF0aC5zdWJzdHIoMCwgcGVyaW9kKV07XG4gICAgICAgIHJldHVybiBpbm5lck9iaiA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogZ2V0QnlLZXlQYXRoKGlubmVyT2JqLCBrZXlQYXRoLnN1YnN0cihwZXJpb2QgKyAxKSk7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmZ1bmN0aW9uIHNldEJ5S2V5UGF0aChvYmosIGtleVBhdGgsIHZhbHVlKSB7XG4gICAgaWYgKCFvYmogfHwga2V5UGF0aCA9PT0gdW5kZWZpbmVkKSByZXR1cm47XG4gICAgaWYgKCdpc0Zyb3plbicgaW4gT2JqZWN0ICYmIE9iamVjdC5pc0Zyb3plbihvYmopKSByZXR1cm47XG4gICAgaWYgKHR5cGVvZiBrZXlQYXRoICE9PSAnc3RyaW5nJyAmJiAnbGVuZ3RoJyBpbiBrZXlQYXRoKSB7XG4gICAgICAgIGFzc2VydCh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnICYmICdsZW5ndGgnIGluIHZhbHVlKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBrZXlQYXRoLmxlbmd0aDsgaSA8IGw7ICsraSkge1xuICAgICAgICAgICAgc2V0QnlLZXlQYXRoKG9iaiwga2V5UGF0aFtpXSwgdmFsdWVbaV0pO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHBlcmlvZCA9IGtleVBhdGguaW5kZXhPZignLicpO1xuICAgICAgICBpZiAocGVyaW9kICE9PSAtMSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRLZXlQYXRoID0ga2V5UGF0aC5zdWJzdHIoMCwgcGVyaW9kKTtcbiAgICAgICAgICAgIHZhciByZW1haW5pbmdLZXlQYXRoID0ga2V5UGF0aC5zdWJzdHIocGVyaW9kICsgMSk7XG4gICAgICAgICAgICBpZiAocmVtYWluaW5nS2V5UGF0aCA9PT0gXCJcIikge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSBkZWxldGUgb2JqW2N1cnJlbnRLZXlQYXRoXTtlbHNlIG9ialtjdXJyZW50S2V5UGF0aF0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGlubmVyT2JqID0gb2JqW2N1cnJlbnRLZXlQYXRoXTtcbiAgICAgICAgICAgICAgICBpZiAoIWlubmVyT2JqKSBpbm5lck9iaiA9IG9ialtjdXJyZW50S2V5UGF0aF0gPSB7fTtcbiAgICAgICAgICAgICAgICBzZXRCeUtleVBhdGgoaW5uZXJPYmosIHJlbWFpbmluZ0tleVBhdGgsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSBkZWxldGUgb2JqW2tleVBhdGhdO2Vsc2Ugb2JqW2tleVBhdGhdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRlbEJ5S2V5UGF0aChvYmosIGtleVBhdGgpIHtcbiAgICBpZiAodHlwZW9mIGtleVBhdGggPT09ICdzdHJpbmcnKSBzZXRCeUtleVBhdGgob2JqLCBrZXlQYXRoLCB1bmRlZmluZWQpO2Vsc2UgaWYgKCdsZW5ndGgnIGluIGtleVBhdGgpIFtdLm1hcC5jYWxsKGtleVBhdGgsIGZ1bmN0aW9uIChrcCkge1xuICAgICAgICBzZXRCeUtleVBhdGgob2JqLCBrcCwgdW5kZWZpbmVkKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gc2hhbGxvd0Nsb25lKG9iaikge1xuICAgIHZhciBydiA9IHt9O1xuICAgIGZvciAodmFyIG0gaW4gb2JqKSB7XG4gICAgICAgIGlmIChoYXNPd24ob2JqLCBtKSkgcnZbbV0gPSBvYmpbbV07XG4gICAgfVxuICAgIHJldHVybiBydjtcbn1cblxuZnVuY3Rpb24gZGVlcENsb25lKGFueSkge1xuICAgIGlmICghYW55IHx8IHR5cGVvZiBhbnkgIT09ICdvYmplY3QnKSByZXR1cm4gYW55O1xuICAgIHZhciBydjtcbiAgICBpZiAoaXNBcnJheShhbnkpKSB7XG4gICAgICAgIHJ2ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gYW55Lmxlbmd0aDsgaSA8IGw7ICsraSkge1xuICAgICAgICAgICAgcnYucHVzaChkZWVwQ2xvbmUoYW55W2ldKSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGFueSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgcnYgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBydi5zZXRUaW1lKGFueS5nZXRUaW1lKCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJ2ID0gYW55LmNvbnN0cnVjdG9yID8gT2JqZWN0LmNyZWF0ZShhbnkuY29uc3RydWN0b3IucHJvdG90eXBlKSA6IHt9O1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIGFueSkge1xuICAgICAgICAgICAgaWYgKGhhc093bihhbnksIHByb3ApKSB7XG4gICAgICAgICAgICAgICAgcnZbcHJvcF0gPSBkZWVwQ2xvbmUoYW55W3Byb3BdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcnY7XG59XG5cbmZ1bmN0aW9uIGdldE9iamVjdERpZmYoYSwgYiwgcnYsIHByZngpIHtcbiAgICAvLyBDb21wYXJlcyBvYmplY3RzIGEgYW5kIGIgYW5kIHByb2R1Y2VzIGEgZGlmZiBvYmplY3QuXG4gICAgcnYgPSBydiB8fCB7fTtcbiAgICBwcmZ4ID0gcHJmeCB8fCAnJztcbiAgICBrZXlzKGEpLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgaWYgKCFoYXNPd24oYiwgcHJvcCkpIHJ2W3ByZnggKyBwcm9wXSA9IHVuZGVmaW5lZDsgLy8gUHJvcGVydHkgcmVtb3ZlZFxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgYXAgPSBhW3Byb3BdLFxuICAgICAgICAgICAgICAgICAgICBicCA9IGJbcHJvcF07XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhcCA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIGJwID09PSAnb2JqZWN0JyAmJiBhcCAmJiBicCAmJiBhcC5jb25zdHJ1Y3RvciA9PT0gYnAuY29uc3RydWN0b3IpXG4gICAgICAgICAgICAgICAgICAgIC8vIFNhbWUgdHlwZSBvZiBvYmplY3QgYnV0IGl0cyBwcm9wZXJ0aWVzIG1heSBoYXZlIGNoYW5nZWRcbiAgICAgICAgICAgICAgICAgICAgZ2V0T2JqZWN0RGlmZihhcCwgYnAsIHJ2LCBwcmZ4ICsgcHJvcCArIFwiLlwiKTtlbHNlIGlmIChhcCAhPT0gYnApIHJ2W3ByZnggKyBwcm9wXSA9IGJbcHJvcF07IC8vIFByaW1pdGl2ZSB2YWx1ZSBjaGFuZ2VkXG4gICAgICAgICAgICB9XG4gICAgfSk7XG4gICAga2V5cyhiKS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wKSB7XG4gICAgICAgIGlmICghaGFzT3duKGEsIHByb3ApKSB7XG4gICAgICAgICAgICBydltwcmZ4ICsgcHJvcF0gPSBiW3Byb3BdOyAvLyBQcm9wZXJ0eSBhZGRlZFxuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJ2O1xufVxuXG4vLyBJZiBmaXJzdCBhcmd1bWVudCBpcyBpdGVyYWJsZSBvciBhcnJheS1saWtlLCByZXR1cm4gaXQgYXMgYW4gYXJyYXlcbnZhciBpdGVyYXRvclN5bWJvbCA9IHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC5pdGVyYXRvcjtcbnZhciBnZXRJdGVyYXRvck9mID0gaXRlcmF0b3JTeW1ib2wgPyBmdW5jdGlvbiAoeCkge1xuICAgIHZhciBpO1xuICAgIHJldHVybiB4ICE9IG51bGwgJiYgKGkgPSB4W2l0ZXJhdG9yU3ltYm9sXSkgJiYgaS5hcHBseSh4KTtcbn0gOiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG51bGw7XG59O1xuXG52YXIgTk9fQ0hBUl9BUlJBWSA9IHt9O1xuLy8gVGFrZXMgb25lIG9yIHNldmVyYWwgYXJndW1lbnRzIGFuZCByZXR1cm5zIGFuIGFycmF5IGJhc2VkIG9uIHRoZSBmb2xsb3dpbmcgY3JpdGVyYXM6XG4vLyAqIElmIHNldmVyYWwgYXJndW1lbnRzIHByb3ZpZGVkLCByZXR1cm4gYXJndW1lbnRzIGNvbnZlcnRlZCB0byBhbiBhcnJheSBpbiBhIHdheSB0aGF0XG4vLyAgIHN0aWxsIGFsbG93cyBqYXZhc2NyaXB0IGVuZ2luZSB0byBvcHRpbWl6ZSB0aGUgY29kZS5cbi8vICogSWYgc2luZ2xlIGFyZ3VtZW50IGlzIGFuIGFycmF5LCByZXR1cm4gYSBjbG9uZSBvZiBpdC5cbi8vICogSWYgdGhpcy1wb2ludGVyIGVxdWFscyBOT19DSEFSX0FSUkFZLCBkb24ndCBhY2NlcHQgc3RyaW5ncyBhcyB2YWxpZCBpdGVyYWJsZXMgYXMgYSBzcGVjaWFsXG4vLyAgIGNhc2UgdG8gdGhlIHR3byBidWxsZXRzIGJlbG93LlxuLy8gKiBJZiBzaW5nbGUgYXJndW1lbnQgaXMgYW4gaXRlcmFibGUsIGNvbnZlcnQgaXQgdG8gYW4gYXJyYXkgYW5kIHJldHVybiB0aGUgcmVzdWx0aW5nIGFycmF5LlxuLy8gKiBJZiBzaW5nbGUgYXJndW1lbnQgaXMgYXJyYXktbGlrZSAoaGFzIGxlbmd0aCBvZiB0eXBlIG51bWJlciksIGNvbnZlcnQgaXQgdG8gYW4gYXJyYXkuXG5mdW5jdGlvbiBnZXRBcnJheU9mKGFycmF5TGlrZSkge1xuICAgIHZhciBpLCBhLCB4LCBpdDtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBpZiAoaXNBcnJheShhcnJheUxpa2UpKSByZXR1cm4gYXJyYXlMaWtlLnNsaWNlKCk7XG4gICAgICAgIGlmICh0aGlzID09PSBOT19DSEFSX0FSUkFZICYmIHR5cGVvZiBhcnJheUxpa2UgPT09ICdzdHJpbmcnKSByZXR1cm4gW2FycmF5TGlrZV07XG4gICAgICAgIGlmIChpdCA9IGdldEl0ZXJhdG9yT2YoYXJyYXlMaWtlKSkge1xuICAgICAgICAgICAgYSA9IFtdO1xuICAgICAgICAgICAgd2hpbGUgKHggPSBpdC5uZXh0KCksICF4LmRvbmUpIHtcbiAgICAgICAgICAgICAgICBhLnB1c2goeC52YWx1ZSk7XG4gICAgICAgICAgICB9cmV0dXJuIGE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFycmF5TGlrZSA9PSBudWxsKSByZXR1cm4gW2FycmF5TGlrZV07XG4gICAgICAgIGkgPSBhcnJheUxpa2UubGVuZ3RoO1xuICAgICAgICBpZiAodHlwZW9mIGkgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICBhID0gbmV3IEFycmF5KGkpO1xuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIGFbaV0gPSBhcnJheUxpa2VbaV07XG4gICAgICAgICAgICB9cmV0dXJuIGE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFthcnJheUxpa2VdO1xuICAgIH1cbiAgICBpID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICBhID0gbmV3IEFycmF5KGkpO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgYVtpXSA9IGFyZ3VtZW50c1tpXTtcbiAgICB9cmV0dXJuIGE7XG59XG5cbnZhciBjb25jYXQgPSBbXS5jb25jYXQ7XG5mdW5jdGlvbiBmbGF0dGVuKGEpIHtcbiAgICByZXR1cm4gY29uY2F0LmFwcGx5KFtdLCBhKTtcbn1cblxuZnVuY3Rpb24gbm9wKCkge31cbmZ1bmN0aW9uIG1pcnJvcih2YWwpIHtcbiAgICByZXR1cm4gdmFsO1xufVxuZnVuY3Rpb24gcHVyZUZ1bmN0aW9uQ2hhaW4oZjEsIGYyKSB7XG4gICAgLy8gRW5hYmxlcyBjaGFpbmVkIGV2ZW50cyB0aGF0IHRha2VzIE9ORSBhcmd1bWVudCBhbmQgcmV0dXJucyBpdCB0byB0aGUgbmV4dCBmdW5jdGlvbiBpbiBjaGFpbi5cbiAgICAvLyBUaGlzIHBhdHRlcm4gaXMgdXNlZCBpbiB0aGUgaG9vayhcInJlYWRpbmdcIikgZXZlbnQuXG4gICAgaWYgKGYxID09IG51bGwgfHwgZjEgPT09IG1pcnJvcikgcmV0dXJuIGYyO1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgIHJldHVybiBmMihmMSh2YWwpKTtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBjYWxsQm90aChvbjEsIG9uMikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG9uMS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICBvbjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBob29rQ3JlYXRpbmdDaGFpbihmMSwgZjIpIHtcbiAgICAvLyBFbmFibGVzIGNoYWluZWQgZXZlbnRzIHRoYXQgdGFrZXMgc2V2ZXJhbCBhcmd1bWVudHMgYW5kIG1heSBtb2RpZnkgZmlyc3QgYXJndW1lbnQgYnkgbWFraW5nIGEgbW9kaWZpY2F0aW9uIGFuZCB0aGVuIHJldHVybmluZyB0aGUgc2FtZSBpbnN0YW5jZS5cbiAgICAvLyBUaGlzIHBhdHRlcm4gaXMgdXNlZCBpbiB0aGUgaG9vayhcImNyZWF0aW5nXCIpIGV2ZW50LlxuICAgIGlmIChmMSA9PT0gbm9wKSByZXR1cm4gZjI7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlcyA9IGYxLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIGlmIChyZXMgIT09IHVuZGVmaW5lZCkgYXJndW1lbnRzWzBdID0gcmVzO1xuICAgICAgICB2YXIgb25zdWNjZXNzID0gdGhpcy5vbnN1Y2Nlc3MsXG4gICAgICAgICAgICAvLyBJbiBjYXNlIGV2ZW50IGxpc3RlbmVyIGhhcyBzZXQgdGhpcy5vbnN1Y2Nlc3NcbiAgICAgICAgb25lcnJvciA9IHRoaXMub25lcnJvcjsgLy8gSW4gY2FzZSBldmVudCBsaXN0ZW5lciBoYXMgc2V0IHRoaXMub25lcnJvclxuICAgICAgICB0aGlzLm9uc3VjY2VzcyA9IG51bGw7XG4gICAgICAgIHRoaXMub25lcnJvciA9IG51bGw7XG4gICAgICAgIHZhciByZXMyID0gZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgaWYgKG9uc3VjY2VzcykgdGhpcy5vbnN1Y2Nlc3MgPSB0aGlzLm9uc3VjY2VzcyA/IGNhbGxCb3RoKG9uc3VjY2VzcywgdGhpcy5vbnN1Y2Nlc3MpIDogb25zdWNjZXNzO1xuICAgICAgICBpZiAob25lcnJvcikgdGhpcy5vbmVycm9yID0gdGhpcy5vbmVycm9yID8gY2FsbEJvdGgob25lcnJvciwgdGhpcy5vbmVycm9yKSA6IG9uZXJyb3I7XG4gICAgICAgIHJldHVybiByZXMyICE9PSB1bmRlZmluZWQgPyByZXMyIDogcmVzO1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIGhvb2tEZWxldGluZ0NoYWluKGYxLCBmMikge1xuICAgIGlmIChmMSA9PT0gbm9wKSByZXR1cm4gZjI7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZjEuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgdmFyIG9uc3VjY2VzcyA9IHRoaXMub25zdWNjZXNzLFxuICAgICAgICAgICAgLy8gSW4gY2FzZSBldmVudCBsaXN0ZW5lciBoYXMgc2V0IHRoaXMub25zdWNjZXNzXG4gICAgICAgIG9uZXJyb3IgPSB0aGlzLm9uZXJyb3I7IC8vIEluIGNhc2UgZXZlbnQgbGlzdGVuZXIgaGFzIHNldCB0aGlzLm9uZXJyb3JcbiAgICAgICAgdGhpcy5vbnN1Y2Nlc3MgPSB0aGlzLm9uZXJyb3IgPSBudWxsO1xuICAgICAgICBmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICBpZiAob25zdWNjZXNzKSB0aGlzLm9uc3VjY2VzcyA9IHRoaXMub25zdWNjZXNzID8gY2FsbEJvdGgob25zdWNjZXNzLCB0aGlzLm9uc3VjY2VzcykgOiBvbnN1Y2Nlc3M7XG4gICAgICAgIGlmIChvbmVycm9yKSB0aGlzLm9uZXJyb3IgPSB0aGlzLm9uZXJyb3IgPyBjYWxsQm90aChvbmVycm9yLCB0aGlzLm9uZXJyb3IpIDogb25lcnJvcjtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBob29rVXBkYXRpbmdDaGFpbihmMSwgZjIpIHtcbiAgICBpZiAoZjEgPT09IG5vcCkgcmV0dXJuIGYyO1xuICAgIHJldHVybiBmdW5jdGlvbiAobW9kaWZpY2F0aW9ucykge1xuICAgICAgICB2YXIgcmVzID0gZjEuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgZXh0ZW5kKG1vZGlmaWNhdGlvbnMsIHJlcyk7IC8vIElmIGYxIHJldHVybnMgbmV3IG1vZGlmaWNhdGlvbnMsIGV4dGVuZCBjYWxsZXIncyBtb2RpZmljYXRpb25zIHdpdGggdGhlIHJlc3VsdCBiZWZvcmUgY2FsbGluZyBuZXh0IGluIGNoYWluLlxuICAgICAgICB2YXIgb25zdWNjZXNzID0gdGhpcy5vbnN1Y2Nlc3MsXG4gICAgICAgICAgICAvLyBJbiBjYXNlIGV2ZW50IGxpc3RlbmVyIGhhcyBzZXQgdGhpcy5vbnN1Y2Nlc3NcbiAgICAgICAgb25lcnJvciA9IHRoaXMub25lcnJvcjsgLy8gSW4gY2FzZSBldmVudCBsaXN0ZW5lciBoYXMgc2V0IHRoaXMub25lcnJvclxuICAgICAgICB0aGlzLm9uc3VjY2VzcyA9IG51bGw7XG4gICAgICAgIHRoaXMub25lcnJvciA9IG51bGw7XG4gICAgICAgIHZhciByZXMyID0gZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgaWYgKG9uc3VjY2VzcykgdGhpcy5vbnN1Y2Nlc3MgPSB0aGlzLm9uc3VjY2VzcyA/IGNhbGxCb3RoKG9uc3VjY2VzcywgdGhpcy5vbnN1Y2Nlc3MpIDogb25zdWNjZXNzO1xuICAgICAgICBpZiAob25lcnJvcikgdGhpcy5vbmVycm9yID0gdGhpcy5vbmVycm9yID8gY2FsbEJvdGgob25lcnJvciwgdGhpcy5vbmVycm9yKSA6IG9uZXJyb3I7XG4gICAgICAgIHJldHVybiByZXMgPT09IHVuZGVmaW5lZCA/IHJlczIgPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6IHJlczIgOiBleHRlbmQocmVzLCByZXMyKTtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiByZXZlcnNlU3RvcHBhYmxlRXZlbnRDaGFpbihmMSwgZjIpIHtcbiAgICBpZiAoZjEgPT09IG5vcCkgcmV0dXJuIGYyO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpID09PSBmYWxzZSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gZjEuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xufVxuXG5cblxuZnVuY3Rpb24gcHJvbWlzYWJsZUNoYWluKGYxLCBmMikge1xuICAgIGlmIChmMSA9PT0gbm9wKSByZXR1cm4gZjI7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlcyA9IGYxLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIGlmIChyZXMgJiYgdHlwZW9mIHJlcy50aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB2YXIgdGhpeiA9IHRoaXMsXG4gICAgICAgICAgICAgICAgaSA9IGFyZ3VtZW50cy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgYXJncyA9IG5ldyBBcnJheShpKTtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgICBhcmdzW2ldID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgfXJldHVybiByZXMudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGYyLmFwcGx5KHRoaXosIGFyZ3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGYyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbn1cblxuLy8gQnkgZGVmYXVsdCwgZGVidWcgd2lsbCBiZSB0cnVlIG9ubHkgaWYgcGxhdGZvcm0gaXMgYSB3ZWIgcGxhdGZvcm0gYW5kIGl0cyBwYWdlIGlzIHNlcnZlZCBmcm9tIGxvY2FsaG9zdC5cbi8vIFdoZW4gZGVidWcgPSB0cnVlLCBlcnJvcidzIHN0YWNrcyB3aWxsIGNvbnRhaW4gYXN5bmNyb25pYyBsb25nIHN0YWNrcy5cbnZhciBkZWJ1ZyA9IHR5cGVvZiBsb2NhdGlvbiAhPT0gJ3VuZGVmaW5lZCcgJiZcbi8vIEJ5IGRlZmF1bHQsIHVzZSBkZWJ1ZyBtb2RlIGlmIHNlcnZlZCBmcm9tIGxvY2FsaG9zdC5cbi9eKGh0dHB8aHR0cHMpOlxcL1xcLyhsb2NhbGhvc3R8MTI3XFwuMFxcLjBcXC4xKS8udGVzdChsb2NhdGlvbi5ocmVmKTtcblxuZnVuY3Rpb24gc2V0RGVidWcodmFsdWUsIGZpbHRlcikge1xuICAgIGRlYnVnID0gdmFsdWU7XG4gICAgbGlicmFyeUZpbHRlciA9IGZpbHRlcjtcbn1cblxudmFyIGxpYnJhcnlGaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG52YXIgTkVFRFNfVEhST1dfRk9SX1NUQUNLID0gIW5ldyBFcnJvcihcIlwiKS5zdGFjaztcblxuZnVuY3Rpb24gZ2V0RXJyb3JXaXRoU3RhY2soKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpZiAoTkVFRFNfVEhST1dfRk9SX1NUQUNLKSB0cnkge1xuICAgICAgICAvLyBEb2luZyBzb21ldGhpbmcgbmF1Z2h0eSBpbiBzdHJpY3QgbW9kZSBoZXJlIHRvIHRyaWdnZXIgYSBzcGVjaWZpYyBlcnJvclxuICAgICAgICAvLyB0aGF0IGNhbiBiZSBleHBsaWNpdGVseSBpZ25vcmVkIGluIGRlYnVnZ2VyJ3MgZXhjZXB0aW9uIHNldHRpbmdzLlxuICAgICAgICAvLyBJZiB3ZSdkIGp1c3QgdGhyb3cgbmV3IEVycm9yKCkgaGVyZSwgSUUncyBkZWJ1Z2dlcidzIGV4Y2VwdGlvbiBzZXR0aW5nc1xuICAgICAgICAvLyB3aWxsIGp1c3QgY29uc2lkZXIgaXQgYXMgXCJleGNlcHRpb24gdGhyb3duIGJ5IGphdmFzY3JpcHQgY29kZVwiIHdoaWNoIGlzXG4gICAgICAgIC8vIHNvbWV0aGluZyB5b3Ugd291bGRuJ3Qgd2FudCBpdCB0byBpZ25vcmUuXG4gICAgICAgIGdldEVycm9yV2l0aFN0YWNrLmFyZ3VtZW50cztcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7IC8vIEZhbGxiYWNrIGlmIGFib3ZlIGxpbmUgZG9uJ3QgdGhyb3cuXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBFcnJvcigpO1xufVxuXG5mdW5jdGlvbiBwcmV0dHlTdGFjayhleGNlcHRpb24sIG51bUlnbm9yZWRGcmFtZXMpIHtcbiAgICB2YXIgc3RhY2sgPSBleGNlcHRpb24uc3RhY2s7XG4gICAgaWYgKCFzdGFjaykgcmV0dXJuIFwiXCI7XG4gICAgbnVtSWdub3JlZEZyYW1lcyA9IG51bUlnbm9yZWRGcmFtZXMgfHwgMDtcbiAgICBpZiAoc3RhY2suaW5kZXhPZihleGNlcHRpb24ubmFtZSkgPT09IDApIG51bUlnbm9yZWRGcmFtZXMgKz0gKGV4Y2VwdGlvbi5uYW1lICsgZXhjZXB0aW9uLm1lc3NhZ2UpLnNwbGl0KCdcXG4nKS5sZW5ndGg7XG4gICAgcmV0dXJuIHN0YWNrLnNwbGl0KCdcXG4nKS5zbGljZShudW1JZ25vcmVkRnJhbWVzKS5maWx0ZXIobGlicmFyeUZpbHRlcikubWFwKGZ1bmN0aW9uIChmcmFtZSkge1xuICAgICAgICByZXR1cm4gXCJcXG5cIiArIGZyYW1lO1xuICAgIH0pLmpvaW4oJycpO1xufVxuXG5mdW5jdGlvbiBkZXByZWNhdGVkKHdoYXQsIGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS53YXJuKHdoYXQgKyBcIiBpcyBkZXByZWNhdGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2RmYWhsYW5kZXIvRGV4aWUuanMvd2lraS9EZXByZWNhdGlvbnMuIFwiICsgcHJldHR5U3RhY2soZ2V0RXJyb3JXaXRoU3RhY2soKSwgMSkpO1xuICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xufVxuXG52YXIgZGV4aWVFcnJvck5hbWVzID0gWydNb2RpZnknLCAnQnVsaycsICdPcGVuRmFpbGVkJywgJ1ZlcnNpb25DaGFuZ2UnLCAnU2NoZW1hJywgJ1VwZ3JhZGUnLCAnSW52YWxpZFRhYmxlJywgJ01pc3NpbmdBUEknLCAnTm9TdWNoRGF0YWJhc2UnLCAnSW52YWxpZEFyZ3VtZW50JywgJ1N1YlRyYW5zYWN0aW9uJywgJ1Vuc3VwcG9ydGVkJywgJ0ludGVybmFsJywgJ0RhdGFiYXNlQ2xvc2VkJywgJ0luY29tcGF0aWJsZVByb21pc2UnXTtcblxudmFyIGlkYkRvbUVycm9yTmFtZXMgPSBbJ1Vua25vd24nLCAnQ29uc3RyYWludCcsICdEYXRhJywgJ1RyYW5zYWN0aW9uSW5hY3RpdmUnLCAnUmVhZE9ubHknLCAnVmVyc2lvbicsICdOb3RGb3VuZCcsICdJbnZhbGlkU3RhdGUnLCAnSW52YWxpZEFjY2VzcycsICdBYm9ydCcsICdUaW1lb3V0JywgJ1F1b3RhRXhjZWVkZWQnLCAnU3ludGF4JywgJ0RhdGFDbG9uZSddO1xuXG52YXIgZXJyb3JMaXN0ID0gZGV4aWVFcnJvck5hbWVzLmNvbmNhdChpZGJEb21FcnJvck5hbWVzKTtcblxudmFyIGRlZmF1bHRUZXh0cyA9IHtcbiAgICBWZXJzaW9uQ2hhbmdlZDogXCJEYXRhYmFzZSB2ZXJzaW9uIGNoYW5nZWQgYnkgb3RoZXIgZGF0YWJhc2UgY29ubmVjdGlvblwiLFxuICAgIERhdGFiYXNlQ2xvc2VkOiBcIkRhdGFiYXNlIGhhcyBiZWVuIGNsb3NlZFwiLFxuICAgIEFib3J0OiBcIlRyYW5zYWN0aW9uIGFib3J0ZWRcIixcbiAgICBUcmFuc2FjdGlvbkluYWN0aXZlOiBcIlRyYW5zYWN0aW9uIGhhcyBhbHJlYWR5IGNvbXBsZXRlZCBvciBmYWlsZWRcIlxufTtcblxuLy9cbi8vIERleGllRXJyb3IgLSBiYXNlIGNsYXNzIG9mIGFsbCBvdXQgZXhjZXB0aW9ucy5cbi8vXG5mdW5jdGlvbiBEZXhpZUVycm9yKG5hbWUsIG1zZykge1xuICAgIC8vIFJlYXNvbiB3ZSBkb24ndCB1c2UgRVM2IGNsYXNzZXMgaXMgYmVjYXVzZTpcbiAgICAvLyAxLiBJdCBibG9hdHMgdHJhbnNwaWxlZCBjb2RlIGFuZCBpbmNyZWFzZXMgc2l6ZSBvZiBtaW5pZmllZCBjb2RlLlxuICAgIC8vIDIuIEl0IGRvZXNuJ3QgZ2l2ZSB1cyBtdWNoIGluIHRoaXMgY2FzZS5cbiAgICAvLyAzLiBJdCB3b3VsZCByZXF1aXJlIHN1YiBjbGFzc2VzIHRvIGNhbGwgc3VwZXIoKSwgd2hpY2hcbiAgICAvLyAgICBpcyBub3QgbmVlZGVkIHdoZW4gZGVyaXZpbmcgZnJvbSBFcnJvci5cbiAgICB0aGlzLl9lID0gZ2V0RXJyb3JXaXRoU3RhY2soKTtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMubWVzc2FnZSA9IG1zZztcbn1cblxuZGVyaXZlKERleGllRXJyb3IpLmZyb20oRXJyb3IpLmV4dGVuZCh7XG4gICAgc3RhY2s6IHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhY2sgfHwgKHRoaXMuX3N0YWNrID0gdGhpcy5uYW1lICsgXCI6IFwiICsgdGhpcy5tZXNzYWdlICsgcHJldHR5U3RhY2sodGhpcy5fZSwgMikpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB0b1N0cmluZzogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYW1lICsgXCI6IFwiICsgdGhpcy5tZXNzYWdlO1xuICAgIH1cbn0pO1xuXG5mdW5jdGlvbiBnZXRNdWx0aUVycm9yTWVzc2FnZShtc2csIGZhaWx1cmVzKSB7XG4gICAgcmV0dXJuIG1zZyArIFwiLiBFcnJvcnM6IFwiICsgZmFpbHVyZXMubWFwKGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmLnRvU3RyaW5nKCk7XG4gICAgfSkuZmlsdGVyKGZ1bmN0aW9uICh2LCBpLCBzKSB7XG4gICAgICAgIHJldHVybiBzLmluZGV4T2YodikgPT09IGk7XG4gICAgfSkgLy8gT25seSB1bmlxdWUgZXJyb3Igc3RyaW5nc1xuICAgIC5qb2luKCdcXG4nKTtcbn1cblxuLy9cbi8vIE1vZGlmeUVycm9yIC0gdGhyb3duIGluIFdyaXRlYWJsZUNvbGxlY3Rpb24ubW9kaWZ5KClcbi8vIFNwZWNpZmljIGNvbnN0cnVjdG9yIGJlY2F1c2UgaXQgY29udGFpbnMgbWVtYmVycyBmYWlsdXJlcyBhbmQgZmFpbGVkS2V5cy5cbi8vXG5mdW5jdGlvbiBNb2RpZnlFcnJvcihtc2csIGZhaWx1cmVzLCBzdWNjZXNzQ291bnQsIGZhaWxlZEtleXMpIHtcbiAgICB0aGlzLl9lID0gZ2V0RXJyb3JXaXRoU3RhY2soKTtcbiAgICB0aGlzLmZhaWx1cmVzID0gZmFpbHVyZXM7XG4gICAgdGhpcy5mYWlsZWRLZXlzID0gZmFpbGVkS2V5cztcbiAgICB0aGlzLnN1Y2Nlc3NDb3VudCA9IHN1Y2Nlc3NDb3VudDtcbn1cbmRlcml2ZShNb2RpZnlFcnJvcikuZnJvbShEZXhpZUVycm9yKTtcblxuZnVuY3Rpb24gQnVsa0Vycm9yKG1zZywgZmFpbHVyZXMpIHtcbiAgICB0aGlzLl9lID0gZ2V0RXJyb3JXaXRoU3RhY2soKTtcbiAgICB0aGlzLm5hbWUgPSBcIkJ1bGtFcnJvclwiO1xuICAgIHRoaXMuZmFpbHVyZXMgPSBmYWlsdXJlcztcbiAgICB0aGlzLm1lc3NhZ2UgPSBnZXRNdWx0aUVycm9yTWVzc2FnZShtc2csIGZhaWx1cmVzKTtcbn1cbmRlcml2ZShCdWxrRXJyb3IpLmZyb20oRGV4aWVFcnJvcik7XG5cbi8vXG4vL1xuLy8gRHluYW1pY2FsbHkgZ2VuZXJhdGUgZXJyb3IgbmFtZXMgYW5kIGV4Y2VwdGlvbiBjbGFzc2VzIGJhc2VkXG4vLyBvbiB0aGUgbmFtZXMgaW4gZXJyb3JMaXN0LlxuLy9cbi8vXG5cbi8vIE1hcCBvZiB7RXJyb3JOYW1lIC0+IEVycm9yTmFtZSArIFwiRXJyb3JcIn1cbnZhciBlcnJuYW1lcyA9IGVycm9yTGlzdC5yZWR1Y2UoZnVuY3Rpb24gKG9iaiwgbmFtZSkge1xuICAgIHJldHVybiBvYmpbbmFtZV0gPSBuYW1lICsgXCJFcnJvclwiLCBvYmo7XG59LCB7fSk7XG5cbi8vIE5lZWQgYW4gYWxpYXMgZm9yIERleGllRXJyb3IgYmVjYXVzZSB3ZSdyZSBnb25uYSBjcmVhdGUgc3ViY2xhc3NlcyB3aXRoIHRoZSBzYW1lIG5hbWUuXG52YXIgQmFzZUV4Y2VwdGlvbiA9IERleGllRXJyb3I7XG4vLyBNYXAgb2Yge0Vycm9yTmFtZSAtPiBleGNlcHRpb24gY29uc3RydWN0b3J9XG52YXIgZXhjZXB0aW9ucyA9IGVycm9yTGlzdC5yZWR1Y2UoZnVuY3Rpb24gKG9iaiwgbmFtZSkge1xuICAgIC8vIExldCB0aGUgbmFtZSBiZSBcIkRleGllRXJyb3JcIiBiZWNhdXNlIHRoaXMgbmFtZSBtYXlcbiAgICAvLyBiZSBzaG93biBpbiBjYWxsIHN0YWNrIGFuZCB3aGVuIGRlYnVnZ2luZy4gRGV4aWVFcnJvciBpc1xuICAgIC8vIHRoZSBtb3N0IHRydWUgbmFtZSBiZWNhdXNlIGl0IGRlcml2ZXMgZnJvbSBEZXhpZUVycm9yLFxuICAgIC8vIGFuZCB3ZSBjYW5ub3QgY2hhbmdlIEZ1bmN0aW9uLm5hbWUgcHJvZ3JhbWF0aWNhbGx5IHdpdGhvdXRcbiAgICAvLyBkeW5hbWljYWxseSBjcmVhdGUgYSBGdW5jdGlvbiBvYmplY3QsIHdoaWNoIHdvdWxkIGJlIGNvbnNpZGVyZWRcbiAgICAvLyAnZXZhbC1ldmlsJy5cbiAgICB2YXIgZnVsbE5hbWUgPSBuYW1lICsgXCJFcnJvclwiO1xuICAgIGZ1bmN0aW9uIERleGllRXJyb3IobXNnT3JJbm5lciwgaW5uZXIpIHtcbiAgICAgICAgdGhpcy5fZSA9IGdldEVycm9yV2l0aFN0YWNrKCk7XG4gICAgICAgIHRoaXMubmFtZSA9IGZ1bGxOYW1lO1xuICAgICAgICBpZiAoIW1zZ09ySW5uZXIpIHtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IGRlZmF1bHRUZXh0c1tuYW1lXSB8fCBmdWxsTmFtZTtcbiAgICAgICAgICAgIHRoaXMuaW5uZXIgPSBudWxsO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBtc2dPcklubmVyID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gbXNnT3JJbm5lcjtcbiAgICAgICAgICAgIHRoaXMuaW5uZXIgPSBpbm5lciB8fCBudWxsO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBtc2dPcklubmVyID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gbXNnT3JJbm5lci5uYW1lICsgJyAnICsgbXNnT3JJbm5lci5tZXNzYWdlO1xuICAgICAgICAgICAgdGhpcy5pbm5lciA9IG1zZ09ySW5uZXI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGVyaXZlKERleGllRXJyb3IpLmZyb20oQmFzZUV4Y2VwdGlvbik7XG4gICAgb2JqW25hbWVdID0gRGV4aWVFcnJvcjtcbiAgICByZXR1cm4gb2JqO1xufSwge30pO1xuXG4vLyBVc2UgRUNNQVNDUklQVCBzdGFuZGFyZCBleGNlcHRpb25zIHdoZXJlIGFwcGxpY2FibGU6XG5leGNlcHRpb25zLlN5bnRheCA9IFN5bnRheEVycm9yO1xuZXhjZXB0aW9ucy5UeXBlID0gVHlwZUVycm9yO1xuZXhjZXB0aW9ucy5SYW5nZSA9IFJhbmdlRXJyb3I7XG5cbnZhciBleGNlcHRpb25NYXAgPSBpZGJEb21FcnJvck5hbWVzLnJlZHVjZShmdW5jdGlvbiAob2JqLCBuYW1lKSB7XG4gICAgb2JqW25hbWUgKyBcIkVycm9yXCJdID0gZXhjZXB0aW9uc1tuYW1lXTtcbiAgICByZXR1cm4gb2JqO1xufSwge30pO1xuXG5mdW5jdGlvbiBtYXBFcnJvcihkb21FcnJvciwgbWVzc2FnZSkge1xuICAgIGlmICghZG9tRXJyb3IgfHwgZG9tRXJyb3IgaW5zdGFuY2VvZiBEZXhpZUVycm9yIHx8IGRvbUVycm9yIGluc3RhbmNlb2YgVHlwZUVycm9yIHx8IGRvbUVycm9yIGluc3RhbmNlb2YgU3ludGF4RXJyb3IgfHwgIWRvbUVycm9yLm5hbWUgfHwgIWV4Y2VwdGlvbk1hcFtkb21FcnJvci5uYW1lXSkgcmV0dXJuIGRvbUVycm9yO1xuICAgIHZhciBydiA9IG5ldyBleGNlcHRpb25NYXBbZG9tRXJyb3IubmFtZV0obWVzc2FnZSB8fCBkb21FcnJvci5tZXNzYWdlLCBkb21FcnJvcik7XG4gICAgaWYgKFwic3RhY2tcIiBpbiBkb21FcnJvcikge1xuICAgICAgICAvLyBEZXJpdmUgc3RhY2sgZnJvbSBpbm5lciBleGNlcHRpb24gaWYgaXQgaGFzIGEgc3RhY2tcbiAgICAgICAgc2V0UHJvcChydiwgXCJzdGFja1wiLCB7IGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlubmVyLnN0YWNrO1xuICAgICAgICAgICAgfSB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJ2O1xufVxuXG52YXIgZnVsbE5hbWVFeGNlcHRpb25zID0gZXJyb3JMaXN0LnJlZHVjZShmdW5jdGlvbiAob2JqLCBuYW1lKSB7XG4gICAgaWYgKFtcIlN5bnRheFwiLCBcIlR5cGVcIiwgXCJSYW5nZVwiXS5pbmRleE9mKG5hbWUpID09PSAtMSkgb2JqW25hbWUgKyBcIkVycm9yXCJdID0gZXhjZXB0aW9uc1tuYW1lXTtcbiAgICByZXR1cm4gb2JqO1xufSwge30pO1xuXG5mdWxsTmFtZUV4Y2VwdGlvbnMuTW9kaWZ5RXJyb3IgPSBNb2RpZnlFcnJvcjtcbmZ1bGxOYW1lRXhjZXB0aW9ucy5EZXhpZUVycm9yID0gRGV4aWVFcnJvcjtcbmZ1bGxOYW1lRXhjZXB0aW9ucy5CdWxrRXJyb3IgPSBCdWxrRXJyb3I7XG5cbmZ1bmN0aW9uIEV2ZW50cyhjdHgpIHtcbiAgICB2YXIgZXZzID0ge307XG4gICAgdmFyIHJ2ID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgc3Vic2NyaWJlcikge1xuICAgICAgICBpZiAoc3Vic2NyaWJlcikge1xuICAgICAgICAgICAgLy8gU3Vic2NyaWJlLiBJZiBhZGRpdGlvbmFsIGFyZ3VtZW50cyB0aGFuIGp1c3QgdGhlIHN1YnNjcmliZXIgd2FzIHByb3ZpZGVkLCBmb3J3YXJkIHRoZW0gYXMgd2VsbC5cbiAgICAgICAgICAgIHZhciBpID0gYXJndW1lbnRzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBhcmdzID0gbmV3IEFycmF5KGkgLSAxKTtcbiAgICAgICAgICAgIHdoaWxlICgtLWkpIHtcbiAgICAgICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIH1ldnNbZXZlbnROYW1lXS5zdWJzY3JpYmUuYXBwbHkobnVsbCwgYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gY3R4O1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudE5hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAvLyBSZXR1cm4gaW50ZXJmYWNlIGFsbG93aW5nIHRvIGZpcmUgb3IgdW5zdWJzY3JpYmUgZnJvbSBldmVudFxuICAgICAgICAgICAgcmV0dXJuIGV2c1tldmVudE5hbWVdO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBydi5hZGRFdmVudFR5cGUgPSBhZGQ7XG5cbiAgICBmb3IgKHZhciBpID0gMSwgbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsOyArK2kpIHtcbiAgICAgICAgYWRkKGFyZ3VtZW50c1tpXSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJ2O1xuXG4gICAgZnVuY3Rpb24gYWRkKGV2ZW50TmFtZSwgY2hhaW5GdW5jdGlvbiwgZGVmYXVsdEZ1bmN0aW9uKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZXZlbnROYW1lID09PSAnb2JqZWN0JykgcmV0dXJuIGFkZENvbmZpZ3VyZWRFdmVudHMoZXZlbnROYW1lKTtcbiAgICAgICAgaWYgKCFjaGFpbkZ1bmN0aW9uKSBjaGFpbkZ1bmN0aW9uID0gcmV2ZXJzZVN0b3BwYWJsZUV2ZW50Q2hhaW47XG4gICAgICAgIGlmICghZGVmYXVsdEZ1bmN0aW9uKSBkZWZhdWx0RnVuY3Rpb24gPSBub3A7XG5cbiAgICAgICAgdmFyIGNvbnRleHQgPSB7XG4gICAgICAgICAgICBzdWJzY3JpYmVyczogW10sXG4gICAgICAgICAgICBmaXJlOiBkZWZhdWx0RnVuY3Rpb24sXG4gICAgICAgICAgICBzdWJzY3JpYmU6IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgICAgICAgIGlmIChjb250ZXh0LnN1YnNjcmliZXJzLmluZGV4T2YoY2IpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnN1YnNjcmliZXJzLnB1c2goY2IpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmZpcmUgPSBjaGFpbkZ1bmN0aW9uKGNvbnRleHQuZmlyZSwgY2IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5zdWJzY3JpYmVycyA9IGNvbnRleHQuc3Vic2NyaWJlcnMuZmlsdGVyKGZ1bmN0aW9uIChmbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4gIT09IGNiO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlyZSA9IGNvbnRleHQuc3Vic2NyaWJlcnMucmVkdWNlKGNoYWluRnVuY3Rpb24sIGRlZmF1bHRGdW5jdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGV2c1tldmVudE5hbWVdID0gcnZbZXZlbnROYW1lXSA9IGNvbnRleHQ7XG4gICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZENvbmZpZ3VyZWRFdmVudHMoY2ZnKSB7XG4gICAgICAgIC8vIGV2ZW50cyh0aGlzLCB7cmVhZGluZzogW2Z1bmN0aW9uQ2hhaW4sIG5vcF19KTtcbiAgICAgICAga2V5cyhjZmcpLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBjZmdbZXZlbnROYW1lXTtcbiAgICAgICAgICAgIGlmIChpc0FycmF5KGFyZ3MpKSB7XG4gICAgICAgICAgICAgICAgYWRkKGV2ZW50TmFtZSwgY2ZnW2V2ZW50TmFtZV1bMF0sIGNmZ1tldmVudE5hbWVdWzFdKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXJncyA9PT0gJ2FzYXAnKSB7XG4gICAgICAgICAgICAgICAgLy8gUmF0aGVyIHRoYW4gYXBwcm9hY2hpbmcgZXZlbnQgc3Vic2NyaXB0aW9uIHVzaW5nIGEgZnVuY3Rpb25hbCBhcHByb2FjaCwgd2UgaGVyZSBkbyBpdCBpbiBhIGZvci1sb29wIHdoZXJlIHN1YnNjcmliZXIgaXMgZXhlY3V0ZWQgaW4gaXRzIG93biBzdGFja1xuICAgICAgICAgICAgICAgIC8vIGVuYWJsaW5nIHRoYXQgYW55IGV4Y2VwdGlvbiB0aGF0IG9jY3VyIHdvbnQgZGlzdHVyYiB0aGUgaW5pdGlhdG9yIGFuZCBhbHNvIG5vdCBuZXNjZXNzYXJ5IGJlIGNhdGNoZWQgYW5kIGZvcmdvdHRlbi5cbiAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IGFkZChldmVudE5hbWUsIG1pcnJvciwgZnVuY3Rpb24gZmlyZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gT3B0aW1hemF0aW9uLXNhZmUgY2xvbmluZyBvZiBhcmd1bWVudHMgaW50byBhcmdzLlxuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzID0gbmV3IEFycmF5KGkpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzW2ldID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgICAgICAgICB9IC8vIEFsbCBlYWNoIHN1YnNjcmliZXI6XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc3Vic2NyaWJlcnMuZm9yRWFjaChmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzYXAoZnVuY3Rpb24gZmlyZUV2ZW50KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZuLmFwcGx5KG51bGwsIGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHRocm93IG5ldyBleGNlcHRpb25zLkludmFsaWRBcmd1bWVudChcIkludmFsaWQgZXZlbnQgY29uZmlnXCIpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8vXG4vLyBQcm9taXNlIENsYXNzIGZvciBEZXhpZSBsaWJyYXJ5XG4vL1xuLy8gSSBzdGFydGVkIG91dCB3cml0aW5nIHRoaXMgUHJvbWlzZSBjbGFzcyBieSBjb3B5aW5nIHByb21pc2UtbGlnaHQgKGh0dHBzOi8vZ2l0aHViLmNvbS90YXlsb3JoYWtlcy9wcm9taXNlLWxpZ2h0KSBieVxuLy8gaHR0cHM6Ly9naXRodWIuY29tL3RheWxvcmhha2VzIC0gYW4gQSsgYW5kIEVDTUFTQ1JJUFQgNiBjb21wbGlhbnQgUHJvbWlzZSBpbXBsZW1lbnRhdGlvbi5cbi8vXG4vLyBNb2RpZmljYXRpb25zIG5lZWRlZCB0byBiZSBkb25lIHRvIHN1cHBvcnQgaW5kZXhlZERCIGJlY2F1c2UgaXQgd29udCBhY2NlcHQgc2V0VGltZW91dCgpXG4vLyAoU2VlIGRpc2N1c3Npb246IGh0dHBzOi8vZ2l0aHViLmNvbS9wcm9taXNlcy1hcGx1cy9wcm9taXNlcy1zcGVjL2lzc3Vlcy80NSkgLlxuLy8gVGhpcyB0b3BpYyB3YXMgYWxzbyBkaXNjdXNzZWQgaW4gdGhlIGZvbGxvd2luZyB0aHJlYWQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9wcm9taXNlcy1hcGx1cy9wcm9taXNlcy1zcGVjL2lzc3Vlcy80NVxuLy9cbi8vIFRoaXMgaW1wbGVtZW50YXRpb24gd2lsbCBub3QgdXNlIHNldFRpbWVvdXQgb3Igc2V0SW1tZWRpYXRlIHdoZW4gaXQncyBub3QgbmVlZGVkLiBUaGUgYmVoYXZpb3IgaXMgMTAwJSBQcm9taXNlL0ErIGNvbXBsaWFudCBzaW5jZVxuLy8gdGhlIGNhbGxlciBvZiBuZXcgUHJvbWlzZSgpIGNhbiBiZSBjZXJ0YWluIHRoYXQgdGhlIHByb21pc2Ugd29udCBiZSB0cmlnZ2VyZWQgdGhlIGxpbmVzIGFmdGVyIGNvbnN0cnVjdGluZyB0aGUgcHJvbWlzZS5cbi8vXG4vLyBJbiBwcmV2aW91cyB2ZXJzaW9ucyB0aGlzIHdhcyBmaXhlZCBieSBub3QgY2FsbGluZyBzZXRUaW1lb3V0IHdoZW4ga25vd2luZyB0aGF0IHRoZSByZXNvbHZlKCkgb3IgcmVqZWN0KCkgY2FtZSBmcm9tIGFub3RoZXJcbi8vIHRpY2suIEluIERleGllIHYxLjQuMCwgSSd2ZSByZXdyaXR0ZW4gdGhlIFByb21pc2UgY2xhc3MgZW50aXJlbHkuIEp1c3Qgc29tZSBmcmFnbWVudHMgb2YgcHJvbWlzZS1saWdodCBpcyBsZWZ0LiBJIHVzZVxuLy8gYW5vdGhlciBzdHJhdGVneSBub3cgdGhhdCBzaW1wbGlmaWVzIGV2ZXJ5dGhpbmcgYSBsb3Q6IHRvIGFsd2F5cyBleGVjdXRlIGNhbGxiYWNrcyBpbiBhIG5ldyB0aWNrLCBidXQgaGF2ZSBhbiBvd24gbWljcm9UaWNrXG4vLyBlbmdpbmUgdGhhdCBpcyB1c2VkIGluc3RlYWQgb2Ygc2V0SW1tZWRpYXRlKCkgb3Igc2V0VGltZW91dCgpLlxuLy8gUHJvbWlzZSBjbGFzcyBoYXMgYWxzbyBiZWVuIG9wdGltaXplZCBhIGxvdCB3aXRoIGluc3BpcmF0aW9uIGZyb20gYmx1ZWJpcmQgLSB0byBhdm9pZCBjbG9zdXJlcyBhcyBtdWNoIGFzIHBvc3NpYmxlLlxuLy8gQWxzbyB3aXRoIGluc3BpcmF0aW9uIGZyb20gYmx1ZWJpcmQsIGFzeW5jcm9uaWMgc3RhY2tzIGluIGRlYnVnIG1vZGUuXG4vL1xuLy8gU3BlY2lmaWMgbm9uLXN0YW5kYXJkIGZlYXR1cmVzIG9mIHRoaXMgUHJvbWlzZSBjbGFzczpcbi8vICogQXN5bmMgc3RhdGljIGNvbnRleHQgc3VwcG9ydCAoUHJvbWlzZS5QU0QpXG4vLyAqIFByb21pc2UuZm9sbG93KCkgbWV0aG9kIGJ1aWx0IHVwb24gUFNELCB0aGF0IGFsbG93cyB1c2VyIHRvIHRyYWNrIGFsbCBwcm9taXNlcyBjcmVhdGVkIGZyb20gY3VycmVudCBzdGFjayBmcmFtZVxuLy8gICBhbmQgYmVsb3cgKyBhbGwgcHJvbWlzZXMgdGhhdCB0aG9zZSBwcm9taXNlcyBjcmVhdGVzIG9yIGF3YWl0cy5cbi8vICogRGV0ZWN0IGFueSB1bmhhbmRsZWQgcHJvbWlzZSBpbiBhIFBTRC1zY29wZSAoUFNELm9udW5oYW5kbGVkKS4gXG4vL1xuLy8gRGF2aWQgRmFobGFuZGVyLCBodHRwczovL2dpdGh1Yi5jb20vZGZhaGxhbmRlclxuLy9cblxuLy8gSnVzdCBhIHBvaW50ZXIgdGhhdCBvbmx5IHRoaXMgbW9kdWxlIGtub3dzIGFib3V0LlxuLy8gVXNlZCBpbiBQcm9taXNlIGNvbnN0cnVjdG9yIHRvIGVtdWxhdGUgYSBwcml2YXRlIGNvbnN0cnVjdG9yLlxudmFyIElOVEVSTkFMID0ge307XG5cbi8vIEFzeW5jIHN0YWNrcyAobG9uZyBzdGFja3MpIG11c3Qgbm90IGdyb3cgaW5maW5pdGVseS5cbnZhciBMT05HX1NUQUNLU19DTElQX0xJTUlUID0gMTAwO1xudmFyIE1BWF9MT05HX1NUQUNLUyA9IDIwO1xudmFyIHN0YWNrX2JlaW5nX2dlbmVyYXRlZCA9IGZhbHNlO1xuXG4vKiBUaGUgZGVmYXVsdCBcIm5leHRUaWNrXCIgZnVuY3Rpb24gdXNlZCBvbmx5IGZvciB0aGUgdmVyeSBmaXJzdCBwcm9taXNlIGluIGEgcHJvbWlzZSBjaGFpbi5cclxuICAgQXMgc29vbiBhcyB0aGVuIHByb21pc2UgaXMgcmVzb2x2ZWQgb3IgcmVqZWN0ZWQsIGFsbCBuZXh0IHRhc2tzIHdpbGwgYmUgZXhlY3V0ZWQgaW4gbWljcm8gdGlja3NcclxuICAgZW11bGF0ZWQgaW4gdGhpcyBtb2R1bGUuIEZvciBpbmRleGVkREIgY29tcGF0aWJpbGl0eSwgdGhpcyBtZWFucyB0aGF0IGV2ZXJ5IG1ldGhvZCBuZWVkcyB0byBcclxuICAgZXhlY3V0ZSBhdCBsZWFzdCBvbmUgcHJvbWlzZSBiZWZvcmUgZG9pbmcgYW4gaW5kZXhlZERCIG9wZXJhdGlvbi4gRGV4aWUgd2lsbCBhbHdheXMgY2FsbCBcclxuICAgZGIucmVhZHkoKS50aGVuKCkgZm9yIGV2ZXJ5IG9wZXJhdGlvbiB0byBtYWtlIHN1cmUgdGhlIGluZGV4ZWREQiBldmVudCBpcyBzdGFydGVkIGluIGFuXHJcbiAgIGVtdWxhdGVkIG1pY3JvIHRpY2suXHJcbiovXG52YXIgc2NoZWR1bGVQaHlzaWNhbFRpY2sgPSBfZ2xvYmFsLnNldEltbWVkaWF0ZSA/XG4vLyBzZXRJbW1lZGlhdGUgc3VwcG9ydGVkLiBUaG9zZSBtb2Rlcm4gcGxhdGZvcm1zIGFsc28gc3VwcG9ydHMgRnVuY3Rpb24uYmluZCgpLlxuc2V0SW1tZWRpYXRlLmJpbmQobnVsbCwgcGh5c2ljYWxUaWNrKSA6IF9nbG9iYWwuTXV0YXRpb25PYnNlcnZlciA/XG4vLyBNdXRhdGlvbk9ic2VydmVyIHN1cHBvcnRlZFxuZnVuY3Rpb24gKCkge1xuICAgIHZhciBoaWRkZW5EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcGh5c2ljYWxUaWNrKCk7XG4gICAgICAgIGhpZGRlbkRpdiA9IG51bGw7XG4gICAgfSkub2JzZXJ2ZShoaWRkZW5EaXYsIHsgYXR0cmlidXRlczogdHJ1ZSB9KTtcbiAgICBoaWRkZW5EaXYuc2V0QXR0cmlidXRlKCdpJywgJzEnKTtcbn0gOlxuLy8gTm8gc3VwcG9ydCBmb3Igc2V0SW1tZWRpYXRlIG9yIE11dGF0aW9uT2JzZXJ2ZXIuIE5vIHdvcnJ5LCBzZXRUaW1lb3V0IGlzIG9ubHkgY2FsbGVkXG4vLyBvbmNlIHRpbWUuIEV2ZXJ5IHRpY2sgdGhhdCBmb2xsb3dzIHdpbGwgYmUgb3VyIGVtdWxhdGVkIG1pY3JvIHRpY2suXG4vLyBDb3VsZCBoYXZlIHVzZXMgc2V0VGltZW91dC5iaW5kKG51bGwsIDAsIHBoeXNpY2FsVGljaykgaWYgaXQgd2FzbnQgZm9yIHRoYXQgRkYxMyBhbmQgYmVsb3cgaGFzIGEgYnVnIFxuZnVuY3Rpb24gKCkge1xuICAgIHNldFRpbWVvdXQocGh5c2ljYWxUaWNrLCAwKTtcbn07XG5cbi8vIENvbmZpZnVyYWJsZSB0aHJvdWdoIFByb21pc2Uuc2NoZWR1bGVyLlxuLy8gRG9uJ3QgZXhwb3J0IGJlY2F1c2UgaXQgd291bGQgYmUgdW5zYWZlIHRvIGxldCB1bmtub3duXG4vLyBjb2RlIGNhbGwgaXQgdW5sZXNzIHRoZXkgZG8gdHJ5Li5jYXRjaCB3aXRoaW4gdGhlaXIgY2FsbGJhY2suXG4vLyBUaGlzIGZ1bmN0aW9uIGNhbiBiZSByZXRyaWV2ZWQgdGhyb3VnaCBnZXR0ZXIgb2YgUHJvbWlzZS5zY2hlZHVsZXIgdGhvdWdoLFxuLy8gYnV0IHVzZXJzIG11c3Qgbm90IGRvIFByb21pc2Uuc2NoZWR1bGVyIChteUZ1bmNUaGF0VGhyb3dzIGV4Y2VwdGlvbikhXG52YXIgYXNhcCQxID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBhcmdzKSB7XG4gICAgbWljcm90aWNrUXVldWUucHVzaChbY2FsbGJhY2ssIGFyZ3NdKTtcbiAgICBpZiAobmVlZHNOZXdQaHlzaWNhbFRpY2spIHtcbiAgICAgICAgc2NoZWR1bGVQaHlzaWNhbFRpY2soKTtcbiAgICAgICAgbmVlZHNOZXdQaHlzaWNhbFRpY2sgPSBmYWxzZTtcbiAgICB9XG59O1xuXG52YXIgaXNPdXRzaWRlTWljcm9UaWNrID0gdHJ1ZTtcbnZhciBuZWVkc05ld1BoeXNpY2FsVGljayA9IHRydWU7XG52YXIgdW5oYW5kbGVkRXJyb3JzID0gW107XG52YXIgcmVqZWN0aW5nRXJyb3JzID0gW107XG52YXIgY3VycmVudEZ1bGZpbGxlciA9IG51bGw7XG52YXIgcmVqZWN0aW9uTWFwcGVyID0gbWlycm9yOyAvLyBSZW1vdmUgaW4gbmV4dCBtYWpvciB3aGVuIHJlbW92aW5nIGVycm9yIG1hcHBpbmcgb2YgRE9NRXJyb3JzIGFuZCBET01FeGNlcHRpb25zXG5cbnZhciBnbG9iYWxQU0QgPSB7XG4gICAgZ2xvYmFsOiB0cnVlLFxuICAgIHJlZjogMCxcbiAgICB1bmhhbmRsZWRzOiBbXSxcbiAgICBvbnVuaGFuZGxlZDogZ2xvYmFsRXJyb3IsXG4gICAgLy9lbnY6IG51bGwsIC8vIFdpbGwgYmUgc2V0IHdoZW5ldmVyIGxlYXZpbmcgYSBzY29wZSB1c2luZyB3cmFwcGVycy5zbmFwc2hvdCgpXG4gICAgZmluYWxpemU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51bmhhbmRsZWRzLmZvckVhY2goZnVuY3Rpb24gKHVoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGdsb2JhbEVycm9yKHVoWzBdLCB1aFsxXSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICB9KTtcbiAgICB9XG59O1xuXG52YXIgUFNEID0gZ2xvYmFsUFNEO1xuXG52YXIgbWljcm90aWNrUXVldWUgPSBbXTsgLy8gQ2FsbGJhY2tzIHRvIGNhbGwgaW4gdGhpcyBvciBuZXh0IHBoeXNpY2FsIHRpY2suXG52YXIgbnVtU2NoZWR1bGVkQ2FsbHMgPSAwOyAvLyBOdW1iZXIgb2YgbGlzdGVuZXItY2FsbHMgbGVmdCB0byBkbyBpbiB0aGlzIHBoeXNpY2FsIHRpY2suXG52YXIgdGlja0ZpbmFsaXplcnMgPSBbXTsgLy8gRmluYWxpemVycyB0byBjYWxsIHdoZW4gdGhlcmUgYXJlIG5vIG1vcmUgYXN5bmMgY2FsbHMgc2NoZWR1bGVkIHdpdGhpbiBjdXJyZW50IHBoeXNpY2FsIHRpY2suXG5cbi8vIFdyYXBwZXJzIGFyZSBub3QgYmVpbmcgdXNlZCB5ZXQuIFRoZWlyIGZyYW1ld29yayBpcyBmdW5jdGlvbmluZyBhbmQgY2FuIGJlIHVzZWRcbi8vIHRvIHJlcGxhY2UgZW52aXJvbm1lbnQgZHVyaW5nIGEgUFNEIHNjb3BlIChhLmsuYS4gJ3pvbmUnKS5cbi8qICoqS0VFUCoqIGV4cG9ydCB2YXIgd3JhcHBlcnMgPSAoKCkgPT4ge1xyXG4gICAgdmFyIHdyYXBwZXJzID0gW107XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBzbmFwc2hvdDogKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgaSA9IHdyYXBwZXJzLmxlbmd0aCxcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBBcnJheShpKTtcclxuICAgICAgICAgICAgd2hpbGUgKGktLSkgcmVzdWx0W2ldID0gd3JhcHBlcnNbaV0uc25hcHNob3QoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlc3RvcmU6IHZhbHVlcyA9PiB7XHJcbiAgICAgICAgICAgIHZhciBpID0gd3JhcHBlcnMubGVuZ3RoO1xyXG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB3cmFwcGVyc1tpXS5yZXN0b3JlKHZhbHVlc1tpXSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB3cmFwOiAoKSA9PiB3cmFwcGVycy5tYXAodyA9PiB3LndyYXAoKSksXHJcbiAgICAgICAgYWRkOiB3cmFwcGVyID0+IHtcclxuICAgICAgICAgICAgd3JhcHBlcnMucHVzaCh3cmFwcGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59KSgpO1xyXG4qL1xuXG5mdW5jdGlvbiBQcm9taXNlKGZuKSB7XG4gICAgaWYgKHR5cGVvZiB0aGlzICE9PSAnb2JqZWN0JykgdGhyb3cgbmV3IFR5cGVFcnJvcignUHJvbWlzZXMgbXVzdCBiZSBjb25zdHJ1Y3RlZCB2aWEgbmV3Jyk7XG4gICAgdGhpcy5fbGlzdGVuZXJzID0gW107XG4gICAgdGhpcy5vbnVuY2F0Y2hlZCA9IG5vcDsgLy8gRGVwcmVjYXRlIGluIG5leHQgbWFqb3IuIE5vdCBuZWVkZWQuIEJldHRlciB0byB1c2UgZ2xvYmFsIGVycm9yIGhhbmRsZXIuXG5cbiAgICAvLyBBIGxpYnJhcnkgbWF5IHNldCBgcHJvbWlzZS5fbGliID0gdHJ1ZTtgIGFmdGVyIHByb21pc2UgaXMgY3JlYXRlZCB0byBtYWtlIHJlc29sdmUoKSBvciByZWplY3QoKVxuICAgIC8vIGV4ZWN1dGUgdGhlIG1pY3JvdGFzayBlbmdpbmUgaW1wbGljaXRlbHkgd2l0aGluIHRoZSBjYWxsIHRvIHJlc29sdmUoKSBvciByZWplY3QoKS5cbiAgICAvLyBUbyByZW1haW4gQSsgY29tcGxpYW50LCBhIGxpYnJhcnkgbXVzdCBvbmx5IHNldCBgX2xpYj10cnVlYCBpZiBpdCBjYW4gZ3VhcmFudGVlIHRoYXQgdGhlIHN0YWNrXG4gICAgLy8gb25seSBjb250YWlucyBsaWJyYXJ5IGNvZGUgd2hlbiBjYWxsaW5nIHJlc29sdmUoKSBvciByZWplY3QoKS5cbiAgICAvLyBSVUxFIE9GIFRIVU1COiBPTkxZIHNldCBfbGliID0gdHJ1ZSBmb3IgcHJvbWlzZXMgZXhwbGljaXRlbHkgcmVzb2x2aW5nL3JlamVjdGluZyBkaXJlY3RseSBmcm9tXG4gICAgLy8gZ2xvYmFsIHNjb3BlIChldmVudCBoYW5kbGVyLCB0aW1lciBldGMpIVxuICAgIHRoaXMuX2xpYiA9IGZhbHNlO1xuICAgIC8vIEN1cnJlbnQgYXN5bmMgc2NvcGVcbiAgICB2YXIgcHNkID0gdGhpcy5fUFNEID0gUFNEO1xuXG4gICAgaWYgKGRlYnVnKSB7XG4gICAgICAgIHRoaXMuX3N0YWNrSG9sZGVyID0gZ2V0RXJyb3JXaXRoU3RhY2soKTtcbiAgICAgICAgdGhpcy5fcHJldiA9IG51bGw7XG4gICAgICAgIHRoaXMuX251bVByZXYgPSAwOyAvLyBOdW1iZXIgb2YgcHJldmlvdXMgcHJvbWlzZXMgKGZvciBsb25nIHN0YWNrcylcbiAgICAgICAgbGlua1RvUHJldmlvdXNQcm9taXNlKHRoaXMsIGN1cnJlbnRGdWxmaWxsZXIpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgaWYgKGZuICE9PSBJTlRFUk5BTCkgdGhyb3cgbmV3IFR5cGVFcnJvcignTm90IGEgZnVuY3Rpb24nKTtcbiAgICAgICAgLy8gUHJpdmF0ZSBjb25zdHJ1Y3RvciAoSU5URVJOQUwsIHN0YXRlLCB2YWx1ZSkuXG4gICAgICAgIC8vIFVzZWQgaW50ZXJuYWxseSBieSBQcm9taXNlLnJlc29sdmUoKSBhbmQgUHJvbWlzZS5yZWplY3QoKS5cbiAgICAgICAgdGhpcy5fc3RhdGUgPSBhcmd1bWVudHNbMV07XG4gICAgICAgIHRoaXMuX3ZhbHVlID0gYXJndW1lbnRzWzJdO1xuICAgICAgICBpZiAodGhpcy5fc3RhdGUgPT09IGZhbHNlKSBoYW5kbGVSZWplY3Rpb24odGhpcywgdGhpcy5fdmFsdWUpOyAvLyBNYXAgZXJyb3IsIHNldCBzdGFjayBhbmQgYWRkUG9zc2libHlVbmhhbmRsZWRFcnJvcigpLlxuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fc3RhdGUgPSBudWxsOyAvLyBudWxsICg9cGVuZGluZyksIGZhbHNlICg9cmVqZWN0ZWQpIG9yIHRydWUgKD1yZXNvbHZlZClcbiAgICB0aGlzLl92YWx1ZSA9IG51bGw7IC8vIGVycm9yIG9yIHJlc3VsdFxuICAgICsrcHNkLnJlZjsgLy8gUmVmY291bnRpbmcgY3VycmVudCBzY29wZVxuICAgIGV4ZWN1dGVQcm9taXNlVGFzayh0aGlzLCBmbik7XG59XG5cbnByb3BzKFByb21pc2UucHJvdG90eXBlLCB7XG5cbiAgICB0aGVuOiBmdW5jdGlvbiAob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICB2YXIgcnYgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBwcm9wYWdhdGVUb0xpc3RlbmVyKF90aGlzLCBuZXcgTGlzdGVuZXIob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQsIHJlc29sdmUsIHJlamVjdCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgZGVidWcgJiYgKCF0aGlzLl9wcmV2IHx8IHRoaXMuX3N0YXRlID09PSBudWxsKSAmJiBsaW5rVG9QcmV2aW91c1Byb21pc2UocnYsIHRoaXMpO1xuICAgICAgICByZXR1cm4gcnY7XG4gICAgfSxcblxuICAgIF90aGVuOiBmdW5jdGlvbiAob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcbiAgICAgICAgLy8gQSBsaXR0bGUgdGluaWVyIHZlcnNpb24gb2YgdGhlbigpIHRoYXQgZG9uJ3QgaGF2ZSB0byBjcmVhdGUgYSByZXN1bHRpbmcgcHJvbWlzZS5cbiAgICAgICAgcHJvcGFnYXRlVG9MaXN0ZW5lcih0aGlzLCBuZXcgTGlzdGVuZXIobnVsbCwgbnVsbCwgb25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpKTtcbiAgICB9LFxuXG4gICAgY2F0Y2g6IGZ1bmN0aW9uIChvblJlamVjdGVkKSB7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uUmVqZWN0ZWQpO1xuICAgICAgICAvLyBGaXJzdCBhcmd1bWVudCBpcyB0aGUgRXJyb3IgdHlwZSB0byBjYXRjaFxuICAgICAgICB2YXIgdHlwZSA9IGFyZ3VtZW50c1swXSxcbiAgICAgICAgICAgIGhhbmRsZXIgPSBhcmd1bWVudHNbMV07XG4gICAgICAgIHJldHVybiB0eXBlb2YgdHlwZSA9PT0gJ2Z1bmN0aW9uJyA/IHRoaXMudGhlbihudWxsLCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIC8vIENhdGNoaW5nIGVycm9ycyBieSBpdHMgY29uc3RydWN0b3IgdHlwZSAoc2ltaWxhciB0byBqYXZhIC8gYysrIC8gYyMpXG4gICAgICAgICAgICAgICAgLy8gU2FtcGxlOiBwcm9taXNlLmNhdGNoKFR5cGVFcnJvciwgZnVuY3Rpb24gKGUpIHsgLi4uIH0pO1xuICAgICAgICAgICAgICAgIGVyciBpbnN0YW5jZW9mIHR5cGUgPyBoYW5kbGVyKGVycikgOiBQcm9taXNlUmVqZWN0KGVycilcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0pIDogdGhpcy50aGVuKG51bGwsIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgLy8gQ2F0Y2hpbmcgZXJyb3JzIGJ5IHRoZSBlcnJvci5uYW1lIHByb3BlcnR5LiBNYWtlcyBzZW5zZSBmb3IgaW5kZXhlZERCIHdoZXJlIGVycm9yIHR5cGVcbiAgICAgICAgICAgICAgICAvLyBpcyBhbHdheXMgRE9NRXJyb3IgYnV0IHdoZXJlIGUubmFtZSB0ZWxscyB0aGUgYWN0dWFsIGVycm9yIHR5cGUuXG4gICAgICAgICAgICAgICAgLy8gU2FtcGxlOiBwcm9taXNlLmNhdGNoKCdDb25zdHJhaW50RXJyb3InLCBmdW5jdGlvbiAoZSkgeyAuLi4gfSk7XG4gICAgICAgICAgICAgICAgZXJyICYmIGVyci5uYW1lID09PSB0eXBlID8gaGFuZGxlcihlcnIpIDogUHJvbWlzZVJlamVjdChlcnIpXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgZmluYWxseTogZnVuY3Rpb24gKG9uRmluYWxseSkge1xuICAgICAgICByZXR1cm4gdGhpcy50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgb25GaW5hbGx5KCk7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIG9uRmluYWxseSgpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2VSZWplY3QoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vIERlcHJlY2F0ZSBpbiBuZXh0IG1ham9yLiBOZWVkZWQgb25seSBmb3IgZGIub24uZXJyb3IuXG4gICAgdW5jYXVnaHQ6IGZ1bmN0aW9uICh1bmNhdWdodEhhbmRsZXIpIHtcbiAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgLy8gQmUgYmFja3dhcmQgY29tcGF0aWJsZSBhbmQgdXNlIFwib251bmNhdGNoZWRcIiBhcyB0aGUgZXZlbnQgbmFtZSBvbiB0aGlzLlxuICAgICAgICAvLyBIYW5kbGUgbXVsdGlwbGUgc3Vic2NyaWJlcnMgdGhyb3VnaCByZXZlcnNlU3RvcHBhYmxlRXZlbnRDaGFpbigpLiBJZiBhIGhhbmRsZXIgcmV0dXJucyBgZmFsc2VgLCBidWJibGluZyBzdG9wcy5cbiAgICAgICAgdGhpcy5vbnVuY2F0Y2hlZCA9IHJldmVyc2VTdG9wcGFibGVFdmVudENoYWluKHRoaXMub251bmNhdGNoZWQsIHVuY2F1Z2h0SGFuZGxlcik7XG4gICAgICAgIC8vIEluIGNhc2UgY2FsbGVyIGRvZXMgdGhpcyBvbiBhbiBhbHJlYWR5IHJlamVjdGVkIHByb21pc2UsIGFzc3VtZSBjYWxsZXIgd2FudHMgdG8gcG9pbnQgb3V0IHRoZSBlcnJvciB0byB0aGlzIHByb21pc2UgYW5kIG5vdFxuICAgICAgICAvLyBhIHByZXZpb3VzIHByb21pc2UuIFJlYXNvbjogdGhlIHByZXZvdXMgcHJvbWlzZSBtYXkgbGFjayBvbnVuY2F0Y2hlZCBoYW5kbGVyLiBcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSBmYWxzZSAmJiB1bmhhbmRsZWRFcnJvcnMuaW5kZXhPZih0aGlzKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vIFJlcGxhY2UgdW5oYW5kbGVkIGVycm9yJ3MgZGVzdGluYWlvbiBwcm9taXNlIHdpdGggdGhpcyBvbmUhXG4gICAgICAgICAgICB1bmhhbmRsZWRFcnJvcnMuc29tZShmdW5jdGlvbiAocCwgaSwgbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwLl92YWx1ZSA9PT0gX3RoaXMyLl92YWx1ZSAmJiAobFtpXSA9IF90aGlzMik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIEFjdHVhbGx5IHdlIGRvIHRoaXMgc2hpdCBiZWNhdXNlIHdlIG5lZWQgdG8gc3VwcG9ydCBkYi5vbi5lcnJvcigpIGNvcnJlY3RseSBkdXJpbmcgZGIub3BlbigpLiBJZiB3ZSBkZXByZWNhdGUgZGIub24uZXJyb3IsIHdlIGNvdWxkXG4gICAgICAgICAgICAvLyB0YWtlIGF3YXkgdGhpcyBwaWVjZSBvZiBjb2RlIGFzIHdlbGwgYXMgdGhlIG9udW5jYXRjaGVkIGFuZCB1bmNhdWdodCgpIG1ldGhvZC5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgc3RhY2s6IHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhY2spIHJldHVybiB0aGlzLl9zdGFjaztcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgc3RhY2tfYmVpbmdfZ2VuZXJhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhY2tzID0gZ2V0U3RhY2sodGhpcywgW10sIE1BWF9MT05HX1NUQUNLUyk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YWNrID0gc3RhY2tzLmpvaW4oXCJcXG5Gcm9tIHByZXZpb3VzOiBcIik7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRlICE9PSBudWxsKSB0aGlzLl9zdGFjayA9IHN0YWNrOyAvLyBTdGFjayBtYXkgYmUgdXBkYXRlZCBvbiByZWplY3QuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YWNrO1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICBzdGFja19iZWluZ19nZW5lcmF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG5mdW5jdGlvbiBMaXN0ZW5lcihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCwgcmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdGhpcy5vbkZ1bGZpbGxlZCA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PT0gJ2Z1bmN0aW9uJyA/IG9uRnVsZmlsbGVkIDogbnVsbDtcbiAgICB0aGlzLm9uUmVqZWN0ZWQgPSB0eXBlb2Ygb25SZWplY3RlZCA9PT0gJ2Z1bmN0aW9uJyA/IG9uUmVqZWN0ZWQgOiBudWxsO1xuICAgIHRoaXMucmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgdGhpcy5yZWplY3QgPSByZWplY3Q7XG4gICAgdGhpcy5wc2QgPSBQU0Q7XG59XG5cbi8vIFByb21pc2UgU3RhdGljIFByb3BlcnRpZXNcbnByb3BzKFByb21pc2UsIHtcbiAgICBhbGw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZhbHVlcyA9IGdldEFycmF5T2YuYXBwbHkobnVsbCwgYXJndW1lbnRzKTsgLy8gU3VwcG9ydHMgaXRlcmFibGVzLCBpbXBsaWNpdCBhcmd1bWVudHMgYW5kIGFycmF5LWxpa2UuXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMCkgcmVzb2x2ZShbXSk7XG4gICAgICAgICAgICB2YXIgcmVtYWluaW5nID0gdmFsdWVzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uIChhLCBpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShhKS50aGVuKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlc1tpXSA9IHg7XG4gICAgICAgICAgICAgICAgICAgIGlmICghIC0tcmVtYWluaW5nKSByZXNvbHZlKHZhbHVlcyk7XG4gICAgICAgICAgICAgICAgfSwgcmVqZWN0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgcmVzb2x2ZTogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHJldHVybiB2YWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZS50aGVuID09PSAnZnVuY3Rpb24nKSByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFsdWUudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKElOVEVSTkFMLCB0cnVlLCB2YWx1ZSk7XG4gICAgfSxcblxuICAgIHJlamVjdDogUHJvbWlzZVJlamVjdCxcblxuICAgIHJhY2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZhbHVlcyA9IGdldEFycmF5T2YuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhbHVlcy5tYXAoZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBQU0Q6IHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gUFNEO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIFBTRCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG5ld1BTRDogbmV3U2NvcGUsXG5cbiAgICB1c2VQU0Q6IHVzZVBTRCxcblxuICAgIHNjaGVkdWxlcjoge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBhc2FwJDE7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBhc2FwJDEgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICByZWplY3Rpb25NYXBwZXI6IHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVqZWN0aW9uTWFwcGVyO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgcmVqZWN0aW9uTWFwcGVyID0gdmFsdWU7XG4gICAgICAgIH0gLy8gTWFwIHJlamVjdCBmYWlsdXJlc1xuICAgIH0sXG5cbiAgICBmb2xsb3c6IGZ1bmN0aW9uIChmbikge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ld1Njb3BlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgcHNkID0gUFNEO1xuICAgICAgICAgICAgICAgIHBzZC51bmhhbmRsZWRzID0gW107IC8vIEZvciB1bmhhbmRsZWQgc3RhbmRhcmQtIG9yIDNyZCBwYXJ0eSBQcm9taXNlcy4gQ2hlY2tlZCBhdCBwc2QuZmluYWxpemUoKVxuICAgICAgICAgICAgICAgIHBzZC5vbnVuaGFuZGxlZCA9IHJlamVjdDsgLy8gVHJpZ2dlcmVkIGRpcmVjdGx5IG9uIHVuaGFuZGxlZCBwcm9taXNlcyBvZiB0aGlzIGxpYnJhcnkuXG4gICAgICAgICAgICAgICAgcHNkLmZpbmFsaXplID0gY2FsbEJvdGgoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgICAgICAgICAgICAgICAvLyBVbmhhbmRsZWQgc3RhbmRhcmQgb3IgM3JkIHBhcnQgcHJvbWlzZXMgYXJlIHB1dCBpbiBQU0QudW5oYW5kbGVkcyBhbmRcbiAgICAgICAgICAgICAgICAgICAgLy8gZXhhbWluZWQgdXBvbiBzY29wZSBjb21wbGV0aW9uIHdoaWxlIHVuaGFuZGxlZCByZWplY3Rpb25zIGluIHRoaXMgUHJvbWlzZVxuICAgICAgICAgICAgICAgICAgICAvLyB3aWxsIHRyaWdnZXIgZGlyZWN0bHkgdGhyb3VnaCBwc2Qub251bmhhbmRsZWRcbiAgICAgICAgICAgICAgICAgICAgcnVuX2F0X2VuZF9vZl90aGlzX29yX25leHRfcGh5c2ljYWxfdGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpczMudW5oYW5kbGVkcy5sZW5ndGggPT09IDAgPyByZXNvbHZlKCkgOiByZWplY3QoX3RoaXMzLnVuaGFuZGxlZHNbMF0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9LCBwc2QuZmluYWxpemUpO1xuICAgICAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgICB9LCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgb246IEV2ZW50cyhudWxsLCB7IFwiZXJyb3JcIjogW3JldmVyc2VTdG9wcGFibGVFdmVudENoYWluLCBkZWZhdWx0RXJyb3JIYW5kbGVyXSAvLyBEZWZhdWx0IHRvIGRlZmF1bHRFcnJvckhhbmRsZXJcbiAgICB9KVxuXG59KTtcblxudmFyIFByb21pc2VPbkVycm9yID0gUHJvbWlzZS5vbi5lcnJvcjtcblByb21pc2VPbkVycm9yLnN1YnNjcmliZSA9IGRlcHJlY2F0ZWQoXCJQcm9taXNlLm9uKCdlcnJvcicpXCIsIFByb21pc2VPbkVycm9yLnN1YnNjcmliZSk7XG5Qcm9taXNlT25FcnJvci51bnN1YnNjcmliZSA9IGRlcHJlY2F0ZWQoXCJQcm9taXNlLm9uKCdlcnJvcicpLnVuc3Vic2NyaWJlXCIsIFByb21pc2VPbkVycm9yLnVuc3Vic2NyaWJlKTtcblxuLyoqXHJcbiogVGFrZSBhIHBvdGVudGlhbGx5IG1pc2JlaGF2aW5nIHJlc29sdmVyIGZ1bmN0aW9uIGFuZCBtYWtlIHN1cmVcclxuKiBvbkZ1bGZpbGxlZCBhbmQgb25SZWplY3RlZCBhcmUgb25seSBjYWxsZWQgb25jZS5cclxuKlxyXG4qIE1ha2VzIG5vIGd1YXJhbnRlZXMgYWJvdXQgYXN5bmNocm9ueS5cclxuKi9cbmZ1bmN0aW9uIGV4ZWN1dGVQcm9taXNlVGFzayhwcm9taXNlLCBmbikge1xuICAgIC8vIFByb21pc2UgUmVzb2x1dGlvbiBQcm9jZWR1cmU6XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3Byb21pc2VzLWFwbHVzL3Byb21pc2VzLXNwZWMjdGhlLXByb21pc2UtcmVzb2x1dGlvbi1wcm9jZWR1cmVcbiAgICB0cnkge1xuICAgICAgICBmbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gbnVsbCkgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBwcm9taXNlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdBIHByb21pc2UgY2Fubm90IGJlIHJlc29sdmVkIHdpdGggaXRzZWxmLicpO1xuICAgICAgICAgICAgdmFyIHNob3VsZEV4ZWN1dGVUaWNrID0gcHJvbWlzZS5fbGliICYmIGJlZ2luTWljcm9UaWNrU2NvcGUoKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGV4ZWN1dGVQcm9taXNlVGFzayhwcm9taXNlLCBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSA/IHZhbHVlLl90aGVuKHJlc29sdmUsIHJlamVjdCkgOiB2YWx1ZS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHByb21pc2UuX3N0YXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBwcm9taXNlLl92YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHByb3BhZ2F0ZUFsbExpc3RlbmVycyhwcm9taXNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzaG91bGRFeGVjdXRlVGljaykgZW5kTWljcm9UaWNrU2NvcGUoKTtcbiAgICAgICAgfSwgaGFuZGxlUmVqZWN0aW9uLmJpbmQobnVsbCwgcHJvbWlzZSkpOyAvLyBJZiBGdW5jdGlvbi5iaW5kIGlzIG5vdCBzdXBwb3J0ZWQuIEV4Y2VwdGlvbiBpcyBoYW5kbGVkIGluIGNhdGNoIGJlbG93XG4gICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgICAgaGFuZGxlUmVqZWN0aW9uKHByb21pc2UsIGV4KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVJlamVjdGlvbihwcm9taXNlLCByZWFzb24pIHtcbiAgICByZWplY3RpbmdFcnJvcnMucHVzaChyZWFzb24pO1xuICAgIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gbnVsbCkgcmV0dXJuO1xuICAgIHZhciBzaG91bGRFeGVjdXRlVGljayA9IHByb21pc2UuX2xpYiAmJiBiZWdpbk1pY3JvVGlja1Njb3BlKCk7XG4gICAgcmVhc29uID0gcmVqZWN0aW9uTWFwcGVyKHJlYXNvbik7XG4gICAgcHJvbWlzZS5fc3RhdGUgPSBmYWxzZTtcbiAgICBwcm9taXNlLl92YWx1ZSA9IHJlYXNvbjtcbiAgICBkZWJ1ZyAmJiByZWFzb24gIT09IG51bGwgJiYgdHlwZW9mIHJlYXNvbiA9PT0gJ29iamVjdCcgJiYgIXJlYXNvbi5fcHJvbWlzZSAmJiB0cnlDYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBvcmlnUHJvcCA9IGdldFByb3BlcnR5RGVzY3JpcHRvcihyZWFzb24sIFwic3RhY2tcIik7XG4gICAgICAgIHJlYXNvbi5fcHJvbWlzZSA9IHByb21pc2U7XG4gICAgICAgIHNldFByb3AocmVhc29uLCBcInN0YWNrXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGFja19iZWluZ19nZW5lcmF0ZWQgPyBvcmlnUHJvcCAmJiAob3JpZ1Byb3AuZ2V0ID8gb3JpZ1Byb3AuZ2V0LmFwcGx5KHJlYXNvbikgOiBvcmlnUHJvcC52YWx1ZSkgOiBwcm9taXNlLnN0YWNrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICAvLyBBZGQgdGhlIGZhaWx1cmUgdG8gYSBsaXN0IG9mIHBvc3NpYmx5IHVuY2F1Z2h0IGVycm9yc1xuICAgIGFkZFBvc3NpYmx5VW5oYW5kbGVkRXJyb3IocHJvbWlzZSk7XG4gICAgcHJvcGFnYXRlQWxsTGlzdGVuZXJzKHByb21pc2UpO1xuICAgIGlmIChzaG91bGRFeGVjdXRlVGljaykgZW5kTWljcm9UaWNrU2NvcGUoKTtcbn1cblxuZnVuY3Rpb24gcHJvcGFnYXRlQWxsTGlzdGVuZXJzKHByb21pc2UpIHtcbiAgICAvL2RlYnVnICYmIGxpbmtUb1ByZXZpb3VzUHJvbWlzZShwcm9taXNlKTtcbiAgICB2YXIgbGlzdGVuZXJzID0gcHJvbWlzZS5fbGlzdGVuZXJzO1xuICAgIHByb21pc2UuX2xpc3RlbmVycyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBsaXN0ZW5lcnMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgcHJvcGFnYXRlVG9MaXN0ZW5lcihwcm9taXNlLCBsaXN0ZW5lcnNbaV0pO1xuICAgIH1cbiAgICB2YXIgcHNkID0gcHJvbWlzZS5fUFNEO1xuICAgIC0tcHNkLnJlZiB8fCBwc2QuZmluYWxpemUoKTsgLy8gaWYgcHNkLnJlZiByZWFjaGVzIHplcm8sIGNhbGwgcHNkLmZpbmFsaXplKCk7XG4gICAgaWYgKG51bVNjaGVkdWxlZENhbGxzID09PSAwKSB7XG4gICAgICAgIC8vIElmIG51bVNjaGVkdWxlZENhbGxzIGlzIDAsIGl0IG1lYW5zIHRoYXQgb3VyIHN0YWNrIGlzIG5vdCBpbiBhIGNhbGxiYWNrIG9mIGEgc2NoZWR1bGVkIGNhbGwsXG4gICAgICAgIC8vIGFuZCB0aGF0IG5vIGRlZmVycmVkcyB3aGVyZSBsaXN0ZW5pbmcgdG8gdGhpcyByZWplY3Rpb24gb3Igc3VjY2Vzcy5cbiAgICAgICAgLy8gU2luY2UgdGhlcmUgaXMgYSByaXNrIHRoYXQgb3VyIHN0YWNrIGNhbiBjb250YWluIGFwcGxpY2F0aW9uIGNvZGUgdGhhdCBtYXlcbiAgICAgICAgLy8gZG8gc3R1ZmYgYWZ0ZXIgdGhpcyBjb2RlIGlzIGZpbmlzaGVkIHRoYXQgbWF5IGdlbmVyYXRlIG5ldyBjYWxscywgd2UgY2Fubm90XG4gICAgICAgIC8vIGNhbGwgZmluYWxpemVycyBoZXJlLlxuICAgICAgICArK251bVNjaGVkdWxlZENhbGxzO1xuICAgICAgICBhc2FwJDEoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKC0tbnVtU2NoZWR1bGVkQ2FsbHMgPT09IDApIGZpbmFsaXplUGh5c2ljYWxUaWNrKCk7IC8vIFdpbGwgZGV0ZWN0IHVuaGFuZGxlZCBlcnJvcnNcbiAgICAgICAgfSwgW10pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcHJvcGFnYXRlVG9MaXN0ZW5lcihwcm9taXNlLCBsaXN0ZW5lcikge1xuICAgIGlmIChwcm9taXNlLl9zdGF0ZSA9PT0gbnVsbCkge1xuICAgICAgICBwcm9taXNlLl9saXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgY2IgPSBwcm9taXNlLl9zdGF0ZSA/IGxpc3RlbmVyLm9uRnVsZmlsbGVkIDogbGlzdGVuZXIub25SZWplY3RlZDtcbiAgICBpZiAoY2IgPT09IG51bGwpIHtcbiAgICAgICAgLy8gVGhpcyBMaXN0ZW5lciBkb2VzbnQgaGF2ZSBhIGxpc3RlbmVyIGZvciB0aGUgZXZlbnQgYmVpbmcgdHJpZ2dlcmVkIChvbkZ1bGZpbGxlZCBvciBvblJlamVjdCkgc28gbGV0cyBmb3J3YXJkIHRoZSBldmVudCB0byBhbnkgZXZlbnR1YWwgbGlzdGVuZXJzIG9uIHRoZSBQcm9taXNlIGluc3RhbmNlIHJldHVybmVkIGJ5IHRoZW4oKSBvciBjYXRjaCgpXG4gICAgICAgIHJldHVybiAocHJvbWlzZS5fc3RhdGUgPyBsaXN0ZW5lci5yZXNvbHZlIDogbGlzdGVuZXIucmVqZWN0KShwcm9taXNlLl92YWx1ZSk7XG4gICAgfVxuICAgIHZhciBwc2QgPSBsaXN0ZW5lci5wc2Q7XG4gICAgKytwc2QucmVmO1xuICAgICsrbnVtU2NoZWR1bGVkQ2FsbHM7XG4gICAgYXNhcCQxKGNhbGxMaXN0ZW5lciwgW2NiLCBwcm9taXNlLCBsaXN0ZW5lcl0pO1xufVxuXG5mdW5jdGlvbiBjYWxsTGlzdGVuZXIoY2IsIHByb21pc2UsIGxpc3RlbmVyKSB7XG4gICAgdmFyIG91dGVyU2NvcGUgPSBQU0Q7XG4gICAgdmFyIHBzZCA9IGxpc3RlbmVyLnBzZDtcbiAgICB0cnkge1xuICAgICAgICBpZiAocHNkICE9PSBvdXRlclNjb3BlKSB7XG4gICAgICAgICAgICAvLyAqKktFRVAqKiBvdXRlclNjb3BlLmVudiA9IHdyYXBwZXJzLnNuYXBzaG90KCk7IC8vIFNuYXBzaG90IG91dGVyU2NvcGUncyBlbnZpcm9ubWVudC5cbiAgICAgICAgICAgIFBTRCA9IHBzZDtcbiAgICAgICAgICAgIC8vICoqS0VFUCoqIHdyYXBwZXJzLnJlc3RvcmUocHNkLmVudik7IC8vIFJlc3RvcmUgUFNEJ3MgZW52aXJvbm1lbnQuXG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXQgc3RhdGljIHZhcmlhYmxlIGN1cnJlbnRGdWxmaWxsZXIgdG8gdGhlIHByb21pc2UgdGhhdCBpcyBiZWluZyBmdWxsZmlsbGVkLFxuICAgICAgICAvLyBzbyB0aGF0IHdlIGNvbm5lY3QgdGhlIGNoYWluIG9mIHByb21pc2VzIChmb3IgbG9uZyBzdGFja3Mgc3VwcG9ydClcbiAgICAgICAgY3VycmVudEZ1bGZpbGxlciA9IHByb21pc2U7XG5cbiAgICAgICAgLy8gQ2FsbCBjYWxsYmFjayBhbmQgcmVzb2x2ZSBvdXIgbGlzdGVuZXIgd2l0aCBpdCdzIHJldHVybiB2YWx1ZS5cbiAgICAgICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdmFsdWUsXG4gICAgICAgICAgICByZXQ7XG4gICAgICAgIGlmIChwcm9taXNlLl9zdGF0ZSkge1xuICAgICAgICAgICAgcmV0ID0gY2IodmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHJlamVjdGluZ0Vycm9ycy5sZW5ndGgpIHJlamVjdGluZ0Vycm9ycyA9IFtdO1xuICAgICAgICAgICAgcmV0ID0gY2IodmFsdWUpO1xuICAgICAgICAgICAgaWYgKHJlamVjdGluZ0Vycm9ycy5pbmRleE9mKHZhbHVlKSA9PT0gLTEpIG1hcmtFcnJvckFzSGFuZGxlZChwcm9taXNlKTsgLy8gQ2FsbGJhY2sgZGlkbnQgZG8gUHJvbWlzZS5yZWplY3QoZXJyKSBub3IgcmVqZWN0KGVycikgb250byBhbm90aGVyIHByb21pc2UuXG4gICAgICAgIH1cbiAgICAgICAgbGlzdGVuZXIucmVzb2x2ZShyZXQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gRXhjZXB0aW9uIHRocm93biBpbiBjYWxsYmFjay4gUmVqZWN0IG91ciBsaXN0ZW5lci5cbiAgICAgICAgbGlzdGVuZXIucmVqZWN0KGUpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAgIC8vIFJlc3RvcmUgUFNELCBlbnYgYW5kIGN1cnJlbnRGdWxmaWxsZXIuXG4gICAgICAgIGlmIChwc2QgIT09IG91dGVyU2NvcGUpIHtcbiAgICAgICAgICAgIFBTRCA9IG91dGVyU2NvcGU7XG4gICAgICAgICAgICAvLyAqKktFRVAqKiB3cmFwcGVycy5yZXN0b3JlKG91dGVyU2NvcGUuZW52KTsgLy8gUmVzdG9yZSBvdXRlclNjb3BlJ3MgZW52aXJvbm1lbnRcbiAgICAgICAgfVxuICAgICAgICBjdXJyZW50RnVsZmlsbGVyID0gbnVsbDtcbiAgICAgICAgaWYgKC0tbnVtU2NoZWR1bGVkQ2FsbHMgPT09IDApIGZpbmFsaXplUGh5c2ljYWxUaWNrKCk7XG4gICAgICAgIC0tcHNkLnJlZiB8fCBwc2QuZmluYWxpemUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldFN0YWNrKHByb21pc2UsIHN0YWNrcywgbGltaXQpIHtcbiAgICBpZiAoc3RhY2tzLmxlbmd0aCA9PT0gbGltaXQpIHJldHVybiBzdGFja3M7XG4gICAgdmFyIHN0YWNrID0gXCJcIjtcbiAgICBpZiAocHJvbWlzZS5fc3RhdGUgPT09IGZhbHNlKSB7XG4gICAgICAgIHZhciBmYWlsdXJlID0gcHJvbWlzZS5fdmFsdWUsXG4gICAgICAgICAgICBlcnJvck5hbWUsXG4gICAgICAgICAgICBtZXNzYWdlO1xuXG4gICAgICAgIGlmIChmYWlsdXJlICE9IG51bGwpIHtcbiAgICAgICAgICAgIGVycm9yTmFtZSA9IGZhaWx1cmUubmFtZSB8fCBcIkVycm9yXCI7XG4gICAgICAgICAgICBtZXNzYWdlID0gZmFpbHVyZS5tZXNzYWdlIHx8IGZhaWx1cmU7XG4gICAgICAgICAgICBzdGFjayA9IHByZXR0eVN0YWNrKGZhaWx1cmUsIDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXJyb3JOYW1lID0gZmFpbHVyZTsgLy8gSWYgZXJyb3IgaXMgdW5kZWZpbmVkIG9yIG51bGwsIHNob3cgdGhhdC5cbiAgICAgICAgICAgIG1lc3NhZ2UgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHN0YWNrcy5wdXNoKGVycm9yTmFtZSArIChtZXNzYWdlID8gXCI6IFwiICsgbWVzc2FnZSA6IFwiXCIpICsgc3RhY2spO1xuICAgIH1cbiAgICBpZiAoZGVidWcpIHtcbiAgICAgICAgc3RhY2sgPSBwcmV0dHlTdGFjayhwcm9taXNlLl9zdGFja0hvbGRlciwgMik7XG4gICAgICAgIGlmIChzdGFjayAmJiBzdGFja3MuaW5kZXhPZihzdGFjaykgPT09IC0xKSBzdGFja3MucHVzaChzdGFjayk7XG4gICAgICAgIGlmIChwcm9taXNlLl9wcmV2KSBnZXRTdGFjayhwcm9taXNlLl9wcmV2LCBzdGFja3MsIGxpbWl0KTtcbiAgICB9XG4gICAgcmV0dXJuIHN0YWNrcztcbn1cblxuZnVuY3Rpb24gbGlua1RvUHJldmlvdXNQcm9taXNlKHByb21pc2UsIHByZXYpIHtcbiAgICAvLyBTdXBwb3J0IGxvbmcgc3RhY2tzIGJ5IGxpbmtpbmcgdG8gcHJldmlvdXMgY29tcGxldGVkIHByb21pc2UuXG4gICAgdmFyIG51bVByZXYgPSBwcmV2ID8gcHJldi5fbnVtUHJldiArIDEgOiAwO1xuICAgIGlmIChudW1QcmV2IDwgTE9OR19TVEFDS1NfQ0xJUF9MSU1JVCkge1xuICAgICAgICAvLyBQcm9oaWJpdCBpbmZpbml0ZSBQcm9taXNlIGxvb3BzIHRvIGdldCBhbiBpbmZpbml0ZSBsb25nIG1lbW9yeSBjb25zdW1pbmcgXCJ0YWlsXCIuXG4gICAgICAgIHByb21pc2UuX3ByZXYgPSBwcmV2O1xuICAgICAgICBwcm9taXNlLl9udW1QcmV2ID0gbnVtUHJldjtcbiAgICB9XG59XG5cbi8qIFRoZSBjYWxsYmFjayB0byBzY2hlZHVsZSB3aXRoIHNldEltbWVkaWF0ZSgpIG9yIHNldFRpbWVvdXQoKS5cclxuICAgSXQgcnVucyBhIHZpcnR1YWwgbWljcm90aWNrIGFuZCBleGVjdXRlcyBhbnkgY2FsbGJhY2sgcmVnaXN0ZXJlZCBpbiBtaWNyb3RpY2tRdWV1ZS5cclxuICovXG5mdW5jdGlvbiBwaHlzaWNhbFRpY2soKSB7XG4gICAgYmVnaW5NaWNyb1RpY2tTY29wZSgpICYmIGVuZE1pY3JvVGlja1Njb3BlKCk7XG59XG5cbmZ1bmN0aW9uIGJlZ2luTWljcm9UaWNrU2NvcGUoKSB7XG4gICAgdmFyIHdhc1Jvb3RFeGVjID0gaXNPdXRzaWRlTWljcm9UaWNrO1xuICAgIGlzT3V0c2lkZU1pY3JvVGljayA9IGZhbHNlO1xuICAgIG5lZWRzTmV3UGh5c2ljYWxUaWNrID0gZmFsc2U7XG4gICAgcmV0dXJuIHdhc1Jvb3RFeGVjO1xufVxuXG4vKiBFeGVjdXRlcyBtaWNyby10aWNrcyB3aXRob3V0IGRvaW5nIHRyeS4uY2F0Y2guXHJcbiAgIFRoaXMgY2FuIGJlIHBvc3NpYmxlIGJlY2F1c2Ugd2Ugb25seSB1c2UgdGhpcyBpbnRlcm5hbGx5IGFuZFxyXG4gICB0aGUgcmVnaXN0ZXJlZCBmdW5jdGlvbnMgYXJlIGV4Y2VwdGlvbi1zYWZlICh0aGV5IGRvIHRyeS4uY2F0Y2hcclxuICAgaW50ZXJuYWxseSBiZWZvcmUgY2FsbGluZyBhbnkgZXh0ZXJuYWwgbWV0aG9kKS4gSWYgcmVnaXN0ZXJpbmdcclxuICAgZnVuY3Rpb25zIGluIHRoZSBtaWNyb3RpY2tRdWV1ZSB0aGF0IGFyZSBub3QgZXhjZXB0aW9uLXNhZmUsIHRoaXNcclxuICAgd291bGQgZGVzdHJveSB0aGUgZnJhbWV3b3JrIGFuZCBtYWtlIGl0IGluc3RhYmxlLiBTbyB3ZSBkb24ndCBleHBvcnRcclxuICAgb3VyIGFzYXAgbWV0aG9kLlxyXG4qL1xuZnVuY3Rpb24gZW5kTWljcm9UaWNrU2NvcGUoKSB7XG4gICAgdmFyIGNhbGxiYWNrcywgaSwgbDtcbiAgICBkbyB7XG4gICAgICAgIHdoaWxlIChtaWNyb3RpY2tRdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjYWxsYmFja3MgPSBtaWNyb3RpY2tRdWV1ZTtcbiAgICAgICAgICAgIG1pY3JvdGlja1F1ZXVlID0gW107XG4gICAgICAgICAgICBsID0gY2FsbGJhY2tzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGNhbGxiYWNrc1tpXTtcbiAgICAgICAgICAgICAgICBpdGVtWzBdLmFwcGx5KG51bGwsIGl0ZW1bMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSB3aGlsZSAobWljcm90aWNrUXVldWUubGVuZ3RoID4gMCk7XG4gICAgaXNPdXRzaWRlTWljcm9UaWNrID0gdHJ1ZTtcbiAgICBuZWVkc05ld1BoeXNpY2FsVGljayA9IHRydWU7XG59XG5cbmZ1bmN0aW9uIGZpbmFsaXplUGh5c2ljYWxUaWNrKCkge1xuICAgIHZhciB1bmhhbmRsZWRFcnJzID0gdW5oYW5kbGVkRXJyb3JzO1xuICAgIHVuaGFuZGxlZEVycm9ycyA9IFtdO1xuICAgIHVuaGFuZGxlZEVycnMuZm9yRWFjaChmdW5jdGlvbiAocCkge1xuICAgICAgICBwLl9QU0Qub251bmhhbmRsZWQuY2FsbChudWxsLCBwLl92YWx1ZSwgcCk7XG4gICAgfSk7XG4gICAgdmFyIGZpbmFsaXplcnMgPSB0aWNrRmluYWxpemVycy5zbGljZSgwKTsgLy8gQ2xvbmUgZmlyc3QgYmVjYXVzZSBmaW5hbGl6ZXIgbWF5IHJlbW92ZSBpdHNlbGYgZnJvbSBsaXN0LlxuICAgIHZhciBpID0gZmluYWxpemVycy5sZW5ndGg7XG4gICAgd2hpbGUgKGkpIHtcbiAgICAgICAgZmluYWxpemVyc1stLWldKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBydW5fYXRfZW5kX29mX3RoaXNfb3JfbmV4dF9waHlzaWNhbF90aWNrKGZuKSB7XG4gICAgZnVuY3Rpb24gZmluYWxpemVyKCkge1xuICAgICAgICBmbigpO1xuICAgICAgICB0aWNrRmluYWxpemVycy5zcGxpY2UodGlja0ZpbmFsaXplcnMuaW5kZXhPZihmaW5hbGl6ZXIpLCAxKTtcbiAgICB9XG4gICAgdGlja0ZpbmFsaXplcnMucHVzaChmaW5hbGl6ZXIpO1xuICAgICsrbnVtU2NoZWR1bGVkQ2FsbHM7XG4gICAgYXNhcCQxKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKC0tbnVtU2NoZWR1bGVkQ2FsbHMgPT09IDApIGZpbmFsaXplUGh5c2ljYWxUaWNrKCk7XG4gICAgfSwgW10pO1xufVxuXG5mdW5jdGlvbiBhZGRQb3NzaWJseVVuaGFuZGxlZEVycm9yKHByb21pc2UpIHtcbiAgICAvLyBPbmx5IGFkZCB0byB1bmhhbmRsZWRFcnJvcnMgaWYgbm90IGFscmVhZHkgdGhlcmUuIFRoZSBmaXJzdCBvbmUgdG8gYWRkIHRvIHRoaXMgbGlzdFxuICAgIC8vIHdpbGwgYmUgdXBvbiB0aGUgZmlyc3QgcmVqZWN0aW9uIHNvIHRoYXQgdGhlIHJvb3QgY2F1c2UgKGZpcnN0IHByb21pc2UgaW4gdGhlXG4gICAgLy8gcmVqZWN0aW9uIGNoYWluKSBpcyB0aGUgb25lIGxpc3RlZC5cbiAgICBpZiAoIXVuaGFuZGxlZEVycm9ycy5zb21lKGZ1bmN0aW9uIChwKSB7XG4gICAgICAgIHJldHVybiBwLl92YWx1ZSA9PT0gcHJvbWlzZS5fdmFsdWU7XG4gICAgfSkpIHVuaGFuZGxlZEVycm9ycy5wdXNoKHByb21pc2UpO1xufVxuXG5mdW5jdGlvbiBtYXJrRXJyb3JBc0hhbmRsZWQocHJvbWlzZSkge1xuICAgIC8vIENhbGxlZCB3aGVuIGEgcmVqZWN0IGhhbmRsZWQgaXMgYWN0dWFsbHkgYmVpbmcgY2FsbGVkLlxuICAgIC8vIFNlYXJjaCBpbiB1bmhhbmRsZWRFcnJvcnMgZm9yIGFueSBwcm9taXNlIHdob3MgX3ZhbHVlIGlzIHRoaXMgcHJvbWlzZV92YWx1ZSAobGlzdFxuICAgIC8vIGNvbnRhaW5zIG9ubHkgcmVqZWN0ZWQgcHJvbWlzZXMsIGFuZCBvbmx5IG9uZSBpdGVtIHBlciBlcnJvcilcbiAgICB2YXIgaSA9IHVuaGFuZGxlZEVycm9ycy5sZW5ndGg7XG4gICAgd2hpbGUgKGkpIHtcbiAgICAgICAgaWYgKHVuaGFuZGxlZEVycm9yc1stLWldLl92YWx1ZSA9PT0gcHJvbWlzZS5fdmFsdWUpIHtcbiAgICAgICAgICAgIC8vIEZvdW5kIGEgcHJvbWlzZSB0aGF0IGZhaWxlZCB3aXRoIHRoaXMgc2FtZSBlcnJvciBvYmplY3QgcG9pbnRlcixcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGF0IHNpbmNlIHRoZXJlIGlzIGEgbGlzdGVuZXIgdGhhdCBhY3R1YWxseSB0YWtlcyBjYXJlIG9mIGl0LlxuICAgICAgICAgICAgdW5oYW5kbGVkRXJyb3JzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8gQnkgZGVmYXVsdCwgbG9nIHVuY2F1Z2h0IGVycm9ycyB0byB0aGUgY29uc29sZVxuZnVuY3Rpb24gZGVmYXVsdEVycm9ySGFuZGxlcihlKSB7XG4gICAgY29uc29sZS53YXJuKCdVbmhhbmRsZWQgcmVqZWN0aW9uOiAnICsgKGUuc3RhY2sgfHwgZSkpO1xufVxuXG5mdW5jdGlvbiBQcm9taXNlUmVqZWN0KHJlYXNvbikge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShJTlRFUk5BTCwgZmFsc2UsIHJlYXNvbik7XG59XG5cbmZ1bmN0aW9uIHdyYXAoZm4sIGVycm9yQ2F0Y2hlcikge1xuICAgIHZhciBwc2QgPSBQU0Q7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHdhc1Jvb3RFeGVjID0gYmVnaW5NaWNyb1RpY2tTY29wZSgpLFxuICAgICAgICAgICAgb3V0ZXJTY29wZSA9IFBTRDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKG91dGVyU2NvcGUgIT09IHBzZCkge1xuICAgICAgICAgICAgICAgIC8vICoqS0VFUCoqIG91dGVyU2NvcGUuZW52ID0gd3JhcHBlcnMuc25hcHNob3QoKTsgLy8gU25hcHNob3Qgb3V0ZXJTY29wZSdzIGVudmlyb25tZW50XG4gICAgICAgICAgICAgICAgUFNEID0gcHNkO1xuICAgICAgICAgICAgICAgIC8vICoqS0VFUCoqIHdyYXBwZXJzLnJlc3RvcmUocHNkLmVudik7IC8vIFJlc3RvcmUgUFNEJ3MgZW52aXJvbm1lbnQuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgZXJyb3JDYXRjaGVyICYmIGVycm9yQ2F0Y2hlcihlKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIGlmIChvdXRlclNjb3BlICE9PSBwc2QpIHtcbiAgICAgICAgICAgICAgICBQU0QgPSBvdXRlclNjb3BlO1xuICAgICAgICAgICAgICAgIC8vICoqS0VFUCoqIHdyYXBwZXJzLnJlc3RvcmUob3V0ZXJTY29wZS5lbnYpOyAvLyBSZXN0b3JlIG91dGVyU2NvcGUncyBlbnZpcm9ubWVudFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHdhc1Jvb3RFeGVjKSBlbmRNaWNyb1RpY2tTY29wZSgpO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gbmV3U2NvcGUoZm4sIGExLCBhMiwgYTMpIHtcbiAgICB2YXIgcGFyZW50ID0gUFNELFxuICAgICAgICBwc2QgPSBPYmplY3QuY3JlYXRlKHBhcmVudCk7XG4gICAgcHNkLnBhcmVudCA9IHBhcmVudDtcbiAgICBwc2QucmVmID0gMDtcbiAgICBwc2QuZ2xvYmFsID0gZmFsc2U7XG4gICAgLy8gKipLRUVQKiogcHNkLmVudiA9IHdyYXBwZXJzLndyYXAocHNkKTtcblxuICAgIC8vIHVuaGFuZGxlZHMgYW5kIG9udW5oYW5kbGVkIHNob3VsZCBub3QgYmUgc3BlY2lmaWNhbGx5IHNldCBoZXJlLlxuICAgIC8vIExlYXZlIHRoZW0gb24gcGFyZW50IHByb3RvdHlwZS5cbiAgICAvLyB1bmhhbmRsZWRzLnB1c2goZXJyKSB3aWxsIHB1c2ggdG8gcGFyZW50J3MgcHJvdG90eXBlXG4gICAgLy8gb251bmhhbmRsZWQoKSB3aWxsIGNhbGwgcGFyZW50cyBvbnVuaGFuZGxlZCAod2l0aCB0aGlzIHNjb3BlJ3MgdGhpcy1wb2ludGVyIHRob3VnaCEpXG4gICAgKytwYXJlbnQucmVmO1xuICAgIHBzZC5maW5hbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLS10aGlzLnBhcmVudC5yZWYgfHwgdGhpcy5wYXJlbnQuZmluYWxpemUoKTtcbiAgICB9O1xuICAgIHZhciBydiA9IHVzZVBTRChwc2QsIGZuLCBhMSwgYTIsIGEzKTtcbiAgICBpZiAocHNkLnJlZiA9PT0gMCkgcHNkLmZpbmFsaXplKCk7XG4gICAgcmV0dXJuIHJ2O1xufVxuXG5mdW5jdGlvbiB1c2VQU0QocHNkLCBmbiwgYTEsIGEyLCBhMykge1xuICAgIHZhciBvdXRlclNjb3BlID0gUFNEO1xuICAgIHRyeSB7XG4gICAgICAgIGlmIChwc2QgIT09IG91dGVyU2NvcGUpIHtcbiAgICAgICAgICAgIC8vICoqS0VFUCoqIG91dGVyU2NvcGUuZW52ID0gd3JhcHBlcnMuc25hcHNob3QoKTsgLy8gc25hcHNob3Qgb3V0ZXJTY29wZSdzIGVudmlyb25tZW50LlxuICAgICAgICAgICAgUFNEID0gcHNkO1xuICAgICAgICAgICAgLy8gKipLRUVQKiogd3JhcHBlcnMucmVzdG9yZShwc2QuZW52KTsgLy8gUmVzdG9yZSBQU0QncyBlbnZpcm9ubWVudC5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZm4oYTEsIGEyLCBhMyk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKHBzZCAhPT0gb3V0ZXJTY29wZSkge1xuICAgICAgICAgICAgUFNEID0gb3V0ZXJTY29wZTtcbiAgICAgICAgICAgIC8vICoqS0VFUCoqIHdyYXBwZXJzLnJlc3RvcmUob3V0ZXJTY29wZS5lbnYpOyAvLyBSZXN0b3JlIG91dGVyU2NvcGUncyBlbnZpcm9ubWVudC5cbiAgICAgICAgfVxuICAgIH1cbn1cblxudmFyIFVOSEFORExFRFJFSkVDVElPTiA9IFwidW5oYW5kbGVkcmVqZWN0aW9uXCI7XG5cbmZ1bmN0aW9uIGdsb2JhbEVycm9yKGVyciwgcHJvbWlzZSkge1xuICAgIHZhciBydjtcbiAgICB0cnkge1xuICAgICAgICBydiA9IHByb21pc2Uub251bmNhdGNoZWQoZXJyKTtcbiAgICB9IGNhdGNoIChlKSB7fVxuICAgIGlmIChydiAhPT0gZmFsc2UpIHRyeSB7XG4gICAgICAgIHZhciBldmVudCxcbiAgICAgICAgICAgIGV2ZW50RGF0YSA9IHsgcHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiBlcnIgfTtcbiAgICAgICAgaWYgKF9nbG9iYWwuZG9jdW1lbnQgJiYgZG9jdW1lbnQuY3JlYXRlRXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0V2ZW50Jyk7XG4gICAgICAgICAgICBldmVudC5pbml0RXZlbnQoVU5IQU5ETEVEUkVKRUNUSU9OLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgICAgIGV4dGVuZChldmVudCwgZXZlbnREYXRhKTtcbiAgICAgICAgfSBlbHNlIGlmIChfZ2xvYmFsLkN1c3RvbUV2ZW50KSB7XG4gICAgICAgICAgICBldmVudCA9IG5ldyBDdXN0b21FdmVudChVTkhBTkRMRURSRUpFQ1RJT04sIHsgZGV0YWlsOiBldmVudERhdGEgfSk7XG4gICAgICAgICAgICBleHRlbmQoZXZlbnQsIGV2ZW50RGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50ICYmIF9nbG9iYWwuZGlzcGF0Y2hFdmVudCkge1xuICAgICAgICAgICAgZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgICAgICBpZiAoIV9nbG9iYWwuUHJvbWlzZVJlamVjdGlvbkV2ZW50ICYmIF9nbG9iYWwub251bmhhbmRsZWRyZWplY3Rpb24pXG4gICAgICAgICAgICAgICAgLy8gTm8gbmF0aXZlIHN1cHBvcnQgZm9yIFByb21pc2VSZWplY3Rpb25FdmVudCBidXQgdXNlciBoYXMgc2V0IHdpbmRvdy5vbnVuaGFuZGxlZHJlamVjdGlvbi4gTWFudWFsbHkgY2FsbCBpdC5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBfZ2xvYmFsLm9udW5oYW5kbGVkcmVqZWN0aW9uKGV2ZW50KTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChfKSB7fVxuICAgICAgICB9XG4gICAgICAgIGlmICghZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgICAgICAgLy8gQmFja3dhcmQgY29tcGF0aWJpbGl0eTogZmlyZSB0byBldmVudHMgcmVnaXN0ZXJlZCBhdCBQcm9taXNlLm9uLmVycm9yXG4gICAgICAgICAgICBQcm9taXNlLm9uLmVycm9yLmZpcmUoZXJyLCBwcm9taXNlKTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHt9XG59XG5cbi8qICoqS0VFUCoqIFxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHdyYXBQcm9taXNlKFByb21pc2VDbGFzcykge1xyXG4gICAgdmFyIHByb3RvID0gUHJvbWlzZUNsYXNzLnByb3RvdHlwZTtcclxuICAgIHZhciBvcmlnVGhlbiA9IHByb3RvLnRoZW47XHJcbiAgICBcclxuICAgIHdyYXBwZXJzLmFkZCh7XHJcbiAgICAgICAgc25hcHNob3Q6ICgpID0+IHByb3RvLnRoZW4sXHJcbiAgICAgICAgcmVzdG9yZTogdmFsdWUgPT4ge3Byb3RvLnRoZW4gPSB2YWx1ZTt9LFxyXG4gICAgICAgIHdyYXA6ICgpID0+IHBhdGNoZWRUaGVuXHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBwYXRjaGVkVGhlbiAob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcclxuICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG9uRnVsZmlsbGVkUHJveHkgPSB3cmFwKGZ1bmN0aW9uKHZhbHVlKXtcclxuICAgICAgICAgICAgdmFyIHJ2ID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGlmIChvbkZ1bGZpbGxlZCkge1xyXG4gICAgICAgICAgICAgICAgcnYgPSBvbkZ1bGZpbGxlZChydik7XHJcbiAgICAgICAgICAgICAgICBpZiAocnYgJiYgdHlwZW9mIHJ2LnRoZW4gPT09ICdmdW5jdGlvbicpIHJ2LnRoZW4oKTsgLy8gSW50ZXJjZXB0IHRoYXQgcHJvbWlzZSBhcyB3ZWxsLlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC0tUFNELnJlZiB8fCBQU0QuZmluYWxpemUoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJ2O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBvblJlamVjdGVkUHJveHkgPSB3cmFwKGZ1bmN0aW9uKGVycil7XHJcbiAgICAgICAgICAgIHByb21pc2UuXyRlcnIgPSBlcnI7XHJcbiAgICAgICAgICAgIHZhciB1bmhhbmRsZWRzID0gUFNELnVuaGFuZGxlZHM7XHJcbiAgICAgICAgICAgIHZhciBpZHggPSB1bmhhbmRsZWRzLmxlbmd0aCxcclxuICAgICAgICAgICAgICAgIHJ2O1xyXG4gICAgICAgICAgICB3aGlsZSAoaWR4LS0pIGlmICh1bmhhbmRsZWRzW2lkeF0uXyRlcnIgPT09IGVycikgYnJlYWs7XHJcbiAgICAgICAgICAgIGlmIChvblJlamVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaWR4ICE9PSAtMSkgdW5oYW5kbGVkcy5zcGxpY2UoaWR4LCAxKTsgLy8gTWFyayBhcyBoYW5kbGVkLlxyXG4gICAgICAgICAgICAgICAgcnYgPSBvblJlamVjdGVkKGVycik7XHJcbiAgICAgICAgICAgICAgICBpZiAocnYgJiYgdHlwZW9mIHJ2LnRoZW4gPT09ICdmdW5jdGlvbicpIHJ2LnRoZW4oKTsgLy8gSW50ZXJjZXB0IHRoYXQgcHJvbWlzZSBhcyB3ZWxsLlxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlkeCA9PT0gLTEpIHVuaGFuZGxlZHMucHVzaChwcm9taXNlKTtcclxuICAgICAgICAgICAgICAgIHJ2ID0gUHJvbWlzZUNsYXNzLnJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgcnYuXyRub2ludGVyY2VwdCA9IHRydWU7IC8vIFByb2hpYml0IGV0ZXJuYWwgbG9vcC5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAtLVBTRC5yZWYgfHwgUFNELmZpbmFsaXplKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBydjtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAodGhpcy5fJG5vaW50ZXJjZXB0KSByZXR1cm4gb3JpZ1RoZW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICArK1BTRC5yZWY7XHJcbiAgICAgICAgcmV0dXJuIG9yaWdUaGVuLmNhbGwodGhpcywgb25GdWxmaWxsZWRQcm94eSwgb25SZWplY3RlZFByb3h5KTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gR2xvYmFsIFByb21pc2Ugd3JhcHBlclxyXG5pZiAoX2dsb2JhbC5Qcm9taXNlKSB3cmFwUHJvbWlzZShfZ2xvYmFsLlByb21pc2UpO1xyXG5cclxuKi9cblxuZG9GYWtlQXV0b0NvbXBsZXRlKGZ1bmN0aW9uICgpIHtcbiAgICAvLyBTaW1wbGlmeSB0aGUgam9iIGZvciBWUyBJbnRlbGxpc2Vuc2UuIFRoaXMgcGllY2Ugb2YgY29kZSBpcyBvbmUgb2YgdGhlIGtleXMgdG8gdGhlIG5ldyBtYXJ2ZWxsb3VzIGludGVsbGlzZW5zZSBzdXBwb3J0IGluIERleGllLlxuICAgIGFzYXAkMSA9IGZ1bmN0aW9uIChmbiwgYXJncykge1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZuLmFwcGx5KG51bGwsIGFyZ3MpO1xuICAgICAgICB9LCAwKTtcbiAgICB9O1xufSk7XG5cbmZ1bmN0aW9uIHJlamVjdGlvbihlcnIsIHVuY2F1Z2h0SGFuZGxlcikge1xuICAgIC8vIEdldCB0aGUgY2FsbCBzdGFjayBhbmQgcmV0dXJuIGEgcmVqZWN0ZWQgcHJvbWlzZS5cbiAgICB2YXIgcnYgPSBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgIHJldHVybiB1bmNhdWdodEhhbmRsZXIgPyBydi51bmNhdWdodCh1bmNhdWdodEhhbmRsZXIpIDogcnY7XG59XG5cbi8qXHJcbiAqIERleGllLmpzIC0gYSBtaW5pbWFsaXN0aWMgd3JhcHBlciBmb3IgSW5kZXhlZERCXHJcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqXHJcbiAqIEJ5IERhdmlkIEZhaGxhbmRlciwgZGF2aWQuZmFobGFuZGVyQGdtYWlsLmNvbVxyXG4gKlxyXG4gKiBWZXJzaW9uIDEuNS4xLCBUdWUgTm92IDAxIDIwMTZcclxuICpcclxuICogaHR0cDovL2RleGllLm9yZ1xyXG4gKlxyXG4gKiBBcGFjaGUgTGljZW5zZSBWZXJzaW9uIDIuMCwgSmFudWFyeSAyMDA0LCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvXHJcbiAqL1xuXG52YXIgREVYSUVfVkVSU0lPTiA9ICcxLjUuMSc7XG52YXIgbWF4U3RyaW5nID0gU3RyaW5nLmZyb21DaGFyQ29kZSg2NTUzNSk7XG52YXIgbWF4S2V5ID0gZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIElEQktleVJhbmdlLm9ubHkoW1tdXSk7cmV0dXJuIFtbXV07XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gbWF4U3RyaW5nO1xuICAgIH1cbn0oKTtcbnZhciBJTlZBTElEX0tFWV9BUkdVTUVOVCA9IFwiSW52YWxpZCBrZXkgcHJvdmlkZWQuIEtleXMgbXVzdCBiZSBvZiB0eXBlIHN0cmluZywgbnVtYmVyLCBEYXRlIG9yIEFycmF5PHN0cmluZyB8IG51bWJlciB8IERhdGU+LlwiO1xudmFyIFNUUklOR19FWFBFQ1RFRCA9IFwiU3RyaW5nIGV4cGVjdGVkLlwiO1xudmFyIGNvbm5lY3Rpb25zID0gW107XG52YXIgaXNJRU9yRWRnZSA9IHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIC8oTVNJRXxUcmlkZW50fEVkZ2UpLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xudmFyIGhhc0lFRGVsZXRlT2JqZWN0U3RvcmVCdWcgPSBpc0lFT3JFZGdlO1xudmFyIGhhbmdzT25EZWxldGVMYXJnZUtleVJhbmdlID0gaXNJRU9yRWRnZTtcbnZhciBkZXhpZVN0YWNrRnJhbWVGaWx0ZXIgPSBmdW5jdGlvbiAoZnJhbWUpIHtcbiAgICByZXR1cm4gIS8oZGV4aWVcXC5qc3xkZXhpZVxcLm1pblxcLmpzKS8udGVzdChmcmFtZSk7XG59O1xuXG5zZXREZWJ1ZyhkZWJ1ZywgZGV4aWVTdGFja0ZyYW1lRmlsdGVyKTtcblxuZnVuY3Rpb24gRGV4aWUoZGJOYW1lLCBvcHRpb25zKSB7XG4gICAgLy8vIDxwYXJhbSBuYW1lPVwib3B0aW9uc1wiIHR5cGU9XCJPYmplY3RcIiBvcHRpb25hbD1cInRydWVcIj5TcGVjaWZ5IG9ubHkgaWYgeW91IHdpY2ggdG8gY29udHJvbCB3aGljaCBhZGRvbnMgdGhhdCBzaG91bGQgcnVuIG9uIHRoaXMgaW5zdGFuY2U8L3BhcmFtPlxuICAgIHZhciBkZXBzID0gRGV4aWUuZGVwZW5kZW5jaWVzO1xuICAgIHZhciBvcHRzID0gZXh0ZW5kKHtcbiAgICAgICAgLy8gRGVmYXVsdCBPcHRpb25zXG4gICAgICAgIGFkZG9uczogRGV4aWUuYWRkb25zLCAvLyBQaWNrIHN0YXRpY2FsbHkgcmVnaXN0ZXJlZCBhZGRvbnMgYnkgZGVmYXVsdFxuICAgICAgICBhdXRvT3BlbjogdHJ1ZSwgLy8gRG9uJ3QgcmVxdWlyZSBkYi5vcGVuKCkgZXhwbGljaXRlbHkuXG4gICAgICAgIGluZGV4ZWREQjogZGVwcy5pbmRleGVkREIsIC8vIEJhY2tlbmQgSW5kZXhlZERCIGFwaS4gRGVmYXVsdCB0byBJREJTaGltIG9yIGJyb3dzZXIgZW52LlxuICAgICAgICBJREJLZXlSYW5nZTogZGVwcy5JREJLZXlSYW5nZSAvLyBCYWNrZW5kIElEQktleVJhbmdlIGFwaS4gRGVmYXVsdCB0byBJREJTaGltIG9yIGJyb3dzZXIgZW52LlxuICAgIH0sIG9wdGlvbnMpO1xuICAgIHZhciBhZGRvbnMgPSBvcHRzLmFkZG9ucyxcbiAgICAgICAgYXV0b09wZW4gPSBvcHRzLmF1dG9PcGVuLFxuICAgICAgICBpbmRleGVkREIgPSBvcHRzLmluZGV4ZWREQixcbiAgICAgICAgSURCS2V5UmFuZ2UgPSBvcHRzLklEQktleVJhbmdlO1xuXG4gICAgdmFyIGdsb2JhbFNjaGVtYSA9IHRoaXMuX2RiU2NoZW1hID0ge307XG4gICAgdmFyIHZlcnNpb25zID0gW107XG4gICAgdmFyIGRiU3RvcmVOYW1lcyA9IFtdO1xuICAgIHZhciBhbGxUYWJsZXMgPSB7fTtcbiAgICAvLy88dmFyIHR5cGU9XCJJREJEYXRhYmFzZVwiIC8+XG4gICAgdmFyIGlkYmRiID0gbnVsbDsgLy8gSW5zdGFuY2Ugb2YgSURCRGF0YWJhc2VcbiAgICB2YXIgZGJPcGVuRXJyb3IgPSBudWxsO1xuICAgIHZhciBpc0JlaW5nT3BlbmVkID0gZmFsc2U7XG4gICAgdmFyIG9wZW5Db21wbGV0ZSA9IGZhbHNlO1xuICAgIHZhciBSRUFET05MWSA9IFwicmVhZG9ubHlcIixcbiAgICAgICAgUkVBRFdSSVRFID0gXCJyZWFkd3JpdGVcIjtcbiAgICB2YXIgZGIgPSB0aGlzO1xuICAgIHZhciBkYlJlYWR5UmVzb2x2ZSxcbiAgICAgICAgZGJSZWFkeVByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICBkYlJlYWR5UmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgfSksXG4gICAgICAgIGNhbmNlbE9wZW4sXG4gICAgICAgIG9wZW5DYW5jZWxsZXIgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAoXywgcmVqZWN0KSB7XG4gICAgICAgIGNhbmNlbE9wZW4gPSByZWplY3Q7XG4gICAgfSk7XG4gICAgdmFyIGF1dG9TY2hlbWEgPSB0cnVlO1xuICAgIHZhciBoYXNOYXRpdmVHZXREYXRhYmFzZU5hbWVzID0gISFnZXROYXRpdmVHZXREYXRhYmFzZU5hbWVzRm4oaW5kZXhlZERCKSxcbiAgICAgICAgaGFzR2V0QWxsO1xuXG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgLy8gRGVmYXVsdCBzdWJzY3JpYmVycyB0byBcInZlcnNpb25jaGFuZ2VcIiBhbmQgXCJibG9ja2VkXCIuXG4gICAgICAgIC8vIENhbiBiZSBvdmVycmlkZGVuIGJ5IGN1c3RvbSBoYW5kbGVycy4gSWYgY3VzdG9tIGhhbmRsZXJzIHJldHVybiBmYWxzZSwgdGhlc2UgZGVmYXVsdFxuICAgICAgICAvLyBiZWhhdmlvdXJzIHdpbGwgYmUgcHJldmVudGVkLlxuICAgICAgICBkYi5vbihcInZlcnNpb25jaGFuZ2VcIiwgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICAvLyBEZWZhdWx0IGJlaGF2aW9yIGZvciB2ZXJzaW9uY2hhbmdlIGV2ZW50IGlzIHRvIGNsb3NlIGRhdGFiYXNlIGNvbm5lY3Rpb24uXG4gICAgICAgICAgICAvLyBDYWxsZXIgY2FuIG92ZXJyaWRlIHRoaXMgYmVoYXZpb3IgYnkgZG9pbmcgZGIub24oXCJ2ZXJzaW9uY2hhbmdlXCIsIGZ1bmN0aW9uKCl7IHJldHVybiBmYWxzZTsgfSk7XG4gICAgICAgICAgICAvLyBMZXQncyBub3QgYmxvY2sgdGhlIG90aGVyIHdpbmRvdyBmcm9tIG1ha2luZyBpdCdzIGRlbGV0ZSgpIG9yIG9wZW4oKSBjYWxsLlxuICAgICAgICAgICAgLy8gTk9URSEgVGhpcyBldmVudCBpcyBuZXZlciBmaXJlZCBpbiBJRSxFZGdlIG9yIFNhZmFyaS5cbiAgICAgICAgICAgIGlmIChldi5uZXdWZXJzaW9uID4gMCkgY29uc29sZS53YXJuKCdBbm90aGVyIGNvbm5lY3Rpb24gd2FudHMgdG8gdXBncmFkZSBkYXRhYmFzZSBcXCcnICsgZGIubmFtZSArICdcXCcuIENsb3NpbmcgZGIgbm93IHRvIHJlc3VtZSB0aGUgdXBncmFkZS4nKTtlbHNlIGNvbnNvbGUud2FybignQW5vdGhlciBjb25uZWN0aW9uIHdhbnRzIHRvIGRlbGV0ZSBkYXRhYmFzZSBcXCcnICsgZGIubmFtZSArICdcXCcuIENsb3NpbmcgZGIgbm93IHRvIHJlc3VtZSB0aGUgZGVsZXRlIHJlcXVlc3QuJyk7XG4gICAgICAgICAgICBkYi5jbG9zZSgpO1xuICAgICAgICAgICAgLy8gSW4gbWFueSB3ZWIgYXBwbGljYXRpb25zLCBpdCB3b3VsZCBiZSByZWNvbW1lbmRlZCB0byBmb3JjZSB3aW5kb3cucmVsb2FkKClcbiAgICAgICAgICAgIC8vIHdoZW4gdGhpcyBldmVudCBvY2N1cnMuIFRvIGRvIHRoYXQsIHN1YnNjcmliZSB0byB0aGUgdmVyc2lvbmNoYW5nZSBldmVudFxuICAgICAgICAgICAgLy8gYW5kIGNhbGwgd2luZG93LmxvY2F0aW9uLnJlbG9hZCh0cnVlKSBpZiBldi5uZXdWZXJzaW9uID4gMCAobm90IGEgZGVsZXRpb24pXG4gICAgICAgICAgICAvLyBUaGUgcmVhc29uIGZvciB0aGlzIGlzIHRoYXQgeW91ciBjdXJyZW50IHdlYiBhcHAgb2J2aW91c2x5IGhhcyBvbGQgc2NoZW1hIGNvZGUgdGhhdCBuZWVkc1xuICAgICAgICAgICAgLy8gdG8gYmUgdXBkYXRlZC4gQW5vdGhlciB3aW5kb3cgZ290IGEgbmV3ZXIgdmVyc2lvbiBvZiB0aGUgYXBwIGFuZCBuZWVkcyB0byB1cGdyYWRlIERCIGJ1dFxuICAgICAgICAgICAgLy8geW91ciB3aW5kb3cgaXMgYmxvY2tpbmcgaXQgdW5sZXNzIHdlIGNsb3NlIGl0IGhlcmUuXG4gICAgICAgIH0pO1xuICAgICAgICBkYi5vbihcImJsb2NrZWRcIiwgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICBpZiAoIWV2Lm5ld1ZlcnNpb24gfHwgZXYubmV3VmVyc2lvbiA8IGV2Lm9sZFZlcnNpb24pIGNvbnNvbGUud2FybignRGV4aWUuZGVsZXRlKFxcJycgKyBkYi5uYW1lICsgJ1xcJykgd2FzIGJsb2NrZWQnKTtlbHNlIGNvbnNvbGUud2FybignVXBncmFkZSBcXCcnICsgZGIubmFtZSArICdcXCcgYmxvY2tlZCBieSBvdGhlciBjb25uZWN0aW9uIGhvbGRpbmcgdmVyc2lvbiAnICsgZXYub2xkVmVyc2lvbiAvIDEwKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy9cbiAgICAvL1xuICAgIC8vXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBWZXJzaW9uaW5nIEZyYW1ld29yay0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy9cbiAgICAvL1xuXG4gICAgdGhpcy52ZXJzaW9uID0gZnVuY3Rpb24gKHZlcnNpb25OdW1iZXIpIHtcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwidmVyc2lvbk51bWJlclwiIHR5cGU9XCJOdW1iZXJcIj48L3BhcmFtPlxuICAgICAgICAvLy8gPHJldHVybnMgdHlwZT1cIlZlcnNpb25cIj48L3JldHVybnM+XG4gICAgICAgIGlmIChpZGJkYiB8fCBpc0JlaW5nT3BlbmVkKSB0aHJvdyBuZXcgZXhjZXB0aW9ucy5TY2hlbWEoXCJDYW5ub3QgYWRkIHZlcnNpb24gd2hlbiBkYXRhYmFzZSBpcyBvcGVuXCIpO1xuICAgICAgICB0aGlzLnZlcm5vID0gTWF0aC5tYXgodGhpcy52ZXJubywgdmVyc2lvbk51bWJlcik7XG4gICAgICAgIHZhciB2ZXJzaW9uSW5zdGFuY2UgPSB2ZXJzaW9ucy5maWx0ZXIoZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIHJldHVybiB2Ll9jZmcudmVyc2lvbiA9PT0gdmVyc2lvbk51bWJlcjtcbiAgICAgICAgfSlbMF07XG4gICAgICAgIGlmICh2ZXJzaW9uSW5zdGFuY2UpIHJldHVybiB2ZXJzaW9uSW5zdGFuY2U7XG4gICAgICAgIHZlcnNpb25JbnN0YW5jZSA9IG5ldyBWZXJzaW9uKHZlcnNpb25OdW1iZXIpO1xuICAgICAgICB2ZXJzaW9ucy5wdXNoKHZlcnNpb25JbnN0YW5jZSk7XG4gICAgICAgIHZlcnNpb25zLnNvcnQobG93ZXJWZXJzaW9uRmlyc3QpO1xuICAgICAgICByZXR1cm4gdmVyc2lvbkluc3RhbmNlO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBWZXJzaW9uKHZlcnNpb25OdW1iZXIpIHtcbiAgICAgICAgdGhpcy5fY2ZnID0ge1xuICAgICAgICAgICAgdmVyc2lvbjogdmVyc2lvbk51bWJlcixcbiAgICAgICAgICAgIHN0b3Jlc1NvdXJjZTogbnVsbCxcbiAgICAgICAgICAgIGRic2NoZW1hOiB7fSxcbiAgICAgICAgICAgIHRhYmxlczoge30sXG4gICAgICAgICAgICBjb250ZW50VXBncmFkZTogbnVsbFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnN0b3Jlcyh7fSk7IC8vIERlcml2ZSBlYXJsaWVyIHNjaGVtYXMgYnkgZGVmYXVsdC5cbiAgICB9XG5cbiAgICBleHRlbmQoVmVyc2lvbi5wcm90b3R5cGUsIHtcbiAgICAgICAgc3RvcmVzOiBmdW5jdGlvbiAoc3RvcmVzKSB7XG4gICAgICAgICAgICAvLy8gPHN1bW1hcnk+XG4gICAgICAgICAgICAvLy8gICBEZWZpbmVzIHRoZSBzY2hlbWEgZm9yIGEgcGFydGljdWxhciB2ZXJzaW9uXG4gICAgICAgICAgICAvLy8gPC9zdW1tYXJ5PlxuICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwic3RvcmVzXCIgdHlwZT1cIk9iamVjdFwiPlxuICAgICAgICAgICAgLy8vIEV4YW1wbGU6IDxici8+XG4gICAgICAgICAgICAvLy8gICB7dXNlcnM6IFwiaWQrKyxmaXJzdCxsYXN0LCZhbXA7dXNlcm5hbWUsKmVtYWlsXCIsIDxici8+XG4gICAgICAgICAgICAvLy8gICBwYXNzd29yZHM6IFwiaWQrKywmYW1wO3VzZXJuYW1lXCJ9PGJyLz5cbiAgICAgICAgICAgIC8vLyA8YnIvPlxuICAgICAgICAgICAgLy8vIFN5bnRheDoge1RhYmxlOiBcIltwcmltYXJ5S2V5XVsrK10sWyZhbXA7XVsqXWluZGV4MSxbJmFtcDtdWypdaW5kZXgyLC4uLlwifTxici8+PGJyLz5cbiAgICAgICAgICAgIC8vLyBTcGVjaWFsIGNoYXJhY3RlcnM6PGJyLz5cbiAgICAgICAgICAgIC8vLyAgXCImYW1wO1wiICBtZWFucyB1bmlxdWUga2V5LCA8YnIvPlxuICAgICAgICAgICAgLy8vICBcIipcIiAgbWVhbnMgdmFsdWUgaXMgbXVsdGlFbnRyeSwgPGJyLz5cbiAgICAgICAgICAgIC8vLyAgXCIrK1wiIG1lYW5zIGF1dG8taW5jcmVtZW50IGFuZCBvbmx5IGFwcGxpY2FibGUgZm9yIHByaW1hcnkga2V5IDxici8+XG4gICAgICAgICAgICAvLy8gPC9wYXJhbT5cbiAgICAgICAgICAgIHRoaXMuX2NmZy5zdG9yZXNTb3VyY2UgPSB0aGlzLl9jZmcuc3RvcmVzU291cmNlID8gZXh0ZW5kKHRoaXMuX2NmZy5zdG9yZXNTb3VyY2UsIHN0b3JlcykgOiBzdG9yZXM7XG5cbiAgICAgICAgICAgIC8vIERlcml2ZSBzdG9yZXMgZnJvbSBlYXJsaWVyIHZlcnNpb25zIGlmIHRoZXkgYXJlIG5vdCBleHBsaWNpdGVseSBzcGVjaWZpZWQgYXMgbnVsbCBvciBhIG5ldyBzeW50YXguXG4gICAgICAgICAgICB2YXIgc3RvcmVzU3BlYyA9IHt9O1xuICAgICAgICAgICAgdmVyc2lvbnMuZm9yRWFjaChmdW5jdGlvbiAodmVyc2lvbikge1xuICAgICAgICAgICAgICAgIC8vICd2ZXJzaW9ucycgaXMgYWx3YXlzIHNvcnRlZCBieSBsb3dlc3QgdmVyc2lvbiBmaXJzdC5cbiAgICAgICAgICAgICAgICBleHRlbmQoc3RvcmVzU3BlYywgdmVyc2lvbi5fY2ZnLnN0b3Jlc1NvdXJjZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdmFyIGRic2NoZW1hID0gdGhpcy5fY2ZnLmRic2NoZW1hID0ge307XG4gICAgICAgICAgICB0aGlzLl9wYXJzZVN0b3Jlc1NwZWMoc3RvcmVzU3BlYywgZGJzY2hlbWEpO1xuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBsYXRlc3Qgc2NoZW1hIHRvIHRoaXMgdmVyc2lvblxuICAgICAgICAgICAgLy8gVXBkYXRlIEFQSVxuICAgICAgICAgICAgZ2xvYmFsU2NoZW1hID0gZGIuX2RiU2NoZW1hID0gZGJzY2hlbWE7XG4gICAgICAgICAgICByZW1vdmVUYWJsZXNBcGkoW2FsbFRhYmxlcywgZGIsIFRyYW5zYWN0aW9uLnByb3RvdHlwZV0pO1xuICAgICAgICAgICAgc2V0QXBpT25QbGFjZShbYWxsVGFibGVzLCBkYiwgVHJhbnNhY3Rpb24ucHJvdG90eXBlLCB0aGlzLl9jZmcudGFibGVzXSwga2V5cyhkYnNjaGVtYSksIFJFQURXUklURSwgZGJzY2hlbWEpO1xuICAgICAgICAgICAgZGJTdG9yZU5hbWVzID0ga2V5cyhkYnNjaGVtYSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgdXBncmFkZTogZnVuY3Rpb24gKHVwZ3JhZGVGdW5jdGlvbikge1xuICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwidXBncmFkZUZ1bmN0aW9uXCIgb3B0aW9uYWw9XCJ0cnVlXCI+RnVuY3Rpb24gdGhhdCBwZXJmb3JtcyB1cGdyYWRpbmcgYWN0aW9ucy48L3BhcmFtPlxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgZmFrZUF1dG9Db21wbGV0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdXBncmFkZUZ1bmN0aW9uKGRiLl9jcmVhdGVUcmFuc2FjdGlvbihSRUFEV1JJVEUsIGtleXMoc2VsZi5fY2ZnLmRic2NoZW1hKSwgc2VsZi5fY2ZnLmRic2NoZW1hKSk7IC8vIEJVR0JVRzogTm8gY29kZSBjb21wbGV0aW9uIGZvciBwcmV2IHZlcnNpb24ncyB0YWJsZXMgd29udCBhcHBlYXIuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX2NmZy5jb250ZW50VXBncmFkZSA9IHVwZ3JhZGVGdW5jdGlvbjtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBfcGFyc2VTdG9yZXNTcGVjOiBmdW5jdGlvbiAoc3RvcmVzLCBvdXRTY2hlbWEpIHtcbiAgICAgICAgICAgIGtleXMoc3RvcmVzKS5mb3JFYWNoKGZ1bmN0aW9uICh0YWJsZU5hbWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RvcmVzW3RhYmxlTmFtZV0gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlVGVtcGxhdGUgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ZXMgPSBwYXJzZUluZGV4U3ludGF4KHN0b3Jlc1t0YWJsZU5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByaW1LZXkgPSBpbmRleGVzLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmltS2V5Lm11bHRpKSB0aHJvdyBuZXcgZXhjZXB0aW9ucy5TY2hlbWEoXCJQcmltYXJ5IGtleSBjYW5ub3QgYmUgbXVsdGktdmFsdWVkXCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJpbUtleS5rZXlQYXRoKSBzZXRCeUtleVBhdGgoaW5zdGFuY2VUZW1wbGF0ZSwgcHJpbUtleS5rZXlQYXRoLCBwcmltS2V5LmF1dG8gPyAwIDogcHJpbUtleS5rZXlQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXhlcy5mb3JFYWNoKGZ1bmN0aW9uIChpZHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHguYXV0bykgdGhyb3cgbmV3IGV4Y2VwdGlvbnMuU2NoZW1hKFwiT25seSBwcmltYXJ5IGtleSBjYW4gYmUgbWFya2VkIGFzIGF1dG9JbmNyZW1lbnQgKCsrKVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaWR4LmtleVBhdGgpIHRocm93IG5ldyBleGNlcHRpb25zLlNjaGVtYShcIkluZGV4IG11c3QgaGF2ZSBhIG5hbWUgYW5kIGNhbm5vdCBiZSBhbiBlbXB0eSBzdHJpbmdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRCeUtleVBhdGgoaW5zdGFuY2VUZW1wbGF0ZSwgaWR4LmtleVBhdGgsIGlkeC5jb21wb3VuZCA/IGlkeC5rZXlQYXRoLm1hcChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSA6IFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgb3V0U2NoZW1hW3RhYmxlTmFtZV0gPSBuZXcgVGFibGVTY2hlbWEodGFibGVOYW1lLCBwcmltS2V5LCBpbmRleGVzLCBpbnN0YW5jZVRlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gcnVuVXBncmFkZXJzKG9sZFZlcnNpb24sIGlkYnRyYW5zLCByZWplY3QpIHtcbiAgICAgICAgdmFyIHRyYW5zID0gZGIuX2NyZWF0ZVRyYW5zYWN0aW9uKFJFQURXUklURSwgZGJTdG9yZU5hbWVzLCBnbG9iYWxTY2hlbWEpO1xuICAgICAgICB0cmFucy5jcmVhdGUoaWRidHJhbnMpO1xuICAgICAgICB0cmFucy5fY29tcGxldGlvbi5jYXRjaChyZWplY3QpO1xuICAgICAgICB2YXIgcmVqZWN0VHJhbnNhY3Rpb24gPSB0cmFucy5fcmVqZWN0LmJpbmQodHJhbnMpO1xuICAgICAgICBuZXdTY29wZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBQU0QudHJhbnMgPSB0cmFucztcbiAgICAgICAgICAgIGlmIChvbGRWZXJzaW9uID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRhYmxlczpcbiAgICAgICAgICAgICAgICBrZXlzKGdsb2JhbFNjaGVtYSkuZm9yRWFjaChmdW5jdGlvbiAodGFibGVOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZVRhYmxlKGlkYnRyYW5zLCB0YWJsZU5hbWUsIGdsb2JhbFNjaGVtYVt0YWJsZU5hbWVdLnByaW1LZXksIGdsb2JhbFNjaGVtYVt0YWJsZU5hbWVdLmluZGV4ZXMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFByb21pc2UuZm9sbG93KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRiLm9uLnBvcHVsYXRlLmZpcmUodHJhbnMpO1xuICAgICAgICAgICAgICAgIH0pLmNhdGNoKHJlamVjdFRyYW5zYWN0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSB1cGRhdGVUYWJsZXNBbmRJbmRleGVzKG9sZFZlcnNpb24sIHRyYW5zLCBpZGJ0cmFucykuY2F0Y2gocmVqZWN0VHJhbnNhY3Rpb24pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVUYWJsZXNBbmRJbmRleGVzKG9sZFZlcnNpb24sIHRyYW5zLCBpZGJ0cmFucykge1xuICAgICAgICAvLyBVcGdyYWRlIHZlcnNpb24gdG8gdmVyc2lvbiwgc3RlcC1ieS1zdGVwIGZyb20gb2xkZXN0IHRvIG5ld2VzdCB2ZXJzaW9uLlxuICAgICAgICAvLyBFYWNoIHRyYW5zYWN0aW9uIG9iamVjdCB3aWxsIGNvbnRhaW4gdGhlIHRhYmxlIHNldCB0aGF0IHdhcyBjdXJyZW50IGluIHRoYXQgdmVyc2lvbiAoYnV0IGFsc28gbm90LXlldC1kZWxldGVkIHRhYmxlcyBmcm9tIGl0cyBwcmV2aW91cyB2ZXJzaW9uKVxuICAgICAgICB2YXIgcXVldWUgPSBbXTtcbiAgICAgICAgdmFyIG9sZFZlcnNpb25TdHJ1Y3QgPSB2ZXJzaW9ucy5maWx0ZXIoZnVuY3Rpb24gKHZlcnNpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB2ZXJzaW9uLl9jZmcudmVyc2lvbiA9PT0gb2xkVmVyc2lvbjtcbiAgICAgICAgfSlbMF07XG4gICAgICAgIGlmICghb2xkVmVyc2lvblN0cnVjdCkgdGhyb3cgbmV3IGV4Y2VwdGlvbnMuVXBncmFkZShcIkRleGllIHNwZWNpZmljYXRpb24gb2YgY3VycmVudGx5IGluc3RhbGxlZCBEQiB2ZXJzaW9uIGlzIG1pc3NpbmdcIik7XG4gICAgICAgIGdsb2JhbFNjaGVtYSA9IGRiLl9kYlNjaGVtYSA9IG9sZFZlcnNpb25TdHJ1Y3QuX2NmZy5kYnNjaGVtYTtcbiAgICAgICAgdmFyIGFueUNvbnRlbnRVcGdyYWRlckhhc1J1biA9IGZhbHNlO1xuXG4gICAgICAgIHZhciB2ZXJzVG9SdW4gPSB2ZXJzaW9ucy5maWx0ZXIoZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIHJldHVybiB2Ll9jZmcudmVyc2lvbiA+IG9sZFZlcnNpb247XG4gICAgICAgIH0pO1xuICAgICAgICB2ZXJzVG9SdW4uZm9yRWFjaChmdW5jdGlvbiAodmVyc2lvbikge1xuICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwidmVyc2lvblwiIHR5cGU9XCJWZXJzaW9uXCI+PC9wYXJhbT5cbiAgICAgICAgICAgIHF1ZXVlLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBvbGRTY2hlbWEgPSBnbG9iYWxTY2hlbWE7XG4gICAgICAgICAgICAgICAgdmFyIG5ld1NjaGVtYSA9IHZlcnNpb24uX2NmZy5kYnNjaGVtYTtcbiAgICAgICAgICAgICAgICBhZGp1c3RUb0V4aXN0aW5nSW5kZXhOYW1lcyhvbGRTY2hlbWEsIGlkYnRyYW5zKTtcbiAgICAgICAgICAgICAgICBhZGp1c3RUb0V4aXN0aW5nSW5kZXhOYW1lcyhuZXdTY2hlbWEsIGlkYnRyYW5zKTtcbiAgICAgICAgICAgICAgICBnbG9iYWxTY2hlbWEgPSBkYi5fZGJTY2hlbWEgPSBuZXdTY2hlbWE7XG4gICAgICAgICAgICAgICAgdmFyIGRpZmYgPSBnZXRTY2hlbWFEaWZmKG9sZFNjaGVtYSwgbmV3U2NoZW1hKTtcbiAgICAgICAgICAgICAgICAvLyBBZGQgdGFibGVzICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBkaWZmLmFkZC5mb3JFYWNoKGZ1bmN0aW9uICh0dXBsZSkge1xuICAgICAgICAgICAgICAgICAgICBjcmVhdGVUYWJsZShpZGJ0cmFucywgdHVwbGVbMF0sIHR1cGxlWzFdLnByaW1LZXksIHR1cGxlWzFdLmluZGV4ZXMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIENoYW5nZSB0YWJsZXNcbiAgICAgICAgICAgICAgICBkaWZmLmNoYW5nZS5mb3JFYWNoKGZ1bmN0aW9uIChjaGFuZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZS5yZWNyZWF0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IGV4Y2VwdGlvbnMuVXBncmFkZShcIk5vdCB5ZXQgc3VwcG9ydCBmb3IgY2hhbmdpbmcgcHJpbWFyeSBrZXlcIik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RvcmUgPSBpZGJ0cmFucy5vYmplY3RTdG9yZShjaGFuZ2UubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgaW5kZXhlc1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlLmFkZC5mb3JFYWNoKGZ1bmN0aW9uIChpZHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRJbmRleChzdG9yZSwgaWR4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIGluZGV4ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZS5jaGFuZ2UuZm9yRWFjaChmdW5jdGlvbiAoaWR4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmUuZGVsZXRlSW5kZXgoaWR4Lm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEluZGV4KHN0b3JlLCBpZHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgaW5kZXhlc1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlLmRlbC5mb3JFYWNoKGZ1bmN0aW9uIChpZHhOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmUuZGVsZXRlSW5kZXgoaWR4TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmICh2ZXJzaW9uLl9jZmcuY29udGVudFVwZ3JhZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgYW55Q29udGVudFVwZ3JhZGVySGFzUnVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuZm9sbG93KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24uX2NmZy5jb250ZW50VXBncmFkZSh0cmFucyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcXVldWUucHVzaChmdW5jdGlvbiAoaWRidHJhbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWFueUNvbnRlbnRVcGdyYWRlckhhc1J1biB8fCAhaGFzSUVEZWxldGVPYmplY3RTdG9yZUJ1Zykge1xuICAgICAgICAgICAgICAgICAgICAvLyBEb250IGRlbGV0ZSBvbGQgdGFibGVzIGlmIGllQnVnIGlzIHByZXNlbnQgYW5kIGEgY29udGVudCB1cGdyYWRlciBoYXMgcnVuLiBMZXQgdGFibGVzIGJlIGxlZnQgaW4gREIgc28gZmFyLiBUaGlzIG5lZWRzIHRvIGJlIHRha2VuIGNhcmUgb2YuXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdTY2hlbWEgPSB2ZXJzaW9uLl9jZmcuZGJzY2hlbWE7XG4gICAgICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBvbGQgdGFibGVzXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZVJlbW92ZWRUYWJsZXMobmV3U2NoZW1hLCBpZGJ0cmFucyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIE5vdywgY3JlYXRlIGEgcXVldWUgZXhlY3V0aW9uIGVuZ2luZVxuICAgICAgICBmdW5jdGlvbiBydW5RdWV1ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBxdWV1ZS5sZW5ndGggPyBQcm9taXNlLnJlc29sdmUocXVldWUuc2hpZnQoKSh0cmFucy5pZGJ0cmFucykpLnRoZW4ocnVuUXVldWUpIDogUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcnVuUXVldWUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNyZWF0ZU1pc3NpbmdUYWJsZXMoZ2xvYmFsU2NoZW1hLCBpZGJ0cmFucyk7IC8vIEF0IGxhc3QsIG1ha2Ugc3VyZSB0byBjcmVhdGUgYW55IG1pc3NpbmcgdGFibGVzLiAoTmVlZGVkIGJ5IGFkZG9ucyB0aGF0IGFkZCBzdG9yZXMgdG8gREIgd2l0aG91dCBzcGVjaWZ5aW5nIHZlcnNpb24pXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFNjaGVtYURpZmYob2xkU2NoZW1hLCBuZXdTY2hlbWEpIHtcbiAgICAgICAgdmFyIGRpZmYgPSB7XG4gICAgICAgICAgICBkZWw6IFtdLCAvLyBBcnJheSBvZiB0YWJsZSBuYW1lc1xuICAgICAgICAgICAgYWRkOiBbXSwgLy8gQXJyYXkgb2YgW3RhYmxlTmFtZSwgbmV3RGVmaW5pdGlvbl1cbiAgICAgICAgICAgIGNoYW5nZTogW10gLy8gQXJyYXkgb2Yge25hbWU6IHRhYmxlTmFtZSwgcmVjcmVhdGU6IG5ld0RlZmluaXRpb24sIGRlbDogZGVsSW5kZXhOYW1lcywgYWRkOiBuZXdJbmRleERlZnMsIGNoYW5nZTogY2hhbmdlZEluZGV4RGVmc31cbiAgICAgICAgfTtcbiAgICAgICAgZm9yICh2YXIgdGFibGUgaW4gb2xkU2NoZW1hKSB7XG4gICAgICAgICAgICBpZiAoIW5ld1NjaGVtYVt0YWJsZV0pIGRpZmYuZGVsLnB1c2godGFibGUpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodGFibGUgaW4gbmV3U2NoZW1hKSB7XG4gICAgICAgICAgICB2YXIgb2xkRGVmID0gb2xkU2NoZW1hW3RhYmxlXSxcbiAgICAgICAgICAgICAgICBuZXdEZWYgPSBuZXdTY2hlbWFbdGFibGVdO1xuICAgICAgICAgICAgaWYgKCFvbGREZWYpIHtcbiAgICAgICAgICAgICAgICBkaWZmLmFkZC5wdXNoKFt0YWJsZSwgbmV3RGVmXSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBjaGFuZ2UgPSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IHRhYmxlLFxuICAgICAgICAgICAgICAgICAgICBkZWY6IG5ld0RlZixcbiAgICAgICAgICAgICAgICAgICAgcmVjcmVhdGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBkZWw6IFtdLFxuICAgICAgICAgICAgICAgICAgICBhZGQ6IFtdLFxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2U6IFtdXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAob2xkRGVmLnByaW1LZXkuc3JjICE9PSBuZXdEZWYucHJpbUtleS5zcmMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUHJpbWFyeSBrZXkgaGFzIGNoYW5nZWQuIFJlbW92ZSBhbmQgcmUtYWRkIHRhYmxlLlxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2UucmVjcmVhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBkaWZmLmNoYW5nZS5wdXNoKGNoYW5nZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2FtZSBwcmltYXJ5IGtleS4gSnVzdCBmaW5kIG91dCB3aGF0IGRpZmZlcnM6XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRJbmRleGVzID0gb2xkRGVmLmlkeEJ5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0luZGV4ZXMgPSBuZXdEZWYuaWR4QnlOYW1lO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpZHhOYW1lIGluIG9sZEluZGV4ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbmV3SW5kZXhlc1tpZHhOYW1lXSkgY2hhbmdlLmRlbC5wdXNoKGlkeE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaWR4TmFtZSBpbiBuZXdJbmRleGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2xkSWR4ID0gb2xkSW5kZXhlc1tpZHhOYW1lXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdJZHggPSBuZXdJbmRleGVzW2lkeE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvbGRJZHgpIGNoYW5nZS5hZGQucHVzaChuZXdJZHgpO2Vsc2UgaWYgKG9sZElkeC5zcmMgIT09IG5ld0lkeC5zcmMpIGNoYW5nZS5jaGFuZ2UucHVzaChuZXdJZHgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFuZ2UuZGVsLmxlbmd0aCA+IDAgfHwgY2hhbmdlLmFkZC5sZW5ndGggPiAwIHx8IGNoYW5nZS5jaGFuZ2UubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlmZi5jaGFuZ2UucHVzaChjaGFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkaWZmO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVRhYmxlKGlkYnRyYW5zLCB0YWJsZU5hbWUsIHByaW1LZXksIGluZGV4ZXMpIHtcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwiaWRidHJhbnNcIiB0eXBlPVwiSURCVHJhbnNhY3Rpb25cIj48L3BhcmFtPlxuICAgICAgICB2YXIgc3RvcmUgPSBpZGJ0cmFucy5kYi5jcmVhdGVPYmplY3RTdG9yZSh0YWJsZU5hbWUsIHByaW1LZXkua2V5UGF0aCA/IHsga2V5UGF0aDogcHJpbUtleS5rZXlQYXRoLCBhdXRvSW5jcmVtZW50OiBwcmltS2V5LmF1dG8gfSA6IHsgYXV0b0luY3JlbWVudDogcHJpbUtleS5hdXRvIH0pO1xuICAgICAgICBpbmRleGVzLmZvckVhY2goZnVuY3Rpb24gKGlkeCkge1xuICAgICAgICAgICAgYWRkSW5kZXgoc3RvcmUsIGlkeCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gc3RvcmU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlTWlzc2luZ1RhYmxlcyhuZXdTY2hlbWEsIGlkYnRyYW5zKSB7XG4gICAgICAgIGtleXMobmV3U2NoZW1hKS5mb3JFYWNoKGZ1bmN0aW9uICh0YWJsZU5hbWUpIHtcbiAgICAgICAgICAgIGlmICghaWRidHJhbnMuZGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyh0YWJsZU5hbWUpKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlVGFibGUoaWRidHJhbnMsIHRhYmxlTmFtZSwgbmV3U2NoZW1hW3RhYmxlTmFtZV0ucHJpbUtleSwgbmV3U2NoZW1hW3RhYmxlTmFtZV0uaW5kZXhlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlbGV0ZVJlbW92ZWRUYWJsZXMobmV3U2NoZW1hLCBpZGJ0cmFucykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlkYnRyYW5zLmRiLm9iamVjdFN0b3JlTmFtZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBzdG9yZU5hbWUgPSBpZGJ0cmFucy5kYi5vYmplY3RTdG9yZU5hbWVzW2ldO1xuICAgICAgICAgICAgaWYgKG5ld1NjaGVtYVtzdG9yZU5hbWVdID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZGJ0cmFucy5kYi5kZWxldGVPYmplY3RTdG9yZShzdG9yZU5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkSW5kZXgoc3RvcmUsIGlkeCkge1xuICAgICAgICBzdG9yZS5jcmVhdGVJbmRleChpZHgubmFtZSwgaWR4LmtleVBhdGgsIHsgdW5pcXVlOiBpZHgudW5pcXVlLCBtdWx0aUVudHJ5OiBpZHgubXVsdGkgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGJVbmNhdWdodChlcnIpIHtcbiAgICAgICAgcmV0dXJuIGRiLm9uLmVycm9yLmZpcmUoZXJyKTtcbiAgICB9XG5cbiAgICAvL1xuICAgIC8vXG4gICAgLy8gICAgICBEZXhpZSBQcm90ZWN0ZWQgQVBJXG4gICAgLy9cbiAgICAvL1xuXG4gICAgdGhpcy5fYWxsVGFibGVzID0gYWxsVGFibGVzO1xuXG4gICAgdGhpcy5fdGFibGVGYWN0b3J5ID0gZnVuY3Rpb24gY3JlYXRlVGFibGUobW9kZSwgdGFibGVTY2hlbWEpIHtcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwidGFibGVTY2hlbWFcIiB0eXBlPVwiVGFibGVTY2hlbWFcIj48L3BhcmFtPlxuICAgICAgICBpZiAobW9kZSA9PT0gUkVBRE9OTFkpIHJldHVybiBuZXcgVGFibGUodGFibGVTY2hlbWEubmFtZSwgdGFibGVTY2hlbWEsIENvbGxlY3Rpb24pO2Vsc2UgcmV0dXJuIG5ldyBXcml0ZWFibGVUYWJsZSh0YWJsZVNjaGVtYS5uYW1lLCB0YWJsZVNjaGVtYSk7XG4gICAgfTtcblxuICAgIHRoaXMuX2NyZWF0ZVRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKG1vZGUsIHN0b3JlTmFtZXMsIGRic2NoZW1hLCBwYXJlbnRUcmFuc2FjdGlvbikge1xuICAgICAgICByZXR1cm4gbmV3IFRyYW5zYWN0aW9uKG1vZGUsIHN0b3JlTmFtZXMsIGRic2NoZW1hLCBwYXJlbnRUcmFuc2FjdGlvbik7XG4gICAgfTtcblxuICAgIC8qIEdlbmVyYXRlIGEgdGVtcG9yYXJ5IHRyYW5zYWN0aW9uIHdoZW4gZGIgb3BlcmF0aW9ucyBhcmUgZG9uZSBvdXRzaWRlIGEgdHJhbnNhY3Rpbm8gc2NvcGUuXHJcbiAgICAqL1xuICAgIGZ1bmN0aW9uIHRlbXBUcmFuc2FjdGlvbihtb2RlLCBzdG9yZU5hbWVzLCBmbikge1xuICAgICAgICAvLyBMYXN0IGFyZ3VtZW50IGlzIFwid3JpdGVMb2NrZWRcIi4gQnV0IHRoaXMgZG9lc250IGFwcGx5IHRvIG9uZXNob3QgZGlyZWN0IGRiIG9wZXJhdGlvbnMsIHNvIHdlIGlnbm9yZSBpdC5cbiAgICAgICAgaWYgKCFvcGVuQ29tcGxldGUgJiYgIVBTRC5sZXRUaHJvdWdoKSB7XG4gICAgICAgICAgICBpZiAoIWlzQmVpbmdPcGVuZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWF1dG9PcGVuKSByZXR1cm4gcmVqZWN0aW9uKG5ldyBleGNlcHRpb25zLkRhdGFiYXNlQ2xvc2VkKCksIGRiVW5jYXVnaHQpO1xuICAgICAgICAgICAgICAgIGRiLm9wZW4oKS5jYXRjaChub3ApOyAvLyBPcGVuIGluIGJhY2tncm91bmQuIElmIGlmIGZhaWxzLCBpdCB3aWxsIGJlIGNhdGNoZWQgYnkgdGhlIGZpbmFsIHByb21pc2UgYW55d2F5LlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGRiUmVhZHlQcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0ZW1wVHJhbnNhY3Rpb24obW9kZSwgc3RvcmVOYW1lcywgZm4pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgdHJhbnMgPSBkYi5fY3JlYXRlVHJhbnNhY3Rpb24obW9kZSwgc3RvcmVOYW1lcywgZ2xvYmFsU2NoZW1hKTtcbiAgICAgICAgICAgIHJldHVybiB0cmFucy5fcHJvbWlzZShtb2RlLCBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgbmV3U2NvcGUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBPUFRJTUlaQVRJT04gUE9TU0lCTEU/IG5ld1Njb3BlKCkgbm90IG5lZWRlZCBiZWNhdXNlIGl0J3MgYWxyZWFkeSBkb25lIGluIF9wcm9taXNlLlxuICAgICAgICAgICAgICAgICAgICBQU0QudHJhbnMgPSB0cmFucztcbiAgICAgICAgICAgICAgICAgICAgZm4ocmVzb2x2ZSwgcmVqZWN0LCB0cmFucyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnN0ZWFkIG9mIHJlc29sdmluZyB2YWx1ZSBkaXJlY3RseSwgd2FpdCB3aXRoIHJlc29sdmluZyBpdCB1bnRpbCB0cmFuc2FjdGlvbiBoYXMgY29tcGxldGVkLlxuICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSB0aGUgZGF0YSB3b3VsZCBub3QgYmUgaW4gdGhlIERCIGlmIHJlcXVlc3RpbmcgaXQgaW4gdGhlIHRoZW4oKSBvcGVyYXRpb24uXG4gICAgICAgICAgICAgICAgLy8gU3BlY2lmaWNhbGx5LCB0byBlbnN1cmUgdGhhdCB0aGUgZm9sbG93aW5nIGV4cHJlc3Npb24gd2lsbCB3b3JrOlxuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgLy8gICBkYi5mcmllbmRzLnB1dCh7bmFtZTogXCJBcm5lXCJ9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICBkYi5mcmllbmRzLndoZXJlKFwibmFtZVwiKS5lcXVhbHMoXCJBcm5lXCIpLmNvdW50KGZ1bmN0aW9uKGNvdW50KSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgIGFzc2VydCAoY291bnQgPT09IDEpO1xuICAgICAgICAgICAgICAgIC8vICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vICAgfSk7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnMuX2NvbXBsZXRpb24udGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTsgLyouY2F0Y2goZXJyID0+IHsgLy8gRG9uJ3QgZG8gdGhpcyBhcyBvZiBub3cuIElmIHdvdWxkIGFmZmVjdCBidWxrLSBhbmQgbW9kaWZ5IG1ldGhvZHMgaW4gYSB3YXkgdGhhdCBjb3VsZCBiZSBtb3JlIGludHVpdGl2ZS4gQnV0IHdhaXQhIE1heWJlIGNoYW5nZSBpbiBuZXh0IG1ham9yLlxyXG4gICAgICAgICAgICAgICAgIHRyYW5zLl9yZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0aW9uKGVycik7XHJcbiAgICAgICAgICAgICAgICB9KTsqL1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5fd2hlblJlYWR5ID0gZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmYWtlIHx8IG9wZW5Db21wbGV0ZSB8fCBQU0QubGV0VGhyb3VnaCA/IGZuIDogZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgaWYgKCFpc0JlaW5nT3BlbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhdXRvT3Blbikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IGV4Y2VwdGlvbnMuRGF0YWJhc2VDbG9zZWQoKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGIub3BlbigpLmNhdGNoKG5vcCk7IC8vIE9wZW4gaW4gYmFja2dyb3VuZC4gSWYgaWYgZmFpbHMsIGl0IHdpbGwgYmUgY2F0Y2hlZCBieSB0aGUgZmluYWwgcHJvbWlzZSBhbnl3YXkuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYlJlYWR5UHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmbihyZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pLnVuY2F1Z2h0KGRiVW5jYXVnaHQpO1xuICAgIH07XG5cbiAgICAvL1xuICAgIC8vXG4gICAgLy9cbiAgICAvL1xuICAgIC8vICAgICAgRGV4aWUgQVBJXG4gICAgLy9cbiAgICAvL1xuICAgIC8vXG5cbiAgICB0aGlzLnZlcm5vID0gMDtcblxuICAgIHRoaXMub3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGlzQmVpbmdPcGVuZWQgfHwgaWRiZGIpIHJldHVybiBkYlJlYWR5UHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBkYk9wZW5FcnJvciA/IHJlamVjdGlvbihkYk9wZW5FcnJvciwgZGJVbmNhdWdodCkgOiBkYjtcbiAgICAgICAgfSk7XG4gICAgICAgIGRlYnVnICYmIChvcGVuQ2FuY2VsbGVyLl9zdGFja0hvbGRlciA9IGdldEVycm9yV2l0aFN0YWNrKCkpOyAvLyBMZXQgc3RhY2tzIHBvaW50IHRvIHdoZW4gb3BlbigpIHdhcyBjYWxsZWQgcmF0aGVyIHRoYW4gd2hlcmUgbmV3IERleGllKCkgd2FzIGNhbGxlZC5cbiAgICAgICAgaXNCZWluZ09wZW5lZCA9IHRydWU7XG4gICAgICAgIGRiT3BlbkVycm9yID0gbnVsbDtcbiAgICAgICAgb3BlbkNvbXBsZXRlID0gZmFsc2U7XG5cbiAgICAgICAgLy8gRnVuY3Rpb24gcG9pbnRlcnMgdG8gY2FsbCB3aGVuIHRoZSBjb3JlIG9wZW5pbmcgcHJvY2VzcyBjb21wbGV0ZXMuXG4gICAgICAgIHZhciByZXNvbHZlRGJSZWFkeSA9IGRiUmVhZHlSZXNvbHZlLFxuXG4gICAgICAgIC8vIHVwZ3JhZGVUcmFuc2FjdGlvbiB0byBhYm9ydCBvbiBmYWlsdXJlLlxuICAgICAgICB1cGdyYWRlVHJhbnNhY3Rpb24gPSBudWxsO1xuXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJhY2UoW29wZW5DYW5jZWxsZXIsIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGRvRmFrZUF1dG9Db21wbGV0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBNYWtlIHN1cmUgY2FsbGVyIGhhcyBzcGVjaWZpZWQgYXQgbGVhc3Qgb25lIHZlcnNpb25cbiAgICAgICAgICAgIGlmICh2ZXJzaW9ucy5sZW5ndGggPiAwKSBhdXRvU2NoZW1hID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8vIE11bHRpcGx5IGRiLnZlcm5vIHdpdGggMTAgd2lsbCBiZSBuZWVkZWQgdG8gd29ya2Fyb3VuZCB1cGdyYWRpbmcgYnVnIGluIElFOlxuICAgICAgICAgICAgLy8gSUUgZmFpbHMgd2hlbiBkZWxldGluZyBvYmplY3RTdG9yZSBhZnRlciByZWFkaW5nIGZyb20gaXQuXG4gICAgICAgICAgICAvLyBBIGZ1dHVyZSB2ZXJzaW9uIG9mIERleGllLmpzIHdpbGwgc3RvcG92ZXIgYW4gaW50ZXJtZWRpYXRlIHZlcnNpb24gdG8gd29ya2Fyb3VuZCB0aGlzLlxuICAgICAgICAgICAgLy8gQXQgdGhhdCBwb2ludCwgd2Ugd2FudCB0byBiZSBiYWNrd2FyZCBjb21wYXRpYmxlLiBDb3VsZCBoYXZlIGJlZW4gbXVsdGlwbGllZCB3aXRoIDIsIGJ1dCBieSB1c2luZyAxMCwgaXQgaXMgZWFzaWVyIHRvIG1hcCB0aGUgbnVtYmVyIHRvIHRoZSByZWFsIHZlcnNpb24gbnVtYmVyLlxuXG4gICAgICAgICAgICAvLyBJZiBubyBBUEksIHRocm93IVxuICAgICAgICAgICAgaWYgKCFpbmRleGVkREIpIHRocm93IG5ldyBleGNlcHRpb25zLk1pc3NpbmdBUEkoXCJpbmRleGVkREIgQVBJIG5vdCBmb3VuZC4gSWYgdXNpbmcgSUUxMCssIG1ha2Ugc3VyZSB0byBydW4geW91ciBjb2RlIG9uIGEgc2VydmVyIFVSTCBcIiArIFwiKG5vdCBsb2NhbGx5KS4gSWYgdXNpbmcgb2xkIFNhZmFyaSB2ZXJzaW9ucywgbWFrZSBzdXJlIHRvIGluY2x1ZGUgaW5kZXhlZERCIHBvbHlmaWxsLlwiKTtcblxuICAgICAgICAgICAgdmFyIHJlcSA9IGF1dG9TY2hlbWEgPyBpbmRleGVkREIub3BlbihkYk5hbWUpIDogaW5kZXhlZERCLm9wZW4oZGJOYW1lLCBNYXRoLnJvdW5kKGRiLnZlcm5vICogMTApKTtcbiAgICAgICAgICAgIGlmICghcmVxKSB0aHJvdyBuZXcgZXhjZXB0aW9ucy5NaXNzaW5nQVBJKFwiSW5kZXhlZERCIEFQSSBub3QgYXZhaWxhYmxlXCIpOyAvLyBNYXkgaGFwcGVuIGluIFNhZmFyaSBwcml2YXRlIG1vZGUsIHNlZSBodHRwczovL2dpdGh1Yi5jb20vZGZhaGxhbmRlci9EZXhpZS5qcy9pc3N1ZXMvMTM0XG4gICAgICAgICAgICByZXEub25lcnJvciA9IHdyYXAoZXZlbnRSZWplY3RIYW5kbGVyKHJlamVjdCkpO1xuICAgICAgICAgICAgcmVxLm9uYmxvY2tlZCA9IHdyYXAoZmlyZU9uQmxvY2tlZCk7XG4gICAgICAgICAgICByZXEub251cGdyYWRlbmVlZGVkID0gd3JhcChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIHVwZ3JhZGVUcmFuc2FjdGlvbiA9IHJlcS50cmFuc2FjdGlvbjtcbiAgICAgICAgICAgICAgICBpZiAoYXV0b1NjaGVtYSAmJiAhZGIuX2FsbG93RW1wdHlEQikge1xuICAgICAgICAgICAgICAgICAgICAvLyBVbmxlc3MgYW4gYWRkb24gaGFzIHNwZWNpZmllZCBkYi5fYWxsb3dFbXB0eURCLCBsZXRzIG1ha2UgdGhlIGNhbGwgZmFpbC5cbiAgICAgICAgICAgICAgICAgICAgLy8gQ2FsbGVyIGRpZCBub3Qgc3BlY2lmeSBhIHZlcnNpb24gb3Igc2NoZW1hLiBEb2luZyB0aGF0IGlzIG9ubHkgYWNjZXB0YWJsZSBmb3Igb3BlbmluZyBhbHJlYWQgZXhpc3RpbmcgZGF0YWJhc2VzLlxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBvbnVwZ3JhZGVuZWVkZWQgaXMgY2FsbGVkIGl0IG1lYW5zIGRhdGFiYXNlIGRpZCBub3QgZXhpc3QuIFJlamVjdCB0aGUgb3BlbigpIHByb21pc2UgYW5kIG1ha2Ugc3VyZSB0aGF0IHdlXG4gICAgICAgICAgICAgICAgICAgIC8vIGRvIG5vdCBjcmVhdGUgYSBuZXcgZGF0YWJhc2UgYnkgYWNjaWRlbnQgaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSBwcmV2ZW50RGVmYXVsdDsgLy8gUHJvaGliaXQgb25hYm9ydCBlcnJvciBmcm9tIGZpcmluZyBiZWZvcmUgd2UncmUgZG9uZSFcbiAgICAgICAgICAgICAgICAgICAgdXBncmFkZVRyYW5zYWN0aW9uLmFib3J0KCk7IC8vIEFib3J0IHRyYW5zYWN0aW9uICh3b3VsZCBob3BlIHRoYXQgdGhpcyB3b3VsZCBtYWtlIERCIGRpc2FwcGVhciBidXQgaXQgZG9lc250LilcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2xvc2UgZGF0YWJhc2UgYW5kIGRlbGV0ZSBpdC5cbiAgICAgICAgICAgICAgICAgICAgcmVxLnJlc3VsdC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVscmVxID0gaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKGRiTmFtZSk7IC8vIFRoZSB1cGdyYWRlIHRyYW5zYWN0aW9uIGlzIGF0b21pYywgYW5kIGphdmFzY3JpcHQgaXMgc2luZ2xlIHRocmVhZGVkIC0gbWVhbmluZyB0aGF0IHRoZXJlIGlzIG5vIHJpc2sgdGhhdCB3ZSBkZWxldGUgc29tZW9uZSBlbHNlcyBkYXRhYmFzZSBoZXJlIVxuICAgICAgICAgICAgICAgICAgICBkZWxyZXEub25zdWNjZXNzID0gZGVscmVxLm9uZXJyb3IgPSB3cmFwKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgZXhjZXB0aW9ucy5Ob1N1Y2hEYXRhYmFzZSgnRGF0YWJhc2UgJyArIGRiTmFtZSArICcgZG9lc250IGV4aXN0JykpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1cGdyYWRlVHJhbnNhY3Rpb24ub25lcnJvciA9IHdyYXAoZXZlbnRSZWplY3RIYW5kbGVyKHJlamVjdCkpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkVmVyID0gZS5vbGRWZXJzaW9uID4gTWF0aC5wb3coMiwgNjIpID8gMCA6IGUub2xkVmVyc2lvbjsgLy8gU2FmYXJpIDggZml4LlxuICAgICAgICAgICAgICAgICAgICBydW5VcGdyYWRlcnMob2xkVmVyIC8gMTAsIHVwZ3JhZGVUcmFuc2FjdGlvbiwgcmVqZWN0LCByZXEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHJlamVjdCk7XG5cbiAgICAgICAgICAgIHJlcS5vbnN1Y2Nlc3MgPSB3cmFwKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyBDb3JlIG9wZW5pbmcgcHJvY2VkdXJlIGNvbXBsZXRlLiBOb3cgbGV0J3MganVzdCByZWNvcmQgc29tZSBzdHVmZi5cbiAgICAgICAgICAgICAgICB1cGdyYWRlVHJhbnNhY3Rpb24gPSBudWxsO1xuICAgICAgICAgICAgICAgIGlkYmRiID0gcmVxLnJlc3VsdDtcbiAgICAgICAgICAgICAgICBjb25uZWN0aW9ucy5wdXNoKGRiKTsgLy8gVXNlZCBmb3IgZW11bGF0aW5nIHZlcnNpb25jaGFuZ2UgZXZlbnQgb24gSUUvRWRnZS9TYWZhcmkuXG5cbiAgICAgICAgICAgICAgICBpZiAoYXV0b1NjaGVtYSkgcmVhZEdsb2JhbFNjaGVtYSgpO2Vsc2UgaWYgKGlkYmRiLm9iamVjdFN0b3JlTmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0VG9FeGlzdGluZ0luZGV4TmFtZXMoZ2xvYmFsU2NoZW1hLCBpZGJkYi50cmFuc2FjdGlvbihzYWZhcmlNdWx0aVN0b3JlRml4KGlkYmRiLm9iamVjdFN0b3JlTmFtZXMpLCBSRUFET05MWSkpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTYWZhcmkgbWF5IGJhaWwgb3V0IGlmID4gMSBzdG9yZSBuYW1lcy4gSG93ZXZlciwgdGhpcyBzaG91bGRudCBiZSBhIHNob3dzdG9wcGVyLiBJc3N1ZSAjMTIwLlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWRiZGIub252ZXJzaW9uY2hhbmdlID0gd3JhcChmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgICAgICAgICAgZGIuX3ZjRmlyZWQgPSB0cnVlOyAvLyBkZXRlY3QgaW1wbGVtZW50YXRpb25zIHRoYXQgbm90IHN1cHBvcnQgdmVyc2lvbmNoYW5nZSAoSUUvRWRnZS9TYWZhcmkpXG4gICAgICAgICAgICAgICAgICAgIGRiLm9uKFwidmVyc2lvbmNoYW5nZVwiKS5maXJlKGV2KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmICghaGFzTmF0aXZlR2V0RGF0YWJhc2VOYW1lcykge1xuICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgbG9jYWxTdG9yYWdlIHdpdGggbGlzdCBvZiBkYXRhYmFzZSBuYW1lc1xuICAgICAgICAgICAgICAgICAgICBnbG9iYWxEYXRhYmFzZUxpc3QoZnVuY3Rpb24gKGRhdGFiYXNlTmFtZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhYmFzZU5hbWVzLmluZGV4T2YoZGJOYW1lKSA9PT0gLTEpIHJldHVybiBkYXRhYmFzZU5hbWVzLnB1c2goZGJOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSwgcmVqZWN0KTtcbiAgICAgICAgfSldKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIEJlZm9yZSBmaW5hbGx5IHJlc29sdmluZyB0aGUgZGJSZWFkeVByb21pc2UgYW5kIHRoaXMgcHJvbWlzZSxcbiAgICAgICAgICAgIC8vIGNhbGwgYW5kIGF3YWl0IGFsbCBvbigncmVhZHknKSBzdWJzY3JpYmVyczpcbiAgICAgICAgICAgIC8vIERleGllLnZpcCgpIG1ha2VzIHN1YnNjcmliZXJzIGFibGUgdG8gdXNlIHRoZSBkYXRhYmFzZSB3aGlsZSBiZWluZyBvcGVuZWQuXG4gICAgICAgICAgICAvLyBUaGlzIGlzIGEgbXVzdCBzaW5jZSB0aGVzZSBzdWJzY3JpYmVycyB0YWtlIHBhcnQgb2YgdGhlIG9wZW5pbmcgcHJvY2VkdXJlLlxuICAgICAgICAgICAgcmV0dXJuIERleGllLnZpcChkYi5vbi5yZWFkeS5maXJlKTtcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBSZXNvbHZlIHRoZSBkYi5vcGVuKCkgd2l0aCB0aGUgZGIgaW5zdGFuY2UuXG4gICAgICAgICAgICBpc0JlaW5nT3BlbmVkID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm4gZGI7XG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gRGlkIHdlIGZhaWwgd2l0aGluIG9udXBncmFkZW5lZWRlZD8gTWFrZSBzdXJlIHRvIGFib3J0IHRoZSB1cGdyYWRlIHRyYW5zYWN0aW9uIHNvIGl0IGRvZXNudCBjb21taXQuXG4gICAgICAgICAgICAgICAgdXBncmFkZVRyYW5zYWN0aW9uICYmIHVwZ3JhZGVUcmFuc2FjdGlvbi5hYm9ydCgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgICAgIGlzQmVpbmdPcGVuZWQgPSBmYWxzZTsgLy8gU2V0IGJlZm9yZSBjYWxsaW5nIGRiLmNsb3NlKCkgc28gdGhhdCBpdCBkb2VzbnQgcmVqZWN0IG9wZW5DYW5jZWxsZXIgYWdhaW4gKGxlYWRzIHRvIHVuaGFuZGxlZCByZWplY3Rpb24gZXZlbnQpLlxuICAgICAgICAgICAgZGIuY2xvc2UoKTsgLy8gQ2xvc2VzIGFuZCByZXNldHMgaWRiZGIsIHJlbW92ZXMgY29ubmVjdGlvbnMsIHJlc2V0cyBkYlJlYWR5UHJvbWlzZSBhbmQgb3BlbkNhbmNlbGxlciBzbyB0aGF0IGEgbGF0ZXIgZGIub3BlbigpIGlzIGZyZXNoLlxuICAgICAgICAgICAgLy8gQSBjYWxsIHRvIGRiLmNsb3NlKCkgbWF5IGhhdmUgbWFkZSBvbi1yZWFkeSBzdWJzY3JpYmVycyBmYWlsLiBVc2UgZGJPcGVuRXJyb3IgaWYgc2V0LCBzaW5jZSBlcnIgY291bGQgYmUgYSBmb2xsb3ctdXAgZXJyb3Igb24gdGhhdC5cbiAgICAgICAgICAgIGRiT3BlbkVycm9yID0gZXJyOyAvLyBSZWNvcmQgdGhlIGVycm9yLiBJdCB3aWxsIGJlIHVzZWQgdG8gcmVqZWN0IGZ1cnRoZXIgcHJvbWlzZXMgb2YgZGIgb3BlcmF0aW9ucy5cbiAgICAgICAgICAgIHJldHVybiByZWplY3Rpb24oZGJPcGVuRXJyb3IsIGRiVW5jYXVnaHQpOyAvLyBkYlVuY2F1Z2h0IHdpbGwgbWFrZSBzdXJlIGFueSBlcnJvciB0aGF0IGhhcHBlbmVkIGluIGFueSBvcGVyYXRpb24gYmVmb3JlIHdpbGwgbm93IGJ1YmJsZSB0byBkYi5vbi5lcnJvcigpIHRoYW5rcyB0byB0aGUgc3BlY2lhbCBoYW5kbGluZyBpbiBQcm9taXNlLnVuY2F1Z2h0KCkuXG4gICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgb3BlbkNvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlc29sdmVEYlJlYWR5KCk7IC8vIGRiUmVhZHlQcm9taXNlIGlzIHJlc29sdmVkIG5vIG1hdHRlciBpZiBvcGVuKCkgcmVqZWN0cyBvciByZXNvbHZlZC4gSXQncyBqdXN0IHRvIHdha2UgdXAgd2FpdGVycy5cbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRoaXMuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpZHggPSBjb25uZWN0aW9ucy5pbmRleE9mKGRiKTtcbiAgICAgICAgaWYgKGlkeCA+PSAwKSBjb25uZWN0aW9ucy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgaWYgKGlkYmRiKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlkYmRiLmNsb3NlKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICAgICAgaWRiZGIgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGF1dG9PcGVuID0gZmFsc2U7XG4gICAgICAgIGRiT3BlbkVycm9yID0gbmV3IGV4Y2VwdGlvbnMuRGF0YWJhc2VDbG9zZWQoKTtcbiAgICAgICAgaWYgKGlzQmVpbmdPcGVuZWQpIGNhbmNlbE9wZW4oZGJPcGVuRXJyb3IpO1xuICAgICAgICAvLyBSZXNldCBkYlJlYWR5UHJvbWlzZSBwcm9taXNlOlxuICAgICAgICBkYlJlYWR5UHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICBkYlJlYWR5UmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICAgIH0pO1xuICAgICAgICBvcGVuQ2FuY2VsbGVyID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKF8sIHJlamVjdCkge1xuICAgICAgICAgICAgY2FuY2VsT3BlbiA9IHJlamVjdDtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRoaXMuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaGFzQXJndW1lbnRzID0gYXJndW1lbnRzLmxlbmd0aCA+IDA7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBpZiAoaGFzQXJndW1lbnRzKSB0aHJvdyBuZXcgZXhjZXB0aW9ucy5JbnZhbGlkQXJndW1lbnQoXCJBcmd1bWVudHMgbm90IGFsbG93ZWQgaW4gZGIuZGVsZXRlKClcIik7XG4gICAgICAgICAgICBpZiAoaXNCZWluZ09wZW5lZCkge1xuICAgICAgICAgICAgICAgIGRiUmVhZHlQcm9taXNlLnRoZW4oZG9EZWxldGUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkb0RlbGV0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gZG9EZWxldGUoKSB7XG4gICAgICAgICAgICAgICAgZGIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB2YXIgcmVxID0gaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKGRiTmFtZSk7XG4gICAgICAgICAgICAgICAgcmVxLm9uc3VjY2VzcyA9IHdyYXAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc05hdGl2ZUdldERhdGFiYXNlTmFtZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbERhdGFiYXNlTGlzdChmdW5jdGlvbiAoZGF0YWJhc2VOYW1lcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3MgPSBkYXRhYmFzZU5hbWVzLmluZGV4T2YoZGJOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zID49IDApIHJldHVybiBkYXRhYmFzZU5hbWVzLnNwbGljZShwb3MsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJlcS5vbmVycm9yID0gd3JhcChldmVudFJlamVjdEhhbmRsZXIocmVqZWN0KSk7XG4gICAgICAgICAgICAgICAgcmVxLm9uYmxvY2tlZCA9IGZpcmVPbkJsb2NrZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLnVuY2F1Z2h0KGRiVW5jYXVnaHQpO1xuICAgIH07XG5cbiAgICB0aGlzLmJhY2tlbmREQiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGlkYmRiO1xuICAgIH07XG5cbiAgICB0aGlzLmlzT3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGlkYmRiICE9PSBudWxsO1xuICAgIH07XG4gICAgdGhpcy5oYXNGYWlsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBkYk9wZW5FcnJvciAhPT0gbnVsbDtcbiAgICB9O1xuICAgIHRoaXMuZHluYW1pY2FsbHlPcGVuZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBhdXRvU2NoZW1hO1xuICAgIH07XG5cbiAgICAvL1xuICAgIC8vIFByb3BlcnRpZXNcbiAgICAvL1xuICAgIHRoaXMubmFtZSA9IGRiTmFtZTtcblxuICAgIC8vIGRiLnRhYmxlcyAtIGFuIGFycmF5IG9mIGFsbCBUYWJsZSBpbnN0YW5jZXMuXG4gICAgc2V0UHJvcCh0aGlzLCBcInRhYmxlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8vIDxyZXR1cm5zIHR5cGU9XCJBcnJheVwiIGVsZW1lbnRUeXBlPVwiV3JpdGVhYmxlVGFibGVcIiAvPlxuICAgICAgICAgICAgcmV0dXJuIGtleXMoYWxsVGFibGVzKS5tYXAoZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWxsVGFibGVzW25hbWVdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vXG4gICAgLy8gRXZlbnRzXG4gICAgLy9cbiAgICB0aGlzLm9uID0gRXZlbnRzKHRoaXMsIFwiZXJyb3JcIiwgXCJwb3B1bGF0ZVwiLCBcImJsb2NrZWRcIiwgXCJ2ZXJzaW9uY2hhbmdlXCIsIHsgcmVhZHk6IFtwcm9taXNhYmxlQ2hhaW4sIG5vcF0gfSk7XG4gICAgdGhpcy5vbi5lcnJvci5zdWJzY3JpYmUgPSBkZXByZWNhdGVkKFwiRGV4aWUub24uZXJyb3JcIiwgdGhpcy5vbi5lcnJvci5zdWJzY3JpYmUpO1xuICAgIHRoaXMub24uZXJyb3IudW5zdWJzY3JpYmUgPSBkZXByZWNhdGVkKFwiRGV4aWUub24uZXJyb3IudW5zdWJzY3JpYmVcIiwgdGhpcy5vbi5lcnJvci51bnN1YnNjcmliZSk7XG5cbiAgICB0aGlzLm9uLnJlYWR5LnN1YnNjcmliZSA9IG92ZXJyaWRlKHRoaXMub24ucmVhZHkuc3Vic2NyaWJlLCBmdW5jdGlvbiAoc3Vic2NyaWJlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoc3Vic2NyaWJlciwgYlN0aWNreSkge1xuICAgICAgICAgICAgRGV4aWUudmlwKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAob3BlbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIERhdGFiYXNlIGFscmVhZHkgb3Blbi4gQ2FsbCBzdWJzY3JpYmVyIGFzYXAuXG4gICAgICAgICAgICAgICAgICAgIGlmICghZGJPcGVuRXJyb3IpIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oc3Vic2NyaWJlcik7XG4gICAgICAgICAgICAgICAgICAgIC8vIGJTdGlja3k6IEFsc28gc3Vic2NyaWJlIHRvIGZ1dHVyZSBvcGVuIHN1Y2Vzc2VzIChhZnRlciBjbG9zZSAvIHJlb3BlbikgXG4gICAgICAgICAgICAgICAgICAgIGlmIChiU3RpY2t5KSBzdWJzY3JpYmUoc3Vic2NyaWJlcik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRGF0YWJhc2Ugbm90IHlldCBvcGVuLiBTdWJzY3JpYmUgdG8gaXQuXG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZShzdWJzY3JpYmVyKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgYlN0aWNreSBpcyBmYWxzeSwgbWFrZSBzdXJlIHRvIHVuc3Vic2NyaWJlIHN1YnNjcmliZXIgd2hlbiBmaXJlZCBvbmNlLlxuICAgICAgICAgICAgICAgICAgICBpZiAoIWJTdGlja3kpIHN1YnNjcmliZShmdW5jdGlvbiB1bnN1YnNjcmliZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRiLm9uLnJlYWR5LnVuc3Vic2NyaWJlKHN1YnNjcmliZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGIub24ucmVhZHkudW5zdWJzY3JpYmUodW5zdWJzY3JpYmUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9KTtcblxuICAgIGZha2VBdXRvQ29tcGxldGUoZnVuY3Rpb24gKCkge1xuICAgICAgICBkYi5vbihcInBvcHVsYXRlXCIpLmZpcmUoZGIuX2NyZWF0ZVRyYW5zYWN0aW9uKFJFQURXUklURSwgZGJTdG9yZU5hbWVzLCBnbG9iYWxTY2hlbWEpKTtcbiAgICAgICAgZGIub24oXCJlcnJvclwiKS5maXJlKG5ldyBFcnJvcigpKTtcbiAgICB9KTtcblxuICAgIHRoaXMudHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAobW9kZSwgdGFibGVJbnN0YW5jZXMsIHNjb3BlRnVuYykge1xuICAgICAgICAvLy8gPHN1bW1hcnk+XG4gICAgICAgIC8vL1xuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJtb2RlXCIgdHlwZT1cIlN0cmluZ1wiPlwiclwiIGZvciByZWFkb25seSwgb3IgXCJyd1wiIGZvciByZWFkd3JpdGU8L3BhcmFtPlxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0YWJsZUluc3RhbmNlc1wiPlRhYmxlIGluc3RhbmNlLCBBcnJheSBvZiBUYWJsZSBpbnN0YW5jZXMsIFN0cmluZyBvciBTdHJpbmcgQXJyYXkgb2Ygb2JqZWN0IHN0b3JlcyB0byBpbmNsdWRlIGluIHRoZSB0cmFuc2FjdGlvbjwvcGFyYW0+XG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInNjb3BlRnVuY1wiIHR5cGU9XCJGdW5jdGlvblwiPkZ1bmN0aW9uIHRvIGV4ZWN1dGUgd2l0aCB0cmFuc2FjdGlvbjwvcGFyYW0+XG5cbiAgICAgICAgLy8gTGV0IHRhYmxlIGFyZ3VtZW50cyBiZSBhbGwgYXJndW1lbnRzIGJldHdlZW4gbW9kZSBhbmQgbGFzdCBhcmd1bWVudC5cbiAgICAgICAgdmFyIGkgPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgICAgICBpZiAoaSA8IDIpIHRocm93IG5ldyBleGNlcHRpb25zLkludmFsaWRBcmd1bWVudChcIlRvbyBmZXcgYXJndW1lbnRzXCIpO1xuICAgICAgICAvLyBQcmV2ZW50IG9wdGltemF0aW9uIGtpbGxlciAoaHR0cHM6Ly9naXRodWIuY29tL3BldGthYW50b25vdi9ibHVlYmlyZC93aWtpL09wdGltaXphdGlvbi1raWxsZXJzIzMyLWxlYWtpbmctYXJndW1lbnRzKVxuICAgICAgICAvLyBhbmQgY2xvbmUgYXJndW1lbnRzIGV4Y2VwdCB0aGUgZmlyc3Qgb25lIGludG8gbG9jYWwgdmFyICdhcmdzJy5cbiAgICAgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoaSAtIDEpO1xuICAgICAgICB3aGlsZSAoLS1pKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfSAvLyBMZXQgc2NvcGVGdW5jIGJlIHRoZSBsYXN0IGFyZ3VtZW50IGFuZCBwb3AgaXQgc28gdGhhdCBhcmdzIG5vdyBvbmx5IGNvbnRhaW4gdGhlIHRhYmxlIGFyZ3VtZW50cy5cbiAgICAgICAgc2NvcGVGdW5jID0gYXJncy5wb3AoKTtcbiAgICAgICAgdmFyIHRhYmxlcyA9IGZsYXR0ZW4oYXJncyk7IC8vIFN1cHBvcnQgdXNpbmcgYXJyYXkgYXMgbWlkZGxlIGFyZ3VtZW50LCBvciBhIG1peCBvZiBhcnJheXMgYW5kIG5vbi1hcnJheXMuXG4gICAgICAgIHZhciBwYXJlbnRUcmFuc2FjdGlvbiA9IFBTRC50cmFucztcbiAgICAgICAgLy8gQ2hlY2sgaWYgcGFyZW50IHRyYW5zYWN0aW9ucyBpcyBib3VuZCB0byB0aGlzIGRiIGluc3RhbmNlLCBhbmQgaWYgY2FsbGVyIHdhbnRzIHRvIHJldXNlIGl0XG4gICAgICAgIGlmICghcGFyZW50VHJhbnNhY3Rpb24gfHwgcGFyZW50VHJhbnNhY3Rpb24uZGIgIT09IGRiIHx8IG1vZGUuaW5kZXhPZignIScpICE9PSAtMSkgcGFyZW50VHJhbnNhY3Rpb24gPSBudWxsO1xuICAgICAgICB2YXIgb25seUlmQ29tcGF0aWJsZSA9IG1vZGUuaW5kZXhPZignPycpICE9PSAtMTtcbiAgICAgICAgbW9kZSA9IG1vZGUucmVwbGFjZSgnIScsICcnKS5yZXBsYWNlKCc/JywgJycpOyAvLyBPay4gV2lsbCBjaGFuZ2UgYXJndW1lbnRzWzBdIGFzIHdlbGwgYnV0IHdlIHdvbnQgdG91Y2ggYXJndW1lbnRzIGhlbmNlZm9ydGguXG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyBHZXQgc3RvcmVOYW1lcyBmcm9tIGFyZ3VtZW50cy4gRWl0aGVyIHRocm91Z2ggZ2l2ZW4gdGFibGUgaW5zdGFuY2VzLCBvciB0aHJvdWdoIGdpdmVuIHRhYmxlIG5hbWVzLlxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIHZhciBzdG9yZU5hbWVzID0gdGFibGVzLm1hcChmdW5jdGlvbiAodGFibGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RvcmVOYW1lID0gdGFibGUgaW5zdGFuY2VvZiBUYWJsZSA/IHRhYmxlLm5hbWUgOiB0YWJsZTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN0b3JlTmFtZSAhPT0gJ3N0cmluZycpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIHRhYmxlIGFyZ3VtZW50IHRvIERleGllLnRyYW5zYWN0aW9uKCkuIE9ubHkgVGFibGUgb3IgU3RyaW5nIGFyZSBhbGxvd2VkXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBzdG9yZU5hbWU7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIFJlc29sdmUgbW9kZS4gQWxsb3cgc2hvcnRjdXRzIFwiclwiIGFuZCBcInJ3XCIuXG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgaWYgKG1vZGUgPT0gXCJyXCIgfHwgbW9kZSA9PSBSRUFET05MWSkgbW9kZSA9IFJFQURPTkxZO2Vsc2UgaWYgKG1vZGUgPT0gXCJyd1wiIHx8IG1vZGUgPT0gUkVBRFdSSVRFKSBtb2RlID0gUkVBRFdSSVRFO2Vsc2UgdGhyb3cgbmV3IGV4Y2VwdGlvbnMuSW52YWxpZEFyZ3VtZW50KFwiSW52YWxpZCB0cmFuc2FjdGlvbiBtb2RlOiBcIiArIG1vZGUpO1xuXG4gICAgICAgICAgICBpZiAocGFyZW50VHJhbnNhY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAvLyBCYXNpYyBjaGVja3NcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50VHJhbnNhY3Rpb24ubW9kZSA9PT0gUkVBRE9OTFkgJiYgbW9kZSA9PT0gUkVBRFdSSVRFKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvbmx5SWZDb21wYXRpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTcGF3biBuZXcgdHJhbnNhY3Rpb24gaW5zdGVhZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudFRyYW5zYWN0aW9uID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHRocm93IG5ldyBleGNlcHRpb25zLlN1YlRyYW5zYWN0aW9uKFwiQ2Fubm90IGVudGVyIGEgc3ViLXRyYW5zYWN0aW9uIHdpdGggUkVBRFdSSVRFIG1vZGUgd2hlbiBwYXJlbnQgdHJhbnNhY3Rpb24gaXMgUkVBRE9OTFlcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwYXJlbnRUcmFuc2FjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBzdG9yZU5hbWVzLmZvckVhY2goZnVuY3Rpb24gKHN0b3JlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudFRyYW5zYWN0aW9uICYmIHBhcmVudFRyYW5zYWN0aW9uLnN0b3JlTmFtZXMuaW5kZXhPZihzdG9yZU5hbWUpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvbmx5SWZDb21wYXRpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNwYXduIG5ldyB0cmFuc2FjdGlvbiBpbnN0ZWFkLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRUcmFuc2FjdGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHRocm93IG5ldyBleGNlcHRpb25zLlN1YlRyYW5zYWN0aW9uKFwiVGFibGUgXCIgKyBzdG9yZU5hbWUgKyBcIiBub3QgaW5jbHVkZWQgaW4gcGFyZW50IHRyYW5zYWN0aW9uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyZW50VHJhbnNhY3Rpb24gPyBwYXJlbnRUcmFuc2FjdGlvbi5fcHJvbWlzZShudWxsLCBmdW5jdGlvbiAoXywgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfSkgOiByZWplY3Rpb24oZSwgZGJVbmNhdWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgdGhpcyBpcyBhIHN1Yi10cmFuc2FjdGlvbiwgbG9jayB0aGUgcGFyZW50IGFuZCB0aGVuIGxhdW5jaCB0aGUgc3ViLXRyYW5zYWN0aW9uLlxuICAgICAgICByZXR1cm4gcGFyZW50VHJhbnNhY3Rpb24gPyBwYXJlbnRUcmFuc2FjdGlvbi5fcHJvbWlzZShtb2RlLCBlbnRlclRyYW5zYWN0aW9uU2NvcGUsIFwibG9ja1wiKSA6IGRiLl93aGVuUmVhZHkoZW50ZXJUcmFuc2FjdGlvblNjb3BlKTtcblxuICAgICAgICBmdW5jdGlvbiBlbnRlclRyYW5zYWN0aW9uU2NvcGUocmVzb2x2ZSkge1xuICAgICAgICAgICAgdmFyIHBhcmVudFBTRCA9IFBTRDtcbiAgICAgICAgICAgIHJlc29sdmUoUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld1Njb3BlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gS2VlcCBhIHBvaW50ZXIgdG8gbGFzdCBub24tdHJhbnNhY3Rpb25hbCBQU0QgdG8gdXNlIGlmIHNvbWVvbmUgY2FsbHMgRGV4aWUuaWdub3JlVHJhbnNhY3Rpb24oKS5cbiAgICAgICAgICAgICAgICAgICAgUFNELnRyYW5zbGVzcyA9IFBTRC50cmFuc2xlc3MgfHwgcGFyZW50UFNEO1xuICAgICAgICAgICAgICAgICAgICAvLyBPdXIgdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICAgICAgICAgIC8vcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zID0gZGIuX2NyZWF0ZVRyYW5zYWN0aW9uKG1vZGUsIHN0b3JlTmFtZXMsIGdsb2JhbFNjaGVtYSwgcGFyZW50VHJhbnNhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAvLyBMZXQgdGhlIHRyYW5zYWN0aW9uIGluc3RhbmNlIGJlIHBhcnQgb2YgYSBQcm9taXNlLXNwZWNpZmljIGRhdGEgKFBTRCkgdmFsdWUuXG4gICAgICAgICAgICAgICAgICAgIFBTRC50cmFucyA9IHRyYW5zO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnRUcmFuc2FjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRW11bGF0ZSB0cmFuc2FjdGlvbiBjb21taXQgYXdhcmVuZXNzIGZvciBpbm5lciB0cmFuc2FjdGlvbiAobXVzdCAnY29tbWl0JyB3aGVuIHRoZSBpbm5lciB0cmFuc2FjdGlvbiBoYXMgbm8gbW9yZSBvcGVyYXRpb25zIG9uZ29pbmcpXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFucy5pZGJ0cmFucyA9IHBhcmVudFRyYW5zYWN0aW9uLmlkYnRyYW5zO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnMuY3JlYXRlKCk7IC8vIENyZWF0ZSB0aGUgYmFja2VuZCB0cmFuc2FjdGlvbiBzbyB0aGF0IGNvbXBsZXRlKCkgb3IgZXJyb3IoKSB3aWxsIHRyaWdnZXIgZXZlbiBpZiBubyBvcGVyYXRpb24gaXMgbWFkZSB1cG9uIGl0LlxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUHJvdmlkZSBhcmd1bWVudHMgdG8gdGhlIHNjb3BlIGZ1bmN0aW9uIChmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlQXJncyA9IHN0b3JlTmFtZXMubWFwKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWxsVGFibGVzW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVBcmdzLnB1c2godHJhbnMpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXR1cm5WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuZm9sbG93KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmFsbHksIGNhbGwgdGhlIHNjb3BlIGZ1bmN0aW9uIHdpdGggb3VyIHRhYmxlIGFuZCB0cmFuc2FjdGlvbiBhcmd1bWVudHMuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHNjb3BlRnVuYy5hcHBseSh0cmFucywgdGFibGVBcmdzKTsgLy8gTk9URTogcmV0dXJuVmFsdWUgaXMgdXNlZCBpbiB0cmFucy5vbi5jb21wbGV0ZSgpIG5vdCBhcyBhIHJldHVyblZhbHVlIHRvIHRoaXMgZnVuYy5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXR1cm5WYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmV0dXJuVmFsdWUubmV4dCA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgcmV0dXJuVmFsdWUudGhyb3cgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2NvcGVGdW5jIHJldHVybmVkIGFuIGl0ZXJhdG9yIHdpdGggdGhyb3ctc3VwcG9ydC4gSGFuZGxlIHlpZWxkIGFzIGF3YWl0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZSA9IGF3YWl0SXRlcmF0b3IocmV0dXJuVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHJldHVyblZhbHVlLnRoZW4gPT09ICdmdW5jdGlvbicgJiYgIWhhc093bihyZXR1cm5WYWx1ZSwgJ19QU0QnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgZXhjZXB0aW9ucy5JbmNvbXBhdGlibGVQcm9taXNlKFwiSW5jb21wYXRpYmxlIFByb21pc2UgcmV0dXJuZWQgZnJvbSB0cmFuc2FjdGlvbiBzY29wZSAocmVhZCBtb3JlIGF0IGh0dHA6Ly90aW55dXJsLmNvbS96bnlxanFjKS4gVHJhbnNhY3Rpb24gc2NvcGU6IFwiICsgc2NvcGVGdW5jLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSkudW5jYXVnaHQoZGJVbmNhdWdodCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50VHJhbnNhY3Rpb24pIHRyYW5zLl9yZXNvbHZlKCk7IC8vIHN1YiB0cmFuc2FjdGlvbnMgZG9uJ3QgcmVhY3QgdG8gaWRidHJhbnMub25jb21wbGV0ZS4gV2UgbXVzdCB0cmlnZ2VyIGEgYWNvbXBsZXRpb24uXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnMuX2NvbXBsZXRpb247IC8vIEV2ZW4gaWYgV0UgYmVsaWV2ZSBldmVyeXRoaW5nIGlzIGZpbmUuIEF3YWl0IElEQlRyYW5zYWN0aW9uJ3Mgb25jb21wbGV0ZSBvciBvbmVycm9yIGFzIHdlbGwuXG4gICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldHVyblZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9yZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFucy5fcmVqZWN0KGUpOyAvLyBZZXMsIGFib3ZlIHRoZW4taGFuZGxlciB3ZXJlIG1heWJlIG5vdCBjYWxsZWQgYmVjYXVzZSBvZiBhbiB1bmhhbmRsZWQgcmVqZWN0aW9uIGluIHNjb3BlRnVuYyFcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3Rpb24oZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAvL30pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMudGFibGUgPSBmdW5jdGlvbiAodGFibGVOYW1lKSB7XG4gICAgICAgIC8vLyA8cmV0dXJucyB0eXBlPVwiV3JpdGVhYmxlVGFibGVcIj48L3JldHVybnM+XG4gICAgICAgIGlmIChmYWtlICYmIGF1dG9TY2hlbWEpIHJldHVybiBuZXcgV3JpdGVhYmxlVGFibGUodGFibGVOYW1lKTtcbiAgICAgICAgaWYgKCFoYXNPd24oYWxsVGFibGVzLCB0YWJsZU5hbWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgZXhjZXB0aW9ucy5JbnZhbGlkVGFibGUoJ1RhYmxlICcgKyB0YWJsZU5hbWUgKyAnIGRvZXMgbm90IGV4aXN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFsbFRhYmxlc1t0YWJsZU5hbWVdO1xuICAgIH07XG5cbiAgICAvL1xuICAgIC8vXG4gICAgLy9cbiAgICAvLyBUYWJsZSBDbGFzc1xuICAgIC8vXG4gICAgLy9cbiAgICAvL1xuICAgIGZ1bmN0aW9uIFRhYmxlKG5hbWUsIHRhYmxlU2NoZW1hLCBjb2xsQ2xhc3MpIHtcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwibmFtZVwiIHR5cGU9XCJTdHJpbmdcIj48L3BhcmFtPlxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLnNjaGVtYSA9IHRhYmxlU2NoZW1hO1xuICAgICAgICB0aGlzLmhvb2sgPSBhbGxUYWJsZXNbbmFtZV0gPyBhbGxUYWJsZXNbbmFtZV0uaG9vayA6IEV2ZW50cyhudWxsLCB7XG4gICAgICAgICAgICBcImNyZWF0aW5nXCI6IFtob29rQ3JlYXRpbmdDaGFpbiwgbm9wXSxcbiAgICAgICAgICAgIFwicmVhZGluZ1wiOiBbcHVyZUZ1bmN0aW9uQ2hhaW4sIG1pcnJvcl0sXG4gICAgICAgICAgICBcInVwZGF0aW5nXCI6IFtob29rVXBkYXRpbmdDaGFpbiwgbm9wXSxcbiAgICAgICAgICAgIFwiZGVsZXRpbmdcIjogW2hvb2tEZWxldGluZ0NoYWluLCBub3BdXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9jb2xsQ2xhc3MgPSBjb2xsQ2xhc3MgfHwgQ29sbGVjdGlvbjtcbiAgICB9XG5cbiAgICBwcm9wcyhUYWJsZS5wcm90b3R5cGUsIHtcblxuICAgICAgICAvL1xuICAgICAgICAvLyBUYWJsZSBQcm90ZWN0ZWQgTWV0aG9kc1xuICAgICAgICAvL1xuXG4gICAgICAgIF90cmFuczogZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb24obW9kZSwgZm4sIHdyaXRlTG9ja2VkKSB7XG4gICAgICAgICAgICB2YXIgdHJhbnMgPSBQU0QudHJhbnM7XG4gICAgICAgICAgICByZXR1cm4gdHJhbnMgJiYgdHJhbnMuZGIgPT09IGRiID8gdHJhbnMuX3Byb21pc2UobW9kZSwgZm4sIHdyaXRlTG9ja2VkKSA6IHRlbXBUcmFuc2FjdGlvbihtb2RlLCBbdGhpcy5uYW1lXSwgZm4pO1xuICAgICAgICB9LFxuICAgICAgICBfaWRic3RvcmU6IGZ1bmN0aW9uIGdldElEQk9iamVjdFN0b3JlKG1vZGUsIGZuLCB3cml0ZUxvY2tlZCkge1xuICAgICAgICAgICAgaWYgKGZha2UpIHJldHVybiBuZXcgUHJvbWlzZShmbik7IC8vIFNpbXBsaWZ5IHRoZSB3b3JrIGZvciBJbnRlbGxpc2Vuc2UvQ29kZSBjb21wbGV0aW9uLlxuICAgICAgICAgICAgdmFyIHRyYW5zID0gUFNELnRyYW5zLFxuICAgICAgICAgICAgICAgIHRhYmxlTmFtZSA9IHRoaXMubmFtZTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHN1cHBseUlkYlN0b3JlKHJlc29sdmUsIHJlamVjdCwgdHJhbnMpIHtcbiAgICAgICAgICAgICAgICBmbihyZXNvbHZlLCByZWplY3QsIHRyYW5zLmlkYnRyYW5zLm9iamVjdFN0b3JlKHRhYmxlTmFtZSksIHRyYW5zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cmFucyAmJiB0cmFucy5kYiA9PT0gZGIgPyB0cmFucy5fcHJvbWlzZShtb2RlLCBzdXBwbHlJZGJTdG9yZSwgd3JpdGVMb2NrZWQpIDogdGVtcFRyYW5zYWN0aW9uKG1vZGUsIFt0aGlzLm5hbWVdLCBzdXBwbHlJZGJTdG9yZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gVGFibGUgUHVibGljIE1ldGhvZHNcbiAgICAgICAgLy9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoa2V5LCBjYikge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lkYnN0b3JlKFJFQURPTkxZLCBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0LCBpZGJzdG9yZSkge1xuICAgICAgICAgICAgICAgIGZha2UgJiYgcmVzb2x2ZShzZWxmLnNjaGVtYS5pbnN0YW5jZVRlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICB2YXIgcmVxID0gaWRic3RvcmUuZ2V0KGtleSk7XG4gICAgICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSBldmVudFJlamVjdEhhbmRsZXIocmVqZWN0KTtcbiAgICAgICAgICAgICAgICByZXEub25zdWNjZXNzID0gd3JhcChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc2VsZi5ob29rLnJlYWRpbmcuZmlyZShyZXEucmVzdWx0KSk7XG4gICAgICAgICAgICAgICAgfSwgcmVqZWN0KTtcbiAgICAgICAgICAgIH0pLnRoZW4oY2IpO1xuICAgICAgICB9LFxuICAgICAgICB3aGVyZTogZnVuY3Rpb24gKGluZGV4TmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBXaGVyZUNsYXVzZSh0aGlzLCBpbmRleE5hbWUpO1xuICAgICAgICB9LFxuICAgICAgICBjb3VudDogZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b0NvbGxlY3Rpb24oKS5jb3VudChjYik7XG4gICAgICAgIH0sXG4gICAgICAgIG9mZnNldDogZnVuY3Rpb24gKG9mZnNldCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9Db2xsZWN0aW9uKCkub2Zmc2V0KG9mZnNldCk7XG4gICAgICAgIH0sXG4gICAgICAgIGxpbWl0OiBmdW5jdGlvbiAobnVtUm93cykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9Db2xsZWN0aW9uKCkubGltaXQobnVtUm93cyk7XG4gICAgICAgIH0sXG4gICAgICAgIHJldmVyc2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRvQ29sbGVjdGlvbigpLnJldmVyc2UoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZmlsdGVyOiBmdW5jdGlvbiAoZmlsdGVyRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRvQ29sbGVjdGlvbigpLmFuZChmaWx0ZXJGdW5jdGlvbik7XG4gICAgICAgIH0sXG4gICAgICAgIGVhY2g6IGZ1bmN0aW9uIChmbikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9Db2xsZWN0aW9uKCkuZWFjaChmbik7XG4gICAgICAgIH0sXG4gICAgICAgIHRvQXJyYXk6IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9Db2xsZWN0aW9uKCkudG9BcnJheShjYik7XG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyB0aGlzLl9jb2xsQ2xhc3MobmV3IFdoZXJlQ2xhdXNlKHRoaXMsIGluZGV4KSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdG9Db2xsZWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IHRoaXMuX2NvbGxDbGFzcyhuZXcgV2hlcmVDbGF1c2UodGhpcykpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG1hcFRvQ2xhc3M6IGZ1bmN0aW9uIChjb25zdHJ1Y3Rvciwgc3RydWN0dXJlKSB7XG4gICAgICAgICAgICAvLy8gPHN1bW1hcnk+XG4gICAgICAgICAgICAvLy8gICAgIE1hcCB0YWJsZSB0byBhIGphdmFzY3JpcHQgY29uc3RydWN0b3IgZnVuY3Rpb24uIE9iamVjdHMgcmV0dXJuZWQgZnJvbSB0aGUgZGF0YWJhc2Ugd2lsbCBiZSBpbnN0YW5jZXMgb2YgdGhpcyBjbGFzcywgbWFraW5nXG4gICAgICAgICAgICAvLy8gICAgIGl0IHBvc3NpYmxlIHRvIHRoZSBpbnN0YW5jZU9mIG9wZXJhdG9yIGFzIHdlbGwgYXMgZXh0ZW5kaW5nIHRoZSBjbGFzcyB1c2luZyBjb25zdHJ1Y3Rvci5wcm90b3R5cGUubWV0aG9kID0gZnVuY3Rpb24oKXsuLi59LlxuICAgICAgICAgICAgLy8vIDwvc3VtbWFyeT5cbiAgICAgICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cImNvbnN0cnVjdG9yXCI+Q29uc3RydWN0b3IgZnVuY3Rpb24gcmVwcmVzZW50aW5nIHRoZSBjbGFzcy48L3BhcmFtPlxuICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwic3RydWN0dXJlXCIgb3B0aW9uYWw9XCJ0cnVlXCI+SGVscHMgSURFIGNvZGUgY29tcGxldGlvbiBieSBrbm93aW5nIHRoZSBtZW1iZXJzIHRoYXQgb2JqZWN0cyBjb250YWluIGFuZCBub3QganVzdCB0aGUgaW5kZXhlcy4gQWxzb1xuICAgICAgICAgICAgLy8vIGtub3cgd2hhdCB0eXBlIGVhY2ggbWVtYmVyIGhhcy4gRXhhbXBsZToge25hbWU6IFN0cmluZywgZW1haWxBZGRyZXNzZXM6IFtTdHJpbmddLCBwYXNzd29yZH08L3BhcmFtPlxuICAgICAgICAgICAgdGhpcy5zY2hlbWEubWFwcGVkQ2xhc3MgPSBjb25zdHJ1Y3RvcjtcbiAgICAgICAgICAgIHZhciBpbnN0YW5jZVRlbXBsYXRlID0gT2JqZWN0LmNyZWF0ZShjb25zdHJ1Y3Rvci5wcm90b3R5cGUpO1xuICAgICAgICAgICAgaWYgKHN0cnVjdHVyZSkge1xuICAgICAgICAgICAgICAgIC8vIHN0cnVjdHVyZSBhbmQgaW5zdGFuY2VUZW1wbGF0ZSBpcyBmb3IgSURFIGNvZGUgY29tcGV0aW9uIG9ubHkgd2hpbGUgY29uc3RydWN0b3IucHJvdG90eXBlIGlzIGZvciBhY3R1YWwgaW5oZXJpdGFuY2UuXG4gICAgICAgICAgICAgICAgYXBwbHlTdHJ1Y3R1cmUoaW5zdGFuY2VUZW1wbGF0ZSwgc3RydWN0dXJlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2NoZW1hLmluc3RhbmNlVGVtcGxhdGUgPSBpbnN0YW5jZVRlbXBsYXRlO1xuXG4gICAgICAgICAgICAvLyBOb3csIHN1YnNjcmliZSB0byB0aGUgd2hlbihcInJlYWRpbmdcIikgZXZlbnQgdG8gbWFrZSBhbGwgb2JqZWN0cyB0aGF0IGNvbWUgb3V0IGZyb20gdGhpcyB0YWJsZSBpbmhlcml0IGZyb20gZ2l2ZW4gY2xhc3NcbiAgICAgICAgICAgIC8vIG5vIG1hdHRlciB3aGljaCBtZXRob2QgdG8gdXNlIGZvciByZWFkaW5nIChUYWJsZS5nZXQoKSBvciBUYWJsZS53aGVyZSguLi4pLi4uIClcbiAgICAgICAgICAgIHZhciByZWFkSG9vayA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgICBpZiAoIW9iaikgcmV0dXJuIG9iajsgLy8gTm8gdmFsaWQgb2JqZWN0LiAoVmFsdWUgaXMgbnVsbCkuIFJldHVybiBhcyBpcy5cbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBuZXcgb2JqZWN0IHRoYXQgZGVyaXZlcyBmcm9tIGNvbnN0cnVjdG9yOlxuICAgICAgICAgICAgICAgIHZhciByZXMgPSBPYmplY3QuY3JlYXRlKGNvbnN0cnVjdG9yLnByb3RvdHlwZSk7XG4gICAgICAgICAgICAgICAgLy8gQ2xvbmUgbWVtYmVyczpcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBtIGluIG9iaikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGFzT3duKG9iaiwgbSkpIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNbbV0gPSBvYmpbbV07XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKF8pIHt9XG4gICAgICAgICAgICAgICAgfXJldHVybiByZXM7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAodGhpcy5zY2hlbWEucmVhZEhvb2spIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhvb2sucmVhZGluZy51bnN1YnNjcmliZSh0aGlzLnNjaGVtYS5yZWFkSG9vayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNjaGVtYS5yZWFkSG9vayA9IHJlYWRIb29rO1xuICAgICAgICAgICAgdGhpcy5ob29rKFwicmVhZGluZ1wiLCByZWFkSG9vayk7XG4gICAgICAgICAgICByZXR1cm4gY29uc3RydWN0b3I7XG4gICAgICAgIH0sXG4gICAgICAgIGRlZmluZUNsYXNzOiBmdW5jdGlvbiAoc3RydWN0dXJlKSB7XG4gICAgICAgICAgICAvLy8gPHN1bW1hcnk+XG4gICAgICAgICAgICAvLy8gICAgIERlZmluZSBhbGwgbWVtYmVycyBvZiB0aGUgY2xhc3MgdGhhdCByZXByZXNlbnRzIHRoZSB0YWJsZS4gVGhpcyB3aWxsIGhlbHAgY29kZSBjb21wbGV0aW9uIG9mIHdoZW4gb2JqZWN0cyBhcmUgcmVhZCBmcm9tIHRoZSBkYXRhYmFzZVxuICAgICAgICAgICAgLy8vICAgICBhcyB3ZWxsIGFzIG1ha2luZyBpdCBwb3NzaWJsZSB0byBleHRlbmQgdGhlIHByb3RvdHlwZSBvZiB0aGUgcmV0dXJuZWQgY29uc3RydWN0b3IgZnVuY3Rpb24uXG4gICAgICAgICAgICAvLy8gPC9zdW1tYXJ5PlxuICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwic3RydWN0dXJlXCI+SGVscHMgSURFIGNvZGUgY29tcGxldGlvbiBieSBrbm93aW5nIHRoZSBtZW1iZXJzIHRoYXQgb2JqZWN0cyBjb250YWluIGFuZCBub3QganVzdCB0aGUgaW5kZXhlcy4gQWxzb1xuICAgICAgICAgICAgLy8vIGtub3cgd2hhdCB0eXBlIGVhY2ggbWVtYmVyIGhhcy4gRXhhbXBsZToge25hbWU6IFN0cmluZywgZW1haWxBZGRyZXNzZXM6IFtTdHJpbmddLCBwcm9wZXJ0aWVzOiB7c2hvZVNpemU6IE51bWJlcn19PC9wYXJhbT5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1hcFRvQ2xhc3MoRGV4aWUuZGVmaW5lQ2xhc3Moc3RydWN0dXJlKSwgc3RydWN0dXJlKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy9cbiAgICAvL1xuICAgIC8vXG4gICAgLy8gV3JpdGVhYmxlVGFibGUgQ2xhc3MgKGV4dGVuZHMgVGFibGUpXG4gICAgLy9cbiAgICAvL1xuICAgIC8vXG4gICAgZnVuY3Rpb24gV3JpdGVhYmxlVGFibGUobmFtZSwgdGFibGVTY2hlbWEsIGNvbGxDbGFzcykge1xuICAgICAgICBUYWJsZS5jYWxsKHRoaXMsIG5hbWUsIHRhYmxlU2NoZW1hLCBjb2xsQ2xhc3MgfHwgV3JpdGVhYmxlQ29sbGVjdGlvbik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gQnVsa0Vycm9ySGFuZGxlckNhdGNoQWxsKGVycm9yTGlzdCwgZG9uZSwgc3VwcG9ydEhvb2tzKSB7XG4gICAgICAgIHJldHVybiAoc3VwcG9ydEhvb2tzID8gaG9va2VkRXZlbnRSZWplY3RIYW5kbGVyIDogZXZlbnRSZWplY3RIYW5kbGVyKShmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZXJyb3JMaXN0LnB1c2goZSk7XG4gICAgICAgICAgICBkb25lICYmIGRvbmUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYnVsa0RlbGV0ZShpZGJzdG9yZSwgdHJhbnMsIGtleXNPclR1cGxlcywgaGFzRGVsZXRlSG9vaywgZGVsZXRpbmdIb29rKSB7XG4gICAgICAgIC8vIElmIGhhc0RlbGV0ZUhvb2ssIGtleXNPclR1cGxlcyBtdXN0IGJlIGFuIGFycmF5IG9mIHR1cGxlczogW1trZXkxLCB2YWx1ZTJdLFtrZXkyLHZhbHVlMl0sLi4uXSxcbiAgICAgICAgLy8gZWxzZSBrZXlzT3JUdXBsZXMgbXVzdCBiZSBqdXN0IGFuIGFycmF5IG9mIGtleXM6IFtrZXkxLCBrZXkyLCAuLi5dLlxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGxlbiA9IGtleXNPclR1cGxlcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgbGFzdEl0ZW0gPSBsZW4gLSAxO1xuICAgICAgICAgICAgaWYgKGxlbiA9PT0gMCkgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICAgIGlmICghaGFzRGVsZXRlSG9vaykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcSA9IGlkYnN0b3JlLmRlbGV0ZShrZXlzT3JUdXBsZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICByZXEub25lcnJvciA9IHdyYXAoZXZlbnRSZWplY3RIYW5kbGVyKHJlamVjdCkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gbGFzdEl0ZW0pIHJlcS5vbnN1Y2Nlc3MgPSB3cmFwKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGhvb2tDdHgsXG4gICAgICAgICAgICAgICAgICAgIGVycm9ySGFuZGxlciA9IGhvb2tlZEV2ZW50UmVqZWN0SGFuZGxlcihyZWplY3QpLFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzSGFuZGxlciA9IGhvb2tlZEV2ZW50U3VjY2Vzc0hhbmRsZXIobnVsbCk7XG4gICAgICAgICAgICAgICAgdHJ5Q2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob29rQ3R4ID0geyBvbnN1Y2Nlc3M6IG51bGwsIG9uZXJyb3I6IG51bGwgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0dXBsZSA9IGtleXNPclR1cGxlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0aW5nSG9vay5jYWxsKGhvb2tDdHgsIHR1cGxlWzBdLCB0dXBsZVsxXSwgdHJhbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcSA9IGlkYnN0b3JlLmRlbGV0ZSh0dXBsZVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXEuX2hvb2tDdHggPSBob29rQ3R4O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSBlcnJvckhhbmRsZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gbGFzdEl0ZW0pIHJlcS5vbnN1Y2Nlc3MgPSBob29rZWRFdmVudFN1Y2Nlc3NIYW5kbGVyKHJlc29sdmUpO2Vsc2UgcmVxLm9uc3VjY2VzcyA9IHN1Y2Nlc3NIYW5kbGVyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICBob29rQ3R4Lm9uZXJyb3IgJiYgaG9va0N0eC5vbmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkudW5jYXVnaHQoZGJVbmNhdWdodCk7XG4gICAgfVxuXG4gICAgZGVyaXZlKFdyaXRlYWJsZVRhYmxlKS5mcm9tKFRhYmxlKS5leHRlbmQoe1xuICAgICAgICBidWxrRGVsZXRlOiBmdW5jdGlvbiAoa2V5cyQkMSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaG9vay5kZWxldGluZy5maXJlID09PSBub3ApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faWRic3RvcmUoUkVBRFdSSVRFLCBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0LCBpZGJzdG9yZSwgdHJhbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShidWxrRGVsZXRlKGlkYnN0b3JlLCB0cmFucywga2V5cyQkMSwgZmFsc2UsIG5vcCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy53aGVyZSgnOmlkJykuYW55T2Yoa2V5cyQkMSkuZGVsZXRlKCkudGhlbihmdW5jdGlvbiAoKSB7fSk7IC8vIFJlc29sdmUgd2l0aCB1bmRlZmluZWQuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGJ1bGtQdXQ6IGZ1bmN0aW9uIChvYmplY3RzLCBrZXlzJCQxKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faWRic3RvcmUoUkVBRFdSSVRFLCBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0LCBpZGJzdG9yZSkge1xuICAgICAgICAgICAgICAgIGlmICghaWRic3RvcmUua2V5UGF0aCAmJiAhX3RoaXMuc2NoZW1hLnByaW1LZXkuYXV0byAmJiAha2V5cyQkMSkgdGhyb3cgbmV3IGV4Y2VwdGlvbnMuSW52YWxpZEFyZ3VtZW50KFwiYnVsa1B1dCgpIHdpdGggbm9uLWluYm91bmQga2V5cyByZXF1aXJlcyBrZXlzIGFycmF5IGluIHNlY29uZCBhcmd1bWVudFwiKTtcbiAgICAgICAgICAgICAgICBpZiAoaWRic3RvcmUua2V5UGF0aCAmJiBrZXlzJCQxKSB0aHJvdyBuZXcgZXhjZXB0aW9ucy5JbnZhbGlkQXJndW1lbnQoXCJidWxrUHV0KCk6IGtleXMgYXJndW1lbnQgaW52YWxpZCBvbiB0YWJsZXMgd2l0aCBpbmJvdW5kIGtleXNcIik7XG4gICAgICAgICAgICAgICAgaWYgKGtleXMkJDEgJiYga2V5cyQkMS5sZW5ndGggIT09IG9iamVjdHMubGVuZ3RoKSB0aHJvdyBuZXcgZXhjZXB0aW9ucy5JbnZhbGlkQXJndW1lbnQoXCJBcmd1bWVudHMgb2JqZWN0cyBhbmQga2V5cyBtdXN0IGhhdmUgdGhlIHNhbWUgbGVuZ3RoXCIpO1xuICAgICAgICAgICAgICAgIGlmIChvYmplY3RzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHJlc29sdmUoKTsgLy8gQ2FsbGVyIHByb3ZpZGVkIGVtcHR5IGxpc3QuXG4gICAgICAgICAgICAgICAgdmFyIGRvbmUgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvckxpc3QubGVuZ3RoID09PSAwKSByZXNvbHZlKHJlc3VsdCk7ZWxzZSByZWplY3QobmV3IEJ1bGtFcnJvcihfdGhpcy5uYW1lICsgJy5idWxrUHV0KCk6ICcgKyBlcnJvckxpc3QubGVuZ3RoICsgJyBvZiAnICsgbnVtT2JqcyArICcgb3BlcmF0aW9ucyBmYWlsZWQnLCBlcnJvckxpc3QpKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciByZXEsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yTGlzdCA9IFtdLFxuICAgICAgICAgICAgICAgICAgICBlcnJvckhhbmRsZXIsXG4gICAgICAgICAgICAgICAgICAgIG51bU9ianMgPSBvYmplY3RzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgdGFibGUgPSBfdGhpcztcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaG9vay5jcmVhdGluZy5maXJlID09PSBub3AgJiYgX3RoaXMuaG9vay51cGRhdGluZy5maXJlID09PSBub3ApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gU3RhbmRhcmQgQnVsayAobm8gJ2NyZWF0aW5nJyBvciAndXBkYXRpbmcnIGhvb2tzIHRvIGNhcmUgYWJvdXQpXG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgIGVycm9ySGFuZGxlciA9IEJ1bGtFcnJvckhhbmRsZXJDYXRjaEFsbChlcnJvckxpc3QpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IG9iamVjdHMubGVuZ3RoOyBpIDwgbDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXEgPSBrZXlzJCQxID8gaWRic3RvcmUucHV0KG9iamVjdHNbaV0sIGtleXMkJDFbaV0pIDogaWRic3RvcmUucHV0KG9iamVjdHNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSBlcnJvckhhbmRsZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gT25seSBuZWVkIHRvIGNhdGNoIHN1Y2Nlc3Mgb3IgZXJyb3Igb24gdGhlIGxhc3Qgb3BlcmF0aW9uXG4gICAgICAgICAgICAgICAgICAgIC8vIGFjY29yZGluZyB0byB0aGUgSURCIHNwZWMuXG4gICAgICAgICAgICAgICAgICAgIHJlcS5vbmVycm9yID0gQnVsa0Vycm9ySGFuZGxlckNhdGNoQWxsKGVycm9yTGlzdCwgZG9uZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlcS5vbnN1Y2Nlc3MgPSBldmVudFN1Y2Nlc3NIYW5kbGVyKGRvbmUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlZmZlY3RpdmVLZXlzID0ga2V5cyQkMSB8fCBpZGJzdG9yZS5rZXlQYXRoICYmIG9iamVjdHMubWFwKGZ1bmN0aW9uIChvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0QnlLZXlQYXRoKG8sIGlkYnN0b3JlLmtleVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gR2VuZXJhdGUgbWFwIG9mIHtba2V5XTogb2JqZWN0fVxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0TG9va3VwID0gZWZmZWN0aXZlS2V5cyAmJiBhcnJheVRvT2JqZWN0KGVmZmVjdGl2ZUtleXMsIGZ1bmN0aW9uIChrZXksIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrZXkgIT0gbnVsbCAmJiBba2V5LCBvYmplY3RzW2ldXTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gIWVmZmVjdGl2ZUtleXMgP1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEF1dG8taW5jcmVtZW50ZWQga2V5LWxlc3Mgb2JqZWN0cyBvbmx5IHdpdGhvdXQgYW55IGtleXMgYXJndW1lbnQuXG4gICAgICAgICAgICAgICAgICAgIHRhYmxlLmJ1bGtBZGQob2JqZWN0cykgOlxuXG4gICAgICAgICAgICAgICAgICAgIC8vIEtleXMgcHJvdmlkZWQuIEVpdGhlciBhcyBpbmJvdW5kIGluIHByb3ZpZGVkIG9iamVjdHMsIG9yIGFzIGEga2V5cyBhcmd1bWVudC5cbiAgICAgICAgICAgICAgICAgICAgLy8gQmVnaW4gd2l0aCB1cGRhdGluZyB0aG9zZSB0aGF0IGV4aXN0cyBpbiBEQjpcbiAgICAgICAgICAgICAgICAgICAgdGFibGUud2hlcmUoJzppZCcpLmFueU9mKGVmZmVjdGl2ZUtleXMuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrZXkgIT0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfSkpLm1vZGlmeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gb2JqZWN0TG9va3VwW3RoaXMucHJpbUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RMb29rdXBbdGhpcy5wcmltS2V5XSA9IG51bGw7IC8vIE1hcmsgYXMgXCJkb24ndCBhZGQgdGhpc1wiXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKE1vZGlmeUVycm9yLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JMaXN0ID0gZS5mYWlsdXJlczsgLy8gTm8gbmVlZCB0byBjb25jYXQgaGVyZS4gVGhlc2UgYXJlIHRoZSBmaXJzdCBlcnJvcnMgYWRkZWQuXG4gICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm93LCBsZXQncyBleGFtaW5lIHdoaWNoIGl0ZW1zIGRpZG50IGV4aXN0IHNvIHdlIGNhbiBhZGQgdGhlbTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmpzVG9BZGQgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzVG9BZGQgPSBrZXlzJCQxICYmIFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSXRlcmF0ZSBiYWNrd2FyZHMuIFdoeT8gQmVjYXVzZSBpZiBzYW1lIGtleSB3YXMgdXNlZCB0d2ljZSwganVzdCBhZGQgdGhlIGxhc3Qgb25lLlxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IGVmZmVjdGl2ZUtleXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gZWZmZWN0aXZlS2V5c1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09IG51bGwgfHwgb2JqZWN0TG9va3VwW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Jqc1RvQWRkLnB1c2gob2JqZWN0c1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleXMkJDEgJiYga2V5c1RvQWRkLnB1c2goa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtleSAhPSBudWxsKSBvYmplY3RMb29rdXBba2V5XSA9IG51bGw7IC8vIE1hcmsgYXMgXCJkb250IGFkZCBhZ2FpblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGl0ZW1zIGFyZSBpbiByZXZlcnNlIG9yZGVyIHNvIHJldmVyc2UgdGhlbSBiZWZvcmUgYWRkaW5nLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ291bGQgYmUgaW1wb3J0YW50IGluIG9yZGVyIHRvIGdldCBhdXRvLWluY3JlbWVudGVkIGtleXMgdGhlIHdheSB0aGUgY2FsbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3b3VsZCBleHBlY3QuIENvdWxkIGhhdmUgdXNlZCB1bnNoaWZ0IGluc3RlYWQgb2YgcHVzaCgpL3JldmVyc2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dDogaHR0cDovL2pzcGVyZi5jb20vdW5zaGlmdC12cy1yZXZlcnNlXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmpzVG9BZGQucmV2ZXJzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAga2V5cyQkMSAmJiBrZXlzVG9BZGQucmV2ZXJzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhYmxlLmJ1bGtBZGQob2Jqc1RvQWRkLCBrZXlzVG9BZGQpO1xuICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChsYXN0QWRkZWRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlc29sdmUgd2l0aCBrZXkgb2YgdGhlIGxhc3Qgb2JqZWN0IGluIGdpdmVuIGFyZ3VtZW50cyB0byBidWxrUHV0KCk6XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdEVmZmVjdGl2ZUtleSA9IGVmZmVjdGl2ZUtleXNbZWZmZWN0aXZlS2V5cy5sZW5ndGggLSAxXTsgLy8gS2V5IHdhcyBwcm92aWRlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsYXN0RWZmZWN0aXZlS2V5ICE9IG51bGwgPyBsYXN0RWZmZWN0aXZlS2V5IDogbGFzdEFkZGVkS2V5O1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4oZG9uZSkuY2F0Y2goQnVsa0Vycm9yLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29uY2F0IGZhaWx1cmUgZnJvbSBNb2RpZnlFcnJvciBhbmQgcmVqZWN0IHVzaW5nIG91ciAnZG9uZScgbWV0aG9kLlxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JMaXN0ID0gZXJyb3JMaXN0LmNvbmNhdChlLmZhaWx1cmVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2gocmVqZWN0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBcImxvY2tlZFwiKTsgLy8gSWYgY2FsbGVkIGZyb20gdHJhbnNhY3Rpb24gc2NvcGUsIGxvY2sgdHJhbnNhY3Rpb24gdGlsIGFsbCBzdGVwcyBhcmUgZG9uZS5cbiAgICAgICAgfSxcbiAgICAgICAgYnVsa0FkZDogZnVuY3Rpb24gKG9iamVjdHMsIGtleXMkJDEpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcyxcbiAgICAgICAgICAgICAgICBjcmVhdGluZ0hvb2sgPSB0aGlzLmhvb2suY3JlYXRpbmcuZmlyZTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pZGJzdG9yZShSRUFEV1JJVEUsIGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlLCB0cmFucykge1xuICAgICAgICAgICAgICAgIGlmICghaWRic3RvcmUua2V5UGF0aCAmJiAhc2VsZi5zY2hlbWEucHJpbUtleS5hdXRvICYmICFrZXlzJCQxKSB0aHJvdyBuZXcgZXhjZXB0aW9ucy5JbnZhbGlkQXJndW1lbnQoXCJidWxrQWRkKCkgd2l0aCBub24taW5ib3VuZCBrZXlzIHJlcXVpcmVzIGtleXMgYXJyYXkgaW4gc2Vjb25kIGFyZ3VtZW50XCIpO1xuICAgICAgICAgICAgICAgIGlmIChpZGJzdG9yZS5rZXlQYXRoICYmIGtleXMkJDEpIHRocm93IG5ldyBleGNlcHRpb25zLkludmFsaWRBcmd1bWVudChcImJ1bGtBZGQoKToga2V5cyBhcmd1bWVudCBpbnZhbGlkIG9uIHRhYmxlcyB3aXRoIGluYm91bmQga2V5c1wiKTtcbiAgICAgICAgICAgICAgICBpZiAoa2V5cyQkMSAmJiBrZXlzJCQxLmxlbmd0aCAhPT0gb2JqZWN0cy5sZW5ndGgpIHRocm93IG5ldyBleGNlcHRpb25zLkludmFsaWRBcmd1bWVudChcIkFyZ3VtZW50cyBvYmplY3RzIGFuZCBrZXlzIG11c3QgaGF2ZSB0aGUgc2FtZSBsZW5ndGhcIik7XG4gICAgICAgICAgICAgICAgaWYgKG9iamVjdHMubGVuZ3RoID09PSAwKSByZXR1cm4gcmVzb2x2ZSgpOyAvLyBDYWxsZXIgcHJvdmlkZWQgZW1wdHkgbGlzdC5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkb25lKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3JMaXN0Lmxlbmd0aCA9PT0gMCkgcmVzb2x2ZShyZXN1bHQpO2Vsc2UgcmVqZWN0KG5ldyBCdWxrRXJyb3Ioc2VsZi5uYW1lICsgJy5idWxrQWRkKCk6ICcgKyBlcnJvckxpc3QubGVuZ3RoICsgJyBvZiAnICsgbnVtT2JqcyArICcgb3BlcmF0aW9ucyBmYWlsZWQnLCBlcnJvckxpc3QpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJlcSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JMaXN0ID0gW10sXG4gICAgICAgICAgICAgICAgICAgIGVycm9ySGFuZGxlcixcbiAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc0hhbmRsZXIsXG4gICAgICAgICAgICAgICAgICAgIG51bU9ianMgPSBvYmplY3RzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBpZiAoY3JlYXRpbmdIb29rICE9PSBub3ApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUgYXJlIHN1YnNjcmliZXJzIHRvIGhvb2soJ2NyZWF0aW5nJylcbiAgICAgICAgICAgICAgICAgICAgLy8gTXVzdCBiZWhhdmUgYXMgZG9jdW1lbnRlZC5cbiAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleVBhdGggPSBpZGJzdG9yZS5rZXlQYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgaG9va0N0eDtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JIYW5kbGVyID0gQnVsa0Vycm9ySGFuZGxlckNhdGNoQWxsKGVycm9yTGlzdCwgbnVsbCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NIYW5kbGVyID0gaG9va2VkRXZlbnRTdWNjZXNzSGFuZGxlcihudWxsKTtcblxuICAgICAgICAgICAgICAgICAgICB0cnlDYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IG9iamVjdHMubGVuZ3RoOyBpIDwgbDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9va0N0eCA9IHsgb25lcnJvcjogbnVsbCwgb25zdWNjZXNzOiBudWxsIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IGtleXMkJDEgJiYga2V5cyQkMVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gb2JqZWN0c1tpXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWZmZWN0aXZlS2V5ID0ga2V5cyQkMSA/IGtleSA6IGtleVBhdGggPyBnZXRCeUtleVBhdGgob2JqLCBrZXlQYXRoKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5VG9Vc2UgPSBjcmVhdGluZ0hvb2suY2FsbChob29rQ3R4LCBlZmZlY3RpdmVLZXksIG9iaiwgdHJhbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZmZlY3RpdmVLZXkgPT0gbnVsbCAmJiBrZXlUb1VzZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXlQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmogPSBkZWVwQ2xvbmUob2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEJ5S2V5UGF0aChvYmosIGtleVBhdGgsIGtleVRvVXNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleSA9IGtleVRvVXNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcSA9IGtleSAhPSBudWxsID8gaWRic3RvcmUuYWRkKG9iaiwga2V5KSA6IGlkYnN0b3JlLmFkZChvYmopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5faG9va0N0eCA9IGhvb2tDdHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCBsIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXEub25lcnJvciA9IGVycm9ySGFuZGxlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhvb2tDdHgub25zdWNjZXNzKSByZXEub25zdWNjZXNzID0gc3VjY2Vzc0hhbmRsZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBob29rQ3R4Lm9uZXJyb3IgJiYgaG9va0N0eC5vbmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJlcS5vbmVycm9yID0gQnVsa0Vycm9ySGFuZGxlckNhdGNoQWxsKGVycm9yTGlzdCwgZG9uZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlcS5vbnN1Y2Nlc3MgPSBob29rZWRFdmVudFN1Y2Nlc3NIYW5kbGVyKGRvbmUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgIC8vIFN0YW5kYXJkIEJ1bGsgKG5vICdjcmVhdGluZycgaG9vayB0byBjYXJlIGFib3V0KVxuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICBlcnJvckhhbmRsZXIgPSBCdWxrRXJyb3JIYW5kbGVyQ2F0Y2hBbGwoZXJyb3JMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBvYmplY3RzLmxlbmd0aDsgaSA8IGw7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVxID0ga2V5cyQkMSA/IGlkYnN0b3JlLmFkZChvYmplY3RzW2ldLCBrZXlzJCQxW2ldKSA6IGlkYnN0b3JlLmFkZChvYmplY3RzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5vbmVycm9yID0gZXJyb3JIYW5kbGVyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgbmVlZCB0byBjYXRjaCBzdWNjZXNzIG9yIGVycm9yIG9uIHRoZSBsYXN0IG9wZXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAvLyBhY2NvcmRpbmcgdG8gdGhlIElEQiBzcGVjLlxuICAgICAgICAgICAgICAgICAgICByZXEub25lcnJvciA9IEJ1bGtFcnJvckhhbmRsZXJDYXRjaEFsbChlcnJvckxpc3QsIGRvbmUpO1xuICAgICAgICAgICAgICAgICAgICByZXEub25zdWNjZXNzID0gZXZlbnRTdWNjZXNzSGFuZGxlcihkb25lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgYWRkOiBmdW5jdGlvbiAob2JqLCBrZXkpIHtcbiAgICAgICAgICAgIC8vLyA8c3VtbWFyeT5cbiAgICAgICAgICAgIC8vLyAgIEFkZCBhbiBvYmplY3QgdG8gdGhlIGRhdGFiYXNlLiBJbiBjYXNlIGFuIG9iamVjdCB3aXRoIHNhbWUgcHJpbWFyeSBrZXkgYWxyZWFkeSBleGlzdHMsIHRoZSBvYmplY3Qgd2lsbCBub3QgYmUgYWRkZWQuXG4gICAgICAgICAgICAvLy8gPC9zdW1tYXJ5PlxuICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwib2JqXCIgdHlwZT1cIk9iamVjdFwiPkEgamF2YXNjcmlwdCBvYmplY3QgdG8gaW5zZXJ0PC9wYXJhbT5cbiAgICAgICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cImtleVwiIG9wdGlvbmFsPVwidHJ1ZVwiPlByaW1hcnkga2V5PC9wYXJhbT5cbiAgICAgICAgICAgIHZhciBjcmVhdGluZ0hvb2sgPSB0aGlzLmhvb2suY3JlYXRpbmcuZmlyZTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pZGJzdG9yZShSRUFEV1JJVEUsIGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlLCB0cmFucykge1xuICAgICAgICAgICAgICAgIHZhciBob29rQ3R4ID0geyBvbnN1Y2Nlc3M6IG51bGwsIG9uZXJyb3I6IG51bGwgfTtcbiAgICAgICAgICAgICAgICBpZiAoY3JlYXRpbmdIb29rICE9PSBub3ApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVmZmVjdGl2ZUtleSA9IGtleSAhPSBudWxsID8ga2V5IDogaWRic3RvcmUua2V5UGF0aCA/IGdldEJ5S2V5UGF0aChvYmosIGlkYnN0b3JlLmtleVBhdGgpIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICB2YXIga2V5VG9Vc2UgPSBjcmVhdGluZ0hvb2suY2FsbChob29rQ3R4LCBlZmZlY3RpdmVLZXksIG9iaiwgdHJhbnMpOyAvLyBBbGxvdyBzdWJzY3JpYmVycyB0byB3aGVuKFwiY3JlYXRpbmdcIikgdG8gZ2VuZXJhdGUgdGhlIGtleS5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGVmZmVjdGl2ZUtleSA9PSBudWxsICYmIGtleVRvVXNlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzaW5nIFwiPT1cIiBhbmQgXCIhPVwiIHRvIGNoZWNrIGZvciBlaXRoZXIgbnVsbCBvciB1bmRlZmluZWQhXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRic3RvcmUua2V5UGF0aCkgc2V0QnlLZXlQYXRoKG9iaiwgaWRic3RvcmUua2V5UGF0aCwga2V5VG9Vc2UpO2Vsc2Uga2V5ID0ga2V5VG9Vc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcSA9IGtleSAhPSBudWxsID8gaWRic3RvcmUuYWRkKG9iaiwga2V5KSA6IGlkYnN0b3JlLmFkZChvYmopO1xuICAgICAgICAgICAgICAgICAgICByZXEuX2hvb2tDdHggPSBob29rQ3R4O1xuICAgICAgICAgICAgICAgICAgICByZXEub25lcnJvciA9IGhvb2tlZEV2ZW50UmVqZWN0SGFuZGxlcihyZWplY3QpO1xuICAgICAgICAgICAgICAgICAgICByZXEub25zdWNjZXNzID0gaG9va2VkRXZlbnRTdWNjZXNzSGFuZGxlcihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBSZW1vdmUgdGhlc2UgdHdvIGxpbmVzIGluIG5leHQgbWFqb3IgcmVsZWFzZSAoMi4wPylcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEl0J3Mgbm8gZ29vZCBwcmFjdGljZSB0byBoYXZlIHNpZGUgZWZmZWN0cyBvbiBwcm92aWRlZCBwYXJhbWV0ZXJzXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5UGF0aCA9IGlkYnN0b3JlLmtleVBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5UGF0aCkgc2V0QnlLZXlQYXRoKG9iaiwga2V5UGF0aCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaG9va0N0eC5vbmVycm9yKSBob29rQ3R4Lm9uZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcHV0OiBmdW5jdGlvbiAob2JqLCBrZXkpIHtcbiAgICAgICAgICAgIC8vLyA8c3VtbWFyeT5cbiAgICAgICAgICAgIC8vLyAgIEFkZCBhbiBvYmplY3QgdG8gdGhlIGRhdGFiYXNlIGJ1dCBpbiBjYXNlIGFuIG9iamVjdCB3aXRoIHNhbWUgcHJpbWFyeSBrZXkgYWxyZWFkIGV4aXN0cywgdGhlIGV4aXN0aW5nIG9uZSB3aWxsIGdldCB1cGRhdGVkLlxuICAgICAgICAgICAgLy8vIDwvc3VtbWFyeT5cbiAgICAgICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cIm9ialwiIHR5cGU9XCJPYmplY3RcIj5BIGphdmFzY3JpcHQgb2JqZWN0IHRvIGluc2VydCBvciB1cGRhdGU8L3BhcmFtPlxuICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwia2V5XCIgb3B0aW9uYWw9XCJ0cnVlXCI+UHJpbWFyeSBrZXk8L3BhcmFtPlxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgICAgICAgICAgIGNyZWF0aW5nSG9vayA9IHRoaXMuaG9vay5jcmVhdGluZy5maXJlLFxuICAgICAgICAgICAgICAgIHVwZGF0aW5nSG9vayA9IHRoaXMuaG9vay51cGRhdGluZy5maXJlO1xuICAgICAgICAgICAgaWYgKGNyZWF0aW5nSG9vayAhPT0gbm9wIHx8IHVwZGF0aW5nSG9vayAhPT0gbm9wKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyBQZW9wbGUgbGlzdGVucyB0byB3aGVuKFwiY3JlYXRpbmdcIikgb3Igd2hlbihcInVwZGF0aW5nXCIpIGV2ZW50cyFcbiAgICAgICAgICAgICAgICAvLyBXZSBtdXN0IGtub3cgd2hldGhlciB0aGUgcHV0IG9wZXJhdGlvbiByZXN1bHRzIGluIGFuIENSRUFURSBvciBVUERBVEUuXG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdHJhbnMoUkVBRFdSSVRFLCBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0LCB0cmFucykge1xuICAgICAgICAgICAgICAgICAgICAvLyBTaW5jZSBrZXkgaXMgb3B0aW9uYWwsIG1ha2Ugc3VyZSB3ZSBnZXQgaXQgZnJvbSBvYmogaWYgbm90IHByb3ZpZGVkXG4gICAgICAgICAgICAgICAgICAgIHZhciBlZmZlY3RpdmVLZXkgPSBrZXkgIT09IHVuZGVmaW5lZCA/IGtleSA6IHNlbGYuc2NoZW1hLnByaW1LZXkua2V5UGF0aCAmJiBnZXRCeUtleVBhdGgob2JqLCBzZWxmLnNjaGVtYS5wcmltS2V5LmtleVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZWZmZWN0aXZlS2V5ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFwiPT0gbnVsbFwiIG1lYW5zIGNoZWNraW5nIGZvciBlaXRoZXIgbnVsbCBvciB1bmRlZmluZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBObyBwcmltYXJ5IGtleS4gTXVzdCB1c2UgYWRkKCkuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFkZChvYmopLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFByaW1hcnkga2V5IGV4aXN0LiBMb2NrIHRyYW5zYWN0aW9uIGFuZCB0cnkgbW9kaWZ5aW5nIGV4aXN0aW5nLiBJZiBub3RoaW5nIG1vZGlmaWVkLCBjYWxsIGFkZCgpLlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnMuX2xvY2soKTsgLy8gTmVlZGVkIGJlY2F1c2Ugb3BlcmF0aW9uIGlzIHNwbGl0dGVkIGludG8gbW9kaWZ5KCkgYW5kIGFkZCgpLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xvbmUgb2JqIGJlZm9yZSB0aGlzIGFzeW5jIGNhbGwuIElmIGNhbGxlciBtb2RpZmllcyBvYmogdGhlIGxpbmUgYWZ0ZXIgcHV0KCksIHRoZSBJREIgc3BlYyByZXF1aXJlcyB0aGF0IGl0IHNob3VsZCBub3QgYWZmZWN0IG9wZXJhdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgICAgIG9iaiA9IGRlZXBDbG9uZShvYmopO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi53aGVyZShcIjppZFwiKS5lcXVhbHMoZWZmZWN0aXZlS2V5KS5tb2RpZnkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgZXh0aXN0aW5nIHZhbHVlIHdpdGggb3VyIG9iamVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENSVUQgZXZlbnQgZmlyaW5nIGhhbmRsZWQgaW4gV3JpdGVhYmxlQ29sbGVjdGlvbi5tb2RpZnkoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBvYmo7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChjb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPYmplY3QncyBrZXkgd2FzIG5vdCBmb3VuZC4gQWRkIHRoZSBvYmplY3QgaW5zdGVhZC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ1JVRCBldmVudCBmaXJpbmcgd2lsbCBiZSBkb25lIGluIGFkZCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmFkZChvYmosIGtleSk7IC8vIFJlc29sdmluZyB3aXRoIGFub3RoZXIgUHJvbWlzZS4gUmV0dXJuZWQgUHJvbWlzZSB3aWxsIHRoZW4gcmVzb2x2ZSB3aXRoIHRoZSBuZXcga2V5LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlZmZlY3RpdmVLZXk7IC8vIFJlc29sdmUgd2l0aCB0aGUgcHJvdmlkZWQga2V5LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zLl91bmxvY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBVc2UgdGhlIHN0YW5kYXJkIElEQiBwdXQoKSBtZXRob2QuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lkYnN0b3JlKFJFQURXUklURSwgZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCwgaWRic3RvcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcSA9IGtleSAhPT0gdW5kZWZpbmVkID8gaWRic3RvcmUucHV0KG9iaiwga2V5KSA6IGlkYnN0b3JlLnB1dChvYmopO1xuICAgICAgICAgICAgICAgICAgICByZXEub25lcnJvciA9IGV2ZW50UmVqZWN0SGFuZGxlcihyZWplY3QpO1xuICAgICAgICAgICAgICAgICAgICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5UGF0aCA9IGlkYnN0b3JlLmtleVBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5UGF0aCkgc2V0QnlLZXlQYXRoKG9iaiwga2V5UGF0aCwgZXYudGFyZ2V0LnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlcS5yZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgICdkZWxldGUnOiBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJrZXlcIj5QcmltYXJ5IGtleSBvZiB0aGUgb2JqZWN0IHRvIGRlbGV0ZTwvcGFyYW0+XG4gICAgICAgICAgICBpZiAodGhpcy5ob29rLmRlbGV0aW5nLnN1YnNjcmliZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIC8vIFBlb3BsZSBsaXN0ZW5zIHRvIHdoZW4oXCJkZWxldGluZ1wiKSBldmVudC4gTXVzdCBpbXBsZW1lbnQgZGVsZXRlIHVzaW5nIFdyaXRlYWJsZUNvbGxlY3Rpb24uZGVsZXRlKCkgdGhhdCB3aWxsXG4gICAgICAgICAgICAgICAgLy8gY2FsbCB0aGUgQ1JVRCBldmVudC4gT25seSBXcml0ZWFibGVDb2xsZWN0aW9uLmRlbGV0ZSgpIHdpbGwga25vdyB3aGV0aGVyIGFuIG9iamVjdCB3YXMgYWN0dWFsbHkgZGVsZXRlZC5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy53aGVyZShcIjppZFwiKS5lcXVhbHMoa2V5KS5kZWxldGUoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gTm8gb25lIGxpc3RlbnMuIFVzZSBzdGFuZGFyZCBJREIgZGVsZXRlKCkgbWV0aG9kLlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pZGJzdG9yZShSRUFEV1JJVEUsIGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXEgPSBpZGJzdG9yZS5kZWxldGUoa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSBldmVudFJlamVjdEhhbmRsZXIocmVqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgcmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVxLnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgY2xlYXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmhvb2suZGVsZXRpbmcuc3Vic2NyaWJlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8gUGVvcGxlIGxpc3RlbnMgdG8gd2hlbihcImRlbGV0aW5nXCIpIGV2ZW50LiBNdXN0IGltcGxlbWVudCBkZWxldGUgdXNpbmcgV3JpdGVhYmxlQ29sbGVjdGlvbi5kZWxldGUoKSB0aGF0IHdpbGxcbiAgICAgICAgICAgICAgICAvLyBjYWxsIHRoZSBDUlVEIGV2ZW50LiBPbmx5IFdyaXRlYWJsZUNvbGxlY3Rpb24uZGVsZXRlKCkgd2lsbCBrbm93cyB3aGljaCBvYmplY3RzIHRoYXQgYXJlIGFjdHVhbGx5IGRlbGV0ZWQuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9Db2xsZWN0aW9uKCkuZGVsZXRlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pZGJzdG9yZShSRUFEV1JJVEUsIGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXEgPSBpZGJzdG9yZS5jbGVhcigpO1xuICAgICAgICAgICAgICAgICAgICByZXEub25lcnJvciA9IGV2ZW50UmVqZWN0SGFuZGxlcihyZWplY3QpO1xuICAgICAgICAgICAgICAgICAgICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXEucmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uIChrZXlPck9iamVjdCwgbW9kaWZpY2F0aW9ucykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBtb2RpZmljYXRpb25zICE9PSAnb2JqZWN0JyB8fCBpc0FycmF5KG1vZGlmaWNhdGlvbnMpKSB0aHJvdyBuZXcgZXhjZXB0aW9ucy5JbnZhbGlkQXJndW1lbnQoXCJNb2RpZmljYXRpb25zIG11c3QgYmUgYW4gb2JqZWN0LlwiKTtcbiAgICAgICAgICAgIGlmICh0eXBlb2Yga2V5T3JPYmplY3QgPT09ICdvYmplY3QnICYmICFpc0FycmF5KGtleU9yT2JqZWN0KSkge1xuICAgICAgICAgICAgICAgIC8vIG9iamVjdCB0byBtb2RpZnkuIEFsc28gbW9kaWZ5IGdpdmVuIG9iamVjdCB3aXRoIHRoZSBtb2RpZmljYXRpb25zOlxuICAgICAgICAgICAgICAgIGtleXMobW9kaWZpY2F0aW9ucykuZm9yRWFjaChmdW5jdGlvbiAoa2V5UGF0aCkge1xuICAgICAgICAgICAgICAgICAgICBzZXRCeUtleVBhdGgoa2V5T3JPYmplY3QsIGtleVBhdGgsIG1vZGlmaWNhdGlvbnNba2V5UGF0aF0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBnZXRCeUtleVBhdGgoa2V5T3JPYmplY3QsIHRoaXMuc2NoZW1hLnByaW1LZXkua2V5UGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gcmVqZWN0aW9uKG5ldyBleGNlcHRpb25zLkludmFsaWRBcmd1bWVudChcIkdpdmVuIG9iamVjdCBkb2VzIG5vdCBjb250YWluIGl0cyBwcmltYXJ5IGtleVwiKSwgZGJVbmNhdWdodCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMud2hlcmUoXCI6aWRcIikuZXF1YWxzKGtleSkubW9kaWZ5KG1vZGlmaWNhdGlvbnMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBrZXkgdG8gbW9kaWZ5XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMud2hlcmUoXCI6aWRcIikuZXF1YWxzKGtleU9yT2JqZWN0KS5tb2RpZnkobW9kaWZpY2F0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vXG4gICAgLy9cbiAgICAvL1xuICAgIC8vIFRyYW5zYWN0aW9uIENsYXNzXG4gICAgLy9cbiAgICAvL1xuICAgIC8vXG4gICAgZnVuY3Rpb24gVHJhbnNhY3Rpb24obW9kZSwgc3RvcmVOYW1lcywgZGJzY2hlbWEsIHBhcmVudCkge1xuICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAvLy8gPHN1bW1hcnk+XG4gICAgICAgIC8vLyAgICBUcmFuc2FjdGlvbiBjbGFzcy4gUmVwcmVzZW50cyBhIGRhdGFiYXNlIHRyYW5zYWN0aW9uLiBBbGwgb3BlcmF0aW9ucyBvbiBkYiBnb2VzIHRocm91Z2ggYSBUcmFuc2FjdGlvbi5cbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwibW9kZVwiIHR5cGU9XCJTdHJpbmdcIj5Bbnkgb2YgXCJyZWFkd3JpdGVcIiBvciBcInJlYWRvbmx5XCI8L3BhcmFtPlxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJzdG9yZU5hbWVzXCIgdHlwZT1cIkFycmF5XCI+QXJyYXkgb2YgdGFibGUgbmFtZXMgdG8gb3BlcmF0ZSBvbjwvcGFyYW0+XG4gICAgICAgIHRoaXMuZGIgPSBkYjtcbiAgICAgICAgdGhpcy5tb2RlID0gbW9kZTtcbiAgICAgICAgdGhpcy5zdG9yZU5hbWVzID0gc3RvcmVOYW1lcztcbiAgICAgICAgdGhpcy5pZGJ0cmFucyA9IG51bGw7XG4gICAgICAgIHRoaXMub24gPSBFdmVudHModGhpcywgXCJjb21wbGV0ZVwiLCBcImVycm9yXCIsIFwiYWJvcnRcIik7XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50IHx8IG51bGw7XG4gICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fdGFibGVzID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcmVjdWxvY2sgPSAwO1xuICAgICAgICB0aGlzLl9ibG9ja2VkRnVuY3MgPSBbXTtcbiAgICAgICAgdGhpcy5fcHNkID0gbnVsbDtcbiAgICAgICAgdGhpcy5fZGJzY2hlbWEgPSBkYnNjaGVtYTtcbiAgICAgICAgdGhpcy5fcmVzb2x2ZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3JlamVjdCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2NvbXBsZXRpb24gPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBfdGhpczIuX3Jlc29sdmUgPSByZXNvbHZlO1xuICAgICAgICAgICAgX3RoaXMyLl9yZWplY3QgPSByZWplY3Q7XG4gICAgICAgIH0pLnVuY2F1Z2h0KGRiVW5jYXVnaHQpO1xuXG4gICAgICAgIHRoaXMuX2NvbXBsZXRpb24udGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpczIub24uY29tcGxldGUuZmlyZSgpO1xuICAgICAgICB9LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgX3RoaXMyLm9uLmVycm9yLmZpcmUoZSk7XG4gICAgICAgICAgICBfdGhpczIucGFyZW50ID8gX3RoaXMyLnBhcmVudC5fcmVqZWN0KGUpIDogX3RoaXMyLmFjdGl2ZSAmJiBfdGhpczIuaWRidHJhbnMgJiYgX3RoaXMyLmlkYnRyYW5zLmFib3J0KCk7XG4gICAgICAgICAgICBfdGhpczIuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm4gcmVqZWN0aW9uKGUpOyAvLyBJbmRpY2F0ZSB3ZSBhY3R1YWxseSBETyBOT1QgY2F0Y2ggdGhpcyBlcnJvci5cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJvcHMoVHJhbnNhY3Rpb24ucHJvdG90eXBlLCB7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIFRyYW5zYWN0aW9uIFByb3RlY3RlZCBNZXRob2RzIChub3QgcmVxdWlyZWQgYnkgQVBJIHVzZXJzLCBidXQgbmVlZGVkIGludGVybmFsbHkgYW5kIGV2ZW50dWFsbHkgYnkgZGV4aWUgZXh0ZW5zaW9ucylcbiAgICAgICAgLy9cbiAgICAgICAgX2xvY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGFzc2VydCghUFNELmdsb2JhbCk7IC8vIExvY2tpbmcgYW5kIHVubG9ja2luZyByZXVpcmVzIHRvIGJlIHdpdGhpbiBhIFBTRCBzY29wZS5cbiAgICAgICAgICAgIC8vIFRlbXBvcmFyeSBzZXQgYWxsIHJlcXVlc3RzIGludG8gYSBwZW5kaW5nIHF1ZXVlIGlmIHRoZXkgYXJlIGNhbGxlZCBiZWZvcmUgZGF0YWJhc2UgaXMgcmVhZHkuXG4gICAgICAgICAgICArK3RoaXMuX3JlY3Vsb2NrOyAvLyBSZWN1cnNpdmUgcmVhZC93cml0ZSBsb2NrIHBhdHRlcm4gdXNpbmcgUFNEIChQcm9taXNlIFNwZWNpZmljIERhdGEpIGluc3RlYWQgb2YgVExTIChUaHJlYWQgTG9jYWwgU3RvcmFnZSlcbiAgICAgICAgICAgIGlmICh0aGlzLl9yZWN1bG9jayA9PT0gMSAmJiAhUFNELmdsb2JhbCkgUFNELmxvY2tPd25lckZvciA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgX3VubG9jazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgYXNzZXJ0KCFQU0QuZ2xvYmFsKTsgLy8gTG9ja2luZyBhbmQgdW5sb2NraW5nIHJldWlyZXMgdG8gYmUgd2l0aGluIGEgUFNEIHNjb3BlLlxuICAgICAgICAgICAgaWYgKC0tdGhpcy5fcmVjdWxvY2sgPT09IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoIVBTRC5nbG9iYWwpIFBTRC5sb2NrT3duZXJGb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLl9ibG9ja2VkRnVuY3MubGVuZ3RoID4gMCAmJiAhdGhpcy5fbG9ja2VkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZuQW5kUFNEID0gdGhpcy5fYmxvY2tlZEZ1bmNzLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VQU0QoZm5BbmRQU0RbMV0sIGZuQW5kUFNEWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgX2xvY2tlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gQ2hlY2tzIGlmIGFueSB3cml0ZS1sb2NrIGlzIGFwcGxpZWQgb24gdGhpcyB0cmFuc2FjdGlvbi5cbiAgICAgICAgICAgIC8vIFRvIHNpbXBsaWZ5IHRoZSBEZXhpZSBBUEkgZm9yIGV4dGVuc2lvbiBpbXBsZW1lbnRhdGlvbnMsIHdlIHN1cHBvcnQgcmVjdXJzaXZlIGxvY2tzLlxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhY2NvbXBsaXNoZWQgYnkgdXNpbmcgXCJQcm9taXNlIFNwZWNpZmljIERhdGFcIiAoUFNEKS5cbiAgICAgICAgICAgIC8vIFBTRCBkYXRhIGlzIGJvdW5kIHRvIGEgUHJvbWlzZSBhbmQgYW55IGNoaWxkIFByb21pc2UgZW1pdHRlZCB0aHJvdWdoIHRoZW4oKSBvciByZXNvbHZlKCBuZXcgUHJvbWlzZSgpICkuXG4gICAgICAgICAgICAvLyBQU0QgaXMgbG9jYWwgdG8gY29kZSBleGVjdXRpbmcgb24gdG9wIG9mIHRoZSBjYWxsIHN0YWNrcyBvZiBhbnkgb2YgYW55IGNvZGUgZXhlY3V0ZWQgYnkgUHJvbWlzZSgpOlxuICAgICAgICAgICAgLy8gICAgICAgICAqIGNhbGxiYWNrIGdpdmVuIHRvIHRoZSBQcm9taXNlKCkgY29uc3RydWN0b3IgIChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KXsuLi59KVxuICAgICAgICAgICAgLy8gICAgICAgICAqIGNhbGxiYWNrcyBnaXZlbiB0byB0aGVuKCkvY2F0Y2goKS9maW5hbGx5KCkgbWV0aG9kcyAoZnVuY3Rpb24gKHZhbHVlKXsuLi59KVxuICAgICAgICAgICAgLy8gSWYgY3JlYXRpbmcgYSBuZXcgaW5kZXBlbmRhbnQgUHJvbWlzZSBpbnN0YW5jZSBmcm9tIHdpdGhpbiBhIFByb21pc2UgY2FsbCBzdGFjaywgdGhlIG5ldyBQcm9taXNlIHdpbGwgZGVyaXZlIHRoZSBQU0QgZnJvbSB0aGUgY2FsbCBzdGFjayBvZiB0aGUgcGFyZW50IFByb21pc2UuXG4gICAgICAgICAgICAvLyBEZXJpdmF0aW9uIGlzIGRvbmUgc28gdGhhdCB0aGUgaW5uZXIgUFNEIF9fcHJvdG9fXyBwb2ludHMgdG8gdGhlIG91dGVyIFBTRC5cbiAgICAgICAgICAgIC8vIFBTRC5sb2NrT3duZXJGb3Igd2lsbCBwb2ludCB0byBjdXJyZW50IHRyYW5zYWN0aW9uIG9iamVjdCBpZiB0aGUgY3VycmVudGx5IGV4ZWN1dGluZyBQU0Qgc2NvcGUgb3ducyB0aGUgbG9jay5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWN1bG9jayAmJiBQU0QubG9ja093bmVyRm9yICE9PSB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uIChpZGJ0cmFucykge1xuICAgICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgICAgICAgIGFzc2VydCghdGhpcy5pZGJ0cmFucyk7XG4gICAgICAgICAgICBpZiAoIWlkYnRyYW5zICYmICFpZGJkYikge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoZGJPcGVuRXJyb3IgJiYgZGJPcGVuRXJyb3IubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiRGF0YWJhc2VDbG9zZWRFcnJvclwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXJyb3JzIHdoZXJlIGl0IGlzIG5vIGRpZmZlcmVuY2Ugd2hldGhlciBpdCB3YXMgY2F1c2VkIGJ5IHRoZSB1c2VyIG9wZXJhdGlvbiBvciBhbiBlYXJsaWVyIGNhbGwgdG8gZGIub3BlbigpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgZXhjZXB0aW9ucy5EYXRhYmFzZUNsb3NlZChkYk9wZW5FcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJNaXNzaW5nQVBJRXJyb3JcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVycm9ycyB3aGVyZSBpdCBpcyBubyBkaWZmZXJlbmNlIHdoZXRoZXIgaXQgd2FzIGNhdXNlZCBieSB0aGUgdXNlciBvcGVyYXRpb24gb3IgYW4gZWFybGllciBjYWxsIHRvIGRiLm9wZW4oKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IGV4Y2VwdGlvbnMuTWlzc2luZ0FQSShkYk9wZW5FcnJvci5tZXNzYWdlLCBkYk9wZW5FcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNYWtlIGl0IGNsZWFyIHRoYXQgdGhlIHVzZXIgb3BlcmF0aW9uIHdhcyBub3Qgd2hhdCBjYXVzZWQgdGhlIGVycm9yIC0gdGhlIGVycm9yIGhhZCBvY2N1cnJlZCBlYXJsaWVyIG9uIGRiLm9wZW4oKSFcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBleGNlcHRpb25zLk9wZW5GYWlsZWQoZGJPcGVuRXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5hY3RpdmUpIHRocm93IG5ldyBleGNlcHRpb25zLlRyYW5zYWN0aW9uSW5hY3RpdmUoKTtcbiAgICAgICAgICAgIGFzc2VydCh0aGlzLl9jb21wbGV0aW9uLl9zdGF0ZSA9PT0gbnVsbCk7XG5cbiAgICAgICAgICAgIGlkYnRyYW5zID0gdGhpcy5pZGJ0cmFucyA9IGlkYnRyYW5zIHx8IGlkYmRiLnRyYW5zYWN0aW9uKHNhZmFyaU11bHRpU3RvcmVGaXgodGhpcy5zdG9yZU5hbWVzKSwgdGhpcy5tb2RlKTtcbiAgICAgICAgICAgIGlkYnRyYW5zLm9uZXJyb3IgPSB3cmFwKGZ1bmN0aW9uIChldikge1xuICAgICAgICAgICAgICAgIHByZXZlbnREZWZhdWx0KGV2KTsgLy8gUHJvaGliaXQgZGVmYXVsdCBidWJibGluZyB0byB3aW5kb3cuZXJyb3JcbiAgICAgICAgICAgICAgICBfdGhpczMuX3JlamVjdChpZGJ0cmFucy5lcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlkYnRyYW5zLm9uYWJvcnQgPSB3cmFwKGZ1bmN0aW9uIChldikge1xuICAgICAgICAgICAgICAgIHByZXZlbnREZWZhdWx0KGV2KTtcbiAgICAgICAgICAgICAgICBfdGhpczMuYWN0aXZlICYmIF90aGlzMy5fcmVqZWN0KG5ldyBleGNlcHRpb25zLkFib3J0KCkpO1xuICAgICAgICAgICAgICAgIF90aGlzMy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBfdGhpczMub24oXCJhYm9ydFwiKS5maXJlKGV2KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWRidHJhbnMub25jb21wbGV0ZSA9IHdyYXAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzMy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBfdGhpczMuX3Jlc29sdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIF9wcm9taXNlOiBmdW5jdGlvbiAobW9kZSwgZm4sIGJXcml0ZUxvY2spIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHZhciBwID0gc2VsZi5fbG9ja2VkKCkgP1xuICAgICAgICAgICAgLy8gUmVhZCBsb2NrIGFsd2F5cy4gVHJhbnNhY3Rpb24gaXMgd3JpdGUtbG9ja2VkLiBXYWl0IGZvciBtdXRleC5cbiAgICAgICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9ibG9ja2VkRnVuY3MucHVzaChbZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9wcm9taXNlKG1vZGUsIGZuLCBiV3JpdGVMb2NrKS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgICAgICAgfSwgUFNEXSk7XG4gICAgICAgICAgICB9KSA6IG5ld1Njb3BlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcF8gPSBzZWxmLmFjdGl2ZSA/IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09IFJFQURXUklURSAmJiBzZWxmLm1vZGUgIT09IFJFQURXUklURSkgdGhyb3cgbmV3IGV4Y2VwdGlvbnMuUmVhZE9ubHkoXCJUcmFuc2FjdGlvbiBpcyByZWFkb25seVwiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWxmLmlkYnRyYW5zICYmIG1vZGUpIHNlbGYuY3JlYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChiV3JpdGVMb2NrKSBzZWxmLl9sb2NrKCk7IC8vIFdyaXRlIGxvY2sgaWYgd3JpdGUgb3BlcmF0aW9uIGlzIHJlcXVlc3RlZFxuICAgICAgICAgICAgICAgICAgICBmbihyZXNvbHZlLCByZWplY3QsIHNlbGYpO1xuICAgICAgICAgICAgICAgIH0pIDogcmVqZWN0aW9uKG5ldyBleGNlcHRpb25zLlRyYW5zYWN0aW9uSW5hY3RpdmUoKSk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuYWN0aXZlICYmIGJXcml0ZUxvY2spIHBfLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl91bmxvY2soKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcF87XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcC5fbGliID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBwLnVuY2F1Z2h0KGRiVW5jYXVnaHQpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIFRyYW5zYWN0aW9uIFB1YmxpYyBQcm9wZXJ0aWVzIGFuZCBNZXRob2RzXG4gICAgICAgIC8vXG4gICAgICAgIGFib3J0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZSAmJiB0aGlzLl9yZWplY3QobmV3IGV4Y2VwdGlvbnMuQWJvcnQoKSk7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHRhYmxlczoge1xuICAgICAgICAgICAgZ2V0OiBkZXByZWNhdGVkKFwiVHJhbnNhY3Rpb24udGFibGVzXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXJyYXlUb09iamVjdCh0aGlzLnN0b3JlTmFtZXMsIGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbbmFtZSwgYWxsVGFibGVzW25hbWVdXTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIFwiVXNlIGRiLnRhYmxlcygpXCIpXG4gICAgICAgIH0sXG5cbiAgICAgICAgY29tcGxldGU6IGRlcHJlY2F0ZWQoXCJUcmFuc2FjdGlvbi5jb21wbGV0ZSgpXCIsIGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub24oXCJjb21wbGV0ZVwiLCBjYik7XG4gICAgICAgIH0pLFxuXG4gICAgICAgIGVycm9yOiBkZXByZWNhdGVkKFwiVHJhbnNhY3Rpb24uZXJyb3IoKVwiLCBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9uKFwiZXJyb3JcIiwgY2IpO1xuICAgICAgICB9KSxcblxuICAgICAgICB0YWJsZTogZGVwcmVjYXRlZChcIlRyYW5zYWN0aW9uLnRhYmxlKClcIiwgZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0b3JlTmFtZXMuaW5kZXhPZihuYW1lKSA9PT0gLTEpIHRocm93IG5ldyBleGNlcHRpb25zLkludmFsaWRUYWJsZShcIlRhYmxlIFwiICsgbmFtZSArIFwiIG5vdCBpbiB0cmFuc2FjdGlvblwiKTtcbiAgICAgICAgICAgIHJldHVybiBhbGxUYWJsZXNbbmFtZV07XG4gICAgICAgIH0pXG5cbiAgICB9KTtcblxuICAgIC8vXG4gICAgLy9cbiAgICAvL1xuICAgIC8vIFdoZXJlQ2xhdXNlXG4gICAgLy9cbiAgICAvL1xuICAgIC8vXG4gICAgZnVuY3Rpb24gV2hlcmVDbGF1c2UodGFibGUsIGluZGV4LCBvckNvbGxlY3Rpb24pIHtcbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwidGFibGVcIiB0eXBlPVwiVGFibGVcIj48L3BhcmFtPlxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJpbmRleFwiIHR5cGU9XCJTdHJpbmdcIiBvcHRpb25hbD1cInRydWVcIj48L3BhcmFtPlxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJvckNvbGxlY3Rpb25cIiB0eXBlPVwiQ29sbGVjdGlvblwiIG9wdGlvbmFsPVwidHJ1ZVwiPjwvcGFyYW0+XG4gICAgICAgIHRoaXMuX2N0eCA9IHtcbiAgICAgICAgICAgIHRhYmxlOiB0YWJsZSxcbiAgICAgICAgICAgIGluZGV4OiBpbmRleCA9PT0gXCI6aWRcIiA/IG51bGwgOiBpbmRleCxcbiAgICAgICAgICAgIGNvbGxDbGFzczogdGFibGUuX2NvbGxDbGFzcyxcbiAgICAgICAgICAgIG9yOiBvckNvbGxlY3Rpb25cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcm9wcyhXaGVyZUNsYXVzZS5wcm90b3R5cGUsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvLyBXaGVyZUNsYXVzZSBwcml2YXRlIG1ldGhvZHNcblxuICAgICAgICBmdW5jdGlvbiBmYWlsKGNvbGxlY3Rpb25PcldoZXJlQ2xhdXNlLCBlcnIsIFQpIHtcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gY29sbGVjdGlvbk9yV2hlcmVDbGF1c2UgaW5zdGFuY2VvZiBXaGVyZUNsYXVzZSA/IG5ldyBjb2xsZWN0aW9uT3JXaGVyZUNsYXVzZS5fY3R4LmNvbGxDbGFzcyhjb2xsZWN0aW9uT3JXaGVyZUNsYXVzZSkgOiBjb2xsZWN0aW9uT3JXaGVyZUNsYXVzZTtcblxuICAgICAgICAgICAgY29sbGVjdGlvbi5fY3R4LmVycm9yID0gVCA/IG5ldyBUKGVycikgOiBuZXcgVHlwZUVycm9yKGVycik7XG4gICAgICAgICAgICByZXR1cm4gY29sbGVjdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGVtcHR5Q29sbGVjdGlvbih3aGVyZUNsYXVzZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyB3aGVyZUNsYXVzZS5fY3R4LmNvbGxDbGFzcyh3aGVyZUNsYXVzZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBJREJLZXlSYW5nZS5vbmx5KFwiXCIpO1xuICAgICAgICAgICAgfSkubGltaXQoMCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cHBlckZhY3RvcnkoZGlyKSB7XG4gICAgICAgICAgICByZXR1cm4gZGlyID09PSBcIm5leHRcIiA/IGZ1bmN0aW9uIChzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHMudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgIH0gOiBmdW5jdGlvbiAocykge1xuICAgICAgICAgICAgICAgIHJldHVybiBzLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGxvd2VyRmFjdG9yeShkaXIpIHtcbiAgICAgICAgICAgIHJldHVybiBkaXIgPT09IFwibmV4dFwiID8gZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcy50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgfSA6IGZ1bmN0aW9uIChzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHMudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gbmV4dENhc2luZyhrZXksIGxvd2VyS2V5LCB1cHBlck5lZWRsZSwgbG93ZXJOZWVkbGUsIGNtcCwgZGlyKSB7XG4gICAgICAgICAgICB2YXIgbGVuZ3RoID0gTWF0aC5taW4oa2V5Lmxlbmd0aCwgbG93ZXJOZWVkbGUubGVuZ3RoKTtcbiAgICAgICAgICAgIHZhciBsbHAgPSAtMTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgbHdyS2V5Q2hhciA9IGxvd2VyS2V5W2ldO1xuICAgICAgICAgICAgICAgIGlmIChsd3JLZXlDaGFyICE9PSBsb3dlck5lZWRsZVtpXSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY21wKGtleVtpXSwgdXBwZXJOZWVkbGVbaV0pIDwgMCkgcmV0dXJuIGtleS5zdWJzdHIoMCwgaSkgKyB1cHBlck5lZWRsZVtpXSArIHVwcGVyTmVlZGxlLnN1YnN0cihpICsgMSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjbXAoa2V5W2ldLCBsb3dlck5lZWRsZVtpXSkgPCAwKSByZXR1cm4ga2V5LnN1YnN0cigwLCBpKSArIGxvd2VyTmVlZGxlW2ldICsgdXBwZXJOZWVkbGUuc3Vic3RyKGkgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxscCA+PSAwKSByZXR1cm4ga2V5LnN1YnN0cigwLCBsbHApICsgbG93ZXJLZXlbbGxwXSArIHVwcGVyTmVlZGxlLnN1YnN0cihsbHAgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjbXAoa2V5W2ldLCBsd3JLZXlDaGFyKSA8IDApIGxscCA9IGk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGVuZ3RoIDwgbG93ZXJOZWVkbGUubGVuZ3RoICYmIGRpciA9PT0gXCJuZXh0XCIpIHJldHVybiBrZXkgKyB1cHBlck5lZWRsZS5zdWJzdHIoa2V5Lmxlbmd0aCk7XG4gICAgICAgICAgICBpZiAobGVuZ3RoIDwga2V5Lmxlbmd0aCAmJiBkaXIgPT09IFwicHJldlwiKSByZXR1cm4ga2V5LnN1YnN0cigwLCB1cHBlck5lZWRsZS5sZW5ndGgpO1xuICAgICAgICAgICAgcmV0dXJuIGxscCA8IDAgPyBudWxsIDoga2V5LnN1YnN0cigwLCBsbHApICsgbG93ZXJOZWVkbGVbbGxwXSArIHVwcGVyTmVlZGxlLnN1YnN0cihsbHAgKyAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFkZElnbm9yZUNhc2VBbGdvcml0aG0od2hlcmVDbGF1c2UsIG1hdGNoLCBuZWVkbGVzLCBzdWZmaXgpIHtcbiAgICAgICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cIm5lZWRsZXNcIiB0eXBlPVwiQXJyYXlcIiBlbGVtZW50VHlwZT1cIlN0cmluZ1wiPjwvcGFyYW0+XG4gICAgICAgICAgICB2YXIgdXBwZXIsXG4gICAgICAgICAgICAgICAgbG93ZXIsXG4gICAgICAgICAgICAgICAgY29tcGFyZSxcbiAgICAgICAgICAgICAgICB1cHBlck5lZWRsZXMsXG4gICAgICAgICAgICAgICAgbG93ZXJOZWVkbGVzLFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbixcbiAgICAgICAgICAgICAgICBuZXh0S2V5U3VmZml4LFxuICAgICAgICAgICAgICAgIG5lZWRsZXNMZW4gPSBuZWVkbGVzLmxlbmd0aDtcbiAgICAgICAgICAgIGlmICghbmVlZGxlcy5ldmVyeShmdW5jdGlvbiAocykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgcyA9PT0gJ3N0cmluZyc7XG4gICAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKHdoZXJlQ2xhdXNlLCBTVFJJTkdfRVhQRUNURUQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gaW5pdERpcmVjdGlvbihkaXIpIHtcbiAgICAgICAgICAgICAgICB1cHBlciA9IHVwcGVyRmFjdG9yeShkaXIpO1xuICAgICAgICAgICAgICAgIGxvd2VyID0gbG93ZXJGYWN0b3J5KGRpcik7XG4gICAgICAgICAgICAgICAgY29tcGFyZSA9IGRpciA9PT0gXCJuZXh0XCIgPyBzaW1wbGVDb21wYXJlIDogc2ltcGxlQ29tcGFyZVJldmVyc2U7XG4gICAgICAgICAgICAgICAgdmFyIG5lZWRsZUJvdW5kcyA9IG5lZWRsZXMubWFwKGZ1bmN0aW9uIChuZWVkbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgbG93ZXI6IGxvd2VyKG5lZWRsZSksIHVwcGVyOiB1cHBlcihuZWVkbGUpIH07XG4gICAgICAgICAgICAgICAgfSkuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyZShhLmxvd2VyLCBiLmxvd2VyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB1cHBlck5lZWRsZXMgPSBuZWVkbGVCb3VuZHMubWFwKGZ1bmN0aW9uIChuYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmIudXBwZXI7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgbG93ZXJOZWVkbGVzID0gbmVlZGxlQm91bmRzLm1hcChmdW5jdGlvbiAobmIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5iLmxvd2VyO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IGRpcjtcbiAgICAgICAgICAgICAgICBuZXh0S2V5U3VmZml4ID0gZGlyID09PSBcIm5leHRcIiA/IFwiXCIgOiBzdWZmaXg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbml0RGlyZWN0aW9uKFwibmV4dFwiKTtcblxuICAgICAgICAgICAgdmFyIGMgPSBuZXcgd2hlcmVDbGF1c2UuX2N0eC5jb2xsQ2xhc3Mod2hlcmVDbGF1c2UsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSURCS2V5UmFuZ2UuYm91bmQodXBwZXJOZWVkbGVzWzBdLCBsb3dlck5lZWRsZXNbbmVlZGxlc0xlbiAtIDFdICsgc3VmZml4KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjLl9vbmRpcmVjdGlvbmNoYW5nZSA9IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGV2ZW50IG9ubHlzIG9jY3VyIGJlZm9yZSBmaWx0ZXIgaXMgY2FsbGVkIHRoZSBmaXJzdCB0aW1lLlxuICAgICAgICAgICAgICAgIGluaXREaXJlY3Rpb24oZGlyZWN0aW9uKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBmaXJzdFBvc3NpYmxlTmVlZGxlID0gMDtcblxuICAgICAgICAgICAgYy5fYWRkQWxnb3JpdGhtKGZ1bmN0aW9uIChjdXJzb3IsIGFkdmFuY2UsIHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJjdXJzb3JcIiB0eXBlPVwiSURCQ3Vyc29yXCI+PC9wYXJhbT5cbiAgICAgICAgICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJhZHZhbmNlXCIgdHlwZT1cIkZ1bmN0aW9uXCI+PC9wYXJhbT5cbiAgICAgICAgICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJyZXNvbHZlXCIgdHlwZT1cIkZ1bmN0aW9uXCI+PC9wYXJhbT5cbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gY3Vyc29yLmtleTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGtleSAhPT0gJ3N0cmluZycpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgbG93ZXJLZXkgPSBsb3dlcihrZXkpO1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaChsb3dlcktleSwgbG93ZXJOZWVkbGVzLCBmaXJzdFBvc3NpYmxlTmVlZGxlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbG93ZXN0UG9zc2libGVDYXNpbmcgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RQb3NzaWJsZU5lZWRsZTsgaSA8IG5lZWRsZXNMZW47ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhc2luZyA9IG5leHRDYXNpbmcoa2V5LCBsb3dlcktleSwgdXBwZXJOZWVkbGVzW2ldLCBsb3dlck5lZWRsZXNbaV0sIGNvbXBhcmUsIGRpcmVjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FzaW5nID09PSBudWxsICYmIGxvd2VzdFBvc3NpYmxlQ2FzaW5nID09PSBudWxsKSBmaXJzdFBvc3NpYmxlTmVlZGxlID0gaSArIDE7ZWxzZSBpZiAobG93ZXN0UG9zc2libGVDYXNpbmcgPT09IG51bGwgfHwgY29tcGFyZShsb3dlc3RQb3NzaWJsZUNhc2luZywgY2FzaW5nKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb3dlc3RQb3NzaWJsZUNhc2luZyA9IGNhc2luZztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobG93ZXN0UG9zc2libGVDYXNpbmcgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkdmFuY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvci5jb250aW51ZShsb3dlc3RQb3NzaWJsZUNhc2luZyArIG5leHRLZXlTdWZmaXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZHZhbmNlKHJlc29sdmUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBjO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gV2hlcmVDbGF1c2UgcHVibGljIG1ldGhvZHNcbiAgICAgICAgLy9cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJldHdlZW46IGZ1bmN0aW9uIChsb3dlciwgdXBwZXIsIGluY2x1ZGVMb3dlciwgaW5jbHVkZVVwcGVyKSB7XG4gICAgICAgICAgICAgICAgLy8vIDxzdW1tYXJ5PlxuICAgICAgICAgICAgICAgIC8vLyAgICAgRmlsdGVyIG91dCByZWNvcmRzIHdob3NlIHdoZXJlLWZpZWxkIGxheXMgYmV0d2VlbiBnaXZlbiBsb3dlciBhbmQgdXBwZXIgdmFsdWVzLiBBcHBsaWVzIHRvIFN0cmluZ3MsIE51bWJlcnMgYW5kIERhdGVzLlxuICAgICAgICAgICAgICAgIC8vLyA8L3N1bW1hcnk+XG4gICAgICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwibG93ZXJcIj48L3BhcmFtPlxuICAgICAgICAgICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInVwcGVyXCI+PC9wYXJhbT5cbiAgICAgICAgICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJpbmNsdWRlTG93ZXJcIiBvcHRpb25hbD1cInRydWVcIj5XaGV0aGVyIGl0ZW1zIHRoYXQgZXF1YWxzIGxvd2VyIHNob3VsZCBiZSBpbmNsdWRlZC4gRGVmYXVsdCB0cnVlLjwvcGFyYW0+XG4gICAgICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwiaW5jbHVkZVVwcGVyXCIgb3B0aW9uYWw9XCJ0cnVlXCI+V2hldGhlciBpdGVtcyB0aGF0IGVxdWFscyB1cHBlciBzaG91bGQgYmUgaW5jbHVkZWQuIERlZmF1bHQgZmFsc2UuPC9wYXJhbT5cbiAgICAgICAgICAgICAgICAvLy8gPHJldHVybnMgdHlwZT1cIkNvbGxlY3Rpb25cIj48L3JldHVybnM+XG4gICAgICAgICAgICAgICAgaW5jbHVkZUxvd2VyID0gaW5jbHVkZUxvd2VyICE9PSBmYWxzZTsgLy8gRGVmYXVsdCB0byB0cnVlXG4gICAgICAgICAgICAgICAgaW5jbHVkZVVwcGVyID0gaW5jbHVkZVVwcGVyID09PSB0cnVlOyAvLyBEZWZhdWx0IHRvIGZhbHNlXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNtcChsb3dlciwgdXBwZXIpID4gMCB8fCBjbXAobG93ZXIsIHVwcGVyKSA9PT0gMCAmJiAoaW5jbHVkZUxvd2VyIHx8IGluY2x1ZGVVcHBlcikgJiYgIShpbmNsdWRlTG93ZXIgJiYgaW5jbHVkZVVwcGVyKSkgcmV0dXJuIGVtcHR5Q29sbGVjdGlvbih0aGlzKTsgLy8gV29ya2Fyb3VuZCBmb3IgaWRpb3RpYyBXM0MgU3BlY2lmaWNhdGlvbiB0aGF0IERhdGFFcnJvciBtdXN0IGJlIHRocm93biBpZiBsb3dlciA+IHVwcGVyLiBUaGUgbmF0dXJhbCByZXN1bHQgd291bGQgYmUgdG8gcmV0dXJuIGFuIGVtcHR5IGNvbGxlY3Rpb24uXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcy5fY3R4LmNvbGxDbGFzcyh0aGlzLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gSURCS2V5UmFuZ2UuYm91bmQobG93ZXIsIHVwcGVyLCAhaW5jbHVkZUxvd2VyLCAhaW5jbHVkZVVwcGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCh0aGlzLCBJTlZBTElEX0tFWV9BUkdVTUVOVCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVxdWFsczogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB0aGlzLl9jdHguY29sbENsYXNzKHRoaXMsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIElEQktleVJhbmdlLm9ubHkodmFsdWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFib3ZlOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHRoaXMuX2N0eC5jb2xsQ2xhc3ModGhpcywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gSURCS2V5UmFuZ2UubG93ZXJCb3VuZCh2YWx1ZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYWJvdmVPckVxdWFsOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHRoaXMuX2N0eC5jb2xsQ2xhc3ModGhpcywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gSURCS2V5UmFuZ2UubG93ZXJCb3VuZCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYmVsb3c6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcy5fY3R4LmNvbGxDbGFzcyh0aGlzLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBJREJLZXlSYW5nZS51cHBlckJvdW5kKHZhbHVlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBiZWxvd09yRXF1YWw6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcy5fY3R4LmNvbGxDbGFzcyh0aGlzLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBJREJLZXlSYW5nZS51cHBlckJvdW5kKHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdGFydHNXaXRoOiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwic3RyXCIgdHlwZT1cIlN0cmluZ1wiPjwvcGFyYW0+XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzdHIgIT09ICdzdHJpbmcnKSByZXR1cm4gZmFpbCh0aGlzLCBTVFJJTkdfRVhQRUNURUQpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJldHdlZW4oc3RyLCBzdHIgKyBtYXhTdHJpbmcsIHRydWUsIHRydWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN0YXJ0c1dpdGhJZ25vcmVDYXNlOiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwic3RyXCIgdHlwZT1cIlN0cmluZ1wiPjwvcGFyYW0+XG4gICAgICAgICAgICAgICAgaWYgKHN0ciA9PT0gXCJcIikgcmV0dXJuIHRoaXMuc3RhcnRzV2l0aChzdHIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhZGRJZ25vcmVDYXNlQWxnb3JpdGhtKHRoaXMsIGZ1bmN0aW9uICh4LCBhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4LmluZGV4T2YoYVswXSkgPT09IDA7XG4gICAgICAgICAgICAgICAgfSwgW3N0cl0sIG1heFN0cmluZyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXF1YWxzSWdub3JlQ2FzZTogZnVuY3Rpb24gKHN0cikge1xuICAgICAgICAgICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInN0clwiIHR5cGU9XCJTdHJpbmdcIj48L3BhcmFtPlxuICAgICAgICAgICAgICAgIHJldHVybiBhZGRJZ25vcmVDYXNlQWxnb3JpdGhtKHRoaXMsIGZ1bmN0aW9uICh4LCBhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4ID09PSBhWzBdO1xuICAgICAgICAgICAgICAgIH0sIFtzdHJdLCBcIlwiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhbnlPZklnbm9yZUNhc2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2V0ID0gZ2V0QXJyYXlPZi5hcHBseShOT19DSEFSX0FSUkFZLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgIGlmIChzZXQubGVuZ3RoID09PSAwKSByZXR1cm4gZW1wdHlDb2xsZWN0aW9uKHRoaXMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhZGRJZ25vcmVDYXNlQWxnb3JpdGhtKHRoaXMsIGZ1bmN0aW9uICh4LCBhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmluZGV4T2YoeCkgIT09IC0xO1xuICAgICAgICAgICAgICAgIH0sIHNldCwgXCJcIik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3RhcnRzV2l0aEFueU9mSWdub3JlQ2FzZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBzZXQgPSBnZXRBcnJheU9mLmFwcGx5KE5PX0NIQVJfQVJSQVksIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgaWYgKHNldC5sZW5ndGggPT09IDApIHJldHVybiBlbXB0eUNvbGxlY3Rpb24odGhpcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFkZElnbm9yZUNhc2VBbGdvcml0aG0odGhpcywgZnVuY3Rpb24gKHgsIGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuc29tZShmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHguaW5kZXhPZihuKSA9PT0gMDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSwgc2V0LCBtYXhTdHJpbmcpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFueU9mOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNldCA9IGdldEFycmF5T2YuYXBwbHkoTk9fQ0hBUl9BUlJBWSwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICB2YXIgY29tcGFyZSA9IGFzY2VuZGluZztcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBzZXQuc29ydChjb21wYXJlKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKHRoaXMsIElOVkFMSURfS0VZX0FSR1VNRU5UKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNldC5sZW5ndGggPT09IDApIHJldHVybiBlbXB0eUNvbGxlY3Rpb24odGhpcyk7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSBuZXcgdGhpcy5fY3R4LmNvbGxDbGFzcyh0aGlzLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBJREJLZXlSYW5nZS5ib3VuZChzZXRbMF0sIHNldFtzZXQubGVuZ3RoIC0gMV0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgYy5fb25kaXJlY3Rpb25jaGFuZ2UgPSBmdW5jdGlvbiAoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBhcmUgPSBkaXJlY3Rpb24gPT09IFwibmV4dFwiID8gYXNjZW5kaW5nIDogZGVzY2VuZGluZztcbiAgICAgICAgICAgICAgICAgICAgc2V0LnNvcnQoY29tcGFyZSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICAgICAgYy5fYWRkQWxnb3JpdGhtKGZ1bmN0aW9uIChjdXJzb3IsIGFkdmFuY2UsIHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IGN1cnNvci5rZXk7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChjb21wYXJlKGtleSwgc2V0W2ldKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBjdXJzb3IgaGFzIHBhc3NlZCBiZXlvbmQgdGhpcyBrZXkuIENoZWNrIG5leHQuXG4gICAgICAgICAgICAgICAgICAgICAgICArK2k7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gc2V0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIGlzIG5vIG5leHQuIFN0b3Agc2VhcmNoaW5nLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkdmFuY2UocmVzb2x2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wYXJlKGtleSwgc2V0W2ldKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGN1cnJlbnQgY3Vyc29yIHZhbHVlIHNob3VsZCBiZSBpbmNsdWRlZCBhbmQgd2Ugc2hvdWxkIGNvbnRpbnVlIGEgc2luZ2xlIHN0ZXAgaW4gY2FzZSBuZXh0IGl0ZW0gaGFzIHRoZSBzYW1lIGtleSBvciBwb3NzaWJseSBvdXIgbmV4dCBrZXkgaW4gc2V0LlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjdXJzb3Iua2V5IG5vdCB5ZXQgYXQgc2V0W2ldLiBGb3J3YXJkIGN1cnNvciB0byB0aGUgbmV4dCBrZXkgdG8gaHVudCBmb3IuXG4gICAgICAgICAgICAgICAgICAgICAgICBhZHZhbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3IuY29udGludWUoc2V0W2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGM7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBub3RFcXVhbDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5BbnlSYW5nZShbWy1JbmZpbml0eSwgdmFsdWVdLCBbdmFsdWUsIG1heEtleV1dLCB7IGluY2x1ZGVMb3dlcnM6IGZhbHNlLCBpbmNsdWRlVXBwZXJzOiBmYWxzZSB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIG5vbmVPZjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBzZXQgPSBnZXRBcnJheU9mLmFwcGx5KE5PX0NIQVJfQVJSQVksIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgaWYgKHNldC5sZW5ndGggPT09IDApIHJldHVybiBuZXcgdGhpcy5fY3R4LmNvbGxDbGFzcyh0aGlzKTsgLy8gUmV0dXJuIGVudGlyZSBjb2xsZWN0aW9uLlxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHNldC5zb3J0KGFzY2VuZGluZyk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCh0aGlzLCBJTlZBTElEX0tFWV9BUkdVTUVOVCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFRyYW5zZm9ybSBbXCJhXCIsXCJiXCIsXCJjXCJdIHRvIGEgc2V0IG9mIHJhbmdlcyBmb3IgYmV0d2Vlbi9hYm92ZS9iZWxvdzogW1stSW5maW5pdHksXCJhXCJdLCBbXCJhXCIsXCJiXCJdLCBbXCJiXCIsXCJjXCJdLCBbXCJjXCIsbWF4S2V5XV1cbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2VzID0gc2V0LnJlZHVjZShmdW5jdGlvbiAocmVzLCB2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcyA/IHJlcy5jb25jYXQoW1tyZXNbcmVzLmxlbmd0aCAtIDFdWzFdLCB2YWxdXSkgOiBbWy1JbmZpbml0eSwgdmFsXV07XG4gICAgICAgICAgICAgICAgfSwgbnVsbCk7XG4gICAgICAgICAgICAgICAgcmFuZ2VzLnB1c2goW3NldFtzZXQubGVuZ3RoIC0gMV0sIG1heEtleV0pO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmluQW55UmFuZ2UocmFuZ2VzLCB7IGluY2x1ZGVMb3dlcnM6IGZhbHNlLCBpbmNsdWRlVXBwZXJzOiBmYWxzZSB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBGaWx0ZXIgb3V0IHZhbHVlcyB3aXRoaW5nIGdpdmVuIHNldCBvZiByYW5nZXMuXHJcbiAgICAgICAgICAgICogRXhhbXBsZSwgZ2l2ZSBjaGlsZHJlbiBhbmQgZWxkZXJzIGEgcmViYXRlIG9mIDUwJTpcclxuICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAqICAgZGIuZnJpZW5kcy53aGVyZSgnYWdlJykuaW5BbnlSYW5nZShbWzAsMThdLFs2NSxJbmZpbml0eV1dKS5tb2RpZnkoe1JlYmF0ZTogMS8yfSk7XHJcbiAgICAgICAgICAgICpcclxuICAgICAgICAgICAgKiBAcGFyYW0geyhzdHJpbmd8bnVtYmVyfERhdGV8QXJyYXkpW11bXX0gcmFuZ2VzXHJcbiAgICAgICAgICAgICogQHBhcmFtIHt7aW5jbHVkZUxvd2VyczogYm9vbGVhbiwgaW5jbHVkZVVwcGVyczogYm9vbGVhbn19IG9wdGlvbnNcclxuICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluQW55UmFuZ2U6IGZ1bmN0aW9uIChyYW5nZXMsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5fY3R4O1xuICAgICAgICAgICAgICAgIGlmIChyYW5nZXMubGVuZ3RoID09PSAwKSByZXR1cm4gZW1wdHlDb2xsZWN0aW9uKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmICghcmFuZ2VzLmV2ZXJ5KGZ1bmN0aW9uIChyYW5nZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmFuZ2VbMF0gIT09IHVuZGVmaW5lZCAmJiByYW5nZVsxXSAhPT0gdW5kZWZpbmVkICYmIGFzY2VuZGluZyhyYW5nZVswXSwgcmFuZ2VbMV0pIDw9IDA7XG4gICAgICAgICAgICAgICAgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwodGhpcywgXCJGaXJzdCBhcmd1bWVudCB0byBpbkFueVJhbmdlKCkgbXVzdCBiZSBhbiBBcnJheSBvZiB0d28tdmFsdWUgQXJyYXlzIFtsb3dlcix1cHBlcl0gd2hlcmUgdXBwZXIgbXVzdCBub3QgYmUgbG93ZXIgdGhhbiBsb3dlclwiLCBleGNlcHRpb25zLkludmFsaWRBcmd1bWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBpbmNsdWRlTG93ZXJzID0gIW9wdGlvbnMgfHwgb3B0aW9ucy5pbmNsdWRlTG93ZXJzICE9PSBmYWxzZTsgLy8gRGVmYXVsdCB0byB0cnVlXG4gICAgICAgICAgICAgICAgdmFyIGluY2x1ZGVVcHBlcnMgPSBvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZVVwcGVycyA9PT0gdHJ1ZTsgLy8gRGVmYXVsdCB0byBmYWxzZVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gYWRkUmFuZ2UocmFuZ2VzLCBuZXdSYW5nZSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHJhbmdlcy5sZW5ndGg7IGkgPCBsOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHJhbmdlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbXAobmV3UmFuZ2VbMF0sIHJhbmdlWzFdKSA8IDAgJiYgY21wKG5ld1JhbmdlWzFdLCByYW5nZVswXSkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2VbMF0gPSBtaW4ocmFuZ2VbMF0sIG5ld1JhbmdlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZVsxXSA9IG1heChyYW5nZVsxXSwgbmV3UmFuZ2VbMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpID09PSBsKSByYW5nZXMucHVzaChuZXdSYW5nZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByYW5nZXM7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHNvcnREaXJlY3Rpb24gPSBhc2NlbmRpbmc7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gcmFuZ2VTb3J0ZXIoYSwgYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc29ydERpcmVjdGlvbihhWzBdLCBiWzBdKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBKb2luIG92ZXJsYXBwaW5nIHJhbmdlc1xuICAgICAgICAgICAgICAgIHZhciBzZXQ7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgc2V0ID0gcmFuZ2VzLnJlZHVjZShhZGRSYW5nZSwgW10pO1xuICAgICAgICAgICAgICAgICAgICBzZXQuc29ydChyYW5nZVNvcnRlcik7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwodGhpcywgSU5WQUxJRF9LRVlfQVJHVU1FTlQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgICAgICB2YXIga2V5SXNCZXlvbmRDdXJyZW50RW50cnkgPSBpbmNsdWRlVXBwZXJzID8gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXNjZW5kaW5nKGtleSwgc2V0W2ldWzFdKSA+IDA7XG4gICAgICAgICAgICAgICAgfSA6IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFzY2VuZGluZyhrZXksIHNldFtpXVsxXSkgPj0gMDtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIGtleUlzQmVmb3JlQ3VycmVudEVudHJ5ID0gaW5jbHVkZUxvd2VycyA/IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlc2NlbmRpbmcoa2V5LCBzZXRbaV1bMF0pID4gMDtcbiAgICAgICAgICAgICAgICB9IDogZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVzY2VuZGluZyhrZXksIHNldFtpXVswXSkgPj0gMDtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24ga2V5V2l0aGluQ3VycmVudFJhbmdlKGtleSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIWtleUlzQmV5b25kQ3VycmVudEVudHJ5KGtleSkgJiYgIWtleUlzQmVmb3JlQ3VycmVudEVudHJ5KGtleSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrS2V5ID0ga2V5SXNCZXlvbmRDdXJyZW50RW50cnk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYyA9IG5ldyBjdHguY29sbENsYXNzKHRoaXMsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIElEQktleVJhbmdlLmJvdW5kKHNldFswXVswXSwgc2V0W3NldC5sZW5ndGggLSAxXVsxXSwgIWluY2x1ZGVMb3dlcnMsICFpbmNsdWRlVXBwZXJzKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGMuX29uZGlyZWN0aW9uY2hhbmdlID0gZnVuY3Rpb24gKGRpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBcIm5leHRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tLZXkgPSBrZXlJc0JleW9uZEN1cnJlbnRFbnRyeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnREaXJlY3Rpb24gPSBhc2NlbmRpbmc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja0tleSA9IGtleUlzQmVmb3JlQ3VycmVudEVudHJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgc29ydERpcmVjdGlvbiA9IGRlc2NlbmRpbmc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2V0LnNvcnQocmFuZ2VTb3J0ZXIpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBjLl9hZGRBbGdvcml0aG0oZnVuY3Rpb24gKGN1cnNvciwgYWR2YW5jZSwgcmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gY3Vyc29yLmtleTtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGNoZWNrS2V5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBjdXJzb3IgaGFzIHBhc3NlZCBiZXlvbmQgdGhpcyBrZXkuIENoZWNrIG5leHQuXG4gICAgICAgICAgICAgICAgICAgICAgICArK2k7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gc2V0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIGlzIG5vIG5leHQuIFN0b3Agc2VhcmNoaW5nLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkdmFuY2UocmVzb2x2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXlXaXRoaW5DdXJyZW50UmFuZ2Uoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGN1cnJlbnQgY3Vyc29yIHZhbHVlIHNob3VsZCBiZSBpbmNsdWRlZCBhbmQgd2Ugc2hvdWxkIGNvbnRpbnVlIGEgc2luZ2xlIHN0ZXAgaW4gY2FzZSBuZXh0IGl0ZW0gaGFzIHRoZSBzYW1lIGtleSBvciBwb3NzaWJseSBvdXIgbmV4dCBrZXkgaW4gc2V0LlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY21wKGtleSwgc2V0W2ldWzFdKSA9PT0gMCB8fCBjbXAoa2V5LCBzZXRbaV1bMF0pID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpbmNsdWRlVXBwZXIgb3IgaW5jbHVkZUxvd2VyIGlzIGZhbHNlIHNvIGtleVdpdGhpbkN1cnJlbnRSYW5nZSgpIHJldHVybnMgZmFsc2UgZXZlbiB0aG91Z2ggd2UgYXJlIGF0IHJhbmdlIGJvcmRlci5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbnRpbnVlIHRvIG5leHQga2V5IGJ1dCBkb24ndCBpbmNsdWRlIHRoaXMgb25lLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3Vyc29yLmtleSBub3QgeWV0IGF0IHNldFtpXS4gRm9yd2FyZCBjdXJzb3IgdG8gdGhlIG5leHQga2V5IHRvIGh1bnQgZm9yLlxuICAgICAgICAgICAgICAgICAgICAgICAgYWR2YW5jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvcnREaXJlY3Rpb24gPT09IGFzY2VuZGluZykgY3Vyc29yLmNvbnRpbnVlKHNldFtpXVswXSk7ZWxzZSBjdXJzb3IuY29udGludWUoc2V0W2ldWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGM7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3RhcnRzV2l0aEFueU9mOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNldCA9IGdldEFycmF5T2YuYXBwbHkoTk9fQ0hBUl9BUlJBWSwgYXJndW1lbnRzKTtcblxuICAgICAgICAgICAgICAgIGlmICghc2V0LmV2ZXJ5KGZ1bmN0aW9uIChzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgcyA9PT0gJ3N0cmluZyc7XG4gICAgICAgICAgICAgICAgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwodGhpcywgXCJzdGFydHNXaXRoQW55T2YoKSBvbmx5IHdvcmtzIHdpdGggc3RyaW5nc1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNldC5sZW5ndGggPT09IDApIHJldHVybiBlbXB0eUNvbGxlY3Rpb24odGhpcyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pbkFueVJhbmdlKHNldC5tYXAoZnVuY3Rpb24gKHN0cikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3N0ciwgc3RyICsgbWF4U3RyaW5nXTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvL1xuICAgIC8vXG4gICAgLy9cbiAgICAvLyBDb2xsZWN0aW9uIENsYXNzXG4gICAgLy9cbiAgICAvL1xuICAgIC8vXG4gICAgZnVuY3Rpb24gQ29sbGVjdGlvbih3aGVyZUNsYXVzZSwga2V5UmFuZ2VHZW5lcmF0b3IpIHtcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxuICAgICAgICAvLy9cbiAgICAgICAgLy8vIDwvc3VtbWFyeT5cbiAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwid2hlcmVDbGF1c2VcIiB0eXBlPVwiV2hlcmVDbGF1c2VcIj5XaGVyZSBjbGF1c2UgaW5zdGFuY2U8L3BhcmFtPlxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJrZXlSYW5nZUdlbmVyYXRvclwiIHZhbHVlPVwiZnVuY3Rpb24oKXsgcmV0dXJuIElEQktleVJhbmdlLmJvdW5kKDAsMSk7fVwiIG9wdGlvbmFsPVwidHJ1ZVwiPjwvcGFyYW0+XG4gICAgICAgIHZhciBrZXlSYW5nZSA9IG51bGwsXG4gICAgICAgICAgICBlcnJvciA9IG51bGw7XG4gICAgICAgIGlmIChrZXlSYW5nZUdlbmVyYXRvcikgdHJ5IHtcbiAgICAgICAgICAgIGtleVJhbmdlID0ga2V5UmFuZ2VHZW5lcmF0b3IoKTtcbiAgICAgICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIGVycm9yID0gZXg7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgd2hlcmVDdHggPSB3aGVyZUNsYXVzZS5fY3R4LFxuICAgICAgICAgICAgdGFibGUgPSB3aGVyZUN0eC50YWJsZTtcbiAgICAgICAgdGhpcy5fY3R4ID0ge1xuICAgICAgICAgICAgdGFibGU6IHRhYmxlLFxuICAgICAgICAgICAgaW5kZXg6IHdoZXJlQ3R4LmluZGV4LFxuICAgICAgICAgICAgaXNQcmltS2V5OiAhd2hlcmVDdHguaW5kZXggfHwgdGFibGUuc2NoZW1hLnByaW1LZXkua2V5UGF0aCAmJiB3aGVyZUN0eC5pbmRleCA9PT0gdGFibGUuc2NoZW1hLnByaW1LZXkubmFtZSxcbiAgICAgICAgICAgIHJhbmdlOiBrZXlSYW5nZSxcbiAgICAgICAgICAgIGtleXNPbmx5OiBmYWxzZSxcbiAgICAgICAgICAgIGRpcjogXCJuZXh0XCIsXG4gICAgICAgICAgICB1bmlxdWU6IFwiXCIsXG4gICAgICAgICAgICBhbGdvcml0aG06IG51bGwsXG4gICAgICAgICAgICBmaWx0ZXI6IG51bGwsXG4gICAgICAgICAgICByZXBsYXlGaWx0ZXI6IG51bGwsXG4gICAgICAgICAgICBqdXN0TGltaXQ6IHRydWUsIC8vIFRydWUgaWYgYSByZXBsYXlGaWx0ZXIgaXMganVzdCBhIGZpbHRlciB0aGF0IHBlcmZvcm1zIGEgXCJsaW1pdFwiIG9wZXJhdGlvbiAob3Igbm9uZSBhdCBhbGwpXG4gICAgICAgICAgICBpc01hdGNoOiBudWxsLFxuICAgICAgICAgICAgb2Zmc2V0OiAwLFxuICAgICAgICAgICAgbGltaXQ6IEluZmluaXR5LFxuICAgICAgICAgICAgZXJyb3I6IGVycm9yLCAvLyBJZiBzZXQsIGFueSBwcm9taXNlIG11c3QgYmUgcmVqZWN0ZWQgd2l0aCB0aGlzIGVycm9yXG4gICAgICAgICAgICBvcjogd2hlcmVDdHgub3IsXG4gICAgICAgICAgICB2YWx1ZU1hcHBlcjogdGFibGUuaG9vay5yZWFkaW5nLmZpcmVcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc1BsYWluS2V5UmFuZ2UoY3R4LCBpZ25vcmVMaW1pdEZpbHRlcikge1xuICAgICAgICByZXR1cm4gIShjdHguZmlsdGVyIHx8IGN0eC5hbGdvcml0aG0gfHwgY3R4Lm9yKSAmJiAoaWdub3JlTGltaXRGaWx0ZXIgPyBjdHguanVzdExpbWl0IDogIWN0eC5yZXBsYXlGaWx0ZXIpO1xuICAgIH1cblxuICAgIHByb3BzKENvbGxlY3Rpb24ucHJvdG90eXBlLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gQ29sbGVjdGlvbiBQcml2YXRlIEZ1bmN0aW9uc1xuICAgICAgICAvL1xuXG4gICAgICAgIGZ1bmN0aW9uIGFkZEZpbHRlcihjdHgsIGZuKSB7XG4gICAgICAgICAgICBjdHguZmlsdGVyID0gY29tYmluZShjdHguZmlsdGVyLCBmbik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBhZGRSZXBsYXlGaWx0ZXIoY3R4LCBmYWN0b3J5LCBpc0xpbWl0RmlsdGVyKSB7XG4gICAgICAgICAgICB2YXIgY3VyciA9IGN0eC5yZXBsYXlGaWx0ZXI7XG4gICAgICAgICAgICBjdHgucmVwbGF5RmlsdGVyID0gY3VyciA/IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tYmluZShjdXJyKCksIGZhY3RvcnkoKSk7XG4gICAgICAgICAgICB9IDogZmFjdG9yeTtcbiAgICAgICAgICAgIGN0eC5qdXN0TGltaXQgPSBpc0xpbWl0RmlsdGVyICYmICFjdXJyO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYWRkTWF0Y2hGaWx0ZXIoY3R4LCBmbikge1xuICAgICAgICAgICAgY3R4LmlzTWF0Y2ggPSBjb21iaW5lKGN0eC5pc01hdGNoLCBmbik7XG4gICAgICAgIH1cblxuICAgICAgICAvKiogQHBhcmFtIGN0eCB7XHJcbiAgICAgICAgICogICAgICBpc1ByaW1LZXk6IGJvb2xlYW4sXHJcbiAgICAgICAgICogICAgICB0YWJsZTogVGFibGUsXHJcbiAgICAgICAgICogICAgICBpbmRleDogc3RyaW5nXHJcbiAgICAgICAgICogfVxyXG4gICAgICAgICAqIEBwYXJhbSBzdG9yZSBJREJPYmplY3RTdG9yZVxyXG4gICAgICAgICAqKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0SW5kZXhPclN0b3JlKGN0eCwgc3RvcmUpIHtcbiAgICAgICAgICAgIGlmIChjdHguaXNQcmltS2V5KSByZXR1cm4gc3RvcmU7XG4gICAgICAgICAgICB2YXIgaW5kZXhTcGVjID0gY3R4LnRhYmxlLnNjaGVtYS5pZHhCeU5hbWVbY3R4LmluZGV4XTtcbiAgICAgICAgICAgIGlmICghaW5kZXhTcGVjKSB0aHJvdyBuZXcgZXhjZXB0aW9ucy5TY2hlbWEoXCJLZXlQYXRoIFwiICsgY3R4LmluZGV4ICsgXCIgb24gb2JqZWN0IHN0b3JlIFwiICsgc3RvcmUubmFtZSArIFwiIGlzIG5vdCBpbmRleGVkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmluZGV4KGluZGV4U3BlYy5uYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBAcGFyYW0gY3R4IHtcclxuICAgICAgICAgKiAgICAgIGlzUHJpbUtleTogYm9vbGVhbixcclxuICAgICAgICAgKiAgICAgIHRhYmxlOiBUYWJsZSxcclxuICAgICAgICAgKiAgICAgIGluZGV4OiBzdHJpbmcsXHJcbiAgICAgICAgICogICAgICBrZXlzT25seTogYm9vbGVhbixcclxuICAgICAgICAgKiAgICAgIHJhbmdlPzogSURCS2V5UmFuZ2UsXHJcbiAgICAgICAgICogICAgICBkaXI6IFwibmV4dFwiIHwgXCJwcmV2XCJcclxuICAgICAgICAgKiB9XHJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIG9wZW5DdXJzb3IoY3R4LCBzdG9yZSkge1xuICAgICAgICAgICAgdmFyIGlkeE9yU3RvcmUgPSBnZXRJbmRleE9yU3RvcmUoY3R4LCBzdG9yZSk7XG4gICAgICAgICAgICByZXR1cm4gY3R4LmtleXNPbmx5ICYmICdvcGVuS2V5Q3Vyc29yJyBpbiBpZHhPclN0b3JlID8gaWR4T3JTdG9yZS5vcGVuS2V5Q3Vyc29yKGN0eC5yYW5nZSB8fCBudWxsLCBjdHguZGlyICsgY3R4LnVuaXF1ZSkgOiBpZHhPclN0b3JlLm9wZW5DdXJzb3IoY3R4LnJhbmdlIHx8IG51bGwsIGN0eC5kaXIgKyBjdHgudW5pcXVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGl0ZXIoY3R4LCBmbiwgcmVzb2x2ZSwgcmVqZWN0LCBpZGJzdG9yZSkge1xuICAgICAgICAgICAgdmFyIGZpbHRlciA9IGN0eC5yZXBsYXlGaWx0ZXIgPyBjb21iaW5lKGN0eC5maWx0ZXIsIGN0eC5yZXBsYXlGaWx0ZXIoKSkgOiBjdHguZmlsdGVyO1xuICAgICAgICAgICAgaWYgKCFjdHgub3IpIHtcbiAgICAgICAgICAgICAgICBpdGVyYXRlKG9wZW5DdXJzb3IoY3R4LCBpZGJzdG9yZSksIGNvbWJpbmUoY3R4LmFsZ29yaXRobSwgZmlsdGVyKSwgZm4sIHJlc29sdmUsIHJlamVjdCwgIWN0eC5rZXlzT25seSAmJiBjdHgudmFsdWVNYXBwZXIpO1xuICAgICAgICAgICAgfSBlbHNlIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNldCA9IHt9O1xuICAgICAgICAgICAgICAgIHZhciByZXNvbHZlZCA9IDA7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiByZXNvbHZlYm90aCgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCsrcmVzb2x2ZWQgPT09IDIpIHJlc29sdmUoKTsgLy8gU2VlbXMgbGlrZSB3ZSBqdXN0IHN1cHBvcnQgb3IgYnR3biBtYXggMiBleHByZXNzaW9ucywgYnV0IHRoZXJlIGFyZSBubyBsaW1pdCBiZWNhdXNlIHdlIGRvIHJlY3Vyc2lvbi5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiB1bmlvbihpdGVtLCBjdXJzb3IsIGFkdmFuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWx0ZXIgfHwgZmlsdGVyKGN1cnNvciwgYWR2YW5jZSwgcmVzb2x2ZWJvdGgsIHJlamVjdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBjdXJzb3IucHJpbWFyeUtleS50b1N0cmluZygpOyAvLyBDb252ZXJ0cyBhbnkgRGF0ZSB0byBTdHJpbmcsIFN0cmluZyB0byBTdHJpbmcsIE51bWJlciB0byBTdHJpbmcgYW5kIEFycmF5IHRvIGNvbW1hLXNlcGFyYXRlZCBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGFzT3duKHNldCwga2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFtrZXldID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbihpdGVtLCBjdXJzb3IsIGFkdmFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY3R4Lm9yLl9pdGVyYXRlKHVuaW9uLCByZXNvbHZlYm90aCwgcmVqZWN0LCBpZGJzdG9yZSk7XG4gICAgICAgICAgICAgICAgaXRlcmF0ZShvcGVuQ3Vyc29yKGN0eCwgaWRic3RvcmUpLCBjdHguYWxnb3JpdGhtLCB1bmlvbiwgcmVzb2x2ZWJvdGgsIHJlamVjdCwgIWN0eC5rZXlzT25seSAmJiBjdHgudmFsdWVNYXBwZXIpO1xuICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRJbnN0YW5jZVRlbXBsYXRlKGN0eCkge1xuICAgICAgICAgICAgcmV0dXJuIGN0eC50YWJsZS5zY2hlbWEuaW5zdGFuY2VUZW1wbGF0ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG5cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyBDb2xsZWN0aW9uIFByb3RlY3RlZCBGdW5jdGlvbnNcbiAgICAgICAgICAgIC8vXG5cbiAgICAgICAgICAgIF9yZWFkOiBmdW5jdGlvbiAoZm4sIGNiKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHRoaXMuX2N0eDtcbiAgICAgICAgICAgICAgICBpZiAoY3R4LmVycm9yKSByZXR1cm4gY3R4LnRhYmxlLl90cmFucyhudWxsLCBmdW5jdGlvbiByZWplY3RvcihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGN0eC5lcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7ZWxzZSByZXR1cm4gY3R4LnRhYmxlLl9pZGJzdG9yZShSRUFET05MWSwgZm4pLnRoZW4oY2IpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF93cml0ZTogZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHRoaXMuX2N0eDtcbiAgICAgICAgICAgICAgICBpZiAoY3R4LmVycm9yKSByZXR1cm4gY3R4LnRhYmxlLl90cmFucyhudWxsLCBmdW5jdGlvbiByZWplY3RvcihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGN0eC5lcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7ZWxzZSByZXR1cm4gY3R4LnRhYmxlLl9pZGJzdG9yZShSRUFEV1JJVEUsIGZuLCBcImxvY2tlZFwiKTsgLy8gV2hlbiBkb2luZyB3cml0ZSBvcGVyYXRpb25zIG9uIGNvbGxlY3Rpb25zLCBhbHdheXMgbG9jayB0aGUgb3BlcmF0aW9uIHNvIHRoYXQgdXBjb21pbmcgb3BlcmF0aW9ucyBnZXRzIHF1ZXVlZC5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfYWRkQWxnb3JpdGhtOiBmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5fY3R4O1xuICAgICAgICAgICAgICAgIGN0eC5hbGdvcml0aG0gPSBjb21iaW5lKGN0eC5hbGdvcml0aG0sIGZuKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIF9pdGVyYXRlOiBmdW5jdGlvbiAoZm4sIHJlc29sdmUsIHJlamVjdCwgaWRic3RvcmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlcih0aGlzLl9jdHgsIGZuLCByZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGNsb25lOiBmdW5jdGlvbiAocHJvcHMkJDEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcnYgPSBPYmplY3QuY3JlYXRlKHRoaXMuY29uc3RydWN0b3IucHJvdG90eXBlKSxcbiAgICAgICAgICAgICAgICAgICAgY3R4ID0gT2JqZWN0LmNyZWF0ZSh0aGlzLl9jdHgpO1xuICAgICAgICAgICAgICAgIGlmIChwcm9wcyQkMSkgZXh0ZW5kKGN0eCwgcHJvcHMkJDEpO1xuICAgICAgICAgICAgICAgIHJ2Ll9jdHggPSBjdHg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJ2O1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgcmF3OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3R4LnZhbHVlTWFwcGVyID0gbnVsbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyBDb2xsZWN0aW9uIFB1YmxpYyBtZXRob2RzXG4gICAgICAgICAgICAvL1xuXG4gICAgICAgICAgICBlYWNoOiBmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5fY3R4O1xuXG4gICAgICAgICAgICAgICAgaWYgKGZha2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBnZXRJbnN0YW5jZVRlbXBsYXRlKGN0eCksXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmltS2V5UGF0aCA9IGN0eC50YWJsZS5zY2hlbWEucHJpbUtleS5rZXlQYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5ID0gZ2V0QnlLZXlQYXRoKGl0ZW0sIGN0eC5pbmRleCA/IGN0eC50YWJsZS5zY2hlbWEuaWR4QnlOYW1lW2N0eC5pbmRleF0ua2V5UGF0aCA6IHByaW1LZXlQYXRoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnlLZXkgPSBnZXRCeUtleVBhdGgoaXRlbSwgcHJpbUtleVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBmbihpdGVtLCB7IGtleToga2V5LCBwcmltYXJ5S2V5OiBwcmltYXJ5S2V5IH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWFkKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlKSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZXIoY3R4LCBmbiwgcmVzb2x2ZSwgcmVqZWN0LCBpZGJzdG9yZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBjb3VudDogZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICAgICAgaWYgKGZha2UpIHJldHVybiBQcm9taXNlLnJlc29sdmUoMCkudGhlbihjYik7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHRoaXMuX2N0eDtcblxuICAgICAgICAgICAgICAgIGlmIChpc1BsYWluS2V5UmFuZ2UoY3R4LCB0cnVlKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgcGxhaW4ga2V5IHJhbmdlLiBXZSBjYW4gdXNlIHRoZSBjb3VudCgpIG1ldGhvZCBpZiB0aGUgaW5kZXguXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWFkKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gZ2V0SW5kZXhPclN0b3JlKGN0eCwgaWRic3RvcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcSA9IGN0eC5yYW5nZSA/IGlkeC5jb3VudChjdHgucmFuZ2UpIDogaWR4LmNvdW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXEub25lcnJvciA9IGV2ZW50UmVqZWN0SGFuZGxlcihyZWplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShNYXRoLm1pbihlLnRhcmdldC5yZXN1bHQsIGN0eC5saW1pdCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSwgY2IpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFsZ29yaXRobXMsIGZpbHRlcnMgb3IgZXhwcmVzc2lvbnMgYXJlIGFwcGxpZWQuIE5lZWQgdG8gY291bnQgbWFudWFsbHkuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWFkKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVyKGN0eCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICsrY291bnQ7cmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoY291bnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgcmVqZWN0LCBpZGJzdG9yZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGNiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBzb3J0Qnk6IGZ1bmN0aW9uIChrZXlQYXRoLCBjYikge1xuICAgICAgICAgICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cImtleVBhdGhcIiB0eXBlPVwiU3RyaW5nXCI+PC9wYXJhbT5cbiAgICAgICAgICAgICAgICB2YXIgcGFydHMgPSBrZXlQYXRoLnNwbGl0KCcuJykucmV2ZXJzZSgpLFxuICAgICAgICAgICAgICAgICAgICBsYXN0UGFydCA9IHBhcnRzWzBdLFxuICAgICAgICAgICAgICAgICAgICBsYXN0SW5kZXggPSBwYXJ0cy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldHZhbChvYmosIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkpIHJldHVybiBnZXR2YWwob2JqW3BhcnRzW2ldXSwgaSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqW2xhc3RQYXJ0XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG9yZGVyID0gdGhpcy5fY3R4LmRpciA9PT0gXCJuZXh0XCIgPyAxIDogLTE7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzb3J0ZXIoYSwgYikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYVZhbCA9IGdldHZhbChhLCBsYXN0SW5kZXgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgYlZhbCA9IGdldHZhbChiLCBsYXN0SW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVZhbCA8IGJWYWwgPyAtb3JkZXIgOiBhVmFsID4gYlZhbCA/IG9yZGVyIDogMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheShmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS5zb3J0KHNvcnRlcik7XG4gICAgICAgICAgICAgICAgfSkudGhlbihjYik7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICB0b0FycmF5OiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5fY3R4O1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWFkKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlKSB7XG4gICAgICAgICAgICAgICAgICAgIGZha2UgJiYgcmVzb2x2ZShbZ2V0SW5zdGFuY2VUZW1wbGF0ZShjdHgpXSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoYXNHZXRBbGwgJiYgY3R4LmRpciA9PT0gJ25leHQnICYmIGlzUGxhaW5LZXlSYW5nZShjdHgsIHRydWUpICYmIGN0eC5saW1pdCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgb3B0aW1hdGlvbiBpZiB3ZSBjb3VsZCB1c2UgSURCT2JqZWN0U3RvcmUuZ2V0QWxsKCkgb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElEQktleVJhbmdlLmdldEFsbCgpOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlYWRpbmdIb29rID0gY3R4LnRhYmxlLmhvb2sucmVhZGluZy5maXJlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeE9yU3RvcmUgPSBnZXRJbmRleE9yU3RvcmUoY3R4LCBpZGJzdG9yZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVxID0gY3R4LmxpbWl0IDwgSW5maW5pdHkgPyBpZHhPclN0b3JlLmdldEFsbChjdHgucmFuZ2UsIGN0eC5saW1pdCkgOiBpZHhPclN0b3JlLmdldEFsbChjdHgucmFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSBldmVudFJlamVjdEhhbmRsZXIocmVqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5vbnN1Y2Nlc3MgPSByZWFkaW5nSG9vayA9PT0gbWlycm9yID8gZXZlbnRTdWNjZXNzSGFuZGxlcihyZXNvbHZlKSA6IHdyYXAoZXZlbnRTdWNjZXNzSGFuZGxlcihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXMubWFwKHJlYWRpbmdIb29rKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0dGluZyBhcnJheSB0aHJvdWdoIGEgY3Vyc29yLlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZXIoY3R4LCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGFycmF5Q29tcGxldGUoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHJlamVjdCwgaWRic3RvcmUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgY2IpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgb2Zmc2V0OiBmdW5jdGlvbiAob2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHRoaXMuX2N0eDtcbiAgICAgICAgICAgICAgICBpZiAob2Zmc2V0IDw9IDApIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgIGN0eC5vZmZzZXQgKz0gb2Zmc2V0OyAvLyBGb3IgY291bnQoKVxuICAgICAgICAgICAgICAgIGlmIChpc1BsYWluS2V5UmFuZ2UoY3R4KSkge1xuICAgICAgICAgICAgICAgICAgICBhZGRSZXBsYXlGaWx0ZXIoY3R4LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0TGVmdCA9IG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoY3Vyc29yLCBhZHZhbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9mZnNldExlZnQgPT09IDApIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvZmZzZXRMZWZ0ID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tb2Zmc2V0TGVmdDtyZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkdmFuY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3IuYWR2YW5jZShvZmZzZXRMZWZ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0TGVmdCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkUmVwbGF5RmlsdGVyKGN0eCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldExlZnQgPSBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtLW9mZnNldExlZnQgPCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgbGltaXQ6IGZ1bmN0aW9uIChudW1Sb3dzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3R4LmxpbWl0ID0gTWF0aC5taW4odGhpcy5fY3R4LmxpbWl0LCBudW1Sb3dzKTsgLy8gRm9yIGNvdW50KClcbiAgICAgICAgICAgICAgICBhZGRSZXBsYXlGaWx0ZXIodGhpcy5fY3R4LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByb3dzTGVmdCA9IG51bVJvd3M7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoY3Vyc29yLCBhZHZhbmNlLCByZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoLS1yb3dzTGVmdCA8PSAwKSBhZHZhbmNlKHJlc29sdmUpOyAvLyBTdG9wIGFmdGVyIHRoaXMgaXRlbSBoYXMgYmVlbiBpbmNsdWRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvd3NMZWZ0ID49IDA7IC8vIElmIG51bVJvd3MgaXMgYWxyZWFkeSBiZWxvdyAwLCByZXR1cm4gZmFsc2UgYmVjYXVzZSB0aGVuIDAgd2FzIHBhc3NlZCB0byBudW1Sb3dzIGluaXRpYWxseS4gT3RoZXJ3aXNlIHdlIHdvdWxkbnQgY29tZSBoZXJlLlxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgdW50aWw6IGZ1bmN0aW9uIChmaWx0ZXJGdW5jdGlvbiwgYkluY2x1ZGVTdG9wRW50cnkpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5fY3R4O1xuICAgICAgICAgICAgICAgIGZha2UgJiYgZmlsdGVyRnVuY3Rpb24oZ2V0SW5zdGFuY2VUZW1wbGF0ZShjdHgpKTtcbiAgICAgICAgICAgICAgICBhZGRGaWx0ZXIodGhpcy5fY3R4LCBmdW5jdGlvbiAoY3Vyc29yLCBhZHZhbmNlLCByZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJGdW5jdGlvbihjdXJzb3IudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZHZhbmNlKHJlc29sdmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJJbmNsdWRlU3RvcEVudHJ5O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGZpcnN0OiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5saW1pdCgxKS50b0FycmF5KGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhWzBdO1xuICAgICAgICAgICAgICAgIH0pLnRoZW4oY2IpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgbGFzdDogZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmV2ZXJzZSgpLmZpcnN0KGNiKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGZpbHRlcjogZnVuY3Rpb24gKGZpbHRlckZ1bmN0aW9uKSB7XG4gICAgICAgICAgICAgICAgLy8vIDxwYXJhbSBuYW1lPVwianNGdW5jdGlvbkZpbHRlclwiIHR5cGU9XCJGdW5jdGlvblwiPmZ1bmN0aW9uKHZhbCl7cmV0dXJuIHRydWUvZmFsc2V9PC9wYXJhbT5cbiAgICAgICAgICAgICAgICBmYWtlICYmIGZpbHRlckZ1bmN0aW9uKGdldEluc3RhbmNlVGVtcGxhdGUodGhpcy5fY3R4KSk7XG4gICAgICAgICAgICAgICAgYWRkRmlsdGVyKHRoaXMuX2N0eCwgZnVuY3Rpb24gKGN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyRnVuY3Rpb24oY3Vyc29yLnZhbHVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBtYXRjaCBmaWx0ZXJzIG5vdCB1c2VkIGluIERleGllLmpzIGJ1dCBjYW4gYmUgdXNlZCBieSAzcmQgcGFydCBsaWJyYXJpZXMgdG8gdGVzdCBhXG4gICAgICAgICAgICAgICAgLy8gY29sbGVjdGlvbiBmb3IgYSBtYXRjaCB3aXRob3V0IHF1ZXJ5aW5nIERCLiBVc2VkIGJ5IERleGllLk9ic2VydmFibGUuXG4gICAgICAgICAgICAgICAgYWRkTWF0Y2hGaWx0ZXIodGhpcy5fY3R4LCBmaWx0ZXJGdW5jdGlvbik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBhbmQ6IGZ1bmN0aW9uIChmaWx0ZXJGdW5jdGlvbikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbHRlcihmaWx0ZXJGdW5jdGlvbik7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBvcjogZnVuY3Rpb24gKGluZGV4TmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgV2hlcmVDbGF1c2UodGhpcy5fY3R4LnRhYmxlLCBpbmRleE5hbWUsIHRoaXMpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgcmV2ZXJzZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2N0eC5kaXIgPSB0aGlzLl9jdHguZGlyID09PSBcInByZXZcIiA/IFwibmV4dFwiIDogXCJwcmV2XCI7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uZGlyZWN0aW9uY2hhbmdlKSB0aGlzLl9vbmRpcmVjdGlvbmNoYW5nZSh0aGlzLl9jdHguZGlyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGRlc2M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXZlcnNlKCk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBlYWNoS2V5OiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5fY3R4O1xuICAgICAgICAgICAgICAgIGN0eC5rZXlzT25seSA9ICFjdHguaXNNYXRjaDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICh2YWwsIGN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICBjYihjdXJzb3Iua2V5LCBjdXJzb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZWFjaFVuaXF1ZUtleTogZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3R4LnVuaXF1ZSA9IFwidW5pcXVlXCI7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaEtleShjYik7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBlYWNoUHJpbWFyeUtleTogZnVuY3Rpb24gKGNiKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHRoaXMuX2N0eDtcbiAgICAgICAgICAgICAgICBjdHgua2V5c09ubHkgPSAhY3R4LmlzTWF0Y2g7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAodmFsLCBjdXJzb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY2IoY3Vyc29yLnByaW1hcnlLZXksIGN1cnNvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBrZXlzOiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5fY3R4O1xuICAgICAgICAgICAgICAgIGN0eC5rZXlzT25seSA9ICFjdHguaXNNYXRjaDtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGl0ZW0sIGN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICBhLnB1c2goY3Vyc29yLmtleSk7XG4gICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgICAgIH0pLnRoZW4oY2IpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgcHJpbWFyeUtleXM6IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgICAgICAgIHZhciBjdHggPSB0aGlzLl9jdHg7XG4gICAgICAgICAgICAgICAgaWYgKGhhc0dldEFsbCAmJiBjdHguZGlyID09PSAnbmV4dCcgJiYgaXNQbGFpbktleVJhbmdlKGN0eCwgdHJ1ZSkgJiYgY3R4LmxpbWl0ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIG9wdGltYXRpb24gaWYgd2UgY291bGQgdXNlIElEQk9iamVjdFN0b3JlLmdldEFsbEtleXMoKSBvclxuICAgICAgICAgICAgICAgICAgICAvLyBJREJLZXlSYW5nZS5nZXRBbGxLZXlzKCk6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWFkKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4T3JTdG9yZSA9IGdldEluZGV4T3JTdG9yZShjdHgsIGlkYnN0b3JlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXEgPSBjdHgubGltaXQgPCBJbmZpbml0eSA/IGlkeE9yU3RvcmUuZ2V0QWxsS2V5cyhjdHgucmFuZ2UsIGN0eC5saW1pdCkgOiBpZHhPclN0b3JlLmdldEFsbEtleXMoY3R4LnJhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5vbmVycm9yID0gZXZlbnRSZWplY3RIYW5kbGVyKHJlamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXEub25zdWNjZXNzID0gZXZlbnRTdWNjZXNzSGFuZGxlcihyZXNvbHZlKTtcbiAgICAgICAgICAgICAgICAgICAgfSkudGhlbihjYik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGN0eC5rZXlzT25seSA9ICFjdHguaXNNYXRjaDtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGl0ZW0sIGN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICBhLnB1c2goY3Vyc29yLnByaW1hcnlLZXkpO1xuICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgICAgICB9KS50aGVuKGNiKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHVuaXF1ZUtleXM6IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2N0eC51bmlxdWUgPSBcInVuaXF1ZVwiO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmtleXMoY2IpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZmlyc3RLZXk6IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxpbWl0KDEpLmtleXMoZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFbMF07XG4gICAgICAgICAgICAgICAgfSkudGhlbihjYik7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBsYXN0S2V5OiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXZlcnNlKCkuZmlyc3RLZXkoY2IpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZGlzdGluY3Q6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5fY3R4LFxuICAgICAgICAgICAgICAgICAgICBpZHggPSBjdHguaW5kZXggJiYgY3R4LnRhYmxlLnNjaGVtYS5pZHhCeU5hbWVbY3R4LmluZGV4XTtcbiAgICAgICAgICAgICAgICBpZiAoIWlkeCB8fCAhaWR4Lm11bHRpKSByZXR1cm4gdGhpczsgLy8gZGlzdGluY3QoKSBvbmx5IG1ha2VzIGRpZmZlcmVuY2llcyBvbiBtdWx0aUVudHJ5IGluZGV4ZXMuXG4gICAgICAgICAgICAgICAgdmFyIHNldCA9IHt9O1xuICAgICAgICAgICAgICAgIGFkZEZpbHRlcih0aGlzLl9jdHgsIGZ1bmN0aW9uIChjdXJzb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cktleSA9IGN1cnNvci5wcmltYXJ5S2V5LnRvU3RyaW5nKCk7IC8vIENvbnZlcnRzIGFueSBEYXRlIHRvIFN0cmluZywgU3RyaW5nIHRvIFN0cmluZywgTnVtYmVyIHRvIFN0cmluZyBhbmQgQXJyYXkgdG8gY29tbWEtc2VwYXJhdGVkIHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBoYXNPd24oc2V0LCBzdHJLZXkpO1xuICAgICAgICAgICAgICAgICAgICBzZXRbc3RyS2V5XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhZm91bmQ7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvL1xuICAgIC8vXG4gICAgLy8gV3JpdGVhYmxlQ29sbGVjdGlvbiBDbGFzc1xuICAgIC8vXG4gICAgLy9cbiAgICBmdW5jdGlvbiBXcml0ZWFibGVDb2xsZWN0aW9uKCkge1xuICAgICAgICBDb2xsZWN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgZGVyaXZlKFdyaXRlYWJsZUNvbGxlY3Rpb24pLmZyb20oQ29sbGVjdGlvbikuZXh0ZW5kKHtcblxuICAgICAgICAvL1xuICAgICAgICAvLyBXcml0ZWFibGVDb2xsZWN0aW9uIFB1YmxpYyBNZXRob2RzXG4gICAgICAgIC8vXG5cbiAgICAgICAgbW9kaWZ5OiBmdW5jdGlvbiAoY2hhbmdlcykge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgICAgICAgICAgIGN0eCA9IHRoaXMuX2N0eCxcbiAgICAgICAgICAgICAgICBob29rID0gY3R4LnRhYmxlLmhvb2ssXG4gICAgICAgICAgICAgICAgdXBkYXRpbmdIb29rID0gaG9vay51cGRhdGluZy5maXJlLFxuICAgICAgICAgICAgICAgIGRlbGV0aW5nSG9vayA9IGhvb2suZGVsZXRpbmcuZmlyZTtcblxuICAgICAgICAgICAgZmFrZSAmJiB0eXBlb2YgY2hhbmdlcyA9PT0gJ2Z1bmN0aW9uJyAmJiBjaGFuZ2VzLmNhbGwoeyB2YWx1ZTogY3R4LnRhYmxlLnNjaGVtYS5pbnN0YW5jZVRlbXBsYXRlIH0sIGN0eC50YWJsZS5zY2hlbWEuaW5zdGFuY2VUZW1wbGF0ZSk7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl93cml0ZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0LCBpZGJzdG9yZSwgdHJhbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgbW9kaWZ5ZXI7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjaGFuZ2VzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENoYW5nZXMgaXMgYSBmdW5jdGlvbiB0aGF0IG1heSB1cGRhdGUsIGFkZCBvciBkZWxldGUgcHJvcHRlcnRpZXMgb3IgZXZlbiByZXF1aXJlIGEgZGVsZXRpb24gdGhlIG9iamVjdCBpdHNlbGYgKGRlbGV0ZSB0aGlzLml0ZW0pXG4gICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGluZ0hvb2sgPT09IG5vcCAmJiBkZWxldGluZ0hvb2sgPT09IG5vcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm9vbmUgY2FyZXMgYWJvdXQgd2hhdCBpcyBiZWluZyBjaGFuZ2VkLiBKdXN0IGxldCB0aGUgbW9kaWZpZXIgZnVuY3Rpb24gYmUgdGhlIGdpdmVuIGFyZ3VtZW50IGFzIGlzLlxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZ5ZXIgPSBjaGFuZ2VzO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUGVvcGxlIHdhbnQgdG8ga25vdyBleGFjdGx5IHdoYXQgaXMgYmVpbmcgbW9kaWZpZWQgb3IgZGVsZXRlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIExldCBtb2RpZnllciBiZSBhIHByb3h5IGZ1bmN0aW9uIHRoYXQgZmluZHMgb3V0IHdoYXQgY2hhbmdlcyB0aGUgY2FsbGVyIGlzIGFjdHVhbGx5IGRvaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgY2FsbCB0aGUgaG9va3MgYWNjb3JkaW5nbHkhXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RpZnllciA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9yaWdJdGVtID0gZGVlcENsb25lKGl0ZW0pOyAvLyBDbG9uZSB0aGUgaXRlbSBmaXJzdCBzbyB3ZSBjYW4gY29tcGFyZSBsYXRlcnMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZXMuY2FsbCh0aGlzLCBpdGVtLCB0aGlzKSA9PT0gZmFsc2UpIHJldHVybiBmYWxzZTsgLy8gQ2FsbCB0aGUgcmVhbCBtb2RpZnllciBmdW5jdGlvbiAoSWYgaXQgcmV0dXJucyBmYWxzZSBleHBsaWNpdGVseSwgaXQgbWVhbnMgaXQgZG9udCB3YW50IHRvIG1vZGlmeSBhbnl0aW5nIG9uIHRoaXMgb2JqZWN0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGFzT3duKHRoaXMsIFwidmFsdWVcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHJlYWwgbW9kaWZ5ZXIgZnVuY3Rpb24gcmVxdWVzdHMgYSBkZWxldGlvbiBvZiB0aGUgb2JqZWN0LiBJbmZvcm0gdGhlIGRlbGV0aW5nSG9vayB0aGF0IGEgZGVsZXRpb24gaXMgdGFraW5nIHBsYWNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGluZ0hvb2suY2FsbCh0aGlzLCB0aGlzLnByaW1LZXksIGl0ZW0sIHRyYW5zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBObyBkZWxldGlvbi4gQ2hlY2sgd2hhdCB3YXMgY2hhbmdlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0RGlmZiA9IGdldE9iamVjdERpZmYob3JpZ0l0ZW0sIHRoaXMudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWRkaXRpb25hbENoYW5nZXMgPSB1cGRhdGluZ0hvb2suY2FsbCh0aGlzLCBvYmplY3REaWZmLCB0aGlzLnByaW1LZXksIG9yaWdJdGVtLCB0cmFucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZGRpdGlvbmFsQ2hhbmdlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG9vayB3YW50IHRvIGFwcGx5IGFkZGl0aW9uYWwgbW9kaWZpY2F0aW9ucy4gTWFrZSBzdXJlIHRvIGZ1bGxmaWxsIHRoZSB3aWxsIG9mIHRoZSBob29rLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IHRoaXMudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzKGFkZGl0aW9uYWxDaGFuZ2VzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXlQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0QnlLZXlQYXRoKGl0ZW0sIGtleVBhdGgsIGFkZGl0aW9uYWxDaGFuZ2VzW2tleVBhdGhdKTsgLy8gQWRkaW5nIHtrZXlQYXRoOiB1bmRlZmluZWR9IG1lYW5zIHRoYXQgdGhlIGtleVBhdGggc2hvdWxkIGJlIGRlbGV0ZWQuIEhhbmRsZWQgYnkgc2V0QnlLZXlQYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVwZGF0aW5nSG9vayA9PT0gbm9wKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoYW5nZXMgaXMgYSBzZXQgb2Yge2tleVBhdGg6IHZhbHVlfSBhbmQgbm8gb25lIGlzIGxpc3RlbmluZyB0byB0aGUgdXBkYXRpbmcgaG9vay5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleVBhdGhzID0ga2V5cyhjaGFuZ2VzKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG51bUtleXMgPSBrZXlQYXRocy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIG1vZGlmeWVyID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbnl0aGluZ01vZGlmaWVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bUtleXM7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXlQYXRoID0ga2V5UGF0aHNbaV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9IGNoYW5nZXNba2V5UGF0aF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdldEJ5S2V5UGF0aChpdGVtLCBrZXlQYXRoKSAhPT0gdmFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEJ5S2V5UGF0aChpdGVtLCBrZXlQYXRoLCB2YWwpOyAvLyBBZGRpbmcge2tleVBhdGg6IHVuZGVmaW5lZH0gbWVhbnMgdGhhdCB0aGUga2V5UGF0aCBzaG91bGQgYmUgZGVsZXRlZC4gSGFuZGxlZCBieSBzZXRCeUtleVBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW55dGhpbmdNb2RpZmllZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFueXRoaW5nTW9kaWZpZWQ7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hhbmdlcyBpcyBhIHNldCBvZiB7a2V5UGF0aDogdmFsdWV9IGFuZCBwZW9wbGUgYXJlIGxpc3RlbmluZyB0byB0aGUgdXBkYXRpbmcgaG9vayBzbyB3ZSBuZWVkIHRvIGNhbGwgaXQgYW5kXG4gICAgICAgICAgICAgICAgICAgIC8vIGFsbG93IGl0IHRvIGFkZCBhZGRpdGlvbmFsIG1vZGlmaWNhdGlvbnMgdG8gbWFrZS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG9yaWdDaGFuZ2VzID0gY2hhbmdlcztcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlcyA9IHNoYWxsb3dDbG9uZShvcmlnQ2hhbmdlcyk7IC8vIExldCdzIHdvcmsgd2l0aCBhIGNsb25lIG9mIHRoZSBjaGFuZ2VzIGtleVBhdGgvdmFsdWUgc2V0IHNvIHRoYXQgd2UgY2FuIHJlc3RvcmUgaXQgaW4gY2FzZSBhIGhvb2sgZXh0ZW5kcyBpdC5cbiAgICAgICAgICAgICAgICAgICAgbW9kaWZ5ZXIgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFueXRoaW5nTW9kaWZpZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhZGRpdGlvbmFsQ2hhbmdlcyA9IHVwZGF0aW5nSG9vay5jYWxsKHRoaXMsIGNoYW5nZXMsIHRoaXMucHJpbUtleSwgZGVlcENsb25lKGl0ZW0pLCB0cmFucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWRkaXRpb25hbENoYW5nZXMpIGV4dGVuZChjaGFuZ2VzLCBhZGRpdGlvbmFsQ2hhbmdlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlzKGNoYW5nZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleVBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsID0gY2hhbmdlc1trZXlQYXRoXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0QnlLZXlQYXRoKGl0ZW0sIGtleVBhdGgpICE9PSB2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0QnlLZXlQYXRoKGl0ZW0sIGtleVBhdGgsIHZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFueXRoaW5nTW9kaWZpZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFkZGl0aW9uYWxDaGFuZ2VzKSBjaGFuZ2VzID0gc2hhbGxvd0Nsb25lKG9yaWdDaGFuZ2VzKTsgLy8gUmVzdG9yZSBvcmlnaW5hbCBjaGFuZ2VzIGZvciBuZXh0IGl0ZXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFueXRoaW5nTW9kaWZpZWQ7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2Vzc0NvdW50ID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgaXRlcmF0aW9uQ29tcGxldGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgZmFpbEtleXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudEtleSA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBtb2RpZnlJdGVtKGl0ZW0sIGN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50S2V5ID0gY3Vyc29yLnByaW1hcnlLZXk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aGlzQ29udGV4dCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1LZXk6IGN1cnNvci5wcmltYXJ5S2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0sXG4gICAgICAgICAgICAgICAgICAgICAgICBvbnN1Y2Nlc3M6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBvbmVycm9yOiBudWxsXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gb25lcnJvcihlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmYWlsdXJlcy5wdXNoKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbEtleXMucHVzaCh0aGlzQ29udGV4dC5wcmltS2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrRmluaXNoZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOyAvLyBDYXRjaCB0aGVzZSBlcnJvcnMgYW5kIGxldCBhIGZpbmFsIHJlamVjdGlvbiBkZWNpZGUgd2hldGhlciBvciBub3QgdG8gYWJvcnQgZW50aXJlIHRyYW5zYWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAobW9kaWZ5ZXIuY2FsbCh0aGlzQ29udGV4dCwgaXRlbSwgdGhpc0NvbnRleHQpICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgYSBjYWxsYmFjayBleHBsaWNpdGVseSByZXR1cm5zIGZhbHNlLCBkbyBub3QgcGVyZm9ybSB0aGUgdXBkYXRlIVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJEZWxldGUgPSAhaGFzT3duKHRoaXNDb250ZXh0LCBcInZhbHVlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgKytjb3VudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeUNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVxID0gYkRlbGV0ZSA/IGN1cnNvci5kZWxldGUoKSA6IGN1cnNvci51cGRhdGUodGhpc0NvbnRleHQudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5faG9va0N0eCA9IHRoaXNDb250ZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5vbmVycm9yID0gaG9va2VkRXZlbnRSZWplY3RIYW5kbGVyKG9uZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5vbnN1Y2Nlc3MgPSBob29rZWRFdmVudFN1Y2Nlc3NIYW5kbGVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKytzdWNjZXNzQ291bnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrRmluaXNoZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIG9uZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXNDb250ZXh0Lm9uc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG9vayB3aWxsIGV4cGVjdCBlaXRoZXIgb25lcnJvciBvciBvbnN1Y2Nlc3MgdG8gYWx3YXlzIGJlIGNhbGxlZCFcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNDb250ZXh0Lm9uc3VjY2Vzcyh0aGlzQ29udGV4dC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkb1JlamVjdChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmYWlsdXJlcy5wdXNoKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbEtleXMucHVzaChjdXJyZW50S2V5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBNb2RpZnlFcnJvcihcIkVycm9yIG1vZGlmeWluZyBvbmUgb3IgbW9yZSBvYmplY3RzXCIsIGZhaWx1cmVzLCBzdWNjZXNzQ291bnQsIGZhaWxLZXlzKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tGaW5pc2hlZCgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZXJhdGlvbkNvbXBsZXRlICYmIHN1Y2Nlc3NDb3VudCArIGZhaWx1cmVzLmxlbmd0aCA9PT0gY291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmYWlsdXJlcy5sZW5ndGggPiAwKSBkb1JlamVjdCgpO2Vsc2UgcmVzb2x2ZShzdWNjZXNzQ291bnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYuY2xvbmUoKS5yYXcoKS5faXRlcmF0ZShtb2RpZnlJdGVtLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZXJhdGlvbkNvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tGaW5pc2hlZCgpO1xuICAgICAgICAgICAgICAgIH0sIGRvUmVqZWN0LCBpZGJzdG9yZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAnZGVsZXRlJzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBjdHggPSB0aGlzLl9jdHgsXG4gICAgICAgICAgICAgICAgcmFuZ2UgPSBjdHgucmFuZ2UsXG4gICAgICAgICAgICAgICAgZGVsZXRpbmdIb29rID0gY3R4LnRhYmxlLmhvb2suZGVsZXRpbmcuZmlyZSxcbiAgICAgICAgICAgICAgICBoYXNEZWxldGVIb29rID0gZGVsZXRpbmdIb29rICE9PSBub3A7XG4gICAgICAgICAgICBpZiAoIWhhc0RlbGV0ZUhvb2sgJiYgaXNQbGFpbktleVJhbmdlKGN0eCkgJiYgKGN0eC5pc1ByaW1LZXkgJiYgIWhhbmdzT25EZWxldGVMYXJnZUtleVJhbmdlIHx8ICFyYW5nZSkpIC8vIGlmIG5vIHJhbmdlLCB3ZSdsbCB1c2UgY2xlYXIoKS5cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE1heSB1c2UgSURCT2JqZWN0U3RvcmUuZGVsZXRlKElEQktleVJhbmdlKSBpbiB0aGlzIGNhc2UgKElzc3VlICMyMDgpXG4gICAgICAgICAgICAgICAgICAgIC8vIEZvciBjaHJvbWl1bSwgdGhpcyBpcyB0aGUgd2F5IG1vc3Qgb3B0aW1pemVkIHZlcnNpb24uXG4gICAgICAgICAgICAgICAgICAgIC8vIEZvciBJRS9FZGdlLCB0aGlzIGNvdWxkIGhhbmcgdGhlIGluZGV4ZWREQiBlbmdpbmUgYW5kIG1ha2Ugb3BlcmF0aW5nIHN5c3RlbSBpbnN0YWJsZVxuICAgICAgICAgICAgICAgICAgICAvLyAoaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vZGZhaGxhbmRlci81YTM5MzI4ZjAyOWRlMTgyMjJjZjIxMjVkNTZjMzhmNylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dyaXRlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPdXIgQVBJIGNvbnRyYWN0IGlzIHRvIHJldHVybiBhIGNvdW50IG9mIGRlbGV0ZWQgaXRlbXMsIHNvIHdlIGhhdmUgdG8gY291bnQoKSBiZWZvcmUgZGVsZXRlKCkuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb25lcnJvciA9IGV2ZW50UmVqZWN0SGFuZGxlcihyZWplY3QpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50UmVxID0gcmFuZ2UgPyBpZGJzdG9yZS5jb3VudChyYW5nZSkgOiBpZGJzdG9yZS5jb3VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRSZXEub25lcnJvciA9IG9uZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudFJlcS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gY291bnRSZXEucmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeUNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlbFJlcSA9IHJhbmdlID8gaWRic3RvcmUuZGVsZXRlKHJhbmdlKSA6IGlkYnN0b3JlLmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbFJlcS5vbmVycm9yID0gb25lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsUmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKGNvdW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRGVmYXVsdCB2ZXJzaW9uIHRvIHVzZSB3aGVuIGNvbGxlY3Rpb24gaXMgbm90IGEgdmFuaWxsYSBJREJLZXlSYW5nZSBvbiB0aGUgcHJpbWFyeSBrZXkuXG4gICAgICAgICAgICAvLyBEaXZpZGUgaW50byBjaHVua3MgdG8gbm90IHN0YXJ2ZSBSQU0uXG4gICAgICAgICAgICAvLyBJZiBoYXMgZGVsZXRlIGhvb2ssIHdlIHdpbGwgaGF2ZSB0byBjb2xsZWN0IG5vdCBqdXN0IGtleXMgYnV0IGFsc28gb2JqZWN0cywgc28gaXQgd2lsbCB1c2VcbiAgICAgICAgICAgIC8vIG1vcmUgbWVtb3J5IGFuZCBuZWVkIGxvd2VyIGNodW5rIHNpemUuXG4gICAgICAgICAgICB2YXIgQ0hVTktTSVpFID0gaGFzRGVsZXRlSG9vayA/IDIwMDAgOiAxMDAwMDtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dyaXRlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIGlkYnN0b3JlLCB0cmFucykge1xuICAgICAgICAgICAgICAgIHZhciB0b3RhbENvdW50ID0gMDtcbiAgICAgICAgICAgICAgICAvLyBDbG9uZSBjb2xsZWN0aW9uIGFuZCBjaGFuZ2UgaXRzIHRhYmxlIGFuZCBzZXQgYSBsaW1pdCBvZiBDSFVOS1NJWkUgb24gdGhlIGNsb25lZCBDb2xsZWN0aW9uIGluc3RhbmNlLlxuICAgICAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gX3RoaXM0LmNsb25lKHtcbiAgICAgICAgICAgICAgICAgICAga2V5c09ubHk6ICFjdHguaXNNYXRjaCAmJiAhaGFzRGVsZXRlSG9vayB9KSAvLyBsb2FkIGp1c3Qga2V5cyAodW5sZXNzIGZpbHRlcigpIG9yIGFuZCgpIG9yIGRlbGV0ZUhvb2sgaGFzIHN1YnNjcmliZXJzKVxuICAgICAgICAgICAgICAgIC5kaXN0aW5jdCgpIC8vIEluIGNhc2UgbXVsdGlFbnRyeSBpcyB1c2VkLCBuZXZlciBkZWxldGUgc2FtZSBrZXkgdHdpY2UgYmVjYXVzZSByZXN1bHRpbmcgY291bnRcbiAgICAgICAgICAgICAgICAvLyB3b3VsZCBiZWNvbWUgbGFyZ2VyIHRoYW4gYWN0dWFsIGRlbGV0ZSBjb3VudC5cbiAgICAgICAgICAgICAgICAubGltaXQoQ0hVTktTSVpFKS5yYXcoKTsgLy8gRG9uJ3QgZmlsdGVyIHRocm91Z2ggcmVhZGluZy1ob29rcyAobGlrZSBtYXBwZWQgY2xhc3NlcyBldGMpXG5cbiAgICAgICAgICAgICAgICB2YXIga2V5c09yVHVwbGVzID0gW107XG5cbiAgICAgICAgICAgICAgICAvLyBXZSdyZSBnb25uYSBkbyB0aGluZ3Mgb24gYXMgbWFueSBjaHVua3MgdGhhdCBhcmUgbmVlZGVkLlxuICAgICAgICAgICAgICAgIC8vIFVzZSByZWN1cnNpb24gb2YgbmV4dENodW5rIGZ1bmN0aW9uOlxuICAgICAgICAgICAgICAgIHZhciBuZXh0Q2h1bmsgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uLmVhY2goaGFzRGVsZXRlSG9vayA/IGZ1bmN0aW9uICh2YWwsIGN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU29tZWJvZHkgc3Vic2NyaWJlcyB0byBob29rKCdkZWxldGluZycpLiBDb2xsZWN0IGFsbCBwcmltYXJ5IGtleXMgYW5kIHRoZWlyIHZhbHVlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvIHRoYXQgdGhlIGhvb2sgY2FuIGJlIGNhbGxlZCB3aXRoIGl0cyB2YWx1ZXMgaW4gYnVsa0RlbGV0ZSgpLlxuICAgICAgICAgICAgICAgICAgICAgICAga2V5c09yVHVwbGVzLnB1c2goW2N1cnNvci5wcmltYXJ5S2V5LCBjdXJzb3IudmFsdWVdKTtcbiAgICAgICAgICAgICAgICAgICAgfSA6IGZ1bmN0aW9uICh2YWwsIGN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm8gb25lIHN1YnNjcmliZXMgdG8gaG9vaygnZGVsZXRpbmcnKS4gQ29sbGVjdCBvbmx5IHByaW1hcnkga2V5czpcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleXNPclR1cGxlcy5wdXNoKGN1cnNvci5wcmltYXJ5S2V5KTtcbiAgICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDaHJvbWl1bSBkZWxldGVzIGZhc3RlciB3aGVuIGRvaW5nIGl0IGluIHNvcnQgb3JkZXIuXG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNEZWxldGVIb29rID8ga2V5c09yVHVwbGVzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXNjZW5kaW5nKGFbMF0sIGJbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkgOiBrZXlzT3JUdXBsZXMuc29ydChhc2NlbmRpbmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJ1bGtEZWxldGUoaWRic3RvcmUsIHRyYW5zLCBrZXlzT3JUdXBsZXMsIGhhc0RlbGV0ZUhvb2ssIGRlbGV0aW5nSG9vayk7XG4gICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0ga2V5c09yVHVwbGVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQ291bnQgKz0gY291bnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlzT3JUdXBsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb3VudCA8IENIVU5LU0laRSA/IHRvdGFsQ291bnQgOiBuZXh0Q2h1bmsoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJlc29sdmUobmV4dENodW5rKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vXG4gICAgLy9cbiAgICAvL1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gSGVscCBmdW5jdGlvbnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvL1xuICAgIC8vXG5cbiAgICBmdW5jdGlvbiBsb3dlclZlcnNpb25GaXJzdChhLCBiKSB7XG4gICAgICAgIHJldHVybiBhLl9jZmcudmVyc2lvbiAtIGIuX2NmZy52ZXJzaW9uO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldEFwaU9uUGxhY2Uob2JqcywgdGFibGVOYW1lcywgbW9kZSwgZGJzY2hlbWEpIHtcbiAgICAgICAgdGFibGVOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uICh0YWJsZU5hbWUpIHtcbiAgICAgICAgICAgIHZhciB0YWJsZUluc3RhbmNlID0gZGIuX3RhYmxlRmFjdG9yeShtb2RlLCBkYnNjaGVtYVt0YWJsZU5hbWVdKTtcbiAgICAgICAgICAgIG9ianMuZm9yRWFjaChmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgICAgdGFibGVOYW1lIGluIG9iaiB8fCAob2JqW3RhYmxlTmFtZV0gPSB0YWJsZUluc3RhbmNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVUYWJsZXNBcGkob2Jqcykge1xuICAgICAgICBvYmpzLmZvckVhY2goZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICAgICAgICAgIGlmIChvYmpba2V5XSBpbnN0YW5jZW9mIFRhYmxlKSBkZWxldGUgb2JqW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGl0ZXJhdGUocmVxLCBmaWx0ZXIsIGZuLCByZXNvbHZlLCByZWplY3QsIHZhbHVlTWFwcGVyKSB7XG5cbiAgICAgICAgLy8gQXBwbHkgdmFsdWVNYXBwZXIgKGhvb2soJ3JlYWRpbmcnKSBvciBtYXBwcGVkIGNsYXNzKVxuICAgICAgICB2YXIgbWFwcGVkRm4gPSB2YWx1ZU1hcHBlciA/IGZ1bmN0aW9uICh4LCBjLCBhKSB7XG4gICAgICAgICAgICByZXR1cm4gZm4odmFsdWVNYXBwZXIoeCksIGMsIGEpO1xuICAgICAgICB9IDogZm47XG4gICAgICAgIC8vIFdyYXAgZm4gd2l0aCBQU0QgYW5kIG1pY3JvdGljayBzdHVmZiBmcm9tIFByb21pc2UuXG4gICAgICAgIHZhciB3cmFwcGVkRm4gPSB3cmFwKG1hcHBlZEZuLCByZWplY3QpO1xuXG4gICAgICAgIGlmICghcmVxLm9uZXJyb3IpIHJlcS5vbmVycm9yID0gZXZlbnRSZWplY3RIYW5kbGVyKHJlamVjdCk7XG4gICAgICAgIGlmIChmaWx0ZXIpIHtcbiAgICAgICAgICAgIHJlcS5vbnN1Y2Nlc3MgPSB0cnljYXRjaGVyKGZ1bmN0aW9uIGZpbHRlcl9yZWNvcmQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnNvciA9IHJlcS5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnNvcikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsdGVyKGN1cnNvciwgZnVuY3Rpb24gKGFkdmFuY2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjID0gYWR2YW5jZXI7XG4gICAgICAgICAgICAgICAgICAgIH0sIHJlc29sdmUsIHJlamVjdCkpIHdyYXBwZWRGbihjdXJzb3IudmFsdWUsIGN1cnNvciwgZnVuY3Rpb24gKGFkdmFuY2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjID0gYWR2YW5jZXI7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHJlamVjdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXEub25zdWNjZXNzID0gdHJ5Y2F0Y2hlcihmdW5jdGlvbiBmaWx0ZXJfcmVjb3JkKCkge1xuICAgICAgICAgICAgICAgIHZhciBjdXJzb3IgPSByZXEucmVzdWx0O1xuICAgICAgICAgICAgICAgIGlmIChjdXJzb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgd3JhcHBlZEZuKGN1cnNvci52YWx1ZSwgY3Vyc29yLCBmdW5jdGlvbiAoYWR2YW5jZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBhZHZhbmNlcjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGMoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgcmVqZWN0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlSW5kZXhTeW50YXgoaW5kZXhlcykge1xuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJpbmRleGVzXCIgdHlwZT1cIlN0cmluZ1wiPjwvcGFyYW0+XG4gICAgICAgIC8vLyA8cmV0dXJucyB0eXBlPVwiQXJyYXlcIiBlbGVtZW50VHlwZT1cIkluZGV4U3BlY1wiPjwvcmV0dXJucz5cbiAgICAgICAgdmFyIHJ2ID0gW107XG4gICAgICAgIGluZGV4ZXMuc3BsaXQoJywnKS5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgaW5kZXggPSBpbmRleC50cmltKCk7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IGluZGV4LnJlcGxhY2UoLyhbJipdfFxcK1xcKykvZywgXCJcIik7IC8vIFJlbW92ZSBcIiZcIiwgXCIrK1wiIGFuZCBcIipcIlxuICAgICAgICAgICAgLy8gTGV0IGtleVBhdGggb2YgXCJbYStiXVwiIGJlIFtcImFcIixcImJcIl06XG4gICAgICAgICAgICB2YXIga2V5UGF0aCA9IC9eXFxbLy50ZXN0KG5hbWUpID8gbmFtZS5tYXRjaCgvXlxcWyguKilcXF0kLylbMV0uc3BsaXQoJysnKSA6IG5hbWU7XG5cbiAgICAgICAgICAgIHJ2LnB1c2gobmV3IEluZGV4U3BlYyhuYW1lLCBrZXlQYXRoIHx8IG51bGwsIC9cXCYvLnRlc3QoaW5kZXgpLCAvXFwqLy50ZXN0KGluZGV4KSwgL1xcK1xcKy8udGVzdChpbmRleCksIGlzQXJyYXkoa2V5UGF0aCksIC9cXC4vLnRlc3QoaW5kZXgpKSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcnY7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY21wKGtleTEsIGtleTIpIHtcbiAgICAgICAgcmV0dXJuIGluZGV4ZWREQi5jbXAoa2V5MSwga2V5Mik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWluKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGNtcChhLCBiKSA8IDAgPyBhIDogYjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtYXgoYSwgYikge1xuICAgICAgICByZXR1cm4gY21wKGEsIGIpID4gMCA/IGEgOiBiO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFzY2VuZGluZyhhLCBiKSB7XG4gICAgICAgIHJldHVybiBpbmRleGVkREIuY21wKGEsIGIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlc2NlbmRpbmcoYSwgYikge1xuICAgICAgICByZXR1cm4gaW5kZXhlZERCLmNtcChiLCBhKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzaW1wbGVDb21wYXJlKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEgPCBiID8gLTEgOiBhID09PSBiID8gMCA6IDE7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2ltcGxlQ29tcGFyZVJldmVyc2UoYSwgYikge1xuICAgICAgICByZXR1cm4gYSA+IGIgPyAtMSA6IGEgPT09IGIgPyAwIDogMTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb21iaW5lKGZpbHRlcjEsIGZpbHRlcjIpIHtcbiAgICAgICAgcmV0dXJuIGZpbHRlcjEgPyBmaWx0ZXIyID8gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZpbHRlcjEuYXBwbHkodGhpcywgYXJndW1lbnRzKSAmJiBmaWx0ZXIyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH0gOiBmaWx0ZXIxIDogZmlsdGVyMjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWFkR2xvYmFsU2NoZW1hKCkge1xuICAgICAgICBkYi52ZXJubyA9IGlkYmRiLnZlcnNpb24gLyAxMDtcbiAgICAgICAgZGIuX2RiU2NoZW1hID0gZ2xvYmFsU2NoZW1hID0ge307XG4gICAgICAgIGRiU3RvcmVOYW1lcyA9IHNsaWNlKGlkYmRiLm9iamVjdFN0b3JlTmFtZXMsIDApO1xuICAgICAgICBpZiAoZGJTdG9yZU5hbWVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOyAvLyBEYXRhYmFzZSBjb250YWlucyBubyBzdG9yZXMuXG4gICAgICAgIHZhciB0cmFucyA9IGlkYmRiLnRyYW5zYWN0aW9uKHNhZmFyaU11bHRpU3RvcmVGaXgoZGJTdG9yZU5hbWVzKSwgJ3JlYWRvbmx5Jyk7XG4gICAgICAgIGRiU3RvcmVOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChzdG9yZU5hbWUpIHtcbiAgICAgICAgICAgIHZhciBzdG9yZSA9IHRyYW5zLm9iamVjdFN0b3JlKHN0b3JlTmFtZSksXG4gICAgICAgICAgICAgICAga2V5UGF0aCA9IHN0b3JlLmtleVBhdGgsXG4gICAgICAgICAgICAgICAgZG90dGVkID0ga2V5UGF0aCAmJiB0eXBlb2Yga2V5UGF0aCA9PT0gJ3N0cmluZycgJiYga2V5UGF0aC5pbmRleE9mKCcuJykgIT09IC0xO1xuICAgICAgICAgICAgdmFyIHByaW1LZXkgPSBuZXcgSW5kZXhTcGVjKGtleVBhdGgsIGtleVBhdGggfHwgXCJcIiwgZmFsc2UsIGZhbHNlLCAhIXN0b3JlLmF1dG9JbmNyZW1lbnQsIGtleVBhdGggJiYgdHlwZW9mIGtleVBhdGggIT09ICdzdHJpbmcnLCBkb3R0ZWQpO1xuICAgICAgICAgICAgdmFyIGluZGV4ZXMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc3RvcmUuaW5kZXhOYW1lcy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgICAgIHZhciBpZGJpbmRleCA9IHN0b3JlLmluZGV4KHN0b3JlLmluZGV4TmFtZXNbal0pO1xuICAgICAgICAgICAgICAgIGtleVBhdGggPSBpZGJpbmRleC5rZXlQYXRoO1xuICAgICAgICAgICAgICAgIGRvdHRlZCA9IGtleVBhdGggJiYgdHlwZW9mIGtleVBhdGggPT09ICdzdHJpbmcnICYmIGtleVBhdGguaW5kZXhPZignLicpICE9PSAtMTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBuZXcgSW5kZXhTcGVjKGlkYmluZGV4Lm5hbWUsIGtleVBhdGgsICEhaWRiaW5kZXgudW5pcXVlLCAhIWlkYmluZGV4Lm11bHRpRW50cnksIGZhbHNlLCBrZXlQYXRoICYmIHR5cGVvZiBrZXlQYXRoICE9PSAnc3RyaW5nJywgZG90dGVkKTtcbiAgICAgICAgICAgICAgICBpbmRleGVzLnB1c2goaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2xvYmFsU2NoZW1hW3N0b3JlTmFtZV0gPSBuZXcgVGFibGVTY2hlbWEoc3RvcmVOYW1lLCBwcmltS2V5LCBpbmRleGVzLCB7fSk7XG4gICAgICAgIH0pO1xuICAgICAgICBzZXRBcGlPblBsYWNlKFthbGxUYWJsZXMsIFRyYW5zYWN0aW9uLnByb3RvdHlwZV0sIGtleXMoZ2xvYmFsU2NoZW1hKSwgUkVBRFdSSVRFLCBnbG9iYWxTY2hlbWEpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkanVzdFRvRXhpc3RpbmdJbmRleE5hbWVzKHNjaGVtYSwgaWRidHJhbnMpIHtcbiAgICAgICAgLy8vIDxzdW1tYXJ5PlxuICAgICAgICAvLy8gSXNzdWUgIzMwIFByb2JsZW0gd2l0aCBleGlzdGluZyBkYiAtIGFkanVzdCB0byBleGlzdGluZyBpbmRleCBuYW1lcyB3aGVuIG1pZ3JhdGluZyBmcm9tIG5vbi1kZXhpZSBkYlxuICAgICAgICAvLy8gPC9zdW1tYXJ5PlxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJzY2hlbWFcIiB0eXBlPVwiT2JqZWN0XCI+TWFwIGJldHdlZW4gbmFtZSBhbmQgVGFibGVTY2hlbWE8L3BhcmFtPlxuICAgICAgICAvLy8gPHBhcmFtIG5hbWU9XCJpZGJ0cmFuc1wiIHR5cGU9XCJJREJUcmFuc2FjdGlvblwiPjwvcGFyYW0+XG4gICAgICAgIHZhciBzdG9yZU5hbWVzID0gaWRidHJhbnMuZGIub2JqZWN0U3RvcmVOYW1lcztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdG9yZU5hbWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgc3RvcmVOYW1lID0gc3RvcmVOYW1lc1tpXTtcbiAgICAgICAgICAgIHZhciBzdG9yZSA9IGlkYnRyYW5zLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XG4gICAgICAgICAgICBoYXNHZXRBbGwgPSAnZ2V0QWxsJyBpbiBzdG9yZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc3RvcmUuaW5kZXhOYW1lcy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSBzdG9yZS5pbmRleE5hbWVzW2pdO1xuICAgICAgICAgICAgICAgIHZhciBrZXlQYXRoID0gc3RvcmUuaW5kZXgoaW5kZXhOYW1lKS5rZXlQYXRoO1xuICAgICAgICAgICAgICAgIHZhciBkZXhpZU5hbWUgPSB0eXBlb2Yga2V5UGF0aCA9PT0gJ3N0cmluZycgPyBrZXlQYXRoIDogXCJbXCIgKyBzbGljZShrZXlQYXRoKS5qb2luKCcrJykgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICBpZiAoc2NoZW1hW3N0b3JlTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4U3BlYyA9IHNjaGVtYVtzdG9yZU5hbWVdLmlkeEJ5TmFtZVtkZXhpZU5hbWVdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXhTcGVjKSBpbmRleFNwZWMubmFtZSA9IGluZGV4TmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaXJlT25CbG9ja2VkKGV2KSB7XG4gICAgICAgIGRiLm9uKFwiYmxvY2tlZFwiKS5maXJlKGV2KTtcbiAgICAgICAgLy8gV29ya2Fyb3VuZCAobm90IGZ1bGx5KikgZm9yIG1pc3NpbmcgXCJ2ZXJzaW9uY2hhbmdlXCIgZXZlbnQgaW4gSUUsRWRnZSBhbmQgU2FmYXJpOlxuICAgICAgICBjb25uZWN0aW9ucy5maWx0ZXIoZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgIHJldHVybiBjLm5hbWUgPT09IGRiLm5hbWUgJiYgYyAhPT0gZGIgJiYgIWMuX3ZjRmlyZWQ7XG4gICAgICAgIH0pLm1hcChmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgcmV0dXJuIGMub24oXCJ2ZXJzaW9uY2hhbmdlXCIpLmZpcmUoZXYpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBleHRlbmQodGhpcywge1xuICAgICAgICBDb2xsZWN0aW9uOiBDb2xsZWN0aW9uLFxuICAgICAgICBUYWJsZTogVGFibGUsXG4gICAgICAgIFRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbixcbiAgICAgICAgVmVyc2lvbjogVmVyc2lvbixcbiAgICAgICAgV2hlcmVDbGF1c2U6IFdoZXJlQ2xhdXNlLFxuICAgICAgICBXcml0ZWFibGVDb2xsZWN0aW9uOiBXcml0ZWFibGVDb2xsZWN0aW9uLFxuICAgICAgICBXcml0ZWFibGVUYWJsZTogV3JpdGVhYmxlVGFibGVcbiAgICB9KTtcblxuICAgIGluaXQoKTtcblxuICAgIGFkZG9ucy5mb3JFYWNoKGZ1bmN0aW9uIChmbikge1xuICAgICAgICBmbihkYik7XG4gICAgfSk7XG59XG5cbnZhciBmYWtlQXV0b0NvbXBsZXRlID0gZnVuY3Rpb24gKCkge307IC8vIFdpbGwgbmV2ZXIgYmUgY2hhbmdlZC4gV2UganVzdCBmYWtlIGZvciB0aGUgSURFIHRoYXQgd2UgY2hhbmdlIGl0IChzZWUgZG9GYWtlQXV0b0NvbXBsZXRlKCkpXG52YXIgZmFrZSA9IGZhbHNlOyAvLyBXaWxsIG5ldmVyIGJlIGNoYW5nZWQuIFdlIGp1c3QgZmFrZSBmb3IgdGhlIElERSB0aGF0IHdlIGNoYW5nZSBpdCAoc2VlIGRvRmFrZUF1dG9Db21wbGV0ZSgpKVxuXG5mdW5jdGlvbiBwYXJzZVR5cGUodHlwZSkge1xuICAgIGlmICh0eXBlb2YgdHlwZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gbmV3IHR5cGUoKTtcbiAgICB9IGVsc2UgaWYgKGlzQXJyYXkodHlwZSkpIHtcbiAgICAgICAgcmV0dXJuIFtwYXJzZVR5cGUodHlwZVswXSldO1xuICAgIH0gZWxzZSBpZiAodHlwZSAmJiB0eXBlb2YgdHlwZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgdmFyIHJ2ID0ge307XG4gICAgICAgIGFwcGx5U3RydWN0dXJlKHJ2LCB0eXBlKTtcbiAgICAgICAgcmV0dXJuIHJ2O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0eXBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gYXBwbHlTdHJ1Y3R1cmUob2JqLCBzdHJ1Y3R1cmUpIHtcbiAgICBrZXlzKHN0cnVjdHVyZSkuZm9yRWFjaChmdW5jdGlvbiAobWVtYmVyKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHBhcnNlVHlwZShzdHJ1Y3R1cmVbbWVtYmVyXSk7XG4gICAgICAgIG9ialttZW1iZXJdID0gdmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIG9iajtcbn1cblxuZnVuY3Rpb24gZXZlbnRTdWNjZXNzSGFuZGxlcihkb25lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldikge1xuICAgICAgICBkb25lKGV2LnRhcmdldC5yZXN1bHQpO1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIGhvb2tlZEV2ZW50U3VjY2Vzc0hhbmRsZXIocmVzb2x2ZSkge1xuICAgIC8vIHdyYXAoKSBpcyBuZWVkZWQgd2hlbiBjYWxsaW5nIGhvb2tzIGJlY2F1c2UgdGhlIHJhcmUgc2NlbmFyaW8gb2Y6XG4gICAgLy8gICogaG9vayBkb2VzIGEgZGIgb3BlcmF0aW9uIHRoYXQgZmFpbHMgaW1tZWRpYXRlbHkgKElEQiB0aHJvd3MgZXhjZXB0aW9uKVxuICAgIC8vICAgIEZvciBjYWxsaW5nIGRiIG9wZXJhdGlvbnMgb24gY29ycmVjdCB0cmFuc2FjdGlvbiwgd3JhcCBtYWtlcyBzdXJlIHRvIHNldCBQU0QgY29ycmVjdGx5LlxuICAgIC8vICAgIHdyYXAoKSB3aWxsIGFsc28gZXhlY3V0ZSBpbiBhIHZpcnR1YWwgdGljay5cbiAgICAvLyAgKiBJZiBub3Qgd3JhcHBlZCBpbiBhIHZpcnR1YWwgdGljaywgZGlyZWN0IGV4Y2VwdGlvbiB3aWxsIGxhdW5jaCBhIG5ldyBwaHlzaWNhbCB0aWNrLlxuICAgIC8vICAqIElmIHRoaXMgd2FzIHRoZSBsYXN0IGV2ZW50IGluIHRoZSBidWxrLCB0aGUgcHJvbWlzZSB3aWxsIHJlc29sdmUgYWZ0ZXIgYSBwaHlzaWNhbCB0aWNrXG4gICAgLy8gICAgYW5kIHRoZSB0cmFuc2FjdGlvbiB3aWxsIGhhdmUgY29tbWl0dGVkIGFscmVhZHkuXG4gICAgLy8gSWYgbm8gaG9vaywgdGhlIHZpcnR1YWwgdGljayB3aWxsIGJlIGV4ZWN1dGVkIGluIHRoZSByZWplY3QoKS9yZXNvbHZlIG9mIHRoZSBmaW5hbCBwcm9taXNlLFxuICAgIC8vIGJlY2F1c2UgaXQgaXMgYWx3YXlzIG1hcmtlZCB3aXRoIF9saWIgPSB0cnVlIHdoZW4gY3JlYXRlZCB1c2luZyBUcmFuc2FjdGlvbi5fcHJvbWlzZSgpLlxuICAgIHJldHVybiB3cmFwKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgcmVxID0gZXZlbnQudGFyZ2V0LFxuICAgICAgICAgICAgcmVzdWx0ID0gcmVxLnJlc3VsdCxcbiAgICAgICAgICAgIGN0eCA9IHJlcS5faG9va0N0eCxcbiAgICAgICAgICAgIC8vIENvbnRhaW5zIHRoZSBob29rIGVycm9yIGhhbmRsZXIuIFB1dCBoZXJlIGluc3RlYWQgb2YgY2xvc3VyZSB0byBib29zdCBwZXJmb3JtYW5jZS5cbiAgICAgICAgaG9va1N1Y2Nlc3NIYW5kbGVyID0gY3R4ICYmIGN0eC5vbnN1Y2Nlc3M7XG4gICAgICAgIGhvb2tTdWNjZXNzSGFuZGxlciAmJiBob29rU3VjY2Vzc0hhbmRsZXIocmVzdWx0KTtcbiAgICAgICAgcmVzb2x2ZSAmJiByZXNvbHZlKHJlc3VsdCk7XG4gICAgfSwgcmVzb2x2ZSk7XG59XG5cbmZ1bmN0aW9uIGV2ZW50UmVqZWN0SGFuZGxlcihyZWplY3QpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHByZXZlbnREZWZhdWx0KGV2ZW50KTtcbiAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBob29rZWRFdmVudFJlamVjdEhhbmRsZXIocmVqZWN0KSB7XG4gICAgcmV0dXJuIHdyYXAoZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIC8vIFNlZSBjb21tZW50IG9uIGhvb2tlZEV2ZW50U3VjY2Vzc0hhbmRsZXIoKSB3aHkgd3JhcCgpIGlzIG5lZWRlZCBvbmx5IHdoZW4gc3VwcG9ydGluZyBob29rcy5cblxuICAgICAgICB2YXIgcmVxID0gZXZlbnQudGFyZ2V0LFxuICAgICAgICAgICAgZXJyID0gcmVxLmVycm9yLFxuICAgICAgICAgICAgY3R4ID0gcmVxLl9ob29rQ3R4LFxuICAgICAgICAgICAgLy8gQ29udGFpbnMgdGhlIGhvb2sgZXJyb3IgaGFuZGxlci4gUHV0IGhlcmUgaW5zdGVhZCBvZiBjbG9zdXJlIHRvIGJvb3N0IHBlcmZvcm1hbmNlLlxuICAgICAgICBob29rRXJyb3JIYW5kbGVyID0gY3R4ICYmIGN0eC5vbmVycm9yO1xuICAgICAgICBob29rRXJyb3JIYW5kbGVyICYmIGhvb2tFcnJvckhhbmRsZXIoZXJyKTtcbiAgICAgICAgcHJldmVudERlZmF1bHQoZXZlbnQpO1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBwcmV2ZW50RGVmYXVsdChldmVudCkge1xuICAgIGlmIChldmVudC5zdG9wUHJvcGFnYXRpb24pIC8vIEluZGV4ZWREQlNoaW0gZG9lc250IHN1cHBvcnQgdGhpcyBvbiBTYWZhcmkgOCBhbmQgYmVsb3cuXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGlmIChldmVudC5wcmV2ZW50RGVmYXVsdCkgLy8gSW5kZXhlZERCU2hpbSBkb2VzbnQgc3VwcG9ydCB0aGlzIG9uIFNhZmFyaSA4IGFuZCBiZWxvdy5cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbn1cblxuZnVuY3Rpb24gZ2xvYmFsRGF0YWJhc2VMaXN0KGNiKSB7XG4gICAgdmFyIHZhbCxcbiAgICAgICAgbG9jYWxTdG9yYWdlID0gRGV4aWUuZGVwZW5kZW5jaWVzLmxvY2FsU3RvcmFnZTtcbiAgICBpZiAoIWxvY2FsU3RvcmFnZSkgcmV0dXJuIGNiKFtdKTsgLy8gRW52cyB3aXRob3V0IGxvY2FsU3RvcmFnZSBzdXBwb3J0XG4gICAgdHJ5IHtcbiAgICAgICAgdmFsID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnRGV4aWUuRGF0YWJhc2VOYW1lcycpIHx8IFwiW11cIik7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB2YWwgPSBbXTtcbiAgICB9XG4gICAgaWYgKGNiKHZhbCkpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ0RleGllLkRhdGFiYXNlTmFtZXMnLCBKU09OLnN0cmluZ2lmeSh2YWwpKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGF3YWl0SXRlcmF0b3IoaXRlcmF0b3IpIHtcbiAgICB2YXIgY2FsbE5leHQgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRvci5uZXh0KHJlc3VsdCk7XG4gICAgfSxcbiAgICAgICAgZG9UaHJvdyA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICByZXR1cm4gaXRlcmF0b3IudGhyb3coZXJyb3IpO1xuICAgIH0sXG4gICAgICAgIG9uU3VjY2VzcyA9IHN0ZXAoY2FsbE5leHQpLFxuICAgICAgICBvbkVycm9yID0gc3RlcChkb1Rocm93KTtcblxuICAgIGZ1bmN0aW9uIHN0ZXAoZ2V0TmV4dCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgdmFyIG5leHQgPSBnZXROZXh0KHZhbCksXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBuZXh0LnZhbHVlO1xuXG4gICAgICAgICAgICByZXR1cm4gbmV4dC5kb25lID8gdmFsdWUgOiAhdmFsdWUgfHwgdHlwZW9mIHZhbHVlLnRoZW4gIT09ICdmdW5jdGlvbicgPyBpc0FycmF5KHZhbHVlKSA/IFByb21pc2UuYWxsKHZhbHVlKS50aGVuKG9uU3VjY2Vzcywgb25FcnJvcikgOiBvblN1Y2Nlc3ModmFsdWUpIDogdmFsdWUudGhlbihvblN1Y2Nlc3MsIG9uRXJyb3IpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiBzdGVwKGNhbGxOZXh0KSgpO1xufVxuXG4vL1xuLy8gSW5kZXhTcGVjIHN0cnVjdFxuLy9cbmZ1bmN0aW9uIEluZGV4U3BlYyhuYW1lLCBrZXlQYXRoLCB1bmlxdWUsIG11bHRpLCBhdXRvLCBjb21wb3VuZCwgZG90dGVkKSB7XG4gICAgLy8vIDxwYXJhbSBuYW1lPVwibmFtZVwiIHR5cGU9XCJTdHJpbmdcIj48L3BhcmFtPlxuICAgIC8vLyA8cGFyYW0gbmFtZT1cImtleVBhdGhcIiB0eXBlPVwiU3RyaW5nXCI+PC9wYXJhbT5cbiAgICAvLy8gPHBhcmFtIG5hbWU9XCJ1bmlxdWVcIiB0eXBlPVwiQm9vbGVhblwiPjwvcGFyYW0+XG4gICAgLy8vIDxwYXJhbSBuYW1lPVwibXVsdGlcIiB0eXBlPVwiQm9vbGVhblwiPjwvcGFyYW0+XG4gICAgLy8vIDxwYXJhbSBuYW1lPVwiYXV0b1wiIHR5cGU9XCJCb29sZWFuXCI+PC9wYXJhbT5cbiAgICAvLy8gPHBhcmFtIG5hbWU9XCJjb21wb3VuZFwiIHR5cGU9XCJCb29sZWFuXCI+PC9wYXJhbT5cbiAgICAvLy8gPHBhcmFtIG5hbWU9XCJkb3R0ZWRcIiB0eXBlPVwiQm9vbGVhblwiPjwvcGFyYW0+XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLmtleVBhdGggPSBrZXlQYXRoO1xuICAgIHRoaXMudW5pcXVlID0gdW5pcXVlO1xuICAgIHRoaXMubXVsdGkgPSBtdWx0aTtcbiAgICB0aGlzLmF1dG8gPSBhdXRvO1xuICAgIHRoaXMuY29tcG91bmQgPSBjb21wb3VuZDtcbiAgICB0aGlzLmRvdHRlZCA9IGRvdHRlZDtcbiAgICB2YXIga2V5UGF0aFNyYyA9IHR5cGVvZiBrZXlQYXRoID09PSAnc3RyaW5nJyA/IGtleVBhdGggOiBrZXlQYXRoICYmICdbJyArIFtdLmpvaW4uY2FsbChrZXlQYXRoLCAnKycpICsgJ10nO1xuICAgIHRoaXMuc3JjID0gKHVuaXF1ZSA/ICcmJyA6ICcnKSArIChtdWx0aSA/ICcqJyA6ICcnKSArIChhdXRvID8gXCIrK1wiIDogXCJcIikgKyBrZXlQYXRoU3JjO1xufVxuXG4vL1xuLy8gVGFibGVTY2hlbWEgc3RydWN0XG4vL1xuZnVuY3Rpb24gVGFibGVTY2hlbWEobmFtZSwgcHJpbUtleSwgaW5kZXhlcywgaW5zdGFuY2VUZW1wbGF0ZSkge1xuICAgIC8vLyA8cGFyYW0gbmFtZT1cIm5hbWVcIiB0eXBlPVwiU3RyaW5nXCI+PC9wYXJhbT5cbiAgICAvLy8gPHBhcmFtIG5hbWU9XCJwcmltS2V5XCIgdHlwZT1cIkluZGV4U3BlY1wiPjwvcGFyYW0+XG4gICAgLy8vIDxwYXJhbSBuYW1lPVwiaW5kZXhlc1wiIHR5cGU9XCJBcnJheVwiIGVsZW1lbnRUeXBlPVwiSW5kZXhTcGVjXCI+PC9wYXJhbT5cbiAgICAvLy8gPHBhcmFtIG5hbWU9XCJpbnN0YW5jZVRlbXBsYXRlXCIgdHlwZT1cIk9iamVjdFwiPjwvcGFyYW0+XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLnByaW1LZXkgPSBwcmltS2V5IHx8IG5ldyBJbmRleFNwZWMoKTtcbiAgICB0aGlzLmluZGV4ZXMgPSBpbmRleGVzIHx8IFtuZXcgSW5kZXhTcGVjKCldO1xuICAgIHRoaXMuaW5zdGFuY2VUZW1wbGF0ZSA9IGluc3RhbmNlVGVtcGxhdGU7XG4gICAgdGhpcy5tYXBwZWRDbGFzcyA9IG51bGw7XG4gICAgdGhpcy5pZHhCeU5hbWUgPSBhcnJheVRvT2JqZWN0KGluZGV4ZXMsIGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gW2luZGV4Lm5hbWUsIGluZGV4XTtcbiAgICB9KTtcbn1cblxuLy8gVXNlZCBpbiB3aGVuIGRlZmluaW5nIGRlcGVuZGVuY2llcyBsYXRlci4uLlxuLy8gKElmIEluZGV4ZWREQlNoaW0gaXMgbG9hZGVkLCBwcmVmZXIgaXQgYmVmb3JlIHN0YW5kYXJkIGluZGV4ZWREQilcbnZhciBpZGJzaGltID0gX2dsb2JhbC5pZGJNb2R1bGVzICYmIF9nbG9iYWwuaWRiTW9kdWxlcy5zaGltSW5kZXhlZERCID8gX2dsb2JhbC5pZGJNb2R1bGVzIDoge307XG5cbmZ1bmN0aW9uIHNhZmFyaU11bHRpU3RvcmVGaXgoc3RvcmVOYW1lcykge1xuICAgIHJldHVybiBzdG9yZU5hbWVzLmxlbmd0aCA9PT0gMSA/IHN0b3JlTmFtZXNbMF0gOiBzdG9yZU5hbWVzO1xufVxuXG5mdW5jdGlvbiBnZXROYXRpdmVHZXREYXRhYmFzZU5hbWVzRm4oaW5kZXhlZERCKSB7XG4gICAgdmFyIGZuID0gaW5kZXhlZERCICYmIChpbmRleGVkREIuZ2V0RGF0YWJhc2VOYW1lcyB8fCBpbmRleGVkREIud2Via2l0R2V0RGF0YWJhc2VOYW1lcyk7XG4gICAgcmV0dXJuIGZuICYmIGZuLmJpbmQoaW5kZXhlZERCKTtcbn1cblxuLy8gRXhwb3J0IEVycm9yIGNsYXNzZXNcbnByb3BzKERleGllLCBmdWxsTmFtZUV4Y2VwdGlvbnMpOyAvLyBEZXhpZS5YWFhFcnJvciA9IGNsYXNzIFhYWEVycm9yIHsuLi59O1xuXG4vL1xuLy8gU3RhdGljIG1ldGhvZHMgYW5kIHByb3BlcnRpZXNcbi8vIFxucHJvcHMoRGV4aWUsIHtcblxuICAgIC8vXG4gICAgLy8gU3RhdGljIGRlbGV0ZSgpIG1ldGhvZC5cbiAgICAvL1xuICAgIGRlbGV0ZTogZnVuY3Rpb24gKGRhdGFiYXNlTmFtZSkge1xuICAgICAgICB2YXIgZGIgPSBuZXcgRGV4aWUoZGF0YWJhc2VOYW1lKSxcbiAgICAgICAgICAgIHByb21pc2UgPSBkYi5kZWxldGUoKTtcbiAgICAgICAgcHJvbWlzZS5vbmJsb2NrZWQgPSBmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgICAgIGRiLm9uKFwiYmxvY2tlZFwiLCBmbik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfSxcblxuICAgIC8vXG4gICAgLy8gU3RhdGljIGV4aXN0cygpIG1ldGhvZC5cbiAgICAvL1xuICAgIGV4aXN0czogZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEZXhpZShuYW1lKS5vcGVuKCkudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSkuY2F0Y2goRGV4aWUuTm9TdWNoRGF0YWJhc2VFcnJvciwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLy9cbiAgICAvLyBTdGF0aWMgbWV0aG9kIGZvciByZXRyaWV2aW5nIGEgbGlzdCBvZiBhbGwgZXhpc3RpbmcgZGF0YWJhc2VzIGF0IGN1cnJlbnQgaG9zdC5cbiAgICAvL1xuICAgIGdldERhdGFiYXNlTmFtZXM6IGZ1bmN0aW9uIChjYikge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGdldERhdGFiYXNlTmFtZXMgPSBnZXROYXRpdmVHZXREYXRhYmFzZU5hbWVzRm4oaW5kZXhlZERCKTtcbiAgICAgICAgICAgIGlmIChnZXREYXRhYmFzZU5hbWVzKSB7XG4gICAgICAgICAgICAgICAgLy8gSW4gY2FzZSBnZXREYXRhYmFzZU5hbWVzKCkgYmVjb21lcyBzdGFuZGFyZCwgbGV0J3MgcHJlcGFyZSB0byBzdXBwb3J0IGl0OlxuICAgICAgICAgICAgICAgIHZhciByZXEgPSBnZXREYXRhYmFzZU5hbWVzKCk7XG4gICAgICAgICAgICAgICAgcmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHNsaWNlKGV2ZW50LnRhcmdldC5yZXN1bHQsIDApKTsgLy8gQ29udmVyc3QgRE9NU3RyaW5nTGlzdCB0byBBcnJheTxTdHJpbmc+XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXEub25lcnJvciA9IGV2ZW50UmVqZWN0SGFuZGxlcihyZWplY3QpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBnbG9iYWxEYXRhYmFzZUxpc3QoZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHZhbCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkudGhlbihjYik7XG4gICAgfSxcblxuICAgIGRlZmluZUNsYXNzOiBmdW5jdGlvbiAoc3RydWN0dXJlKSB7XG4gICAgICAgIC8vLyA8c3VtbWFyeT5cbiAgICAgICAgLy8vICAgICBDcmVhdGUgYSBqYXZhc2NyaXB0IGNvbnN0cnVjdG9yIGJhc2VkIG9uIGdpdmVuIHRlbXBsYXRlIGZvciB3aGljaCBwcm9wZXJ0aWVzIHRvIGV4cGVjdCBpbiB0aGUgY2xhc3MuXG4gICAgICAgIC8vLyAgICAgQW55IHByb3BlcnR5IHRoYXQgaXMgYSBjb25zdHJ1Y3RvciBmdW5jdGlvbiB3aWxsIGFjdCBhcyBhIHR5cGUuIFNvIHtuYW1lOiBTdHJpbmd9IHdpbGwgYmUgZXF1YWwgdG8ge25hbWU6IG5ldyBTdHJpbmcoKX0uXG4gICAgICAgIC8vLyA8L3N1bW1hcnk+XG4gICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInN0cnVjdHVyZVwiPkhlbHBzIElERSBjb2RlIGNvbXBsZXRpb24gYnkga25vd2luZyB0aGUgbWVtYmVycyB0aGF0IG9iamVjdHMgY29udGFpbiBhbmQgbm90IGp1c3QgdGhlIGluZGV4ZXMuIEFsc29cbiAgICAgICAgLy8vIGtub3cgd2hhdCB0eXBlIGVhY2ggbWVtYmVyIGhhcy4gRXhhbXBsZToge25hbWU6IFN0cmluZywgZW1haWxBZGRyZXNzZXM6IFtTdHJpbmddLCBwcm9wZXJ0aWVzOiB7c2hvZVNpemU6IE51bWJlcn19PC9wYXJhbT5cblxuICAgICAgICAvLyBEZWZhdWx0IGNvbnN0cnVjdG9yIGFibGUgdG8gY29weSBnaXZlbiBwcm9wZXJ0aWVzIGludG8gdGhpcyBvYmplY3QuXG4gICAgICAgIGZ1bmN0aW9uIENsYXNzKHByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIC8vLyA8cGFyYW0gbmFtZT1cInByb3BlcnRpZXNcIiB0eXBlPVwiT2JqZWN0XCIgb3B0aW9uYWw9XCJ0cnVlXCI+UHJvcGVydGllcyB0byBpbml0aWFsaXplIG9iamVjdCB3aXRoLlxuICAgICAgICAgICAgLy8vIDwvcGFyYW0+XG4gICAgICAgICAgICBwcm9wZXJ0aWVzID8gZXh0ZW5kKHRoaXMsIHByb3BlcnRpZXMpIDogZmFrZSAmJiBhcHBseVN0cnVjdHVyZSh0aGlzLCBzdHJ1Y3R1cmUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBDbGFzcztcbiAgICB9LFxuXG4gICAgYXBwbHlTdHJ1Y3R1cmU6IGFwcGx5U3RydWN0dXJlLFxuXG4gICAgaWdub3JlVHJhbnNhY3Rpb246IGZ1bmN0aW9uIChzY29wZUZ1bmMpIHtcbiAgICAgICAgLy8gSW4gY2FzZSBjYWxsZXIgaXMgd2l0aGluIGEgdHJhbnNhY3Rpb24gYnV0IG5lZWRzIHRvIGNyZWF0ZSBhIHNlcGFyYXRlIHRyYW5zYWN0aW9uLlxuICAgICAgICAvLyBFeGFtcGxlIG9mIHVzYWdlOlxuICAgICAgICAvL1xuICAgICAgICAvLyBMZXQncyBzYXkgd2UgaGF2ZSBhIGxvZ2dlciBmdW5jdGlvbiBpbiBvdXIgYXBwLiBPdGhlciBhcHBsaWNhdGlvbi1sb2dpYyBzaG91bGQgYmUgdW5hd2FyZSBvZiB0aGVcbiAgICAgICAgLy8gbG9nZ2VyIGZ1bmN0aW9uIGFuZCBub3QgbmVlZCB0byBpbmNsdWRlIHRoZSAnbG9nZW50cmllcycgdGFibGUgaW4gYWxsIHRyYW5zYWN0aW9uIGl0IHBlcmZvcm1zLlxuICAgICAgICAvLyBUaGUgbG9nZ2luZyBzaG91bGQgYWx3YXlzIGJlIGRvbmUgaW4gYSBzZXBhcmF0ZSB0cmFuc2FjdGlvbiBhbmQgbm90IGJlIGRlcGVuZGFudCBvbiB0aGUgY3VycmVudFxuICAgICAgICAvLyBydW5uaW5nIHRyYW5zYWN0aW9uIGNvbnRleHQuIFRoZW4geW91IGNvdWxkIHVzZSBEZXhpZS5pZ25vcmVUcmFuc2FjdGlvbigpIHRvIHJ1biBjb2RlIHRoYXQgc3RhcnRzIGEgbmV3IHRyYW5zYWN0aW9uLlxuICAgICAgICAvL1xuICAgICAgICAvLyAgICAgRGV4aWUuaWdub3JlVHJhbnNhY3Rpb24oZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vICAgICAgICAgZGIubG9nZW50cmllcy5hZGQobmV3TG9nRW50cnkpO1xuICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIFVubGVzcyB1c2luZyBEZXhpZS5pZ25vcmVUcmFuc2FjdGlvbigpLCB0aGUgYWJvdmUgZXhhbXBsZSB3b3VsZCB0cnkgdG8gcmV1c2UgdGhlIGN1cnJlbnQgdHJhbnNhY3Rpb25cbiAgICAgICAgLy8gaW4gY3VycmVudCBQcm9taXNlLXNjb3BlLlxuICAgICAgICAvL1xuICAgICAgICAvLyBBbiBhbHRlcm5hdGl2ZSB0byBEZXhpZS5pZ25vcmVUcmFuc2FjdGlvbigpIHdvdWxkIGJlIHNldEltbWVkaWF0ZSgpIG9yIHNldFRpbWVvdXQoKS4gVGhlIHJlYXNvbiB3ZSBzdGlsbCBwcm92aWRlIGFuXG4gICAgICAgIC8vIEFQSSBmb3IgdGhpcyBiZWNhdXNlXG4gICAgICAgIC8vICAxKSBUaGUgaW50ZW50aW9uIG9mIHdyaXRpbmcgdGhlIHN0YXRlbWVudCBjb3VsZCBiZSB1bmNsZWFyIGlmIHVzaW5nIHNldEltbWVkaWF0ZSgpIG9yIHNldFRpbWVvdXQoKS5cbiAgICAgICAgLy8gIDIpIHNldFRpbWVvdXQoKSB3b3VsZCB3YWl0IHVubmVzY2Vzc2FyeSB1bnRpbCBmaXJpbmcuIFRoaXMgaXMgaG93ZXZlciBub3QgdGhlIGNhc2Ugd2l0aCBzZXRJbW1lZGlhdGUoKS5cbiAgICAgICAgLy8gIDMpIHNldEltbWVkaWF0ZSgpIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhlIEVTIHN0YW5kYXJkLlxuICAgICAgICAvLyAgNCkgWW91IG1pZ2h0IHdhbnQgdG8ga2VlcCBvdGhlciBQU0Qgc3RhdGUgdGhhdCB3YXMgc2V0IGluIGEgcGFyZW50IFBTRCwgc3VjaCBhcyBQU0QubGV0VGhyb3VnaC5cbiAgICAgICAgcmV0dXJuIFBTRC50cmFucyA/IHVzZVBTRChQU0QudHJhbnNsZXNzLCBzY29wZUZ1bmMpIDogLy8gVXNlIHRoZSBjbG9zZXN0IHBhcmVudCB0aGF0IHdhcyBub24tdHJhbnNhY3Rpb25hbC5cbiAgICAgICAgc2NvcGVGdW5jKCk7IC8vIE5vIG5lZWQgdG8gY2hhbmdlIHNjb3BlIGJlY2F1c2UgdGhlcmUgaXMgbm8gb25nb2luZyB0cmFuc2FjdGlvbi5cbiAgICB9LFxuXG4gICAgdmlwOiBmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgLy8gVG8gYmUgdXNlZCBieSBzdWJzY3JpYmVycyB0byB0aGUgb24oJ3JlYWR5JykgZXZlbnQuXG4gICAgICAgIC8vIFRoaXMgd2lsbCBsZXQgY2FsbGVyIHRocm91Z2ggdG8gYWNjZXNzIERCIGV2ZW4gd2hlbiBpdCBpcyBibG9ja2VkIHdoaWxlIHRoZSBkYi5yZWFkeSgpIHN1YnNjcmliZXJzIGFyZSBmaXJpbmcuXG4gICAgICAgIC8vIFRoaXMgd291bGQgaGF2ZSB3b3JrZWQgYXV0b21hdGljYWxseSBpZiB3ZSB3ZXJlIGNlcnRhaW4gdGhhdCB0aGUgUHJvdmlkZXIgd2FzIHVzaW5nIERleGllLlByb21pc2UgZm9yIGFsbCBhc3luY3JvbmljIG9wZXJhdGlvbnMuIFRoZSBwcm9taXNlIFBTRFxuICAgICAgICAvLyBmcm9tIHRoZSBwcm92aWRlci5jb25uZWN0KCkgY2FsbCB3b3VsZCB0aGVuIGJlIGRlcml2ZWQgYWxsIHRoZSB3YXkgdG8gd2hlbiBwcm92aWRlciB3b3VsZCBjYWxsIGxvY2FsRGF0YWJhc2UuYXBwbHlDaGFuZ2VzKCkuIEJ1dCBzaW5jZVxuICAgICAgICAvLyB0aGUgcHJvdmlkZXIgbW9yZSBsaWtlbHkgaXMgdXNpbmcgbm9uLXByb21pc2UgYXN5bmMgQVBJcyBvciBvdGhlciB0aGVuYWJsZSBpbXBsZW1lbnRhdGlvbnMsIHdlIGNhbm5vdCBhc3N1bWUgdGhhdC5cbiAgICAgICAgLy8gTm90ZSB0aGF0IHRoaXMgbWV0aG9kIGlzIG9ubHkgdXNlZnVsIGZvciBvbigncmVhZHknKSBzdWJzY3JpYmVycyB0aGF0IGlzIHJldHVybmluZyBhIFByb21pc2UgZnJvbSB0aGUgZXZlbnQuIElmIG5vdCB1c2luZyB2aXAoKVxuICAgICAgICAvLyB0aGUgZGF0YWJhc2UgY291bGQgZGVhZGxvY2sgc2luY2UgaXQgd29udCBvcGVuIHVudGlsIHRoZSByZXR1cm5lZCBQcm9taXNlIGlzIHJlc29sdmVkLCBhbmQgYW55IG5vbi1WSVBlZCBvcGVyYXRpb24gc3RhcnRlZCBieVxuICAgICAgICAvLyB0aGUgY2FsbGVyIHdpbGwgbm90IHJlc29sdmUgdW50aWwgZGF0YWJhc2UgaXMgb3BlbmVkLlxuICAgICAgICByZXR1cm4gbmV3U2NvcGUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgUFNELmxldFRocm91Z2ggPSB0cnVlOyAvLyBNYWtlIHN1cmUgd2UgYXJlIGxldCB0aHJvdWdoIGlmIHN0aWxsIGJsb2NraW5nIGRiIGR1ZSB0byBvbnJlYWR5IGlzIGZpcmluZy5cbiAgICAgICAgICAgIHJldHVybiBmbigpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgYXN5bmM6IGZ1bmN0aW9uIChnZW5lcmF0b3JGbikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgcnYgPSBhd2FpdEl0ZXJhdG9yKGdlbmVyYXRvckZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgICAgICAgICAgICAgIGlmICghcnYgfHwgdHlwZW9mIHJ2LnRoZW4gIT09ICdmdW5jdGlvbicpIHJldHVybiBQcm9taXNlLnJlc29sdmUocnYpO1xuICAgICAgICAgICAgICAgIHJldHVybiBydjtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0aW9uKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICBzcGF3bjogZnVuY3Rpb24gKGdlbmVyYXRvckZuLCBhcmdzLCB0aGl6KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgcnYgPSBhd2FpdEl0ZXJhdG9yKGdlbmVyYXRvckZuLmFwcGx5KHRoaXosIGFyZ3MgfHwgW10pKTtcbiAgICAgICAgICAgIGlmICghcnYgfHwgdHlwZW9mIHJ2LnRoZW4gIT09ICdmdW5jdGlvbicpIHJldHVybiBQcm9taXNlLnJlc29sdmUocnYpO1xuICAgICAgICAgICAgcmV0dXJuIHJ2O1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVqZWN0aW9uKGUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIERleGllLmN1cnJlbnRUcmFuc2FjdGlvbiBwcm9wZXJ0eVxuICAgIGN1cnJlbnRUcmFuc2FjdGlvbjoge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBQU0QudHJhbnMgfHwgbnVsbDtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBFeHBvcnQgb3VyIFByb21pc2UgaW1wbGVtZW50YXRpb24gc2luY2UgaXQgY2FuIGJlIGhhbmR5IGFzIGEgc3RhbmRhbG9uZSBQcm9taXNlIGltcGxlbWVudGF0aW9uXG4gICAgUHJvbWlzZTogUHJvbWlzZSxcblxuICAgIC8vIERleGllLmRlYnVnIHByb3B0ZXJ5OlxuICAgIC8vIERleGllLmRlYnVnID0gZmFsc2VcbiAgICAvLyBEZXhpZS5kZWJ1ZyA9IHRydWVcbiAgICAvLyBEZXhpZS5kZWJ1ZyA9IFwiZGV4aWVcIiAtIGRvbid0IGhpZGUgZGV4aWUncyBzdGFjayBmcmFtZXMuXG4gICAgZGVidWc6IHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVidWc7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBzZXREZWJ1Zyh2YWx1ZSwgdmFsdWUgPT09ICdkZXhpZScgPyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9IDogZGV4aWVTdGFja0ZyYW1lRmlsdGVyKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBFeHBvcnQgb3VyIGRlcml2ZS9leHRlbmQvb3ZlcnJpZGUgbWV0aG9kb2xvZ3lcbiAgICBkZXJpdmU6IGRlcml2ZSxcbiAgICBleHRlbmQ6IGV4dGVuZCxcbiAgICBwcm9wczogcHJvcHMsXG4gICAgb3ZlcnJpZGU6IG92ZXJyaWRlLFxuICAgIC8vIEV4cG9ydCBvdXIgRXZlbnRzKCkgZnVuY3Rpb24gLSBjYW4gYmUgaGFuZHkgYXMgYSB0b29sa2l0XG4gICAgRXZlbnRzOiBFdmVudHMsXG4gICAgZXZlbnRzOiB7IGdldDogZGVwcmVjYXRlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gRXZlbnRzO1xuICAgICAgICB9KSB9LCAvLyBCYWNrd2FyZCBjb21wYXRpYmxlIGxvd2VyY2FzZSB2ZXJzaW9uLlxuICAgIC8vIFV0aWxpdGllc1xuICAgIGdldEJ5S2V5UGF0aDogZ2V0QnlLZXlQYXRoLFxuICAgIHNldEJ5S2V5UGF0aDogc2V0QnlLZXlQYXRoLFxuICAgIGRlbEJ5S2V5UGF0aDogZGVsQnlLZXlQYXRoLFxuICAgIHNoYWxsb3dDbG9uZTogc2hhbGxvd0Nsb25lLFxuICAgIGRlZXBDbG9uZTogZGVlcENsb25lLFxuICAgIGdldE9iamVjdERpZmY6IGdldE9iamVjdERpZmYsXG4gICAgYXNhcDogYXNhcCxcbiAgICBtYXhLZXk6IG1heEtleSxcbiAgICAvLyBBZGRvbiByZWdpc3RyeVxuICAgIGFkZG9uczogW10sXG4gICAgLy8gR2xvYmFsIERCIGNvbm5lY3Rpb24gbGlzdFxuICAgIGNvbm5lY3Rpb25zOiBjb25uZWN0aW9ucyxcblxuICAgIE11bHRpTW9kaWZ5RXJyb3I6IGV4Y2VwdGlvbnMuTW9kaWZ5LCAvLyBCYWNrd2FyZCBjb21wYXRpYmlsaXR5IDAuOS44LiBEZXByZWNhdGUuXG4gICAgZXJybmFtZXM6IGVycm5hbWVzLFxuXG4gICAgLy8gRXhwb3J0IG90aGVyIHN0YXRpYyBjbGFzc2VzXG4gICAgSW5kZXhTcGVjOiBJbmRleFNwZWMsXG4gICAgVGFibGVTY2hlbWE6IFRhYmxlU2NoZW1hLFxuXG4gICAgLy9cbiAgICAvLyBEZXBlbmRlbmNpZXNcbiAgICAvL1xuICAgIC8vIFRoZXNlIHdpbGwgYXV0b21hdGljYWxseSB3b3JrIGluIGJyb3dzZXJzIHdpdGggaW5kZXhlZERCIHN1cHBvcnQsIG9yIHdoZXJlIGFuIGluZGV4ZWREQiBwb2x5ZmlsbCBoYXMgYmVlbiBpbmNsdWRlZC5cbiAgICAvL1xuICAgIC8vIEluIG5vZGUuanMsIGhvd2V2ZXIsIHRoZXNlIHByb3BlcnRpZXMgbXVzdCBiZSBzZXQgXCJtYW51YWxseVwiIGJlZm9yZSBpbnN0YW5zaWF0aW5nIGEgbmV3IERleGllKCkuXG4gICAgLy8gRm9yIG5vZGUuanMsIHlvdSBuZWVkIHRvIHJlcXVpcmUgaW5kZXhlZGRiLWpzIG9yIHNpbWlsYXIgYW5kIHRoZW4gc2V0IHRoZXNlIGRlcHMuXG4gICAgLy9cbiAgICBkZXBlbmRlbmNpZXM6IHtcbiAgICAgICAgLy8gUmVxdWlyZWQ6XG4gICAgICAgIGluZGV4ZWREQjogaWRic2hpbS5zaGltSW5kZXhlZERCIHx8IF9nbG9iYWwuaW5kZXhlZERCIHx8IF9nbG9iYWwubW96SW5kZXhlZERCIHx8IF9nbG9iYWwud2Via2l0SW5kZXhlZERCIHx8IF9nbG9iYWwubXNJbmRleGVkREIsXG4gICAgICAgIElEQktleVJhbmdlOiBpZGJzaGltLklEQktleVJhbmdlIHx8IF9nbG9iYWwuSURCS2V5UmFuZ2UgfHwgX2dsb2JhbC53ZWJraXRJREJLZXlSYW5nZVxuICAgIH0sXG5cbiAgICAvLyBBUEkgVmVyc2lvbiBOdW1iZXI6IFR5cGUgTnVtYmVyLCBtYWtlIHN1cmUgdG8gYWx3YXlzIHNldCBhIHZlcnNpb24gbnVtYmVyIHRoYXQgY2FuIGJlIGNvbXBhcmFibGUgY29ycmVjdGx5LiBFeGFtcGxlOiAwLjksIDAuOTEsIDAuOTIsIDEuMCwgMS4wMSwgMS4xLCAxLjIsIDEuMjEsIGV0Yy5cbiAgICBzZW1WZXI6IERFWElFX1ZFUlNJT04sXG4gICAgdmVyc2lvbjogREVYSUVfVkVSU0lPTi5zcGxpdCgnLicpLm1hcChmdW5jdGlvbiAobikge1xuICAgICAgICByZXR1cm4gcGFyc2VJbnQobik7XG4gICAgfSkucmVkdWNlKGZ1bmN0aW9uIChwLCBjLCBpKSB7XG4gICAgICAgIHJldHVybiBwICsgYyAvIE1hdGgucG93KDEwLCBpICogMik7XG4gICAgfSksXG4gICAgZmFrZUF1dG9Db21wbGV0ZTogZmFrZUF1dG9Db21wbGV0ZSxcblxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9kZmFobGFuZGVyL0RleGllLmpzL2lzc3Vlcy8xODZcbiAgICAvLyB0eXBlc2NyaXB0IGNvbXBpbGVyIHRzYyBpbiBtb2RlIHRzLS0+ZXM1ICYgY29tbW9uSlMsIHdpbGwgZXhwZWN0IHJlcXVpcmUoKSB0byByZXR1cm5cbiAgICAvLyB4LmRlZmF1bHQuIFdvcmthcm91bmQ6IFNldCBEZXhpZS5kZWZhdWx0ID0gRGV4aWUuXG4gICAgZGVmYXVsdDogRGV4aWVcbn0pO1xuXG50cnlDYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgLy8gT3B0aW9uYWwgZGVwZW5kZW5jaWVzXG4gICAgLy8gbG9jYWxTdG9yYWdlXG4gICAgRGV4aWUuZGVwZW5kZW5jaWVzLmxvY2FsU3RvcmFnZSA9ICh0eXBlb2YgY2hyb21lICE9PSBcInVuZGVmaW5lZFwiICYmIGNocm9tZSAhPT0gbnVsbCA/IGNocm9tZS5zdG9yYWdlIDogdm9pZCAwKSAhPSBudWxsID8gbnVsbCA6IF9nbG9iYWwubG9jYWxTdG9yYWdlO1xufSk7XG5cbi8vIE1hcCBET01FcnJvcnMgYW5kIERPTUV4Y2VwdGlvbnMgdG8gY29ycmVzcG9uZGluZyBEZXhpZSBlcnJvcnMuIE1heSBjaGFuZ2UgaW4gRGV4aWUgdjIuMC5cblByb21pc2UucmVqZWN0aW9uTWFwcGVyID0gbWFwRXJyb3I7XG5cbi8vIEZvb2wgSURFIHRvIGltcHJvdmUgYXV0b2NvbXBsZXRlLiBUZXN0ZWQgd2l0aCBWaXN1YWwgU3R1ZGlvIDIwMTMgYW5kIDIwMTUuXG5kb0Zha2VBdXRvQ29tcGxldGUoZnVuY3Rpb24gKCkge1xuICAgIERleGllLmZha2VBdXRvQ29tcGxldGUgPSBmYWtlQXV0b0NvbXBsZXRlID0gZG9GYWtlQXV0b0NvbXBsZXRlO1xuICAgIERleGllLmZha2UgPSBmYWtlID0gdHJ1ZTtcbn0pO1xuXG5yZXR1cm4gRGV4aWU7XG5cbn0pKSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZXhpZS5qcy5tYXBcbiIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXRcbi8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYVxuLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy5cblxudmFyIGNhY2hlZFNldFRpbWVvdXQ7XG52YXIgY2FjaGVkQ2xlYXJUaW1lb3V0O1xuXG5mdW5jdGlvbiBkZWZhdWx0U2V0VGltb3V0KCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuZnVuY3Rpb24gZGVmYXVsdENsZWFyVGltZW91dCAoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbihmdW5jdGlvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgfVxufSAoKSlcbmZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7XG4gICAgaWYgKGNhY2hlZFNldFRpbWVvdXQgPT09IHNldFRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIC8vIGlmIHNldFRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfSBjYXRjaChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbChudWxsLCBmdW4sIDApO1xuICAgICAgICB9IGNhdGNoKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwodGhpcywgZnVuLCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5mdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7XG4gICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuXG4gICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbn1cbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHJ1blRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZE9uY2VMaXN0ZW5lciA9IG5vb3A7XG5cbnByb2Nlc3MubGlzdGVuZXJzID0gZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIFtdIH1cblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iLCIvLyB2ZXJzaW9uOiAwLjEyLjBcbi8vIGRhdGU6IFdlZCBBdWcgMDEgMjAxOCAwOTo0ODoxMCBHTVQrMDEwMCAoV2VzdGVybiBFdXJvcGVhbiBTdW1tZXIgVGltZSlcbi8vIGxpY2VuY2U6IFxuLyoqXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXG4qXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4qXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4qXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbioqL1xuXG5cbi8vIHZlcnNpb246IDAuMTIuMFxuLy8gZGF0ZTogV2VkIEF1ZyAwMSAyMDE4IDA5OjQ4OjEwIEdNVCswMTAwIChXZXN0ZXJuIEV1cm9wZWFuIFN1bW1lciBUaW1lKVxuLy8gbGljZW5jZTogXG4vKipcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cbipcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbipcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbipcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKiovXG5cblxuIWZ1bmN0aW9uKHQsZSl7XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHMmJlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9ZSgpOlwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJtaW5pYnVzXCIsW10sZSk6XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHM/ZXhwb3J0cy5taW5pYnVzPWUoKTp0Lm1pbmlidXM9ZSgpfShcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZj9zZWxmOnRoaXMsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24odCl7ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhuKXtpZihlW25dKXJldHVybiBlW25dLmV4cG9ydHM7dmFyIHI9ZVtuXT17aTpuLGw6ITEsZXhwb3J0czp7fX07cmV0dXJuIHRbbl0uY2FsbChyLmV4cG9ydHMscixyLmV4cG9ydHMsX193ZWJwYWNrX3JlcXVpcmVfXyksci5sPSEwLHIuZXhwb3J0c312YXIgZT17fTtyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5tPXQsX193ZWJwYWNrX3JlcXVpcmVfXy5jPWUsX193ZWJwYWNrX3JlcXVpcmVfXy5kPWZ1bmN0aW9uKHQsZSxuKXtfX3dlYnBhY2tfcmVxdWlyZV9fLm8odCxlKXx8T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsZSx7Y29uZmlndXJhYmxlOiExLGVudW1lcmFibGU6ITAsZ2V0Om59KX0sX193ZWJwYWNrX3JlcXVpcmVfXy5uPWZ1bmN0aW9uKHQpe3ZhciBlPXQmJnQuX19lc01vZHVsZT9mdW5jdGlvbigpe3JldHVybiB0LmRlZmF1bHR9OmZ1bmN0aW9uKCl7cmV0dXJuIHR9O3JldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZSxcImFcIixlKSxlfSxfX3dlYnBhY2tfcmVxdWlyZV9fLm89ZnVuY3Rpb24odCxlKXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsZSl9LF9fd2VicGFja19yZXF1aXJlX18ucD1cIlwiLF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zPTEzNil9KFtmdW5jdGlvbih0LGUpe3ZhciBuPXQuZXhwb3J0cz17dmVyc2lvbjpcIjIuNS43XCJ9O1wibnVtYmVyXCI9PXR5cGVvZiBfX2UmJihfX2U9bil9LGZ1bmN0aW9uKHQsZSl7dmFyIG49dC5leHBvcnRzPVwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5NYXRoPT1NYXRoP3dpbmRvdzpcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZiYmc2VsZi5NYXRoPT1NYXRoP3NlbGY6RnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1wibnVtYmVyXCI9PXR5cGVvZiBfX2cmJihfX2c9bil9LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDI4KShcIndrc1wiKSxvPW4oMjApLGk9bigxKS5TeW1ib2wsdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBpOyh0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIHJbdF18fChyW3RdPXUmJmlbdF18fCh1P2k6bykoXCJTeW1ib2wuXCIrdCkpfSkuc3RvcmU9cn0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMSksbz1uKDApLGk9bigxNSksdT1uKDkpLHM9big4KSxjPWZ1bmN0aW9uKHQsZSxuKXt2YXIgZixhLGwscD10JmMuRix2PXQmYy5HLGQ9dCZjLlMsaD10JmMuUCx5PXQmYy5CLF89dCZjLlcsYj12P286b1tlXXx8KG9bZV09e30pLGc9Yi5wcm90b3R5cGUsbT12P3I6ZD9yW2VdOihyW2VdfHx7fSkucHJvdG90eXBlO3YmJihuPWUpO2ZvcihmIGluIG4pKGE9IXAmJm0mJnZvaWQgMCE9PW1bZl0pJiZzKGIsZil8fChsPWE/bVtmXTpuW2ZdLGJbZl09diYmXCJmdW5jdGlvblwiIT10eXBlb2YgbVtmXT9uW2ZdOnkmJmE/aShsLHIpOl8mJm1bZl09PWw/ZnVuY3Rpb24odCl7dmFyIGU9ZnVuY3Rpb24oZSxuLHIpe2lmKHRoaXMgaW5zdGFuY2VvZiB0KXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBuZXcgdDtjYXNlIDE6cmV0dXJuIG5ldyB0KGUpO2Nhc2UgMjpyZXR1cm4gbmV3IHQoZSxuKX1yZXR1cm4gbmV3IHQoZSxuLHIpfXJldHVybiB0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX07cmV0dXJuIGUucHJvdG90eXBlPXQucHJvdG90eXBlLGV9KGwpOmgmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGw/aShGdW5jdGlvbi5jYWxsLGwpOmwsaCYmKChiLnZpcnR1YWx8fChiLnZpcnR1YWw9e30pKVtmXT1sLHQmYy5SJiZnJiYhZ1tmXSYmdShnLGYsbCkpKX07Yy5GPTEsYy5HPTIsYy5TPTQsYy5QPTgsYy5CPTE2LGMuVz0zMixjLlU9NjQsYy5SPTEyOCx0LmV4cG9ydHM9Y30sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oNik7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe2lmKCFyKHQpKXRocm93IFR5cGVFcnJvcih0K1wiIGlzIG5vdCBhbiBvYmplY3QhXCIpO3JldHVybiB0fX0sZnVuY3Rpb24odCxlLG4pe3QuZXhwb3J0cz0hbigxMykoZnVuY3Rpb24oKXtyZXR1cm4gNyE9T2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LFwiYVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gN319KS5hfSl9LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiB0P251bGwhPT10OlwiZnVuY3Rpb25cIj09dHlwZW9mIHR9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big0KSxvPW4oMzYpLGk9bigyNiksdT1PYmplY3QuZGVmaW5lUHJvcGVydHk7ZS5mPW4oNSk/T2JqZWN0LmRlZmluZVByb3BlcnR5OmZ1bmN0aW9uKHQsZSxuKXtpZihyKHQpLGU9aShlLCEwKSxyKG4pLG8pdHJ5e3JldHVybiB1KHQsZSxuKX1jYXRjaCh0KXt9aWYoXCJnZXRcImluIG58fFwic2V0XCJpbiBuKXRocm93IFR5cGVFcnJvcihcIkFjY2Vzc29ycyBub3Qgc3VwcG9ydGVkIVwiKTtyZXR1cm5cInZhbHVlXCJpbiBuJiYodFtlXT1uLnZhbHVlKSx0fX0sZnVuY3Rpb24odCxlKXt2YXIgbj17fS5oYXNPd25Qcm9wZXJ0eTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXtyZXR1cm4gbi5jYWxsKHQsZSl9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big3KSxvPW4oMTkpO3QuZXhwb3J0cz1uKDUpP2Z1bmN0aW9uKHQsZSxuKXtyZXR1cm4gci5mKHQsZSxvKDEsbikpfTpmdW5jdGlvbih0LGUsbil7cmV0dXJuIHRbZV09bix0fX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oNTcpLG89bigyMyk7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiByKG8odCkpfX0sZnVuY3Rpb24odCxlLG4pe1widXNlIHN0cmljdFwiO2UuX19lc01vZHVsZT0hMCxlLmRlZmF1bHQ9ZnVuY3Rpb24odCxlKXtpZighKHQgaW5zdGFuY2VvZiBlKSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfX0sZnVuY3Rpb24odCxlLG4pe1widXNlIHN0cmljdFwiO2UuX19lc01vZHVsZT0hMDt2YXIgcj1uKDYwKSxvPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX0ocik7ZS5kZWZhdWx0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0LGUpe2Zvcih2YXIgbj0wO248ZS5sZW5ndGg7bisrKXt2YXIgcj1lW25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSwoMCxvLmRlZmF1bHQpKHQsci5rZXkscil9fXJldHVybiBmdW5jdGlvbih0LGUsbil7cmV0dXJuIGUmJmRlZmluZVByb3BlcnRpZXModC5wcm90b3R5cGUsZSksbiYmZGVmaW5lUHJvcGVydGllcyh0LG4pLHR9fSgpfSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXt0cnl7cmV0dXJuISF0KCl9Y2F0Y2godCl7cmV0dXJuITB9fX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ITB9LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDE4KTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlLG4pe2lmKHIodCksdm9pZCAwPT09ZSlyZXR1cm4gdDtzd2l0Y2gobil7Y2FzZSAxOnJldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gdC5jYWxsKGUsbil9O2Nhc2UgMjpyZXR1cm4gZnVuY3Rpb24obixyKXtyZXR1cm4gdC5jYWxsKGUsbixyKX07Y2FzZSAzOnJldHVybiBmdW5jdGlvbihuLHIsbyl7cmV0dXJuIHQuY2FsbChlLG4scixvKX19cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuYXBwbHkoZSxhcmd1bWVudHMpfX19LGZ1bmN0aW9uKHQsZSl7dmFyIG49e30udG9TdHJpbmc7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBuLmNhbGwodCkuc2xpY2UoOCwtMSl9fSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz17fX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgdCl0aHJvdyBUeXBlRXJyb3IodCtcIiBpcyBub3QgYSBmdW5jdGlvbiFcIik7cmV0dXJuIHR9fSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0LGUpe3JldHVybntlbnVtZXJhYmxlOiEoMSZ0KSxjb25maWd1cmFibGU6ISgyJnQpLHdyaXRhYmxlOiEoNCZ0KSx2YWx1ZTplfX19LGZ1bmN0aW9uKHQsZSl7dmFyIG49MCxyPU1hdGgucmFuZG9tKCk7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVyblwiU3ltYm9sKFwiLmNvbmNhdCh2b2lkIDA9PT10P1wiXCI6dCxcIilfXCIsKCsrbityKS50b1N0cmluZygzNikpfX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMzcpLG89bigyOSk7dC5leHBvcnRzPU9iamVjdC5rZXlzfHxmdW5jdGlvbih0KXtyZXR1cm4gcih0LG8pfX0sZnVuY3Rpb24odCxlKXt2YXIgbj1NYXRoLmNlaWwscj1NYXRoLmZsb29yO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gaXNOYU4odD0rdCk/MDoodD4wP3I6bikodCl9fSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXtpZih2b2lkIDA9PXQpdGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gIFwiK3QpO3JldHVybiB0fX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oNykuZixvPW4oOCksaT1uKDIpKFwidG9TdHJpbmdUYWdcIik7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxuKXt0JiYhbyh0PW4/dDp0LnByb3RvdHlwZSxpKSYmcih0LGkse2NvbmZpZ3VyYWJsZTohMCx2YWx1ZTplfSl9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big2KSxvPW4oMSkuZG9jdW1lbnQsaT1yKG8pJiZyKG8uY3JlYXRlRWxlbWVudCk7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBpP28uY3JlYXRlRWxlbWVudCh0KTp7fX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDYpO3QuZXhwb3J0cz1mdW5jdGlvbih0LGUpe2lmKCFyKHQpKXJldHVybiB0O3ZhciBuLG87aWYoZSYmXCJmdW5jdGlvblwiPT10eXBlb2Yobj10LnRvU3RyaW5nKSYmIXIobz1uLmNhbGwodCkpKXJldHVybiBvO2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mKG49dC52YWx1ZU9mKSYmIXIobz1uLmNhbGwodCkpKXJldHVybiBvO2lmKCFlJiZcImZ1bmN0aW9uXCI9PXR5cGVvZihuPXQudG9TdHJpbmcpJiYhcihvPW4uY2FsbCh0KSkpcmV0dXJuIG87dGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlXCIpfX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMjgpKFwia2V5c1wiKSxvPW4oMjApO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gclt0XXx8KHJbdF09byh0KSl9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigwKSxvPW4oMSksaT1vW1wiX19jb3JlLWpzX3NoYXJlZF9fXCJdfHwob1tcIl9fY29yZS1qc19zaGFyZWRfX1wiXT17fSk7KHQuZXhwb3J0cz1mdW5jdGlvbih0LGUpe3JldHVybiBpW3RdfHwoaVt0XT12b2lkIDAhPT1lP2U6e30pfSkoXCJ2ZXJzaW9uc1wiLFtdKS5wdXNoKHt2ZXJzaW9uOnIudmVyc2lvbixtb2RlOm4oMTQpP1wicHVyZVwiOlwiZ2xvYmFsXCIsY29weXJpZ2h0OlwiwqkgMjAxOCBEZW5pcyBQdXNoa2FyZXYgKHpsb2lyb2NrLnJ1KVwifSl9LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPVwiY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mXCIuc3BsaXQoXCIsXCIpfSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigyMyk7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3Qocih0KSl9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big0KSxvPW4oNjkpLGk9bigyOSksdT1uKDI3KShcIklFX1BST1RPXCIpLHM9ZnVuY3Rpb24oKXt9LGM9ZnVuY3Rpb24oKXt2YXIgdCxlPW4oMjUpKFwiaWZyYW1lXCIpLHI9aS5sZW5ndGg7Zm9yKGUuc3R5bGUuZGlzcGxheT1cIm5vbmVcIixuKDQ2KS5hcHBlbmRDaGlsZChlKSxlLnNyYz1cImphdmFzY3JpcHQ6XCIsdD1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQsdC5vcGVuKCksdC53cml0ZShcIjxzY3JpcHQ+ZG9jdW1lbnQuRj1PYmplY3Q8XFwvc2NyaXB0PlwiKSx0LmNsb3NlKCksYz10LkY7ci0tOylkZWxldGUgYy5wcm90b3R5cGVbaVtyXV07cmV0dXJuIGMoKX07dC5leHBvcnRzPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uKHQsZSl7dmFyIG47cmV0dXJuIG51bGwhPT10PyhzLnByb3RvdHlwZT1yKHQpLG49bmV3IHMscy5wcm90b3R5cGU9bnVsbCxuW3VdPXQpOm49YygpLHZvaWQgMD09PWU/bjpvKG4sZSl9fSxmdW5jdGlvbih0LGUsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gUHJvbWlzZUNhcGFiaWxpdHkodCl7dmFyIGUsbjt0aGlzLnByb21pc2U9bmV3IHQoZnVuY3Rpb24odCxyKXtpZih2b2lkIDAhPT1lfHx2b2lkIDAhPT1uKXRocm93IFR5cGVFcnJvcihcIkJhZCBQcm9taXNlIGNvbnN0cnVjdG9yXCIpO2U9dCxuPXJ9KSx0aGlzLnJlc29sdmU9cihlKSx0aGlzLnJlamVjdD1yKG4pfXZhciByPW4oMTgpO3QuZXhwb3J0cy5mPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgUHJvbWlzZUNhcGFiaWxpdHkodCl9fSxmdW5jdGlvbih0LGUsbil7ZS5mPW4oMil9LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDEpLG89bigwKSxpPW4oMTQpLHU9bigzMykscz1uKDcpLmY7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3ZhciBlPW8uU3ltYm9sfHwoby5TeW1ib2w9aT97fTpyLlN5bWJvbHx8e30pO1wiX1wiPT10LmNoYXJBdCgwKXx8dCBpbiBlfHxzKGUsdCx7dmFsdWU6dS5mKHQpfSl9fSxmdW5jdGlvbih0LGUpe2UuZj17fS5wcm9wZXJ0eUlzRW51bWVyYWJsZX0sZnVuY3Rpb24odCxlLG4pe3QuZXhwb3J0cz0hbig1KSYmIW4oMTMpKGZ1bmN0aW9uKCl7cmV0dXJuIDchPU9iamVjdC5kZWZpbmVQcm9wZXJ0eShuKDI1KShcImRpdlwiKSxcImFcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDd9fSkuYX0pfSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big4KSxvPW4oMTApLGk9big1OCkoITEpLHU9bigyNykoXCJJRV9QUk9UT1wiKTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXt2YXIgbixzPW8odCksYz0wLGY9W107Zm9yKG4gaW4gcyluIT11JiZyKHMsbikmJmYucHVzaChuKTtmb3IoO2UubGVuZ3RoPmM7KXIocyxuPWVbYysrXSkmJih+aShmLG4pfHxmLnB1c2gobikpO3JldHVybiBmfX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMjIpLG89TWF0aC5taW47dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiB0PjA/byhyKHQpLDkwMDcxOTkyNTQ3NDA5OTEpOjB9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigzKSxvPW4oMCksaT1uKDEzKTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXt2YXIgbj0oby5PYmplY3R8fHt9KVt0XXx8T2JqZWN0W3RdLHU9e307dVt0XT1lKG4pLHIoci5TK3IuRippKGZ1bmN0aW9uKCl7bigxKX0pLFwiT2JqZWN0XCIsdSl9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigzNSksbz1uKDE5KSxpPW4oMTApLHU9bigyNikscz1uKDgpLGM9bigzNiksZj1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO2UuZj1uKDUpP2Y6ZnVuY3Rpb24odCxlKXtpZih0PWkodCksZT11KGUsITApLGMpdHJ5e3JldHVybiBmKHQsZSl9Y2F0Y2godCl7fWlmKHModCxlKSlyZXR1cm4gbyghci5mLmNhbGwodCxlKSx0W2VdKX19LGZ1bmN0aW9uKHQsZSxuKXt0LmV4cG9ydHM9e2RlZmF1bHQ6big2NiksX19lc01vZHVsZTohMH19LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9big2NykoITApO24oNDQpKFN0cmluZyxcIlN0cmluZ1wiLGZ1bmN0aW9uKHQpe3RoaXMuX3Q9U3RyaW5nKHQpLHRoaXMuX2k9MH0sZnVuY3Rpb24oKXt2YXIgdCxlPXRoaXMuX3Qsbj10aGlzLl9pO3JldHVybiBuPj1lLmxlbmd0aD97dmFsdWU6dm9pZCAwLGRvbmU6ITB9Oih0PXIoZSxuKSx0aGlzLl9pKz10Lmxlbmd0aCx7dmFsdWU6dCxkb25lOiExfSl9KX0sZnVuY3Rpb24odCxlLG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oMTQpLG89bigzKSxpPW4oNDUpLHU9big5KSxzPW4oMTcpLGM9big2OCksZj1uKDI0KSxhPW4oNDcpLGw9bigyKShcIml0ZXJhdG9yXCIpLHA9IShbXS5rZXlzJiZcIm5leHRcImluW10ua2V5cygpKSx2PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O3QuZXhwb3J0cz1mdW5jdGlvbih0LGUsbixkLGgseSxfKXtjKG4sZSxkKTt2YXIgYixnLG0sdz1mdW5jdGlvbih0KXtpZighcCYmdCBpbiBQKXJldHVybiBQW3RdO3N3aXRjaCh0KXtjYXNlXCJrZXlzXCI6Y2FzZVwidmFsdWVzXCI6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKHRoaXMsdCl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgbih0aGlzLHQpfX0seD1lK1wiIEl0ZXJhdG9yXCIsTz1cInZhbHVlc1wiPT1oLE09ITEsUD10LnByb3RvdHlwZSxTPVBbbF18fFBbXCJAQGl0ZXJhdG9yXCJdfHxoJiZQW2hdLEw9U3x8dyhoKSxqPWg/Tz93KFwiZW50cmllc1wiKTpMOnZvaWQgMCxrPVwiQXJyYXlcIj09ZT9QLmVudHJpZXN8fFM6UztpZihrJiYobT1hKGsuY2FsbChuZXcgdCkpKSE9PU9iamVjdC5wcm90b3R5cGUmJm0ubmV4dCYmKGYobSx4LCEwKSxyfHxcImZ1bmN0aW9uXCI9PXR5cGVvZiBtW2xdfHx1KG0sbCx2KSksTyYmUyYmXCJ2YWx1ZXNcIiE9PVMubmFtZSYmKE09ITAsTD1mdW5jdGlvbigpe3JldHVybiBTLmNhbGwodGhpcyl9KSxyJiYhX3x8IXAmJiFNJiZQW2xdfHx1KFAsbCxMKSxzW2VdPUwsc1t4XT12LGgpaWYoYj17dmFsdWVzOk8/TDp3KFwidmFsdWVzXCIpLGtleXM6eT9MOncoXCJrZXlzXCIpLGVudHJpZXM6an0sXylmb3IoZyBpbiBiKWcgaW4gUHx8aShQLGcsYltnXSk7ZWxzZSBvKG8uUCtvLkYqKHB8fE0pLGUsYik7cmV0dXJuIGJ9fSxmdW5jdGlvbih0LGUsbil7dC5leHBvcnRzPW4oOSl9LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDEpLmRvY3VtZW50O3QuZXhwb3J0cz1yJiZyLmRvY3VtZW50RWxlbWVudH0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oOCksbz1uKDMwKSxpPW4oMjcpKFwiSUVfUFJPVE9cIiksdT1PYmplY3QucHJvdG90eXBlO3QuZXhwb3J0cz1PYmplY3QuZ2V0UHJvdG90eXBlT2Z8fGZ1bmN0aW9uKHQpe3JldHVybiB0PW8odCkscih0LGkpP3RbaV06XCJmdW5jdGlvblwiPT10eXBlb2YgdC5jb25zdHJ1Y3RvciYmdCBpbnN0YW5jZW9mIHQuY29uc3RydWN0b3I/dC5jb25zdHJ1Y3Rvci5wcm90b3R5cGU6dCBpbnN0YW5jZW9mIE9iamVjdD91Om51bGx9fSxmdW5jdGlvbih0LGUsbil7big3MCk7Zm9yKHZhciByPW4oMSksbz1uKDkpLGk9bigxNyksdT1uKDIpKFwidG9TdHJpbmdUYWdcIikscz1cIkNTU1J1bGVMaXN0LENTU1N0eWxlRGVjbGFyYXRpb24sQ1NTVmFsdWVMaXN0LENsaWVudFJlY3RMaXN0LERPTVJlY3RMaXN0LERPTVN0cmluZ0xpc3QsRE9NVG9rZW5MaXN0LERhdGFUcmFuc2Zlckl0ZW1MaXN0LEZpbGVMaXN0LEhUTUxBbGxDb2xsZWN0aW9uLEhUTUxDb2xsZWN0aW9uLEhUTUxGb3JtRWxlbWVudCxIVE1MU2VsZWN0RWxlbWVudCxNZWRpYUxpc3QsTWltZVR5cGVBcnJheSxOYW1lZE5vZGVNYXAsTm9kZUxpc3QsUGFpbnRSZXF1ZXN0TGlzdCxQbHVnaW4sUGx1Z2luQXJyYXksU1ZHTGVuZ3RoTGlzdCxTVkdOdW1iZXJMaXN0LFNWR1BhdGhTZWdMaXN0LFNWR1BvaW50TGlzdCxTVkdTdHJpbmdMaXN0LFNWR1RyYW5zZm9ybUxpc3QsU291cmNlQnVmZmVyTGlzdCxTdHlsZVNoZWV0TGlzdCxUZXh0VHJhY2tDdWVMaXN0LFRleHRUcmFja0xpc3QsVG91Y2hMaXN0XCIuc3BsaXQoXCIsXCIpLGM9MDtjPHMubGVuZ3RoO2MrKyl7dmFyIGY9c1tjXSxhPXJbZl0sbD1hJiZhLnByb3RvdHlwZTtsJiYhbFt1XSYmbyhsLHUsZiksaVtmXT1pLkFycmF5fX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMTYpLG89bigyKShcInRvU3RyaW5nVGFnXCIpLGk9XCJBcmd1bWVudHNcIj09cihmdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHN9KCkpLHU9ZnVuY3Rpb24odCxlKXt0cnl7cmV0dXJuIHRbZV19Y2F0Y2godCl7fX07dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3ZhciBlLG4scztyZXR1cm4gdm9pZCAwPT09dD9cIlVuZGVmaW5lZFwiOm51bGw9PT10P1wiTnVsbFwiOlwic3RyaW5nXCI9PXR5cGVvZihuPXUoZT1PYmplY3QodCksbykpP246aT9yKGUpOlwiT2JqZWN0XCI9PShzPXIoZSkpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBlLmNhbGxlZT9cIkFyZ3VtZW50c1wiOnN9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big0KSxvPW4oMTgpLGk9bigyKShcInNwZWNpZXNcIik7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7dmFyIG4sdT1yKHQpLmNvbnN0cnVjdG9yO3JldHVybiB2b2lkIDA9PT11fHx2b2lkIDA9PShuPXIodSlbaV0pP2U6byhuKX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcixvLGksdT1uKDE1KSxzPW4oNzkpLGM9big0NiksZj1uKDI1KSxhPW4oMSksbD1hLnByb2Nlc3MscD1hLnNldEltbWVkaWF0ZSx2PWEuY2xlYXJJbW1lZGlhdGUsZD1hLk1lc3NhZ2VDaGFubmVsLGg9YS5EaXNwYXRjaCx5PTAsXz17fSxiPWZ1bmN0aW9uKCl7dmFyIHQ9K3RoaXM7aWYoXy5oYXNPd25Qcm9wZXJ0eSh0KSl7dmFyIGU9X1t0XTtkZWxldGUgX1t0XSxlKCl9fSxnPWZ1bmN0aW9uKHQpe2IuY2FsbCh0LmRhdGEpfTtwJiZ2fHwocD1mdW5jdGlvbih0KXtmb3IodmFyIGU9W10sbj0xO2FyZ3VtZW50cy5sZW5ndGg+bjspZS5wdXNoKGFyZ3VtZW50c1tuKytdKTtyZXR1cm4gX1srK3ldPWZ1bmN0aW9uKCl7cyhcImZ1bmN0aW9uXCI9PXR5cGVvZiB0P3Q6RnVuY3Rpb24odCksZSl9LHIoeSkseX0sdj1mdW5jdGlvbih0KXtkZWxldGUgX1t0XX0sXCJwcm9jZXNzXCI9PW4oMTYpKGwpP3I9ZnVuY3Rpb24odCl7bC5uZXh0VGljayh1KGIsdCwxKSl9OmgmJmgubm93P3I9ZnVuY3Rpb24odCl7aC5ub3codShiLHQsMSkpfTpkPyhvPW5ldyBkLGk9by5wb3J0MixvLnBvcnQxLm9ubWVzc2FnZT1nLHI9dShpLnBvc3RNZXNzYWdlLGksMSkpOmEuYWRkRXZlbnRMaXN0ZW5lciYmXCJmdW5jdGlvblwiPT10eXBlb2YgcG9zdE1lc3NhZ2UmJiFhLmltcG9ydFNjcmlwdHM/KHI9ZnVuY3Rpb24odCl7YS5wb3N0TWVzc2FnZSh0K1wiXCIsXCIqXCIpfSxhLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsZywhMSkpOnI9XCJvbnJlYWR5c3RhdGVjaGFuZ2VcImluIGYoXCJzY3JpcHRcIik/ZnVuY3Rpb24odCl7Yy5hcHBlbmRDaGlsZChmKFwic2NyaXB0XCIpKS5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXtjLnJlbW92ZUNoaWxkKHRoaXMpLGIuY2FsbCh0KX19OmZ1bmN0aW9uKHQpe3NldFRpbWVvdXQodShiLHQsMSksMCl9KSx0LmV4cG9ydHM9e3NldDpwLGNsZWFyOnZ9fSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXt0cnl7cmV0dXJue2U6ITEsdjp0KCl9fWNhdGNoKHQpe3JldHVybntlOiEwLHY6dH19fX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oNCksbz1uKDYpLGk9bigzMik7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7aWYocih0KSxvKGUpJiZlLmNvbnN0cnVjdG9yPT09dClyZXR1cm4gZTt2YXIgbj1pLmYodCk7cmV0dXJuKDAsbi5yZXNvbHZlKShlKSxuLnByb21pc2V9fSxmdW5jdGlvbih0LGUsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdCh0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19ZS5fX2VzTW9kdWxlPSEwO3ZhciByPW4oOTApLG89X2ludGVyb3BSZXF1aXJlRGVmYXVsdChyKSxpPW4oOTIpLHU9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChpKSxzPVwiZnVuY3Rpb25cIj09dHlwZW9mIHUuZGVmYXVsdCYmXCJzeW1ib2xcIj09dHlwZW9mIG8uZGVmYXVsdD9mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHR9OmZ1bmN0aW9uKHQpe3JldHVybiB0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB1LmRlZmF1bHQmJnQuY29uc3RydWN0b3I9PT11LmRlZmF1bHQmJnQhPT11LmRlZmF1bHQucHJvdG90eXBlP1wic3ltYm9sXCI6dHlwZW9mIHR9O2UuZGVmYXVsdD1cImZ1bmN0aW9uXCI9PXR5cGVvZiB1LmRlZmF1bHQmJlwic3ltYm9sXCI9PT1zKG8uZGVmYXVsdCk/ZnVuY3Rpb24odCl7cmV0dXJuIHZvaWQgMD09PXQ/XCJ1bmRlZmluZWRcIjpzKHQpfTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdS5kZWZhdWx0JiZ0LmNvbnN0cnVjdG9yPT09dS5kZWZhdWx0JiZ0IT09dS5kZWZhdWx0LnByb3RvdHlwZT9cInN5bWJvbFwiOnZvaWQgMD09PXQ/XCJ1bmRlZmluZWRcIjpzKHQpfX0sZnVuY3Rpb24odCxlKXtlLmY9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sc30sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMzcpLG89bigyOSkuY29uY2F0KFwibGVuZ3RoXCIsXCJwcm90b3R5cGVcIik7ZS5mPU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzfHxmdW5jdGlvbih0KXtyZXR1cm4gcih0LG8pfX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMTYpO3QuZXhwb3J0cz1PYmplY3QoXCJ6XCIpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApP09iamVjdDpmdW5jdGlvbih0KXtyZXR1cm5cIlN0cmluZ1wiPT1yKHQpP3Quc3BsaXQoXCJcIik6T2JqZWN0KHQpfX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMTApLG89bigzOCksaT1uKDU5KTt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUsbix1KXt2YXIgcyxjPXIoZSksZj1vKGMubGVuZ3RoKSxhPWkodSxmKTtpZih0JiZuIT1uKXtmb3IoO2Y+YTspaWYoKHM9Y1thKytdKSE9cylyZXR1cm4hMH1lbHNlIGZvcig7Zj5hO2ErKylpZigodHx8YSBpbiBjKSYmY1thXT09PW4pcmV0dXJuIHR8fGF8fDA7cmV0dXJuIXQmJi0xfX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDIyKSxvPU1hdGgubWF4LGk9TWF0aC5taW47dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ9cih0KSx0PDA/byh0K2UsMCk6aSh0LGUpfX0sZnVuY3Rpb24odCxlLG4pe3QuZXhwb3J0cz17ZGVmYXVsdDpuKDYxKSxfX2VzTW9kdWxlOiEwfX0sZnVuY3Rpb24odCxlLG4pe24oNjIpO3ZhciByPW4oMCkuT2JqZWN0O3QuZXhwb3J0cz1mdW5jdGlvbih0LGUsbil7cmV0dXJuIHIuZGVmaW5lUHJvcGVydHkodCxlLG4pfX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMyk7cihyLlMrci5GKiFuKDUpLFwiT2JqZWN0XCIse2RlZmluZVByb3BlcnR5Om4oNykuZn0pfSxmdW5jdGlvbih0LGUsbil7dC5leHBvcnRzPXtkZWZhdWx0Om4oODgpLF9fZXNNb2R1bGU6ITB9fSxmdW5jdGlvbih0LGUsbil7XCJ1c2Ugc3RyaWN0XCI7ZS5fX2VzTW9kdWxlPSEwO3ZhciByPW4oNTQpLG89ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OntkZWZhdWx0OnR9fShyKTtlLmRlZmF1bHQ9ZnVuY3Rpb24odCxlKXtpZighdCl0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7cmV0dXJuIWV8fFwib2JqZWN0XCIhPT0odm9pZCAwPT09ZT9cInVuZGVmaW5lZFwiOigwLG8uZGVmYXVsdCkoZSkpJiZcImZ1bmN0aW9uXCIhPXR5cGVvZiBlP3Q6ZX19LGZ1bmN0aW9uKHQsZSxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX1lLl9fZXNNb2R1bGU9ITA7dmFyIHI9bigxMDEpLG89X2ludGVyb3BSZXF1aXJlRGVmYXVsdChyKSxpPW4oMTA1KSx1PV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoaSkscz1uKDU0KSxjPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQocyk7ZS5kZWZhdWx0PWZ1bmN0aW9uKHQsZSl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgZSYmbnVsbCE9PWUpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIrKHZvaWQgMD09PWU/XCJ1bmRlZmluZWRcIjooMCxjLmRlZmF1bHQpKGUpKSk7dC5wcm90b3R5cGU9KDAsdS5kZWZhdWx0KShlJiZlLnByb3RvdHlwZSx7Y29uc3RydWN0b3I6e3ZhbHVlOnQsZW51bWVyYWJsZTohMSx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksZSYmKG8uZGVmYXVsdD8oMCxvLmRlZmF1bHQpKHQsZSk6dC5fX3Byb3RvX189ZSl9fSxmdW5jdGlvbih0LGUsbil7big0Miksbig0Myksbig0OCksbig3Myksbig4NSksbig4NiksdC5leHBvcnRzPW4oMCkuUHJvbWlzZX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMjIpLG89bigyMyk7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlLG4pe3ZhciBpLHUscz1TdHJpbmcobyhlKSksYz1yKG4pLGY9cy5sZW5ndGg7cmV0dXJuIGM8MHx8Yz49Zj90P1wiXCI6dm9pZCAwOihpPXMuY2hhckNvZGVBdChjKSxpPDU1Mjk2fHxpPjU2MzE5fHxjKzE9PT1mfHwodT1zLmNoYXJDb2RlQXQoYysxKSk8NTYzMjB8fHU+NTczNDM/dD9zLmNoYXJBdChjKTppOnQ/cy5zbGljZShjLGMrMik6dS01NjMyMCsoaS01NTI5Njw8MTApKzY1NTM2KX19fSxmdW5jdGlvbih0LGUsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9bigzMSksbz1uKDE5KSxpPW4oMjQpLHU9e307big5KSh1LG4oMikoXCJpdGVyYXRvclwiKSxmdW5jdGlvbigpe3JldHVybiB0aGlzfSksdC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxuKXt0LnByb3RvdHlwZT1yKHUse25leHQ6bygxLG4pfSksaSh0LGUrXCIgSXRlcmF0b3JcIil9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big3KSxvPW4oNCksaT1uKDIxKTt0LmV4cG9ydHM9big1KT9PYmplY3QuZGVmaW5lUHJvcGVydGllczpmdW5jdGlvbih0LGUpe28odCk7Zm9yKHZhciBuLHU9aShlKSxzPXUubGVuZ3RoLGM9MDtzPmM7KXIuZih0LG49dVtjKytdLGVbbl0pO3JldHVybiB0fX0sZnVuY3Rpb24odCxlLG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oNzEpLG89big3MiksaT1uKDE3KSx1PW4oMTApO3QuZXhwb3J0cz1uKDQ0KShBcnJheSxcIkFycmF5XCIsZnVuY3Rpb24odCxlKXt0aGlzLl90PXUodCksdGhpcy5faT0wLHRoaXMuX2s9ZX0sZnVuY3Rpb24oKXt2YXIgdD10aGlzLl90LGU9dGhpcy5fayxuPXRoaXMuX2krKztyZXR1cm4hdHx8bj49dC5sZW5ndGg/KHRoaXMuX3Q9dm9pZCAwLG8oMSkpOlwia2V5c1wiPT1lP28oMCxuKTpcInZhbHVlc1wiPT1lP28oMCx0W25dKTpvKDAsW24sdFtuXV0pfSxcInZhbHVlc1wiKSxpLkFyZ3VtZW50cz1pLkFycmF5LHIoXCJrZXlzXCIpLHIoXCJ2YWx1ZXNcIikscihcImVudHJpZXNcIil9LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKCl7fX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXtyZXR1cm57dmFsdWU6ZSxkb25lOiEhdH19fSxmdW5jdGlvbih0LGUsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHIsbyxpLHUscz1uKDE0KSxjPW4oMSksZj1uKDE1KSxhPW4oNDkpLGw9bigzKSxwPW4oNiksdj1uKDE4KSxkPW4oNzQpLGg9big3NSkseT1uKDUwKSxfPW4oNTEpLnNldCxiPW4oODApKCksZz1uKDMyKSxtPW4oNTIpLHc9big4MSkseD1uKDUzKSxPPWMuVHlwZUVycm9yLE09Yy5wcm9jZXNzLFA9TSYmTS52ZXJzaW9ucyxTPVAmJlAudjh8fFwiXCIsTD1jLlByb21pc2Usaj1cInByb2Nlc3NcIj09YShNKSxrPWZ1bmN0aW9uKCl7fSxFPW89Zy5mLFI9ISFmdW5jdGlvbigpe3RyeXt2YXIgdD1MLnJlc29sdmUoMSksZT0odC5jb25zdHJ1Y3Rvcj17fSlbbigyKShcInNwZWNpZXNcIildPWZ1bmN0aW9uKHQpe3QoayxrKX07cmV0dXJuKGp8fFwiZnVuY3Rpb25cIj09dHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCkmJnQudGhlbihrKWluc3RhbmNlb2YgZSYmMCE9PVMuaW5kZXhPZihcIjYuNlwiKSYmLTE9PT13LmluZGV4T2YoXCJDaHJvbWUvNjZcIil9Y2F0Y2godCl7fX0oKSxUPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiEoIXAodCl8fFwiZnVuY3Rpb25cIiE9dHlwZW9mKGU9dC50aGVuKSkmJmV9LEM9ZnVuY3Rpb24odCxlKXtpZighdC5fbil7dC5fbj0hMDt2YXIgbj10Ll9jO2IoZnVuY3Rpb24oKXtmb3IodmFyIHI9dC5fdixvPTE9PXQuX3MsaT0wO24ubGVuZ3RoPmk7KSFmdW5jdGlvbihlKXt2YXIgbixpLHUscz1vP2Uub2s6ZS5mYWlsLGM9ZS5yZXNvbHZlLGY9ZS5yZWplY3QsYT1lLmRvbWFpbjt0cnl7cz8ob3x8KDI9PXQuX2gmJkYodCksdC5faD0xKSwhMD09PXM/bj1yOihhJiZhLmVudGVyKCksbj1zKHIpLGEmJihhLmV4aXQoKSx1PSEwKSksbj09PWUucHJvbWlzZT9mKE8oXCJQcm9taXNlLWNoYWluIGN5Y2xlXCIpKTooaT1UKG4pKT9pLmNhbGwobixjLGYpOmMobikpOmYocil9Y2F0Y2godCl7YSYmIXUmJmEuZXhpdCgpLGYodCl9fShuW2krK10pO3QuX2M9W10sdC5fbj0hMSxlJiYhdC5faCYmQSh0KX0pfX0sQT1mdW5jdGlvbih0KXtfLmNhbGwoYyxmdW5jdGlvbigpe3ZhciBlLG4scixvPXQuX3YsaT1EKHQpO2lmKGkmJihlPW0oZnVuY3Rpb24oKXtqP00uZW1pdChcInVuaGFuZGxlZFJlamVjdGlvblwiLG8sdCk6KG49Yy5vbnVuaGFuZGxlZHJlamVjdGlvbik/bih7cHJvbWlzZTp0LHJlYXNvbjpvfSk6KHI9Yy5jb25zb2xlKSYmci5lcnJvciYmci5lcnJvcihcIlVuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvblwiLG8pfSksdC5faD1qfHxEKHQpPzI6MSksdC5fYT12b2lkIDAsaSYmZS5lKXRocm93IGUudn0pfSxEPWZ1bmN0aW9uKHQpe3JldHVybiAxIT09dC5faCYmMD09PSh0Ll9hfHx0Ll9jKS5sZW5ndGh9LEY9ZnVuY3Rpb24odCl7Xy5jYWxsKGMsZnVuY3Rpb24oKXt2YXIgZTtqP00uZW1pdChcInJlamVjdGlvbkhhbmRsZWRcIix0KTooZT1jLm9ucmVqZWN0aW9uaGFuZGxlZCkmJmUoe3Byb21pc2U6dCxyZWFzb246dC5fdn0pfSl9LHE9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcztlLl9kfHwoZS5fZD0hMCxlPWUuX3d8fGUsZS5fdj10LGUuX3M9MixlLl9hfHwoZS5fYT1lLl9jLnNsaWNlKCkpLEMoZSwhMCkpfSxJPWZ1bmN0aW9uKHQpe3ZhciBlLG49dGhpcztpZighbi5fZCl7bi5fZD0hMCxuPW4uX3d8fG47dHJ5e2lmKG49PT10KXRocm93IE8oXCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZlwiKTsoZT1UKHQpKT9iKGZ1bmN0aW9uKCl7dmFyIHI9e193Om4sX2Q6ITF9O3RyeXtlLmNhbGwodCxmKEksciwxKSxmKHEsciwxKSl9Y2F0Y2godCl7cS5jYWxsKHIsdCl9fSk6KG4uX3Y9dCxuLl9zPTEsQyhuLCExKSl9Y2F0Y2godCl7cS5jYWxsKHtfdzpuLF9kOiExfSx0KX19fTtSfHwoTD1mdW5jdGlvbih0KXtkKHRoaXMsTCxcIlByb21pc2VcIixcIl9oXCIpLHYodCksci5jYWxsKHRoaXMpO3RyeXt0KGYoSSx0aGlzLDEpLGYocSx0aGlzLDEpKX1jYXRjaCh0KXtxLmNhbGwodGhpcyx0KX19LHI9ZnVuY3Rpb24odCl7dGhpcy5fYz1bXSx0aGlzLl9hPXZvaWQgMCx0aGlzLl9zPTAsdGhpcy5fZD0hMSx0aGlzLl92PXZvaWQgMCx0aGlzLl9oPTAsdGhpcy5fbj0hMX0sci5wcm90b3R5cGU9big4MikoTC5wcm90b3R5cGUse3RoZW46ZnVuY3Rpb24odCxlKXt2YXIgbj1FKHkodGhpcyxMKSk7cmV0dXJuIG4ub2s9XCJmdW5jdGlvblwiIT10eXBlb2YgdHx8dCxuLmZhaWw9XCJmdW5jdGlvblwiPT10eXBlb2YgZSYmZSxuLmRvbWFpbj1qP00uZG9tYWluOnZvaWQgMCx0aGlzLl9jLnB1c2gobiksdGhpcy5fYSYmdGhpcy5fYS5wdXNoKG4pLHRoaXMuX3MmJkModGhpcywhMSksbi5wcm9taXNlfSxjYXRjaDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50aGVuKHZvaWQgMCx0KX19KSxpPWZ1bmN0aW9uKCl7dmFyIHQ9bmV3IHI7dGhpcy5wcm9taXNlPXQsdGhpcy5yZXNvbHZlPWYoSSx0LDEpLHRoaXMucmVqZWN0PWYocSx0LDEpfSxnLmY9RT1mdW5jdGlvbih0KXtyZXR1cm4gdD09PUx8fHQ9PT11P25ldyBpKHQpOm8odCl9KSxsKGwuRytsLlcrbC5GKiFSLHtQcm9taXNlOkx9KSxuKDI0KShMLFwiUHJvbWlzZVwiKSxuKDgzKShcIlByb21pc2VcIiksdT1uKDApLlByb21pc2UsbChsLlMrbC5GKiFSLFwiUHJvbWlzZVwiLHtyZWplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9RSh0aGlzKTtyZXR1cm4oMCxlLnJlamVjdCkodCksZS5wcm9taXNlfX0pLGwobC5TK2wuRiooc3x8IVIpLFwiUHJvbWlzZVwiLHtyZXNvbHZlOmZ1bmN0aW9uKHQpe3JldHVybiB4KHMmJnRoaXM9PT11P0w6dGhpcyx0KX19KSxsKGwuUytsLkYqIShSJiZuKDg0KShmdW5jdGlvbih0KXtMLmFsbCh0KS5jYXRjaChrKX0pKSxcIlByb21pc2VcIix7YWxsOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMsbj1FKGUpLHI9bi5yZXNvbHZlLG89bi5yZWplY3QsaT1tKGZ1bmN0aW9uKCl7dmFyIG49W10saT0wLHU9MTtoKHQsITEsZnVuY3Rpb24odCl7dmFyIHM9aSsrLGM9ITE7bi5wdXNoKHZvaWQgMCksdSsrLGUucmVzb2x2ZSh0KS50aGVuKGZ1bmN0aW9uKHQpe2N8fChjPSEwLG5bc109dCwtLXV8fHIobikpfSxvKX0pLC0tdXx8cihuKX0pO3JldHVybiBpLmUmJm8oaS52KSxuLnByb21pc2V9LHJhY2U6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxuPUUoZSkscj1uLnJlamVjdCxvPW0oZnVuY3Rpb24oKXtoKHQsITEsZnVuY3Rpb24odCl7ZS5yZXNvbHZlKHQpLnRoZW4obi5yZXNvbHZlLHIpfSl9KTtyZXR1cm4gby5lJiZyKG8udiksbi5wcm9taXNlfX0pfSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0LGUsbixyKXtpZighKHQgaW5zdGFuY2VvZiBlKXx8dm9pZCAwIT09ciYmciBpbiB0KXRocm93IFR5cGVFcnJvcihuK1wiOiBpbmNvcnJlY3QgaW52b2NhdGlvbiFcIik7cmV0dXJuIHR9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigxNSksbz1uKDc2KSxpPW4oNzcpLHU9big0KSxzPW4oMzgpLGM9big3OCksZj17fSxhPXt9LGU9dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxuLGwscCl7dmFyIHYsZCxoLHksXz1wP2Z1bmN0aW9uKCl7cmV0dXJuIHR9OmModCksYj1yKG4sbCxlPzI6MSksZz0wO2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIF8pdGhyb3cgVHlwZUVycm9yKHQrXCIgaXMgbm90IGl0ZXJhYmxlIVwiKTtpZihpKF8pKXtmb3Iodj1zKHQubGVuZ3RoKTt2Pmc7ZysrKWlmKCh5PWU/Yih1KGQ9dFtnXSlbMF0sZFsxXSk6Yih0W2ddKSk9PT1mfHx5PT09YSlyZXR1cm4geX1lbHNlIGZvcihoPV8uY2FsbCh0KTshKGQ9aC5uZXh0KCkpLmRvbmU7KWlmKCh5PW8oaCxiLGQudmFsdWUsZSkpPT09Znx8eT09PWEpcmV0dXJuIHl9O2UuQlJFQUs9ZixlLlJFVFVSTj1hfSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big0KTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlLG4sbyl7dHJ5e3JldHVybiBvP2UocihuKVswXSxuWzFdKTplKG4pfWNhdGNoKGUpe3ZhciBpPXQucmV0dXJuO3Rocm93IHZvaWQgMCE9PWkmJnIoaS5jYWxsKHQpKSxlfX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDE3KSxvPW4oMikoXCJpdGVyYXRvclwiKSxpPUFycmF5LnByb3RvdHlwZTt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIHZvaWQgMCE9PXQmJihyLkFycmF5PT09dHx8aVtvXT09PXQpfX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oNDkpLG89bigyKShcIml0ZXJhdG9yXCIpLGk9bigxNyk7dC5leHBvcnRzPW4oMCkuZ2V0SXRlcmF0b3JNZXRob2Q9ZnVuY3Rpb24odCl7aWYodm9pZCAwIT10KXJldHVybiB0W29dfHx0W1wiQEBpdGVyYXRvclwiXXx8aVtyKHQpXX19LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxuKXt2YXIgcj12b2lkIDA9PT1uO3N3aXRjaChlLmxlbmd0aCl7Y2FzZSAwOnJldHVybiByP3QoKTp0LmNhbGwobik7Y2FzZSAxOnJldHVybiByP3QoZVswXSk6dC5jYWxsKG4sZVswXSk7Y2FzZSAyOnJldHVybiByP3QoZVswXSxlWzFdKTp0LmNhbGwobixlWzBdLGVbMV0pO2Nhc2UgMzpyZXR1cm4gcj90KGVbMF0sZVsxXSxlWzJdKTp0LmNhbGwobixlWzBdLGVbMV0sZVsyXSk7Y2FzZSA0OnJldHVybiByP3QoZVswXSxlWzFdLGVbMl0sZVszXSk6dC5jYWxsKG4sZVswXSxlWzFdLGVbMl0sZVszXSl9cmV0dXJuIHQuYXBwbHkobixlKX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDEpLG89big1MSkuc2V0LGk9ci5NdXRhdGlvbk9ic2VydmVyfHxyLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIsdT1yLnByb2Nlc3Mscz1yLlByb21pc2UsYz1cInByb2Nlc3NcIj09bigxNikodSk7dC5leHBvcnRzPWZ1bmN0aW9uKCl7dmFyIHQsZSxuLGY9ZnVuY3Rpb24oKXt2YXIgcixvO2ZvcihjJiYocj11LmRvbWFpbikmJnIuZXhpdCgpO3Q7KXtvPXQuZm4sdD10Lm5leHQ7dHJ5e28oKX1jYXRjaChyKXt0aHJvdyB0P24oKTplPXZvaWQgMCxyfX1lPXZvaWQgMCxyJiZyLmVudGVyKCl9O2lmKGMpbj1mdW5jdGlvbigpe3UubmV4dFRpY2soZil9O2Vsc2UgaWYoIWl8fHIubmF2aWdhdG9yJiZyLm5hdmlnYXRvci5zdGFuZGFsb25lKWlmKHMmJnMucmVzb2x2ZSl7dmFyIGE9cy5yZXNvbHZlKHZvaWQgMCk7bj1mdW5jdGlvbigpe2EudGhlbihmKX19ZWxzZSBuPWZ1bmN0aW9uKCl7by5jYWxsKHIsZil9O2Vsc2V7dmFyIGw9ITAscD1kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIlwiKTtuZXcgaShmKS5vYnNlcnZlKHAse2NoYXJhY3RlckRhdGE6ITB9KSxuPWZ1bmN0aW9uKCl7cC5kYXRhPWw9IWx9fXJldHVybiBmdW5jdGlvbihyKXt2YXIgbz17Zm46cixuZXh0OnZvaWQgMH07ZSYmKGUubmV4dD1vKSx0fHwodD1vLG4oKSksZT1vfX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDEpLG89ci5uYXZpZ2F0b3I7dC5leHBvcnRzPW8mJm8udXNlckFnZW50fHxcIlwifSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big5KTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlLG4pe2Zvcih2YXIgbyBpbiBlKW4mJnRbb10/dFtvXT1lW29dOnIodCxvLGVbb10pO3JldHVybiB0fX0sZnVuY3Rpb24odCxlLG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oMSksbz1uKDApLGk9big3KSx1PW4oNSkscz1uKDIpKFwic3BlY2llc1wiKTt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7dmFyIGU9XCJmdW5jdGlvblwiPT10eXBlb2Ygb1t0XT9vW3RdOnJbdF07dSYmZSYmIWVbc10mJmkuZihlLHMse2NvbmZpZ3VyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc319KX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDIpKFwiaXRlcmF0b3JcIiksbz0hMTt0cnl7dmFyIGk9WzddW3JdKCk7aS5yZXR1cm49ZnVuY3Rpb24oKXtvPSEwfSxBcnJheS5mcm9tKGksZnVuY3Rpb24oKXt0aHJvdyAyfSl9Y2F0Y2godCl7fXQuZXhwb3J0cz1mdW5jdGlvbih0LGUpe2lmKCFlJiYhbylyZXR1cm4hMTt2YXIgbj0hMTt0cnl7dmFyIGk9WzddLHU9aVtyXSgpO3UubmV4dD1mdW5jdGlvbigpe3JldHVybntkb25lOm49ITB9fSxpW3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHV9LHQoaSl9Y2F0Y2godCl7fXJldHVybiBufX0sZnVuY3Rpb24odCxlLG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oMyksbz1uKDApLGk9bigxKSx1PW4oNTApLHM9big1Myk7cihyLlArci5SLFwiUHJvbWlzZVwiLHtmaW5hbGx5OmZ1bmN0aW9uKHQpe3ZhciBlPXUodGhpcyxvLlByb21pc2V8fGkuUHJvbWlzZSksbj1cImZ1bmN0aW9uXCI9PXR5cGVvZiB0O3JldHVybiB0aGlzLnRoZW4obj9mdW5jdGlvbihuKXtyZXR1cm4gcyhlLHQoKSkudGhlbihmdW5jdGlvbigpe3JldHVybiBufSl9OnQsbj9mdW5jdGlvbihuKXtyZXR1cm4gcyhlLHQoKSkudGhlbihmdW5jdGlvbigpe3Rocm93IG59KX06dCl9fSl9LGZ1bmN0aW9uKHQsZSxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj1uKDMpLG89bigzMiksaT1uKDUyKTtyKHIuUyxcIlByb21pc2VcIix7dHJ5OmZ1bmN0aW9uKHQpe3ZhciBlPW8uZih0aGlzKSxuPWkodCk7cmV0dXJuKG4uZT9lLnJlamVjdDplLnJlc29sdmUpKG4udiksZS5wcm9taXNlfX0pfSxmdW5jdGlvbih0LGUsbil7dmFyIHIsbzshZnVuY3Rpb24oaSx1KXtcInVzZSBzdHJpY3RcIjtyPXUsdm9pZCAwIT09KG89XCJmdW5jdGlvblwiPT10eXBlb2Ygcj9yLmNhbGwoZSxuLGUsdCk6cikmJih0LmV4cG9ydHM9byl9KDAsZnVuY3Rpb24oKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBiaW5kTWV0aG9kKHQsZSl7dmFyIG49dFtlXTtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmJpbmQpcmV0dXJuIG4uYmluZCh0KTt0cnl7cmV0dXJuIEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwobix0KX1jYXRjaChlKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5LmFwcGx5KG4sW3QsYXJndW1lbnRzXSl9fX1mdW5jdGlvbiByZWFsTWV0aG9kKG4pe3JldHVyblwiZGVidWdcIj09PW4mJihuPVwibG9nXCIpLHR5cGVvZiBjb25zb2xlIT09ZSYmKHZvaWQgMCE9PWNvbnNvbGVbbl0/YmluZE1ldGhvZChjb25zb2xlLG4pOnZvaWQgMCE9PWNvbnNvbGUubG9nP2JpbmRNZXRob2QoY29uc29sZSxcImxvZ1wiKTp0KX1mdW5jdGlvbiByZXBsYWNlTG9nZ2luZ01ldGhvZHMoZSxyKXtmb3IodmFyIG89MDtvPG4ubGVuZ3RoO28rKyl7dmFyIGk9bltvXTt0aGlzW2ldPW88ZT90OnRoaXMubWV0aG9kRmFjdG9yeShpLGUscil9dGhpcy5sb2c9dGhpcy5kZWJ1Z31mdW5jdGlvbiBlbmFibGVMb2dnaW5nV2hlbkNvbnNvbGVBcnJpdmVzKHQsbixyKXtyZXR1cm4gZnVuY3Rpb24oKXt0eXBlb2YgY29uc29sZSE9PWUmJihyZXBsYWNlTG9nZ2luZ01ldGhvZHMuY2FsbCh0aGlzLG4sciksdGhpc1t0XS5hcHBseSh0aGlzLGFyZ3VtZW50cykpfX1mdW5jdGlvbiBkZWZhdWx0TWV0aG9kRmFjdG9yeSh0LGUsbil7cmV0dXJuIHJlYWxNZXRob2QodCl8fGVuYWJsZUxvZ2dpbmdXaGVuQ29uc29sZUFycml2ZXMuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIExvZ2dlcih0LHIsbyl7ZnVuY3Rpb24gcGVyc2lzdExldmVsSWZQb3NzaWJsZSh0KXt2YXIgcj0oblt0XXx8XCJzaWxlbnRcIikudG9VcHBlckNhc2UoKTtpZih0eXBlb2Ygd2luZG93IT09ZSl7dHJ5e3JldHVybiB2b2lkKHdpbmRvdy5sb2NhbFN0b3JhZ2Vbc109cil9Y2F0Y2godCl7fXRyeXt3aW5kb3cuZG9jdW1lbnQuY29va2llPWVuY29kZVVSSUNvbXBvbmVudChzKStcIj1cIityK1wiO1wifWNhdGNoKHQpe319fWZ1bmN0aW9uIGdldFBlcnNpc3RlZExldmVsKCl7dmFyIHQ7aWYodHlwZW9mIHdpbmRvdyE9PWUpe3RyeXt0PXdpbmRvdy5sb2NhbFN0b3JhZ2Vbc119Y2F0Y2godCl7fWlmKHR5cGVvZiB0PT09ZSl0cnl7dmFyIG49d2luZG93LmRvY3VtZW50LmNvb2tpZSxyPW4uaW5kZXhPZihlbmNvZGVVUklDb21wb25lbnQocykrXCI9XCIpOy0xIT09ciYmKHQ9L14oW147XSspLy5leGVjKG4uc2xpY2UocikpWzFdKX1jYXRjaCh0KXt9cmV0dXJuIHZvaWQgMD09PXUubGV2ZWxzW3RdJiYodD12b2lkIDApLHR9fXZhciBpLHU9dGhpcyxzPVwibG9nbGV2ZWxcIjt0JiYocys9XCI6XCIrdCksdS5uYW1lPXQsdS5sZXZlbHM9e1RSQUNFOjAsREVCVUc6MSxJTkZPOjIsV0FSTjozLEVSUk9SOjQsU0lMRU5UOjV9LHUubWV0aG9kRmFjdG9yeT1vfHxkZWZhdWx0TWV0aG9kRmFjdG9yeSx1LmdldExldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIGl9LHUuc2V0TGV2ZWw9ZnVuY3Rpb24obixyKXtpZihcInN0cmluZ1wiPT10eXBlb2YgbiYmdm9pZCAwIT09dS5sZXZlbHNbbi50b1VwcGVyQ2FzZSgpXSYmKG49dS5sZXZlbHNbbi50b1VwcGVyQ2FzZSgpXSksIShcIm51bWJlclwiPT10eXBlb2YgbiYmbj49MCYmbjw9dS5sZXZlbHMuU0lMRU5UKSl0aHJvd1wibG9nLnNldExldmVsKCkgY2FsbGVkIHdpdGggaW52YWxpZCBsZXZlbDogXCIrbjtpZihpPW4sITEhPT1yJiZwZXJzaXN0TGV2ZWxJZlBvc3NpYmxlKG4pLHJlcGxhY2VMb2dnaW5nTWV0aG9kcy5jYWxsKHUsbix0KSx0eXBlb2YgY29uc29sZT09PWUmJm48dS5sZXZlbHMuU0lMRU5UKXJldHVyblwiTm8gY29uc29sZSBhdmFpbGFibGUgZm9yIGxvZ2dpbmdcIn0sdS5zZXREZWZhdWx0TGV2ZWw9ZnVuY3Rpb24odCl7Z2V0UGVyc2lzdGVkTGV2ZWwoKXx8dS5zZXRMZXZlbCh0LCExKX0sdS5lbmFibGVBbGw9ZnVuY3Rpb24odCl7dS5zZXRMZXZlbCh1LmxldmVscy5UUkFDRSx0KX0sdS5kaXNhYmxlQWxsPWZ1bmN0aW9uKHQpe3Uuc2V0TGV2ZWwodS5sZXZlbHMuU0lMRU5ULHQpfTt2YXIgYz1nZXRQZXJzaXN0ZWRMZXZlbCgpO251bGw9PWMmJihjPW51bGw9PXI/XCJXQVJOXCI6ciksdS5zZXRMZXZlbChjLCExKX12YXIgdD1mdW5jdGlvbigpe30sZT1cInVuZGVmaW5lZFwiLG49W1widHJhY2VcIixcImRlYnVnXCIsXCJpbmZvXCIsXCJ3YXJuXCIsXCJlcnJvclwiXSxyPW5ldyBMb2dnZXIsbz17fTtyLmdldExvZ2dlcj1mdW5jdGlvbih0KXtpZihcInN0cmluZ1wiIT10eXBlb2YgdHx8XCJcIj09PXQpdGhyb3cgbmV3IFR5cGVFcnJvcihcIllvdSBtdXN0IHN1cHBseSBhIG5hbWUgd2hlbiBjcmVhdGluZyBhIGxvZ2dlci5cIik7dmFyIGU9b1t0XTtyZXR1cm4gZXx8KGU9b1t0XT1uZXcgTG9nZ2VyKHQsci5nZXRMZXZlbCgpLHIubWV0aG9kRmFjdG9yeSkpLGV9O3ZhciBpPXR5cGVvZiB3aW5kb3chPT1lP3dpbmRvdy5sb2c6dm9pZCAwO3JldHVybiByLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdHlwZW9mIHdpbmRvdyE9PWUmJndpbmRvdy5sb2c9PT1yJiYod2luZG93LmxvZz1pKSxyfSxyLmdldExvZ2dlcnM9ZnVuY3Rpb24oKXtyZXR1cm4gb30scn0pfSxmdW5jdGlvbih0LGUsbil7big4OSksdC5leHBvcnRzPW4oMCkuT2JqZWN0LmdldFByb3RvdHlwZU9mfSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigzMCksbz1uKDQ3KTtuKDM5KShcImdldFByb3RvdHlwZU9mXCIsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIG8ocih0KSl9fSl9LGZ1bmN0aW9uKHQsZSxuKXt0LmV4cG9ydHM9e2RlZmF1bHQ6big5MSksX19lc01vZHVsZTohMH19LGZ1bmN0aW9uKHQsZSxuKXtuKDQzKSxuKDQ4KSx0LmV4cG9ydHM9bigzMykuZihcIml0ZXJhdG9yXCIpfSxmdW5jdGlvbih0LGUsbil7dC5leHBvcnRzPXtkZWZhdWx0Om4oOTMpLF9fZXNNb2R1bGU6ITB9fSxmdW5jdGlvbih0LGUsbil7big5NCksbig0Miksbig5OSksbigxMDApLHQuZXhwb3J0cz1uKDApLlN5bWJvbH0sZnVuY3Rpb24odCxlLG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oMSksbz1uKDgpLGk9big1KSx1PW4oMykscz1uKDQ1KSxjPW4oOTUpLktFWSxmPW4oMTMpLGE9bigyOCksbD1uKDI0KSxwPW4oMjApLHY9bigyKSxkPW4oMzMpLGg9bigzNCkseT1uKDk2KSxfPW4oOTcpLGI9big0KSxnPW4oNiksbT1uKDEwKSx3PW4oMjYpLHg9bigxOSksTz1uKDMxKSxNPW4oOTgpLFA9big0MCksUz1uKDcpLEw9bigyMSksaj1QLmYsaz1TLmYsRT1NLmYsUj1yLlN5bWJvbCxUPXIuSlNPTixDPVQmJlQuc3RyaW5naWZ5LEE9dihcIl9oaWRkZW5cIiksRD12KFwidG9QcmltaXRpdmVcIiksRj17fS5wcm9wZXJ0eUlzRW51bWVyYWJsZSxxPWEoXCJzeW1ib2wtcmVnaXN0cnlcIiksST1hKFwic3ltYm9sc1wiKSxOPWEoXCJvcC1zeW1ib2xzXCIpLEI9T2JqZWN0LnByb3RvdHlwZSxXPVwiZnVuY3Rpb25cIj09dHlwZW9mIFIsRz1yLlFPYmplY3QsVT0hR3x8IUcucHJvdG90eXBlfHwhRy5wcm90b3R5cGUuZmluZENoaWxkLFY9aSYmZihmdW5jdGlvbigpe3JldHVybiA3IT1PKGsoe30sXCJhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBrKHRoaXMsXCJhXCIse3ZhbHVlOjd9KS5hfX0pKS5hfSk/ZnVuY3Rpb24odCxlLG4pe3ZhciByPWooQixlKTtyJiZkZWxldGUgQltlXSxrKHQsZSxuKSxyJiZ0IT09QiYmayhCLGUscil9OmssSD1mdW5jdGlvbih0KXt2YXIgZT1JW3RdPU8oUi5wcm90b3R5cGUpO3JldHVybiBlLl9rPXQsZX0sSz1XJiZcInN5bWJvbFwiPT10eXBlb2YgUi5pdGVyYXRvcj9mdW5jdGlvbih0KXtyZXR1cm5cInN5bWJvbFwiPT10eXBlb2YgdH06ZnVuY3Rpb24odCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBSfSxKPWZ1bmN0aW9uKHQsZSxuKXtyZXR1cm4gdD09PUImJkooTixlLG4pLGIodCksZT13KGUsITApLGIobiksbyhJLGUpPyhuLmVudW1lcmFibGU/KG8odCxBKSYmdFtBXVtlXSYmKHRbQV1bZV09ITEpLG49TyhuLHtlbnVtZXJhYmxlOngoMCwhMSl9KSk6KG8odCxBKXx8ayh0LEEseCgxLHt9KSksdFtBXVtlXT0hMCksVih0LGUsbikpOmsodCxlLG4pfSx6PWZ1bmN0aW9uKHQsZSl7Yih0KTtmb3IodmFyIG4scj15KGU9bShlKSksbz0wLGk9ci5sZW5ndGg7aT5vOylKKHQsbj1yW28rK10sZVtuXSk7cmV0dXJuIHR9LFk9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdm9pZCAwPT09ZT9PKHQpOnooTyh0KSxlKX0sUT1mdW5jdGlvbih0KXt2YXIgZT1GLmNhbGwodGhpcyx0PXcodCwhMCkpO3JldHVybiEodGhpcz09PUImJm8oSSx0KSYmIW8oTix0KSkmJighKGV8fCFvKHRoaXMsdCl8fCFvKEksdCl8fG8odGhpcyxBKSYmdGhpc1tBXVt0XSl8fGUpfSxYPWZ1bmN0aW9uKHQsZSl7aWYodD1tKHQpLGU9dyhlLCEwKSx0IT09Qnx8IW8oSSxlKXx8byhOLGUpKXt2YXIgbj1qKHQsZSk7cmV0dXJuIW58fCFvKEksZSl8fG8odCxBKSYmdFtBXVtlXXx8KG4uZW51bWVyYWJsZT0hMCksbn19LFo9ZnVuY3Rpb24odCl7Zm9yKHZhciBlLG49RShtKHQpKSxyPVtdLGk9MDtuLmxlbmd0aD5pOylvKEksZT1uW2krK10pfHxlPT1BfHxlPT1jfHxyLnB1c2goZSk7cmV0dXJuIHJ9LCQ9ZnVuY3Rpb24odCl7Zm9yKHZhciBlLG49dD09PUIscj1FKG4/TjptKHQpKSxpPVtdLHU9MDtyLmxlbmd0aD51OykhbyhJLGU9clt1KytdKXx8biYmIW8oQixlKXx8aS5wdXNoKElbZV0pO3JldHVybiBpfTtXfHwoUj1mdW5jdGlvbigpe2lmKHRoaXMgaW5zdGFuY2VvZiBSKXRocm93IFR5cGVFcnJvcihcIlN5bWJvbCBpcyBub3QgYSBjb25zdHJ1Y3RvciFcIik7dmFyIHQ9cChhcmd1bWVudHMubGVuZ3RoPjA/YXJndW1lbnRzWzBdOnZvaWQgMCksZT1mdW5jdGlvbihuKXt0aGlzPT09QiYmZS5jYWxsKE4sbiksbyh0aGlzLEEpJiZvKHRoaXNbQV0sdCkmJih0aGlzW0FdW3RdPSExKSxWKHRoaXMsdCx4KDEsbikpfTtyZXR1cm4gaSYmVSYmVihCLHQse2NvbmZpZ3VyYWJsZTohMCxzZXQ6ZX0pLEgodCl9LHMoUi5wcm90b3R5cGUsXCJ0b1N0cmluZ1wiLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2t9KSxQLmY9WCxTLmY9SixuKDU2KS5mPU0uZj1aLG4oMzUpLmY9USxuKDU1KS5mPSQsaSYmIW4oMTQpJiZzKEIsXCJwcm9wZXJ0eUlzRW51bWVyYWJsZVwiLFEsITApLGQuZj1mdW5jdGlvbih0KXtyZXR1cm4gSCh2KHQpKX0pLHUodS5HK3UuVyt1LkYqIVcse1N5bWJvbDpSfSk7Zm9yKHZhciB0dD1cImhhc0luc3RhbmNlLGlzQ29uY2F0U3ByZWFkYWJsZSxpdGVyYXRvcixtYXRjaCxyZXBsYWNlLHNlYXJjaCxzcGVjaWVzLHNwbGl0LHRvUHJpbWl0aXZlLHRvU3RyaW5nVGFnLHVuc2NvcGFibGVzXCIuc3BsaXQoXCIsXCIpLGV0PTA7dHQubGVuZ3RoPmV0Oyl2KHR0W2V0KytdKTtmb3IodmFyIG50PUwodi5zdG9yZSkscnQ9MDtudC5sZW5ndGg+cnQ7KWgobnRbcnQrK10pO3UodS5TK3UuRiohVyxcIlN5bWJvbFwiLHtmb3I6ZnVuY3Rpb24odCl7cmV0dXJuIG8ocSx0Kz1cIlwiKT9xW3RdOnFbdF09Uih0KX0sa2V5Rm9yOmZ1bmN0aW9uKHQpe2lmKCFLKHQpKXRocm93IFR5cGVFcnJvcih0K1wiIGlzIG5vdCBhIHN5bWJvbCFcIik7Zm9yKHZhciBlIGluIHEpaWYocVtlXT09PXQpcmV0dXJuIGV9LHVzZVNldHRlcjpmdW5jdGlvbigpe1U9ITB9LHVzZVNpbXBsZTpmdW5jdGlvbigpe1U9ITF9fSksdSh1LlMrdS5GKiFXLFwiT2JqZWN0XCIse2NyZWF0ZTpZLGRlZmluZVByb3BlcnR5OkosZGVmaW5lUHJvcGVydGllczp6LGdldE93blByb3BlcnR5RGVzY3JpcHRvcjpYLGdldE93blByb3BlcnR5TmFtZXM6WixnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6JH0pLFQmJnUodS5TK3UuRiooIVd8fGYoZnVuY3Rpb24oKXt2YXIgdD1SKCk7cmV0dXJuXCJbbnVsbF1cIiE9QyhbdF0pfHxcInt9XCIhPUMoe2E6dH0pfHxcInt9XCIhPUMoT2JqZWN0KHQpKX0pKSxcIkpTT05cIix7c3RyaW5naWZ5OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSxuLHI9W3RdLG89MTthcmd1bWVudHMubGVuZ3RoPm87KXIucHVzaChhcmd1bWVudHNbbysrXSk7aWYobj1lPXJbMV0sKGcoZSl8fHZvaWQgMCE9PXQpJiYhSyh0KSlyZXR1cm4gXyhlKXx8KGU9ZnVuY3Rpb24odCxlKXtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBuJiYoZT1uLmNhbGwodGhpcyx0LGUpKSwhSyhlKSlyZXR1cm4gZX0pLHJbMV09ZSxDLmFwcGx5KFQscil9fSksUi5wcm90b3R5cGVbRF18fG4oOSkoUi5wcm90b3R5cGUsRCxSLnByb3RvdHlwZS52YWx1ZU9mKSxsKFIsXCJTeW1ib2xcIiksbChNYXRoLFwiTWF0aFwiLCEwKSxsKHIuSlNPTixcIkpTT05cIiwhMCl9LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDIwKShcIm1ldGFcIiksbz1uKDYpLGk9big4KSx1PW4oNykuZixzPTAsYz1PYmplY3QuaXNFeHRlbnNpYmxlfHxmdW5jdGlvbigpe3JldHVybiEwfSxmPSFuKDEzKShmdW5jdGlvbigpe3JldHVybiBjKE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpfSksYT1mdW5jdGlvbih0KXt1KHQscix7dmFsdWU6e2k6XCJPXCIrICsrcyx3Ont9fX0pfSxsPWZ1bmN0aW9uKHQsZSl7aWYoIW8odCkpcmV0dXJuXCJzeW1ib2xcIj09dHlwZW9mIHQ/dDooXCJzdHJpbmdcIj09dHlwZW9mIHQ/XCJTXCI6XCJQXCIpK3Q7aWYoIWkodCxyKSl7aWYoIWModCkpcmV0dXJuXCJGXCI7aWYoIWUpcmV0dXJuXCJFXCI7YSh0KX1yZXR1cm4gdFtyXS5pfSxwPWZ1bmN0aW9uKHQsZSl7aWYoIWkodCxyKSl7aWYoIWModCkpcmV0dXJuITA7aWYoIWUpcmV0dXJuITE7YSh0KX1yZXR1cm4gdFtyXS53fSx2PWZ1bmN0aW9uKHQpe3JldHVybiBmJiZkLk5FRUQmJmModCkmJiFpKHQscikmJmEodCksdH0sZD10LmV4cG9ydHM9e0tFWTpyLE5FRUQ6ITEsZmFzdEtleTpsLGdldFdlYWs6cCxvbkZyZWV6ZTp2fX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMjEpLG89big1NSksaT1uKDM1KTt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7dmFyIGU9cih0KSxuPW8uZjtpZihuKWZvcih2YXIgdSxzPW4odCksYz1pLmYsZj0wO3MubGVuZ3RoPmY7KWMuY2FsbCh0LHU9c1tmKytdKSYmZS5wdXNoKHUpO3JldHVybiBlfX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMTYpO3QuZXhwb3J0cz1BcnJheS5pc0FycmF5fHxmdW5jdGlvbih0KXtyZXR1cm5cIkFycmF5XCI9PXIodCl9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigxMCksbz1uKDU2KS5mLGk9e30udG9TdHJpbmcsdT1cIm9iamVjdFwiPT10eXBlb2Ygd2luZG93JiZ3aW5kb3cmJk9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzP09iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdyk6W10scz1mdW5jdGlvbih0KXt0cnl7cmV0dXJuIG8odCl9Y2F0Y2godCl7cmV0dXJuIHUuc2xpY2UoKX19O3QuZXhwb3J0cy5mPWZ1bmN0aW9uKHQpe3JldHVybiB1JiZcIltvYmplY3QgV2luZG93XVwiPT1pLmNhbGwodCk/cyh0KTpvKHIodCkpfX0sZnVuY3Rpb24odCxlLG4pe24oMzQpKFwiYXN5bmNJdGVyYXRvclwiKX0sZnVuY3Rpb24odCxlLG4pe24oMzQpKFwib2JzZXJ2YWJsZVwiKX0sZnVuY3Rpb24odCxlLG4pe3QuZXhwb3J0cz17ZGVmYXVsdDpuKDEwMiksX19lc01vZHVsZTohMH19LGZ1bmN0aW9uKHQsZSxuKXtuKDEwMyksdC5leHBvcnRzPW4oMCkuT2JqZWN0LnNldFByb3RvdHlwZU9mfSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigzKTtyKHIuUyxcIk9iamVjdFwiLHtzZXRQcm90b3R5cGVPZjpuKDEwNCkuc2V0fSl9LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDYpLG89big0KSxpPWZ1bmN0aW9uKHQsZSl7aWYobyh0KSwhcihlKSYmbnVsbCE9PWUpdGhyb3cgVHlwZUVycm9yKGUrXCI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhXCIpfTt0LmV4cG9ydHM9e3NldDpPYmplY3Quc2V0UHJvdG90eXBlT2Z8fChcIl9fcHJvdG9fX1wiaW57fT9mdW5jdGlvbih0LGUscil7dHJ5e3I9bigxNSkoRnVuY3Rpb24uY2FsbCxuKDQwKS5mKE9iamVjdC5wcm90b3R5cGUsXCJfX3Byb3RvX19cIikuc2V0LDIpLHIodCxbXSksZT0hKHQgaW5zdGFuY2VvZiBBcnJheSl9Y2F0Y2godCl7ZT0hMH1yZXR1cm4gZnVuY3Rpb24odCxuKXtyZXR1cm4gaSh0LG4pLGU/dC5fX3Byb3RvX189bjpyKHQsbiksdH19KHt9LCExKTp2b2lkIDApLGNoZWNrOml9fSxmdW5jdGlvbih0LGUsbil7dC5leHBvcnRzPXtkZWZhdWx0Om4oMTA2KSxfX2VzTW9kdWxlOiEwfX0sZnVuY3Rpb24odCxlLG4pe24oMTA3KTt2YXIgcj1uKDApLk9iamVjdDt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXtyZXR1cm4gci5jcmVhdGUodCxlKX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDMpO3Ioci5TLFwiT2JqZWN0XCIse2NyZWF0ZTpuKDMxKX0pfSwsLCwsLCwsLGZ1bmN0aW9uKHQsZSxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX1PYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgcj1uKDYzKSxvPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQociksaT1uKDExKSx1PV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoaSkscz1uKDEyKSxjPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQocyksZj1uKDY0KSxhPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZiksbD1uKDY1KSxwPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQobCksdj1uKDExNyksZD1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KHYpLGg9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gTWluaUJ1cygpe3JldHVybigwLHUuZGVmYXVsdCkodGhpcyxNaW5pQnVzKSwoMCxhLmRlZmF1bHQpKHRoaXMsKE1pbmlCdXMuX19wcm90b19ffHwoMCxvLmRlZmF1bHQpKE1pbmlCdXMpKS5jYWxsKHRoaXMpKX1yZXR1cm4oMCxwLmRlZmF1bHQpKE1pbmlCdXMsdCksKDAsYy5kZWZhdWx0KShNaW5pQnVzLFt7a2V5OlwicG9zdE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbih0LGUsbil7dmFyIHI9dGhpcztyZXR1cm4gci5fZ2VuSWQodCksci5fcmVzcG9uc2VDYWxsYmFjayh0LGUsbiksci5fb25Qb3N0TWVzc2FnZSh0KSx0LmlkfX0se2tleTpcIl9vbk1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzO2lmKCFlLl9vblJlc3BvbnNlKHQpKXt2YXIgbj1lLl9zdWJzY3JpcHRpb25zW3QudG9dO24/KGUuX3B1Ymxpc2hPbihuLHQpLHQudG8uc3RhcnRzV2l0aChcImh5cGVydHlcIil8fGUuX3B1Ymxpc2hPbkRlZmF1bHQodCkpOmUuX3B1Ymxpc2hPbkRlZmF1bHQodCl9fX1dKSxNaW5pQnVzfShkLmRlZmF1bHQpO2UuZGVmYXVsdD1oLHQuZXhwb3J0cz1lLmRlZmF1bHR9LGZ1bmN0aW9uKHQsZSxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX1PYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgcj1uKDQxKSxvPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQociksaT1uKDExKSx1PV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoaSkscz1uKDEyKSxjPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQocyksZj1uKDg3KSxhPWZ1bmN0aW9uKHQpe2lmKHQmJnQuX19lc01vZHVsZSlyZXR1cm4gdDt2YXIgZT17fTtpZihudWxsIT10KWZvcih2YXIgbiBpbiB0KU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LG4pJiYoZVtuXT10W25dKTtyZXR1cm4gZS5kZWZhdWx0PXQsZX0oZiksbD1hLmdldExvZ2dlcihcIkJ1c1wiKSxwPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gQnVzKCl7KDAsdS5kZWZhdWx0KSh0aGlzLEJ1cyk7dmFyIHQ9dGhpczt0Ll9tc2dJZD0wLHQuX3N1YnNjcmlwdGlvbnM9e30sdC5fcmVzcG9uc2VUaW1lT3V0PTNlNCx0Ll9yZXNwb25zZUNhbGxiYWNrcz17fSx0Ll9yZWdpc3RlckV4dGVybmFsTGlzdGVuZXIoKX1yZXR1cm4oMCxjLmRlZmF1bHQpKEJ1cyxbe2tleTpcImFkZExpc3RlbmVyXCIsdmFsdWU6ZnVuY3Rpb24odCxlKXt2YXIgbj10aGlzLHI9bmV3IHYobi5fc3Vic2NyaXB0aW9ucyx0LGUpLG89bi5fc3Vic2NyaXB0aW9uc1t0XTtyZXR1cm4gb3x8KG89W10sbi5fc3Vic2NyaXB0aW9uc1t0XT1vKSxvLnB1c2gocikscn19LHtrZXk6XCJhZGRSZXNwb25zZUxpc3RlbmVyXCIsdmFsdWU6ZnVuY3Rpb24odCxlLG4pe3RoaXMuX3Jlc3BvbnNlQ2FsbGJhY2tzW3QrZV09bn19LHtrZXk6XCJyZW1vdmVSZXNwb25zZUxpc3RlbmVyXCIsdmFsdWU6ZnVuY3Rpb24odCxlKXtkZWxldGUgdGhpcy5fcmVzcG9uc2VDYWxsYmFja3NbdCtlXX19LHtrZXk6XCJyZW1vdmVBbGxMaXN0ZW5lcnNPZlwiLHZhbHVlOmZ1bmN0aW9uKHQpe2RlbGV0ZSB0aGlzLl9zdWJzY3JpcHRpb25zW3RdfX0se2tleTpcImJpbmRcIix2YWx1ZTpmdW5jdGlvbih0LGUsbil7dmFyIHI9dGhpcyxvPXRoaXM7cmV0dXJue3RoaXNMaXN0ZW5lcjpvLmFkZExpc3RlbmVyKHQsZnVuY3Rpb24odCl7bi5wb3N0TWVzc2FnZSh0KX0pLHRhcmdldExpc3RlbmVyOm4uYWRkTGlzdGVuZXIoZSxmdW5jdGlvbih0KXtvLnBvc3RNZXNzYWdlKHQpfSksdW5iaW5kOmZ1bmN0aW9uKCl7ci50aGlzTGlzdGVuZXIucmVtb3ZlKCksci50YXJnZXRMaXN0ZW5lci5yZW1vdmUoKX19fX0se2tleTpcIl9wdWJsaXNoT25EZWZhdWx0XCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fc3Vic2NyaXB0aW9uc1tcIipcIl07ZSYmdGhpcy5fcHVibGlzaE9uKGUsdCl9fSx7a2V5OlwiX3B1Ymxpc2hPblwiLHZhbHVlOmZ1bmN0aW9uKHQsZSl7dC5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QuX2NhbGxiYWNrKGUpfSl9fSx7a2V5OlwiX3Jlc3BvbnNlQ2FsbGJhY2tcIix2YWx1ZTpmdW5jdGlvbih0LGUpe3ZhciBuPSEoYXJndW1lbnRzLmxlbmd0aD4yJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0pfHxhcmd1bWVudHNbMl0scj10aGlzO2lmKGUpe3ZhciBvPXQuZnJvbSt0LmlkO3IuX3Jlc3BvbnNlQ2FsbGJhY2tzW29dPWUsbiYmc2V0VGltZW91dChmdW5jdGlvbigpe3ZhciBlPXIuX3Jlc3BvbnNlQ2FsbGJhY2tzW29dO2lmKGRlbGV0ZSByLl9yZXNwb25zZUNhbGxiYWNrc1tvXSxlKXtlKHtpZDp0LmlkLHR5cGU6XCJyZXNwb25zZVwiLGJvZHk6e2NvZGU6NDA4LGRlc2M6XCJSZXNwb25zZSB0aW1lb3V0IVwiLHZhbHVlOnR9fSl9fSxyLl9yZXNwb25zZVRpbWVPdXQpfX19LHtrZXk6XCJfb25SZXNwb25zZVwiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXM7aWYoXCJyZXNwb25zZVwiPT09dC50eXBlKXt2YXIgbj10LnRvK3QuaWQscj1lLl9yZXNwb25zZUNhbGxiYWNrc1tuXTtpZih0LmJvZHkuY29kZT49MjAwJiZkZWxldGUgZS5fcmVzcG9uc2VDYWxsYmFja3Nbbl0scilyZXR1cm4gcih0KSwhMH1yZXR1cm4hMX19LHtrZXk6XCJfb25NZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcztpZighZS5fb25SZXNwb25zZSh0KSl7dmFyIG49ZS5fc3Vic2NyaXB0aW9uc1t0LnRvXTtuP2UuX3B1Ymxpc2hPbihuLHQpOmUuX3B1Ymxpc2hPbkRlZmF1bHQodCl9fX0se2tleTpcIl9nZW5JZFwiLHZhbHVlOmZ1bmN0aW9uKHQpe3QuaWQmJjAhPT10LmlkfHwodGhpcy5fbXNnSWQrKyx0LmlkPXRoaXMuX21zZ0lkKX19LHtrZXk6XCJwb3N0TWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKHQsZSl7fX0se2tleTpcInBvc3RNZXNzYWdlV2l0aFJldHJpZXNcIix2YWx1ZTpmdW5jdGlvbih0LGUsbil7dmFyIHI9dGhpcyxpPTAsdT1mdW5jdGlvbigpe3JldHVybiBuZXcgby5kZWZhdWx0KGZ1bmN0aW9uKGUsbyl7ci5wb3N0TWVzc2FnZSh0LGZ1bmN0aW9uKHIpezQwOD09PXIuYm9keS5jb2RlfHw1MDA9PT1yLmJvZHkuY29kZT9vKCk6KGwuaW5mbyhcIltCdXMucG9zdE1lc3NhZ2VXaXRoUmV0cmllc10gbXNnIGRlbGl2ZXJlZDogXCIsdCksbihyKSxlKCkpfSl9KX07IWZ1bmN0aW9uIHRyeUFnYWluKCl7dSgpLnRoZW4oZnVuY3Rpb24oKXt9LGZ1bmN0aW9uKCl7aWYobC53YXJuKFwiW0J1cy5wb3N0TWVzc2FnZVdpdGhSZXRyaWVzXSBNZXNzYWdlIEJvdW5jZWQgKHJldHJ5IFwiK2krXCIpOiAnXCIsdCksIShpKys8ZSkpe3ZhciBuPVwiW0Vycm9yXSBNZXNzYWdlIEJvdW5jZWQgKGRlbGl2ZXJ5IGF0dGVtcHRzIFwiK2UrXCIpOiAnXCI7dGhyb3cgbmV3IEVycm9yKG4rdCl9dHJ5QWdhaW4oKX0pfSgpfX0se2tleTpcIl9vblBvc3RNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24odCl7fX0se2tleTpcIl9yZWdpc3RlckV4dGVybmFsTGlzdGVuZXJcIix2YWx1ZTpmdW5jdGlvbigpe319XSksQnVzfSgpLHY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBNc2dMaXN0ZW5lcih0LGUsbil7KDAsdS5kZWZhdWx0KSh0aGlzLE1zZ0xpc3RlbmVyKTt2YXIgcj10aGlzO3IuX3N1YnNjcmlwdGlvbnM9dCxyLl91cmw9ZSxyLl9jYWxsYmFjaz1ufXJldHVybigwLGMuZGVmYXVsdCkoTXNnTGlzdGVuZXIsW3trZXk6XCJyZW1vdmVcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT10Ll9zdWJzY3JpcHRpb25zW3QuX3VybF07aWYoZSl7dmFyIG49ZS5pbmRleE9mKHQpO2Uuc3BsaWNlKG4sMSksMD09PWUubGVuZ3RoJiZkZWxldGUgdC5fc3Vic2NyaXB0aW9uc1t0Ll91cmxdfX19LHtrZXk6XCJ1cmxcIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdXJsfX1dKSxNc2dMaXN0ZW5lcn0oKTtlLmRlZmF1bHQ9cCx0LmV4cG9ydHM9ZS5kZWZhdWx0fSwsLCwsLCwsLCwsLCwsLCwsLCxmdW5jdGlvbih0LGUsbil7XCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIHI9bigxMTYpLG89ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OntkZWZhdWx0OnR9fShyKTtlLmRlZmF1bHQ9by5kZWZhdWx0LHQuZXhwb3J0cz1lLmRlZmF1bHR9XSl9KTsiLCIvLyB2ZXJzaW9uOiAwLjEyLjBcbi8vIGRhdGU6IFdlZCBBdWcgMDEgMjAxOCAwOTo0ODoxMCBHTVQrMDEwMCAoV2VzdGVybiBFdXJvcGVhbiBTdW1tZXIgVGltZSlcbi8vIGxpY2VuY2U6IFxuLyoqXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXG4qXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4qXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4qXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbioqL1xuXG5cbi8vIHZlcnNpb246IDAuMTIuMFxuLy8gZGF0ZTogV2VkIEF1ZyAwMSAyMDE4IDA5OjQ4OjEwIEdNVCswMTAwIChXZXN0ZXJuIEV1cm9wZWFuIFN1bW1lciBUaW1lKVxuLy8gbGljZW5jZTogXG4vKipcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cbipcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbipcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbipcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKiovXG5cblxuIWZ1bmN0aW9uKGUsdCl7XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHMmJlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9dCgpOlwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJzYW5kYm94XCIsW10sdCk6XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHM/ZXhwb3J0cy5zYW5kYm94PXQoKTplLnNhbmRib3g9dCgpfShcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZj9zZWxmOnRoaXMsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oZSl7ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhuKXtpZih0W25dKXJldHVybiB0W25dLmV4cG9ydHM7dmFyIHI9dFtuXT17aTpuLGw6ITEsZXhwb3J0czp7fX07cmV0dXJuIGVbbl0uY2FsbChyLmV4cG9ydHMscixyLmV4cG9ydHMsX193ZWJwYWNrX3JlcXVpcmVfXyksci5sPSEwLHIuZXhwb3J0c312YXIgdD17fTtyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5tPWUsX193ZWJwYWNrX3JlcXVpcmVfXy5jPXQsX193ZWJwYWNrX3JlcXVpcmVfXy5kPWZ1bmN0aW9uKGUsdCxuKXtfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZSx0KXx8T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7Y29uZmlndXJhYmxlOiExLGVudW1lcmFibGU6ITAsZ2V0Om59KX0sX193ZWJwYWNrX3JlcXVpcmVfXy5uPWZ1bmN0aW9uKGUpe3ZhciB0PWUmJmUuX19lc01vZHVsZT9mdW5jdGlvbigpe3JldHVybiBlLmRlZmF1bHR9OmZ1bmN0aW9uKCl7cmV0dXJuIGV9O3JldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLmQodCxcImFcIix0KSx0fSxfX3dlYnBhY2tfcmVxdWlyZV9fLm89ZnVuY3Rpb24oZSx0KXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsdCl9LF9fd2VicGFja19yZXF1aXJlX18ucD1cIlwiLF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zPTEzNCl9KFtmdW5jdGlvbihlLHQpe3ZhciBuPWUuZXhwb3J0cz17dmVyc2lvbjpcIjIuNS43XCJ9O1wibnVtYmVyXCI9PXR5cGVvZiBfX2UmJihfX2U9bil9LGZ1bmN0aW9uKGUsdCl7dmFyIG49ZS5leHBvcnRzPVwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5NYXRoPT1NYXRoP3dpbmRvdzpcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZiYmc2VsZi5NYXRoPT1NYXRoP3NlbGY6RnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1wibnVtYmVyXCI9PXR5cGVvZiBfX2cmJihfX2c9bil9LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDI4KShcIndrc1wiKSxvPW4oMjApLGk9bigxKS5TeW1ib2wsdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBpOyhlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIHJbZV18fChyW2VdPXUmJmlbZV18fCh1P2k6bykoXCJTeW1ib2wuXCIrZSkpfSkuc3RvcmU9cn0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMSksbz1uKDApLGk9bigxNSksdT1uKDkpLHM9big4KSxjPWZ1bmN0aW9uKGUsdCxuKXt2YXIgYSxmLGwscD1lJmMuRixkPWUmYy5HLHY9ZSZjLlMseT1lJmMuUCxfPWUmYy5CLGg9ZSZjLlcsYj1kP286b1t0XXx8KG9bdF09e30pLGc9Yi5wcm90b3R5cGUsbT1kP3I6dj9yW3RdOihyW3RdfHx7fSkucHJvdG90eXBlO2QmJihuPXQpO2ZvcihhIGluIG4pKGY9IXAmJm0mJnZvaWQgMCE9PW1bYV0pJiZzKGIsYSl8fChsPWY/bVthXTpuW2FdLGJbYV09ZCYmXCJmdW5jdGlvblwiIT10eXBlb2YgbVthXT9uW2FdOl8mJmY/aShsLHIpOmgmJm1bYV09PWw/ZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCxuLHIpe2lmKHRoaXMgaW5zdGFuY2VvZiBlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBuZXcgZTtjYXNlIDE6cmV0dXJuIG5ldyBlKHQpO2Nhc2UgMjpyZXR1cm4gbmV3IGUodCxuKX1yZXR1cm4gbmV3IGUodCxuLHIpfXJldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07cmV0dXJuIHQucHJvdG90eXBlPWUucHJvdG90eXBlLHR9KGwpOnkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGw/aShGdW5jdGlvbi5jYWxsLGwpOmwseSYmKChiLnZpcnR1YWx8fChiLnZpcnR1YWw9e30pKVthXT1sLGUmYy5SJiZnJiYhZ1thXSYmdShnLGEsbCkpKX07Yy5GPTEsYy5HPTIsYy5TPTQsYy5QPTgsYy5CPTE2LGMuVz0zMixjLlU9NjQsYy5SPTEyOCxlLmV4cG9ydHM9Y30sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oNik7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe2lmKCFyKGUpKXRocm93IFR5cGVFcnJvcihlK1wiIGlzIG5vdCBhbiBvYmplY3QhXCIpO3JldHVybiBlfX0sZnVuY3Rpb24oZSx0LG4pe2UuZXhwb3J0cz0hbigxMykoZnVuY3Rpb24oKXtyZXR1cm4gNyE9T2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LFwiYVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gN319KS5hfSl9LGZ1bmN0aW9uKGUsdCl7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiBlP251bGwhPT1lOlwiZnVuY3Rpb25cIj09dHlwZW9mIGV9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9big0KSxvPW4oMzYpLGk9bigyNiksdT1PYmplY3QuZGVmaW5lUHJvcGVydHk7dC5mPW4oNSk/T2JqZWN0LmRlZmluZVByb3BlcnR5OmZ1bmN0aW9uKGUsdCxuKXtpZihyKGUpLHQ9aSh0LCEwKSxyKG4pLG8pdHJ5e3JldHVybiB1KGUsdCxuKX1jYXRjaChlKXt9aWYoXCJnZXRcImluIG58fFwic2V0XCJpbiBuKXRocm93IFR5cGVFcnJvcihcIkFjY2Vzc29ycyBub3Qgc3VwcG9ydGVkIVwiKTtyZXR1cm5cInZhbHVlXCJpbiBuJiYoZVt0XT1uLnZhbHVlKSxlfX0sZnVuY3Rpb24oZSx0KXt2YXIgbj17fS5oYXNPd25Qcm9wZXJ0eTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbi5jYWxsKGUsdCl9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9big3KSxvPW4oMTkpO2UuZXhwb3J0cz1uKDUpP2Z1bmN0aW9uKGUsdCxuKXtyZXR1cm4gci5mKGUsdCxvKDEsbikpfTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGVbdF09bixlfX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oNTcpLG89bigyMyk7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiByKG8oZSkpfX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3QuX19lc01vZHVsZT0hMCx0LmRlZmF1bHQ9ZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3QuX19lc01vZHVsZT0hMDt2YXIgcj1uKDYwKSxvPWZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX0ocik7dC5kZWZhdWx0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyhlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSwoMCxvLmRlZmF1bHQpKGUsci5rZXkscil9fXJldHVybiBmdW5jdGlvbihlLHQsbil7cmV0dXJuIHQmJmRlZmluZVByb3BlcnRpZXMoZS5wcm90b3R5cGUsdCksbiYmZGVmaW5lUHJvcGVydGllcyhlLG4pLGV9fSgpfSxmdW5jdGlvbihlLHQpe2UuZXhwb3J0cz1mdW5jdGlvbihlKXt0cnl7cmV0dXJuISFlKCl9Y2F0Y2goZSl7cmV0dXJuITB9fX0sZnVuY3Rpb24oZSx0KXtlLmV4cG9ydHM9ITB9LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDE4KTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0LG4pe2lmKHIoZSksdm9pZCAwPT09dClyZXR1cm4gZTtzd2l0Y2gobil7Y2FzZSAxOnJldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gZS5jYWxsKHQsbil9O2Nhc2UgMjpyZXR1cm4gZnVuY3Rpb24obixyKXtyZXR1cm4gZS5jYWxsKHQsbixyKX07Y2FzZSAzOnJldHVybiBmdW5jdGlvbihuLHIsbyl7cmV0dXJuIGUuY2FsbCh0LG4scixvKX19cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGUuYXBwbHkodCxhcmd1bWVudHMpfX19LGZ1bmN0aW9uKGUsdCl7dmFyIG49e30udG9TdHJpbmc7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBuLmNhbGwoZSkuc2xpY2UoOCwtMSl9fSxmdW5jdGlvbihlLHQpe2UuZXhwb3J0cz17fX0sZnVuY3Rpb24oZSx0KXtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgZSl0aHJvdyBUeXBlRXJyb3IoZStcIiBpcyBub3QgYSBmdW5jdGlvbiFcIik7cmV0dXJuIGV9fSxmdW5jdGlvbihlLHQpe2UuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybntlbnVtZXJhYmxlOiEoMSZlKSxjb25maWd1cmFibGU6ISgyJmUpLHdyaXRhYmxlOiEoNCZlKSx2YWx1ZTp0fX19LGZ1bmN0aW9uKGUsdCl7dmFyIG49MCxyPU1hdGgucmFuZG9tKCk7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVyblwiU3ltYm9sKFwiLmNvbmNhdCh2b2lkIDA9PT1lP1wiXCI6ZSxcIilfXCIsKCsrbityKS50b1N0cmluZygzNikpfX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMzcpLG89bigyOSk7ZS5leHBvcnRzPU9iamVjdC5rZXlzfHxmdW5jdGlvbihlKXtyZXR1cm4gcihlLG8pfX0sZnVuY3Rpb24oZSx0KXt2YXIgbj1NYXRoLmNlaWwscj1NYXRoLmZsb29yO2UuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gaXNOYU4oZT0rZSk/MDooZT4wP3I6bikoZSl9fSxmdW5jdGlvbihlLHQpe2UuZXhwb3J0cz1mdW5jdGlvbihlKXtpZih2b2lkIDA9PWUpdGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gIFwiK2UpO3JldHVybiBlfX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oNykuZixvPW4oOCksaT1uKDIpKFwidG9TdHJpbmdUYWdcIik7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuKXtlJiYhbyhlPW4/ZTplLnByb3RvdHlwZSxpKSYmcihlLGkse2NvbmZpZ3VyYWJsZTohMCx2YWx1ZTp0fSl9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9big2KSxvPW4oMSkuZG9jdW1lbnQsaT1yKG8pJiZyKG8uY3JlYXRlRWxlbWVudCk7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBpP28uY3JlYXRlRWxlbWVudChlKTp7fX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDYpO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQpe2lmKCFyKGUpKXJldHVybiBlO3ZhciBuLG87aWYodCYmXCJmdW5jdGlvblwiPT10eXBlb2Yobj1lLnRvU3RyaW5nKSYmIXIobz1uLmNhbGwoZSkpKXJldHVybiBvO2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mKG49ZS52YWx1ZU9mKSYmIXIobz1uLmNhbGwoZSkpKXJldHVybiBvO2lmKCF0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZihuPWUudG9TdHJpbmcpJiYhcihvPW4uY2FsbChlKSkpcmV0dXJuIG87dGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlXCIpfX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMjgpKFwia2V5c1wiKSxvPW4oMjApO2UuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gcltlXXx8KHJbZV09byhlKSl9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9bigwKSxvPW4oMSksaT1vW1wiX19jb3JlLWpzX3NoYXJlZF9fXCJdfHwob1tcIl9fY29yZS1qc19zaGFyZWRfX1wiXT17fSk7KGUuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybiBpW2VdfHwoaVtlXT12b2lkIDAhPT10P3Q6e30pfSkoXCJ2ZXJzaW9uc1wiLFtdKS5wdXNoKHt2ZXJzaW9uOnIudmVyc2lvbixtb2RlOm4oMTQpP1wicHVyZVwiOlwiZ2xvYmFsXCIsY29weXJpZ2h0OlwiwqkgMjAxOCBEZW5pcyBQdXNoa2FyZXYgKHpsb2lyb2NrLnJ1KVwifSl9LGZ1bmN0aW9uKGUsdCl7ZS5leHBvcnRzPVwiY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mXCIuc3BsaXQoXCIsXCIpfSxmdW5jdGlvbihlLHQsbil7dmFyIHI9bigyMyk7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QocihlKSl9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9big0KSxvPW4oNjkpLGk9bigyOSksdT1uKDI3KShcIklFX1BST1RPXCIpLHM9ZnVuY3Rpb24oKXt9LGM9ZnVuY3Rpb24oKXt2YXIgZSx0PW4oMjUpKFwiaWZyYW1lXCIpLHI9aS5sZW5ndGg7Zm9yKHQuc3R5bGUuZGlzcGxheT1cIm5vbmVcIixuKDQ2KS5hcHBlbmRDaGlsZCh0KSx0LnNyYz1cImphdmFzY3JpcHQ6XCIsZT10LmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQsZS5vcGVuKCksZS53cml0ZShcIjxzY3JpcHQ+ZG9jdW1lbnQuRj1PYmplY3Q8XFwvc2NyaXB0PlwiKSxlLmNsb3NlKCksYz1lLkY7ci0tOylkZWxldGUgYy5wcm90b3R5cGVbaVtyXV07cmV0dXJuIGMoKX07ZS5leHBvcnRzPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uKGUsdCl7dmFyIG47cmV0dXJuIG51bGwhPT1lPyhzLnByb3RvdHlwZT1yKGUpLG49bmV3IHMscy5wcm90b3R5cGU9bnVsbCxuW3VdPWUpOm49YygpLHZvaWQgMD09PXQ/bjpvKG4sdCl9fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gUHJvbWlzZUNhcGFiaWxpdHkoZSl7dmFyIHQsbjt0aGlzLnByb21pc2U9bmV3IGUoZnVuY3Rpb24oZSxyKXtpZih2b2lkIDAhPT10fHx2b2lkIDAhPT1uKXRocm93IFR5cGVFcnJvcihcIkJhZCBQcm9taXNlIGNvbnN0cnVjdG9yXCIpO3Q9ZSxuPXJ9KSx0aGlzLnJlc29sdmU9cih0KSx0aGlzLnJlamVjdD1yKG4pfXZhciByPW4oMTgpO2UuZXhwb3J0cy5mPWZ1bmN0aW9uKGUpe3JldHVybiBuZXcgUHJvbWlzZUNhcGFiaWxpdHkoZSl9fSxmdW5jdGlvbihlLHQsbil7dC5mPW4oMil9LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDEpLG89bigwKSxpPW4oMTQpLHU9bigzMykscz1uKDcpLmY7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3ZhciB0PW8uU3ltYm9sfHwoby5TeW1ib2w9aT97fTpyLlN5bWJvbHx8e30pO1wiX1wiPT1lLmNoYXJBdCgwKXx8ZSBpbiB0fHxzKHQsZSx7dmFsdWU6dS5mKGUpfSl9fSxmdW5jdGlvbihlLHQpe3QuZj17fS5wcm9wZXJ0eUlzRW51bWVyYWJsZX0sZnVuY3Rpb24oZSx0LG4pe2UuZXhwb3J0cz0hbig1KSYmIW4oMTMpKGZ1bmN0aW9uKCl7cmV0dXJuIDchPU9iamVjdC5kZWZpbmVQcm9wZXJ0eShuKDI1KShcImRpdlwiKSxcImFcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDd9fSkuYX0pfSxmdW5jdGlvbihlLHQsbil7dmFyIHI9big4KSxvPW4oMTApLGk9big1OCkoITEpLHU9bigyNykoXCJJRV9QUk9UT1wiKTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXt2YXIgbixzPW8oZSksYz0wLGE9W107Zm9yKG4gaW4gcyluIT11JiZyKHMsbikmJmEucHVzaChuKTtmb3IoO3QubGVuZ3RoPmM7KXIocyxuPXRbYysrXSkmJih+aShhLG4pfHxhLnB1c2gobikpO3JldHVybiBhfX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMjIpLG89TWF0aC5taW47ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBlPjA/byhyKGUpLDkwMDcxOTkyNTQ3NDA5OTEpOjB9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9bigzKSxvPW4oMCksaT1uKDEzKTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXt2YXIgbj0oby5PYmplY3R8fHt9KVtlXXx8T2JqZWN0W2VdLHU9e307dVtlXT10KG4pLHIoci5TK3IuRippKGZ1bmN0aW9uKCl7bigxKX0pLFwiT2JqZWN0XCIsdSl9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9bigzNSksbz1uKDE5KSxpPW4oMTApLHU9bigyNikscz1uKDgpLGM9bigzNiksYT1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO3QuZj1uKDUpP2E6ZnVuY3Rpb24oZSx0KXtpZihlPWkoZSksdD11KHQsITApLGMpdHJ5e3JldHVybiBhKGUsdCl9Y2F0Y2goZSl7fWlmKHMoZSx0KSlyZXR1cm4gbyghci5mLmNhbGwoZSx0KSxlW3RdKX19LGZ1bmN0aW9uKGUsdCxuKXtlLmV4cG9ydHM9e2RlZmF1bHQ6big2NiksX19lc01vZHVsZTohMH19LGZ1bmN0aW9uKGUsdCl7fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9big2NykoITApO24oNDQpKFN0cmluZyxcIlN0cmluZ1wiLGZ1bmN0aW9uKGUpe3RoaXMuX3Q9U3RyaW5nKGUpLHRoaXMuX2k9MH0sZnVuY3Rpb24oKXt2YXIgZSx0PXRoaXMuX3Qsbj10aGlzLl9pO3JldHVybiBuPj10Lmxlbmd0aD97dmFsdWU6dm9pZCAwLGRvbmU6ITB9OihlPXIodCxuKSx0aGlzLl9pKz1lLmxlbmd0aCx7dmFsdWU6ZSxkb25lOiExfSl9KX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oMTQpLG89bigzKSxpPW4oNDUpLHU9big5KSxzPW4oMTcpLGM9big2OCksYT1uKDI0KSxmPW4oNDcpLGw9bigyKShcIml0ZXJhdG9yXCIpLHA9IShbXS5rZXlzJiZcIm5leHRcImluW10ua2V5cygpKSxkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2UuZXhwb3J0cz1mdW5jdGlvbihlLHQsbix2LHksXyxoKXtjKG4sdCx2KTt2YXIgYixnLG0seD1mdW5jdGlvbihlKXtpZighcCYmZSBpbiBNKXJldHVybiBNW2VdO3N3aXRjaChlKXtjYXNlXCJrZXlzXCI6Y2FzZVwidmFsdWVzXCI6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKHRoaXMsZSl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgbih0aGlzLGUpfX0sdz10K1wiIEl0ZXJhdG9yXCIsTz1cInZhbHVlc1wiPT15LFM9ITEsTT1lLnByb3RvdHlwZSxQPU1bbF18fE1bXCJAQGl0ZXJhdG9yXCJdfHx5JiZNW3ldLGs9UHx8eCh5KSxSPXk/Tz94KFwiZW50cmllc1wiKTprOnZvaWQgMCxMPVwiQXJyYXlcIj09dD9NLmVudHJpZXN8fFA6UDtpZihMJiYobT1mKEwuY2FsbChuZXcgZSkpKSE9PU9iamVjdC5wcm90b3R5cGUmJm0ubmV4dCYmKGEobSx3LCEwKSxyfHxcImZ1bmN0aW9uXCI9PXR5cGVvZiBtW2xdfHx1KG0sbCxkKSksTyYmUCYmXCJ2YWx1ZXNcIiE9PVAubmFtZSYmKFM9ITAsaz1mdW5jdGlvbigpe3JldHVybiBQLmNhbGwodGhpcyl9KSxyJiYhaHx8IXAmJiFTJiZNW2xdfHx1KE0sbCxrKSxzW3RdPWssc1t3XT1kLHkpaWYoYj17dmFsdWVzOk8/azp4KFwidmFsdWVzXCIpLGtleXM6Xz9rOngoXCJrZXlzXCIpLGVudHJpZXM6Un0saClmb3IoZyBpbiBiKWcgaW4gTXx8aShNLGcsYltnXSk7ZWxzZSBvKG8uUCtvLkYqKHB8fFMpLHQsYik7cmV0dXJuIGJ9fSxmdW5jdGlvbihlLHQsbil7ZS5leHBvcnRzPW4oOSl9LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDEpLmRvY3VtZW50O2UuZXhwb3J0cz1yJiZyLmRvY3VtZW50RWxlbWVudH0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oOCksbz1uKDMwKSxpPW4oMjcpKFwiSUVfUFJPVE9cIiksdT1PYmplY3QucHJvdG90eXBlO2UuZXhwb3J0cz1PYmplY3QuZ2V0UHJvdG90eXBlT2Z8fGZ1bmN0aW9uKGUpe3JldHVybiBlPW8oZSkscihlLGkpP2VbaV06XCJmdW5jdGlvblwiPT10eXBlb2YgZS5jb25zdHJ1Y3RvciYmZSBpbnN0YW5jZW9mIGUuY29uc3RydWN0b3I/ZS5jb25zdHJ1Y3Rvci5wcm90b3R5cGU6ZSBpbnN0YW5jZW9mIE9iamVjdD91Om51bGx9fSxmdW5jdGlvbihlLHQsbil7big3MCk7Zm9yKHZhciByPW4oMSksbz1uKDkpLGk9bigxNyksdT1uKDIpKFwidG9TdHJpbmdUYWdcIikscz1cIkNTU1J1bGVMaXN0LENTU1N0eWxlRGVjbGFyYXRpb24sQ1NTVmFsdWVMaXN0LENsaWVudFJlY3RMaXN0LERPTVJlY3RMaXN0LERPTVN0cmluZ0xpc3QsRE9NVG9rZW5MaXN0LERhdGFUcmFuc2Zlckl0ZW1MaXN0LEZpbGVMaXN0LEhUTUxBbGxDb2xsZWN0aW9uLEhUTUxDb2xsZWN0aW9uLEhUTUxGb3JtRWxlbWVudCxIVE1MU2VsZWN0RWxlbWVudCxNZWRpYUxpc3QsTWltZVR5cGVBcnJheSxOYW1lZE5vZGVNYXAsTm9kZUxpc3QsUGFpbnRSZXF1ZXN0TGlzdCxQbHVnaW4sUGx1Z2luQXJyYXksU1ZHTGVuZ3RoTGlzdCxTVkdOdW1iZXJMaXN0LFNWR1BhdGhTZWdMaXN0LFNWR1BvaW50TGlzdCxTVkdTdHJpbmdMaXN0LFNWR1RyYW5zZm9ybUxpc3QsU291cmNlQnVmZmVyTGlzdCxTdHlsZVNoZWV0TGlzdCxUZXh0VHJhY2tDdWVMaXN0LFRleHRUcmFja0xpc3QsVG91Y2hMaXN0XCIuc3BsaXQoXCIsXCIpLGM9MDtjPHMubGVuZ3RoO2MrKyl7dmFyIGE9c1tjXSxmPXJbYV0sbD1mJiZmLnByb3RvdHlwZTtsJiYhbFt1XSYmbyhsLHUsYSksaVthXT1pLkFycmF5fX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMTYpLG89bigyKShcInRvU3RyaW5nVGFnXCIpLGk9XCJBcmd1bWVudHNcIj09cihmdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHN9KCkpLHU9ZnVuY3Rpb24oZSx0KXt0cnl7cmV0dXJuIGVbdF19Y2F0Y2goZSl7fX07ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3ZhciB0LG4scztyZXR1cm4gdm9pZCAwPT09ZT9cIlVuZGVmaW5lZFwiOm51bGw9PT1lP1wiTnVsbFwiOlwic3RyaW5nXCI9PXR5cGVvZihuPXUodD1PYmplY3QoZSksbykpP246aT9yKHQpOlwiT2JqZWN0XCI9PShzPXIodCkpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0LmNhbGxlZT9cIkFyZ3VtZW50c1wiOnN9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9big0KSxvPW4oMTgpLGk9bigyKShcInNwZWNpZXNcIik7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7dmFyIG4sdT1yKGUpLmNvbnN0cnVjdG9yO3JldHVybiB2b2lkIDA9PT11fHx2b2lkIDA9PShuPXIodSlbaV0pP3Q6byhuKX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcixvLGksdT1uKDE1KSxzPW4oNzkpLGM9big0NiksYT1uKDI1KSxmPW4oMSksbD1mLnByb2Nlc3MscD1mLnNldEltbWVkaWF0ZSxkPWYuY2xlYXJJbW1lZGlhdGUsdj1mLk1lc3NhZ2VDaGFubmVsLHk9Zi5EaXNwYXRjaCxfPTAsaD17fSxiPWZ1bmN0aW9uKCl7dmFyIGU9K3RoaXM7aWYoaC5oYXNPd25Qcm9wZXJ0eShlKSl7dmFyIHQ9aFtlXTtkZWxldGUgaFtlXSx0KCl9fSxnPWZ1bmN0aW9uKGUpe2IuY2FsbChlLmRhdGEpfTtwJiZkfHwocD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9W10sbj0xO2FyZ3VtZW50cy5sZW5ndGg+bjspdC5wdXNoKGFyZ3VtZW50c1tuKytdKTtyZXR1cm4gaFsrK19dPWZ1bmN0aW9uKCl7cyhcImZ1bmN0aW9uXCI9PXR5cGVvZiBlP2U6RnVuY3Rpb24oZSksdCl9LHIoXyksX30sZD1mdW5jdGlvbihlKXtkZWxldGUgaFtlXX0sXCJwcm9jZXNzXCI9PW4oMTYpKGwpP3I9ZnVuY3Rpb24oZSl7bC5uZXh0VGljayh1KGIsZSwxKSl9OnkmJnkubm93P3I9ZnVuY3Rpb24oZSl7eS5ub3codShiLGUsMSkpfTp2PyhvPW5ldyB2LGk9by5wb3J0MixvLnBvcnQxLm9ubWVzc2FnZT1nLHI9dShpLnBvc3RNZXNzYWdlLGksMSkpOmYuYWRkRXZlbnRMaXN0ZW5lciYmXCJmdW5jdGlvblwiPT10eXBlb2YgcG9zdE1lc3NhZ2UmJiFmLmltcG9ydFNjcmlwdHM/KHI9ZnVuY3Rpb24oZSl7Zi5wb3N0TWVzc2FnZShlK1wiXCIsXCIqXCIpfSxmLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsZywhMSkpOnI9XCJvbnJlYWR5c3RhdGVjaGFuZ2VcImluIGEoXCJzY3JpcHRcIik/ZnVuY3Rpb24oZSl7Yy5hcHBlbmRDaGlsZChhKFwic2NyaXB0XCIpKS5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXtjLnJlbW92ZUNoaWxkKHRoaXMpLGIuY2FsbChlKX19OmZ1bmN0aW9uKGUpe3NldFRpbWVvdXQodShiLGUsMSksMCl9KSxlLmV4cG9ydHM9e3NldDpwLGNsZWFyOmR9fSxmdW5jdGlvbihlLHQpe2UuZXhwb3J0cz1mdW5jdGlvbihlKXt0cnl7cmV0dXJue2U6ITEsdjplKCl9fWNhdGNoKGUpe3JldHVybntlOiEwLHY6ZX19fX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oNCksbz1uKDYpLGk9bigzMik7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7aWYocihlKSxvKHQpJiZ0LmNvbnN0cnVjdG9yPT09ZSlyZXR1cm4gdDt2YXIgbj1pLmYoZSk7cmV0dXJuKDAsbi5yZXNvbHZlKSh0KSxuLnByb21pc2V9fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19dC5fX2VzTW9kdWxlPSEwO3ZhciByPW4oOTApLG89X2ludGVyb3BSZXF1aXJlRGVmYXVsdChyKSxpPW4oOTIpLHU9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChpKSxzPVwiZnVuY3Rpb25cIj09dHlwZW9mIHUuZGVmYXVsdCYmXCJzeW1ib2xcIj09dHlwZW9mIG8uZGVmYXVsdD9mdW5jdGlvbihlKXtyZXR1cm4gdHlwZW9mIGV9OmZ1bmN0aW9uKGUpe3JldHVybiBlJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB1LmRlZmF1bHQmJmUuY29uc3RydWN0b3I9PT11LmRlZmF1bHQmJmUhPT11LmRlZmF1bHQucHJvdG90eXBlP1wic3ltYm9sXCI6dHlwZW9mIGV9O3QuZGVmYXVsdD1cImZ1bmN0aW9uXCI9PXR5cGVvZiB1LmRlZmF1bHQmJlwic3ltYm9sXCI9PT1zKG8uZGVmYXVsdCk/ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWU/XCJ1bmRlZmluZWRcIjpzKGUpfTpmdW5jdGlvbihlKXtyZXR1cm4gZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgdS5kZWZhdWx0JiZlLmNvbnN0cnVjdG9yPT09dS5kZWZhdWx0JiZlIT09dS5kZWZhdWx0LnByb3RvdHlwZT9cInN5bWJvbFwiOnZvaWQgMD09PWU/XCJ1bmRlZmluZWRcIjpzKGUpfX0sZnVuY3Rpb24oZSx0KXt0LmY9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sc30sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMzcpLG89bigyOSkuY29uY2F0KFwibGVuZ3RoXCIsXCJwcm90b3R5cGVcIik7dC5mPU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzfHxmdW5jdGlvbihlKXtyZXR1cm4gcihlLG8pfX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMTYpO2UuZXhwb3J0cz1PYmplY3QoXCJ6XCIpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApP09iamVjdDpmdW5jdGlvbihlKXtyZXR1cm5cIlN0cmluZ1wiPT1yKGUpP2Uuc3BsaXQoXCJcIik6T2JqZWN0KGUpfX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMTApLG89bigzOCksaT1uKDU5KTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQsbix1KXt2YXIgcyxjPXIodCksYT1vKGMubGVuZ3RoKSxmPWkodSxhKTtpZihlJiZuIT1uKXtmb3IoO2E+ZjspaWYoKHM9Y1tmKytdKSE9cylyZXR1cm4hMH1lbHNlIGZvcig7YT5mO2YrKylpZigoZXx8ZiBpbiBjKSYmY1tmXT09PW4pcmV0dXJuIGV8fGZ8fDA7cmV0dXJuIWUmJi0xfX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDIyKSxvPU1hdGgubWF4LGk9TWF0aC5taW47ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU9cihlKSxlPDA/byhlK3QsMCk6aShlLHQpfX0sZnVuY3Rpb24oZSx0LG4pe2UuZXhwb3J0cz17ZGVmYXVsdDpuKDYxKSxfX2VzTW9kdWxlOiEwfX0sZnVuY3Rpb24oZSx0LG4pe24oNjIpO3ZhciByPW4oMCkuT2JqZWN0O2UuZXhwb3J0cz1mdW5jdGlvbihlLHQsbil7cmV0dXJuIHIuZGVmaW5lUHJvcGVydHkoZSx0LG4pfX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMyk7cihyLlMrci5GKiFuKDUpLFwiT2JqZWN0XCIse2RlZmluZVByb3BlcnR5Om4oNykuZn0pfSxmdW5jdGlvbihlLHQsbil7ZS5leHBvcnRzPXtkZWZhdWx0Om4oODgpLF9fZXNNb2R1bGU6ITB9fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dC5fX2VzTW9kdWxlPSEwO3ZhciByPW4oNTQpLG89ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fShyKTt0LmRlZmF1bHQ9ZnVuY3Rpb24oZSx0KXtpZighZSl0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7cmV0dXJuIXR8fFwib2JqZWN0XCIhPT0odm9pZCAwPT09dD9cInVuZGVmaW5lZFwiOigwLG8uZGVmYXVsdCkodCkpJiZcImZ1bmN0aW9uXCIhPXR5cGVvZiB0P2U6dH19LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX10Ll9fZXNNb2R1bGU9ITA7dmFyIHI9bigxMDEpLG89X2ludGVyb3BSZXF1aXJlRGVmYXVsdChyKSxpPW4oMTA1KSx1PV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoaSkscz1uKDU0KSxjPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQocyk7dC5kZWZhdWx0PWZ1bmN0aW9uKGUsdCl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIrKHZvaWQgMD09PXQ/XCJ1bmRlZmluZWRcIjooMCxjLmRlZmF1bHQpKHQpKSk7ZS5wcm90b3R5cGU9KDAsdS5kZWZhdWx0KSh0JiZ0LnByb3RvdHlwZSx7Y29uc3RydWN0b3I6e3ZhbHVlOmUsZW51bWVyYWJsZTohMSx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksdCYmKG8uZGVmYXVsdD8oMCxvLmRlZmF1bHQpKGUsdCk6ZS5fX3Byb3RvX189dCl9fSxmdW5jdGlvbihlLHQsbil7big0Miksbig0Myksbig0OCksbig3Myksbig4NSksbig4NiksZS5leHBvcnRzPW4oMCkuUHJvbWlzZX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMjIpLG89bigyMyk7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0LG4pe3ZhciBpLHUscz1TdHJpbmcobyh0KSksYz1yKG4pLGE9cy5sZW5ndGg7cmV0dXJuIGM8MHx8Yz49YT9lP1wiXCI6dm9pZCAwOihpPXMuY2hhckNvZGVBdChjKSxpPDU1Mjk2fHxpPjU2MzE5fHxjKzE9PT1hfHwodT1zLmNoYXJDb2RlQXQoYysxKSk8NTYzMjB8fHU+NTczNDM/ZT9zLmNoYXJBdChjKTppOmU/cy5zbGljZShjLGMrMik6dS01NjMyMCsoaS01NTI5Njw8MTApKzY1NTM2KX19fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9bigzMSksbz1uKDE5KSxpPW4oMjQpLHU9e307big5KSh1LG4oMikoXCJpdGVyYXRvclwiKSxmdW5jdGlvbigpe3JldHVybiB0aGlzfSksZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuKXtlLnByb3RvdHlwZT1yKHUse25leHQ6bygxLG4pfSksaShlLHQrXCIgSXRlcmF0b3JcIil9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9big3KSxvPW4oNCksaT1uKDIxKTtlLmV4cG9ydHM9big1KT9PYmplY3QuZGVmaW5lUHJvcGVydGllczpmdW5jdGlvbihlLHQpe28oZSk7Zm9yKHZhciBuLHU9aSh0KSxzPXUubGVuZ3RoLGM9MDtzPmM7KXIuZihlLG49dVtjKytdLHRbbl0pO3JldHVybiBlfX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oNzEpLG89big3MiksaT1uKDE3KSx1PW4oMTApO2UuZXhwb3J0cz1uKDQ0KShBcnJheSxcIkFycmF5XCIsZnVuY3Rpb24oZSx0KXt0aGlzLl90PXUoZSksdGhpcy5faT0wLHRoaXMuX2s9dH0sZnVuY3Rpb24oKXt2YXIgZT10aGlzLl90LHQ9dGhpcy5fayxuPXRoaXMuX2krKztyZXR1cm4hZXx8bj49ZS5sZW5ndGg/KHRoaXMuX3Q9dm9pZCAwLG8oMSkpOlwia2V5c1wiPT10P28oMCxuKTpcInZhbHVlc1wiPT10P28oMCxlW25dKTpvKDAsW24sZVtuXV0pfSxcInZhbHVlc1wiKSxpLkFyZ3VtZW50cz1pLkFycmF5LHIoXCJrZXlzXCIpLHIoXCJ2YWx1ZXNcIikscihcImVudHJpZXNcIil9LGZ1bmN0aW9uKGUsdCl7ZS5leHBvcnRzPWZ1bmN0aW9uKCl7fX0sZnVuY3Rpb24oZSx0KXtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm57dmFsdWU6dCxkb25lOiEhZX19fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHIsbyxpLHUscz1uKDE0KSxjPW4oMSksYT1uKDE1KSxmPW4oNDkpLGw9bigzKSxwPW4oNiksZD1uKDE4KSx2PW4oNzQpLHk9big3NSksXz1uKDUwKSxoPW4oNTEpLnNldCxiPW4oODApKCksZz1uKDMyKSxtPW4oNTIpLHg9big4MSksdz1uKDUzKSxPPWMuVHlwZUVycm9yLFM9Yy5wcm9jZXNzLE09UyYmUy52ZXJzaW9ucyxQPU0mJk0udjh8fFwiXCIsaz1jLlByb21pc2UsUj1cInByb2Nlc3NcIj09ZihTKSxMPWZ1bmN0aW9uKCl7fSxqPW89Zy5mLEQ9ISFmdW5jdGlvbigpe3RyeXt2YXIgZT1rLnJlc29sdmUoMSksdD0oZS5jb25zdHJ1Y3Rvcj17fSlbbigyKShcInNwZWNpZXNcIildPWZ1bmN0aW9uKGUpe2UoTCxMKX07cmV0dXJuKFJ8fFwiZnVuY3Rpb25cIj09dHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCkmJmUudGhlbihMKWluc3RhbmNlb2YgdCYmMCE9PVAuaW5kZXhPZihcIjYuNlwiKSYmLTE9PT14LmluZGV4T2YoXCJDaHJvbWUvNjZcIil9Y2F0Y2goZSl7fX0oKSxFPWZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiEoIXAoZSl8fFwiZnVuY3Rpb25cIiE9dHlwZW9mKHQ9ZS50aGVuKSkmJnR9LFQ9ZnVuY3Rpb24oZSx0KXtpZighZS5fbil7ZS5fbj0hMDt2YXIgbj1lLl9jO2IoZnVuY3Rpb24oKXtmb3IodmFyIHI9ZS5fdixvPTE9PWUuX3MsaT0wO24ubGVuZ3RoPmk7KSFmdW5jdGlvbih0KXt2YXIgbixpLHUscz1vP3Qub2s6dC5mYWlsLGM9dC5yZXNvbHZlLGE9dC5yZWplY3QsZj10LmRvbWFpbjt0cnl7cz8ob3x8KDI9PWUuX2gmJkMoZSksZS5faD0xKSwhMD09PXM/bj1yOihmJiZmLmVudGVyKCksbj1zKHIpLGYmJihmLmV4aXQoKSx1PSEwKSksbj09PXQucHJvbWlzZT9hKE8oXCJQcm9taXNlLWNoYWluIGN5Y2xlXCIpKTooaT1FKG4pKT9pLmNhbGwobixjLGEpOmMobikpOmEocil9Y2F0Y2goZSl7ZiYmIXUmJmYuZXhpdCgpLGEoZSl9fShuW2krK10pO2UuX2M9W10sZS5fbj0hMSx0JiYhZS5faCYmQShlKX0pfX0sQT1mdW5jdGlvbihlKXtoLmNhbGwoYyxmdW5jdGlvbigpe3ZhciB0LG4scixvPWUuX3YsaT1xKGUpO2lmKGkmJih0PW0oZnVuY3Rpb24oKXtSP1MuZW1pdChcInVuaGFuZGxlZFJlamVjdGlvblwiLG8sZSk6KG49Yy5vbnVuaGFuZGxlZHJlamVjdGlvbik/bih7cHJvbWlzZTplLHJlYXNvbjpvfSk6KHI9Yy5jb25zb2xlKSYmci5lcnJvciYmci5lcnJvcihcIlVuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvblwiLG8pfSksZS5faD1SfHxxKGUpPzI6MSksZS5fYT12b2lkIDAsaSYmdC5lKXRocm93IHQudn0pfSxxPWZ1bmN0aW9uKGUpe3JldHVybiAxIT09ZS5faCYmMD09PShlLl9hfHxlLl9jKS5sZW5ndGh9LEM9ZnVuY3Rpb24oZSl7aC5jYWxsKGMsZnVuY3Rpb24oKXt2YXIgdDtSP1MuZW1pdChcInJlamVjdGlvbkhhbmRsZWRcIixlKToodD1jLm9ucmVqZWN0aW9uaGFuZGxlZCkmJnQoe3Byb21pc2U6ZSxyZWFzb246ZS5fdn0pfSl9LEk9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpczt0Ll9kfHwodC5fZD0hMCx0PXQuX3d8fHQsdC5fdj1lLHQuX3M9Mix0Ll9hfHwodC5fYT10Ll9jLnNsaWNlKCkpLFQodCwhMCkpfSxGPWZ1bmN0aW9uKGUpe3ZhciB0LG49dGhpcztpZighbi5fZCl7bi5fZD0hMCxuPW4uX3d8fG47dHJ5e2lmKG49PT1lKXRocm93IE8oXCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZlwiKTsodD1FKGUpKT9iKGZ1bmN0aW9uKCl7dmFyIHI9e193Om4sX2Q6ITF9O3RyeXt0LmNhbGwoZSxhKEYsciwxKSxhKEksciwxKSl9Y2F0Y2goZSl7SS5jYWxsKHIsZSl9fSk6KG4uX3Y9ZSxuLl9zPTEsVChuLCExKSl9Y2F0Y2goZSl7SS5jYWxsKHtfdzpuLF9kOiExfSxlKX19fTtEfHwoaz1mdW5jdGlvbihlKXt2KHRoaXMsayxcIlByb21pc2VcIixcIl9oXCIpLGQoZSksci5jYWxsKHRoaXMpO3RyeXtlKGEoRix0aGlzLDEpLGEoSSx0aGlzLDEpKX1jYXRjaChlKXtJLmNhbGwodGhpcyxlKX19LHI9ZnVuY3Rpb24oZSl7dGhpcy5fYz1bXSx0aGlzLl9hPXZvaWQgMCx0aGlzLl9zPTAsdGhpcy5fZD0hMSx0aGlzLl92PXZvaWQgMCx0aGlzLl9oPTAsdGhpcy5fbj0hMX0sci5wcm90b3R5cGU9big4Mikoay5wcm90b3R5cGUse3RoZW46ZnVuY3Rpb24oZSx0KXt2YXIgbj1qKF8odGhpcyxrKSk7cmV0dXJuIG4ub2s9XCJmdW5jdGlvblwiIT10eXBlb2YgZXx8ZSxuLmZhaWw9XCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdCxuLmRvbWFpbj1SP1MuZG9tYWluOnZvaWQgMCx0aGlzLl9jLnB1c2gobiksdGhpcy5fYSYmdGhpcy5fYS5wdXNoKG4pLHRoaXMuX3MmJlQodGhpcywhMSksbi5wcm9taXNlfSxjYXRjaDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy50aGVuKHZvaWQgMCxlKX19KSxpPWZ1bmN0aW9uKCl7dmFyIGU9bmV3IHI7dGhpcy5wcm9taXNlPWUsdGhpcy5yZXNvbHZlPWEoRixlLDEpLHRoaXMucmVqZWN0PWEoSSxlLDEpfSxnLmY9aj1mdW5jdGlvbihlKXtyZXR1cm4gZT09PWt8fGU9PT11P25ldyBpKGUpOm8oZSl9KSxsKGwuRytsLlcrbC5GKiFELHtQcm9taXNlOmt9KSxuKDI0KShrLFwiUHJvbWlzZVwiKSxuKDgzKShcIlByb21pc2VcIiksdT1uKDApLlByb21pc2UsbChsLlMrbC5GKiFELFwiUHJvbWlzZVwiLHtyZWplY3Q6ZnVuY3Rpb24oZSl7dmFyIHQ9aih0aGlzKTtyZXR1cm4oMCx0LnJlamVjdCkoZSksdC5wcm9taXNlfX0pLGwobC5TK2wuRiooc3x8IUQpLFwiUHJvbWlzZVwiLHtyZXNvbHZlOmZ1bmN0aW9uKGUpe3JldHVybiB3KHMmJnRoaXM9PT11P2s6dGhpcyxlKX19KSxsKGwuUytsLkYqIShEJiZuKDg0KShmdW5jdGlvbihlKXtrLmFsbChlKS5jYXRjaChMKX0pKSxcIlByb21pc2VcIix7YWxsOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1qKHQpLHI9bi5yZXNvbHZlLG89bi5yZWplY3QsaT1tKGZ1bmN0aW9uKCl7dmFyIG49W10saT0wLHU9MTt5KGUsITEsZnVuY3Rpb24oZSl7dmFyIHM9aSsrLGM9ITE7bi5wdXNoKHZvaWQgMCksdSsrLHQucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uKGUpe2N8fChjPSEwLG5bc109ZSwtLXV8fHIobikpfSxvKX0pLC0tdXx8cihuKX0pO3JldHVybiBpLmUmJm8oaS52KSxuLnByb21pc2V9LHJhY2U6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPWoodCkscj1uLnJlamVjdCxvPW0oZnVuY3Rpb24oKXt5KGUsITEsZnVuY3Rpb24oZSl7dC5yZXNvbHZlKGUpLnRoZW4obi5yZXNvbHZlLHIpfSl9KTtyZXR1cm4gby5lJiZyKG8udiksbi5wcm9taXNlfX0pfSxmdW5jdGlvbihlLHQpe2UuZXhwb3J0cz1mdW5jdGlvbihlLHQsbixyKXtpZighKGUgaW5zdGFuY2VvZiB0KXx8dm9pZCAwIT09ciYmciBpbiBlKXRocm93IFR5cGVFcnJvcihuK1wiOiBpbmNvcnJlY3QgaW52b2NhdGlvbiFcIik7cmV0dXJuIGV9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9bigxNSksbz1uKDc2KSxpPW4oNzcpLHU9big0KSxzPW4oMzgpLGM9big3OCksYT17fSxmPXt9LHQ9ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuLGwscCl7dmFyIGQsdix5LF8saD1wP2Z1bmN0aW9uKCl7cmV0dXJuIGV9OmMoZSksYj1yKG4sbCx0PzI6MSksZz0wO2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIGgpdGhyb3cgVHlwZUVycm9yKGUrXCIgaXMgbm90IGl0ZXJhYmxlIVwiKTtpZihpKGgpKXtmb3IoZD1zKGUubGVuZ3RoKTtkPmc7ZysrKWlmKChfPXQ/Yih1KHY9ZVtnXSlbMF0sdlsxXSk6YihlW2ddKSk9PT1hfHxfPT09ZilyZXR1cm4gX31lbHNlIGZvcih5PWguY2FsbChlKTshKHY9eS5uZXh0KCkpLmRvbmU7KWlmKChfPW8oeSxiLHYudmFsdWUsdCkpPT09YXx8Xz09PWYpcmV0dXJuIF99O3QuQlJFQUs9YSx0LlJFVFVSTj1mfSxmdW5jdGlvbihlLHQsbil7dmFyIHI9big0KTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0LG4sbyl7dHJ5e3JldHVybiBvP3QocihuKVswXSxuWzFdKTp0KG4pfWNhdGNoKHQpe3ZhciBpPWUucmV0dXJuO3Rocm93IHZvaWQgMCE9PWkmJnIoaS5jYWxsKGUpKSx0fX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDE3KSxvPW4oMikoXCJpdGVyYXRvclwiKSxpPUFycmF5LnByb3RvdHlwZTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMCE9PWUmJihyLkFycmF5PT09ZXx8aVtvXT09PWUpfX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oNDkpLG89bigyKShcIml0ZXJhdG9yXCIpLGk9bigxNyk7ZS5leHBvcnRzPW4oMCkuZ2V0SXRlcmF0b3JNZXRob2Q9ZnVuY3Rpb24oZSl7aWYodm9pZCAwIT1lKXJldHVybiBlW29dfHxlW1wiQEBpdGVyYXRvclwiXXx8aVtyKGUpXX19LGZ1bmN0aW9uKGUsdCl7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj12b2lkIDA9PT1uO3N3aXRjaCh0Lmxlbmd0aCl7Y2FzZSAwOnJldHVybiByP2UoKTplLmNhbGwobik7Y2FzZSAxOnJldHVybiByP2UodFswXSk6ZS5jYWxsKG4sdFswXSk7Y2FzZSAyOnJldHVybiByP2UodFswXSx0WzFdKTplLmNhbGwobix0WzBdLHRbMV0pO2Nhc2UgMzpyZXR1cm4gcj9lKHRbMF0sdFsxXSx0WzJdKTplLmNhbGwobix0WzBdLHRbMV0sdFsyXSk7Y2FzZSA0OnJldHVybiByP2UodFswXSx0WzFdLHRbMl0sdFszXSk6ZS5jYWxsKG4sdFswXSx0WzFdLHRbMl0sdFszXSl9cmV0dXJuIGUuYXBwbHkobix0KX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDEpLG89big1MSkuc2V0LGk9ci5NdXRhdGlvbk9ic2VydmVyfHxyLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIsdT1yLnByb2Nlc3Mscz1yLlByb21pc2UsYz1cInByb2Nlc3NcIj09bigxNikodSk7ZS5leHBvcnRzPWZ1bmN0aW9uKCl7dmFyIGUsdCxuLGE9ZnVuY3Rpb24oKXt2YXIgcixvO2ZvcihjJiYocj11LmRvbWFpbikmJnIuZXhpdCgpO2U7KXtvPWUuZm4sZT1lLm5leHQ7dHJ5e28oKX1jYXRjaChyKXt0aHJvdyBlP24oKTp0PXZvaWQgMCxyfX10PXZvaWQgMCxyJiZyLmVudGVyKCl9O2lmKGMpbj1mdW5jdGlvbigpe3UubmV4dFRpY2soYSl9O2Vsc2UgaWYoIWl8fHIubmF2aWdhdG9yJiZyLm5hdmlnYXRvci5zdGFuZGFsb25lKWlmKHMmJnMucmVzb2x2ZSl7dmFyIGY9cy5yZXNvbHZlKHZvaWQgMCk7bj1mdW5jdGlvbigpe2YudGhlbihhKX19ZWxzZSBuPWZ1bmN0aW9uKCl7by5jYWxsKHIsYSl9O2Vsc2V7dmFyIGw9ITAscD1kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIlwiKTtuZXcgaShhKS5vYnNlcnZlKHAse2NoYXJhY3RlckRhdGE6ITB9KSxuPWZ1bmN0aW9uKCl7cC5kYXRhPWw9IWx9fXJldHVybiBmdW5jdGlvbihyKXt2YXIgbz17Zm46cixuZXh0OnZvaWQgMH07dCYmKHQubmV4dD1vKSxlfHwoZT1vLG4oKSksdD1vfX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDEpLG89ci5uYXZpZ2F0b3I7ZS5leHBvcnRzPW8mJm8udXNlckFnZW50fHxcIlwifSxmdW5jdGlvbihlLHQsbil7dmFyIHI9big5KTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgbyBpbiB0KW4mJmVbb10/ZVtvXT10W29dOnIoZSxvLHRbb10pO3JldHVybiBlfX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oMSksbz1uKDApLGk9big3KSx1PW4oNSkscz1uKDIpKFwic3BlY2llc1wiKTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7dmFyIHQ9XCJmdW5jdGlvblwiPT10eXBlb2Ygb1tlXT9vW2VdOnJbZV07dSYmdCYmIXRbc10mJmkuZih0LHMse2NvbmZpZ3VyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc319KX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDIpKFwiaXRlcmF0b3JcIiksbz0hMTt0cnl7dmFyIGk9WzddW3JdKCk7aS5yZXR1cm49ZnVuY3Rpb24oKXtvPSEwfSxBcnJheS5mcm9tKGksZnVuY3Rpb24oKXt0aHJvdyAyfSl9Y2F0Y2goZSl7fWUuZXhwb3J0cz1mdW5jdGlvbihlLHQpe2lmKCF0JiYhbylyZXR1cm4hMTt2YXIgbj0hMTt0cnl7dmFyIGk9WzddLHU9aVtyXSgpO3UubmV4dD1mdW5jdGlvbigpe3JldHVybntkb25lOm49ITB9fSxpW3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHV9LGUoaSl9Y2F0Y2goZSl7fXJldHVybiBufX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oMyksbz1uKDApLGk9bigxKSx1PW4oNTApLHM9big1Myk7cihyLlArci5SLFwiUHJvbWlzZVwiLHtmaW5hbGx5OmZ1bmN0aW9uKGUpe3ZhciB0PXUodGhpcyxvLlByb21pc2V8fGkuUHJvbWlzZSksbj1cImZ1bmN0aW9uXCI9PXR5cGVvZiBlO3JldHVybiB0aGlzLnRoZW4obj9mdW5jdGlvbihuKXtyZXR1cm4gcyh0LGUoKSkudGhlbihmdW5jdGlvbigpe3JldHVybiBufSl9OmUsbj9mdW5jdGlvbihuKXtyZXR1cm4gcyh0LGUoKSkudGhlbihmdW5jdGlvbigpe3Rocm93IG59KX06ZSl9fSl9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj1uKDMpLG89bigzMiksaT1uKDUyKTtyKHIuUyxcIlByb21pc2VcIix7dHJ5OmZ1bmN0aW9uKGUpe3ZhciB0PW8uZih0aGlzKSxuPWkoZSk7cmV0dXJuKG4uZT90LnJlamVjdDp0LnJlc29sdmUpKG4udiksdC5wcm9taXNlfX0pfSxmdW5jdGlvbihlLHQsbil7dmFyIHIsbzshZnVuY3Rpb24oaSx1KXtcInVzZSBzdHJpY3RcIjtyPXUsdm9pZCAwIT09KG89XCJmdW5jdGlvblwiPT10eXBlb2Ygcj9yLmNhbGwodCxuLHQsZSk6cikmJihlLmV4cG9ydHM9byl9KDAsZnVuY3Rpb24oKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBiaW5kTWV0aG9kKGUsdCl7dmFyIG49ZVt0XTtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmJpbmQpcmV0dXJuIG4uYmluZChlKTt0cnl7cmV0dXJuIEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwobixlKX1jYXRjaCh0KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5LmFwcGx5KG4sW2UsYXJndW1lbnRzXSl9fX1mdW5jdGlvbiByZWFsTWV0aG9kKG4pe3JldHVyblwiZGVidWdcIj09PW4mJihuPVwibG9nXCIpLHR5cGVvZiBjb25zb2xlIT09dCYmKHZvaWQgMCE9PWNvbnNvbGVbbl0/YmluZE1ldGhvZChjb25zb2xlLG4pOnZvaWQgMCE9PWNvbnNvbGUubG9nP2JpbmRNZXRob2QoY29uc29sZSxcImxvZ1wiKTplKX1mdW5jdGlvbiByZXBsYWNlTG9nZ2luZ01ldGhvZHModCxyKXtmb3IodmFyIG89MDtvPG4ubGVuZ3RoO28rKyl7dmFyIGk9bltvXTt0aGlzW2ldPW88dD9lOnRoaXMubWV0aG9kRmFjdG9yeShpLHQscil9dGhpcy5sb2c9dGhpcy5kZWJ1Z31mdW5jdGlvbiBlbmFibGVMb2dnaW5nV2hlbkNvbnNvbGVBcnJpdmVzKGUsbixyKXtyZXR1cm4gZnVuY3Rpb24oKXt0eXBlb2YgY29uc29sZSE9PXQmJihyZXBsYWNlTG9nZ2luZ01ldGhvZHMuY2FsbCh0aGlzLG4sciksdGhpc1tlXS5hcHBseSh0aGlzLGFyZ3VtZW50cykpfX1mdW5jdGlvbiBkZWZhdWx0TWV0aG9kRmFjdG9yeShlLHQsbil7cmV0dXJuIHJlYWxNZXRob2QoZSl8fGVuYWJsZUxvZ2dpbmdXaGVuQ29uc29sZUFycml2ZXMuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIExvZ2dlcihlLHIsbyl7ZnVuY3Rpb24gcGVyc2lzdExldmVsSWZQb3NzaWJsZShlKXt2YXIgcj0obltlXXx8XCJzaWxlbnRcIikudG9VcHBlckNhc2UoKTtpZih0eXBlb2Ygd2luZG93IT09dCl7dHJ5e3JldHVybiB2b2lkKHdpbmRvdy5sb2NhbFN0b3JhZ2Vbc109cil9Y2F0Y2goZSl7fXRyeXt3aW5kb3cuZG9jdW1lbnQuY29va2llPWVuY29kZVVSSUNvbXBvbmVudChzKStcIj1cIityK1wiO1wifWNhdGNoKGUpe319fWZ1bmN0aW9uIGdldFBlcnNpc3RlZExldmVsKCl7dmFyIGU7aWYodHlwZW9mIHdpbmRvdyE9PXQpe3RyeXtlPXdpbmRvdy5sb2NhbFN0b3JhZ2Vbc119Y2F0Y2goZSl7fWlmKHR5cGVvZiBlPT09dCl0cnl7dmFyIG49d2luZG93LmRvY3VtZW50LmNvb2tpZSxyPW4uaW5kZXhPZihlbmNvZGVVUklDb21wb25lbnQocykrXCI9XCIpOy0xIT09ciYmKGU9L14oW147XSspLy5leGVjKG4uc2xpY2UocikpWzFdKX1jYXRjaChlKXt9cmV0dXJuIHZvaWQgMD09PXUubGV2ZWxzW2VdJiYoZT12b2lkIDApLGV9fXZhciBpLHU9dGhpcyxzPVwibG9nbGV2ZWxcIjtlJiYocys9XCI6XCIrZSksdS5uYW1lPWUsdS5sZXZlbHM9e1RSQUNFOjAsREVCVUc6MSxJTkZPOjIsV0FSTjozLEVSUk9SOjQsU0lMRU5UOjV9LHUubWV0aG9kRmFjdG9yeT1vfHxkZWZhdWx0TWV0aG9kRmFjdG9yeSx1LmdldExldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIGl9LHUuc2V0TGV2ZWw9ZnVuY3Rpb24obixyKXtpZihcInN0cmluZ1wiPT10eXBlb2YgbiYmdm9pZCAwIT09dS5sZXZlbHNbbi50b1VwcGVyQ2FzZSgpXSYmKG49dS5sZXZlbHNbbi50b1VwcGVyQ2FzZSgpXSksIShcIm51bWJlclwiPT10eXBlb2YgbiYmbj49MCYmbjw9dS5sZXZlbHMuU0lMRU5UKSl0aHJvd1wibG9nLnNldExldmVsKCkgY2FsbGVkIHdpdGggaW52YWxpZCBsZXZlbDogXCIrbjtpZihpPW4sITEhPT1yJiZwZXJzaXN0TGV2ZWxJZlBvc3NpYmxlKG4pLHJlcGxhY2VMb2dnaW5nTWV0aG9kcy5jYWxsKHUsbixlKSx0eXBlb2YgY29uc29sZT09PXQmJm48dS5sZXZlbHMuU0lMRU5UKXJldHVyblwiTm8gY29uc29sZSBhdmFpbGFibGUgZm9yIGxvZ2dpbmdcIn0sdS5zZXREZWZhdWx0TGV2ZWw9ZnVuY3Rpb24oZSl7Z2V0UGVyc2lzdGVkTGV2ZWwoKXx8dS5zZXRMZXZlbChlLCExKX0sdS5lbmFibGVBbGw9ZnVuY3Rpb24oZSl7dS5zZXRMZXZlbCh1LmxldmVscy5UUkFDRSxlKX0sdS5kaXNhYmxlQWxsPWZ1bmN0aW9uKGUpe3Uuc2V0TGV2ZWwodS5sZXZlbHMuU0lMRU5ULGUpfTt2YXIgYz1nZXRQZXJzaXN0ZWRMZXZlbCgpO251bGw9PWMmJihjPW51bGw9PXI/XCJXQVJOXCI6ciksdS5zZXRMZXZlbChjLCExKX12YXIgZT1mdW5jdGlvbigpe30sdD1cInVuZGVmaW5lZFwiLG49W1widHJhY2VcIixcImRlYnVnXCIsXCJpbmZvXCIsXCJ3YXJuXCIsXCJlcnJvclwiXSxyPW5ldyBMb2dnZXIsbz17fTtyLmdldExvZ2dlcj1mdW5jdGlvbihlKXtpZihcInN0cmluZ1wiIT10eXBlb2YgZXx8XCJcIj09PWUpdGhyb3cgbmV3IFR5cGVFcnJvcihcIllvdSBtdXN0IHN1cHBseSBhIG5hbWUgd2hlbiBjcmVhdGluZyBhIGxvZ2dlci5cIik7dmFyIHQ9b1tlXTtyZXR1cm4gdHx8KHQ9b1tlXT1uZXcgTG9nZ2VyKGUsci5nZXRMZXZlbCgpLHIubWV0aG9kRmFjdG9yeSkpLHR9O3ZhciBpPXR5cGVvZiB3aW5kb3chPT10P3dpbmRvdy5sb2c6dm9pZCAwO3JldHVybiByLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdHlwZW9mIHdpbmRvdyE9PXQmJndpbmRvdy5sb2c9PT1yJiYod2luZG93LmxvZz1pKSxyfSxyLmdldExvZ2dlcnM9ZnVuY3Rpb24oKXtyZXR1cm4gb30scn0pfSxmdW5jdGlvbihlLHQsbil7big4OSksZS5leHBvcnRzPW4oMCkuT2JqZWN0LmdldFByb3RvdHlwZU9mfSxmdW5jdGlvbihlLHQsbil7dmFyIHI9bigzMCksbz1uKDQ3KTtuKDM5KShcImdldFByb3RvdHlwZU9mXCIsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIG8ocihlKSl9fSl9LGZ1bmN0aW9uKGUsdCxuKXtlLmV4cG9ydHM9e2RlZmF1bHQ6big5MSksX19lc01vZHVsZTohMH19LGZ1bmN0aW9uKGUsdCxuKXtuKDQzKSxuKDQ4KSxlLmV4cG9ydHM9bigzMykuZihcIml0ZXJhdG9yXCIpfSxmdW5jdGlvbihlLHQsbil7ZS5leHBvcnRzPXtkZWZhdWx0Om4oOTMpLF9fZXNNb2R1bGU6ITB9fSxmdW5jdGlvbihlLHQsbil7big5NCksbig0Miksbig5OSksbigxMDApLGUuZXhwb3J0cz1uKDApLlN5bWJvbH0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oMSksbz1uKDgpLGk9big1KSx1PW4oMykscz1uKDQ1KSxjPW4oOTUpLktFWSxhPW4oMTMpLGY9bigyOCksbD1uKDI0KSxwPW4oMjApLGQ9bigyKSx2PW4oMzMpLHk9bigzNCksXz1uKDk2KSxoPW4oOTcpLGI9big0KSxnPW4oNiksbT1uKDEwKSx4PW4oMjYpLHc9bigxOSksTz1uKDMxKSxTPW4oOTgpLE09big0MCksUD1uKDcpLGs9bigyMSksUj1NLmYsTD1QLmYsaj1TLmYsRD1yLlN5bWJvbCxFPXIuSlNPTixUPUUmJkUuc3RyaW5naWZ5LEE9ZChcIl9oaWRkZW5cIikscT1kKFwidG9QcmltaXRpdmVcIiksQz17fS5wcm9wZXJ0eUlzRW51bWVyYWJsZSxJPWYoXCJzeW1ib2wtcmVnaXN0cnlcIiksRj1mKFwic3ltYm9sc1wiKSxOPWYoXCJvcC1zeW1ib2xzXCIpLEI9T2JqZWN0LnByb3RvdHlwZSxXPVwiZnVuY3Rpb25cIj09dHlwZW9mIEQsRz1yLlFPYmplY3QsVT0hR3x8IUcucHJvdG90eXBlfHwhRy5wcm90b3R5cGUuZmluZENoaWxkLFY9aSYmYShmdW5jdGlvbigpe3JldHVybiA3IT1PKEwoe30sXCJhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBMKHRoaXMsXCJhXCIse3ZhbHVlOjd9KS5hfX0pKS5hfSk/ZnVuY3Rpb24oZSx0LG4pe3ZhciByPVIoQix0KTtyJiZkZWxldGUgQlt0XSxMKGUsdCxuKSxyJiZlIT09QiYmTChCLHQscil9OkwsSD1mdW5jdGlvbihlKXt2YXIgdD1GW2VdPU8oRC5wcm90b3R5cGUpO3JldHVybiB0Ll9rPWUsdH0sSz1XJiZcInN5bWJvbFwiPT10eXBlb2YgRC5pdGVyYXRvcj9mdW5jdGlvbihlKXtyZXR1cm5cInN5bWJvbFwiPT10eXBlb2YgZX06ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBEfSxKPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZT09PUImJkooTix0LG4pLGIoZSksdD14KHQsITApLGIobiksbyhGLHQpPyhuLmVudW1lcmFibGU/KG8oZSxBKSYmZVtBXVt0XSYmKGVbQV1bdF09ITEpLG49TyhuLHtlbnVtZXJhYmxlOncoMCwhMSl9KSk6KG8oZSxBKXx8TChlLEEsdygxLHt9KSksZVtBXVt0XT0hMCksVihlLHQsbikpOkwoZSx0LG4pfSx6PWZ1bmN0aW9uKGUsdCl7YihlKTtmb3IodmFyIG4scj1fKHQ9bSh0KSksbz0wLGk9ci5sZW5ndGg7aT5vOylKKGUsbj1yW28rK10sdFtuXSk7cmV0dXJuIGV9LFk9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdm9pZCAwPT09dD9PKGUpOnooTyhlKSx0KX0sUT1mdW5jdGlvbihlKXt2YXIgdD1DLmNhbGwodGhpcyxlPXgoZSwhMCkpO3JldHVybiEodGhpcz09PUImJm8oRixlKSYmIW8oTixlKSkmJighKHR8fCFvKHRoaXMsZSl8fCFvKEYsZSl8fG8odGhpcyxBKSYmdGhpc1tBXVtlXSl8fHQpfSxYPWZ1bmN0aW9uKGUsdCl7aWYoZT1tKGUpLHQ9eCh0LCEwKSxlIT09Qnx8IW8oRix0KXx8byhOLHQpKXt2YXIgbj1SKGUsdCk7cmV0dXJuIW58fCFvKEYsdCl8fG8oZSxBKSYmZVtBXVt0XXx8KG4uZW51bWVyYWJsZT0hMCksbn19LFo9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG49aihtKGUpKSxyPVtdLGk9MDtuLmxlbmd0aD5pOylvKEYsdD1uW2krK10pfHx0PT1BfHx0PT1jfHxyLnB1c2godCk7cmV0dXJuIHJ9LCQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG49ZT09PUIscj1qKG4/TjptKGUpKSxpPVtdLHU9MDtyLmxlbmd0aD51OykhbyhGLHQ9clt1KytdKXx8biYmIW8oQix0KXx8aS5wdXNoKEZbdF0pO3JldHVybiBpfTtXfHwoRD1mdW5jdGlvbigpe2lmKHRoaXMgaW5zdGFuY2VvZiBEKXRocm93IFR5cGVFcnJvcihcIlN5bWJvbCBpcyBub3QgYSBjb25zdHJ1Y3RvciFcIik7dmFyIGU9cChhcmd1bWVudHMubGVuZ3RoPjA/YXJndW1lbnRzWzBdOnZvaWQgMCksdD1mdW5jdGlvbihuKXt0aGlzPT09QiYmdC5jYWxsKE4sbiksbyh0aGlzLEEpJiZvKHRoaXNbQV0sZSkmJih0aGlzW0FdW2VdPSExKSxWKHRoaXMsZSx3KDEsbikpfTtyZXR1cm4gaSYmVSYmVihCLGUse2NvbmZpZ3VyYWJsZTohMCxzZXQ6dH0pLEgoZSl9LHMoRC5wcm90b3R5cGUsXCJ0b1N0cmluZ1wiLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2t9KSxNLmY9WCxQLmY9SixuKDU2KS5mPVMuZj1aLG4oMzUpLmY9USxuKDU1KS5mPSQsaSYmIW4oMTQpJiZzKEIsXCJwcm9wZXJ0eUlzRW51bWVyYWJsZVwiLFEsITApLHYuZj1mdW5jdGlvbihlKXtyZXR1cm4gSChkKGUpKX0pLHUodS5HK3UuVyt1LkYqIVcse1N5bWJvbDpEfSk7Zm9yKHZhciBlZT1cImhhc0luc3RhbmNlLGlzQ29uY2F0U3ByZWFkYWJsZSxpdGVyYXRvcixtYXRjaCxyZXBsYWNlLHNlYXJjaCxzcGVjaWVzLHNwbGl0LHRvUHJpbWl0aXZlLHRvU3RyaW5nVGFnLHVuc2NvcGFibGVzXCIuc3BsaXQoXCIsXCIpLHRlPTA7ZWUubGVuZ3RoPnRlOylkKGVlW3RlKytdKTtmb3IodmFyIG5lPWsoZC5zdG9yZSkscmU9MDtuZS5sZW5ndGg+cmU7KXkobmVbcmUrK10pO3UodS5TK3UuRiohVyxcIlN5bWJvbFwiLHtmb3I6ZnVuY3Rpb24oZSl7cmV0dXJuIG8oSSxlKz1cIlwiKT9JW2VdOklbZV09RChlKX0sa2V5Rm9yOmZ1bmN0aW9uKGUpe2lmKCFLKGUpKXRocm93IFR5cGVFcnJvcihlK1wiIGlzIG5vdCBhIHN5bWJvbCFcIik7Zm9yKHZhciB0IGluIEkpaWYoSVt0XT09PWUpcmV0dXJuIHR9LHVzZVNldHRlcjpmdW5jdGlvbigpe1U9ITB9LHVzZVNpbXBsZTpmdW5jdGlvbigpe1U9ITF9fSksdSh1LlMrdS5GKiFXLFwiT2JqZWN0XCIse2NyZWF0ZTpZLGRlZmluZVByb3BlcnR5OkosZGVmaW5lUHJvcGVydGllczp6LGdldE93blByb3BlcnR5RGVzY3JpcHRvcjpYLGdldE93blByb3BlcnR5TmFtZXM6WixnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6JH0pLEUmJnUodS5TK3UuRiooIVd8fGEoZnVuY3Rpb24oKXt2YXIgZT1EKCk7cmV0dXJuXCJbbnVsbF1cIiE9VChbZV0pfHxcInt9XCIhPVQoe2E6ZX0pfHxcInt9XCIhPVQoT2JqZWN0KGUpKX0pKSxcIkpTT05cIix7c3RyaW5naWZ5OmZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxuLHI9W2VdLG89MTthcmd1bWVudHMubGVuZ3RoPm87KXIucHVzaChhcmd1bWVudHNbbysrXSk7aWYobj10PXJbMV0sKGcodCl8fHZvaWQgMCE9PWUpJiYhSyhlKSlyZXR1cm4gaCh0KXx8KHQ9ZnVuY3Rpb24oZSx0KXtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBuJiYodD1uLmNhbGwodGhpcyxlLHQpKSwhSyh0KSlyZXR1cm4gdH0pLHJbMV09dCxULmFwcGx5KEUscil9fSksRC5wcm90b3R5cGVbcV18fG4oOSkoRC5wcm90b3R5cGUscSxELnByb3RvdHlwZS52YWx1ZU9mKSxsKEQsXCJTeW1ib2xcIiksbChNYXRoLFwiTWF0aFwiLCEwKSxsKHIuSlNPTixcIkpTT05cIiwhMCl9LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDIwKShcIm1ldGFcIiksbz1uKDYpLGk9big4KSx1PW4oNykuZixzPTAsYz1PYmplY3QuaXNFeHRlbnNpYmxlfHxmdW5jdGlvbigpe3JldHVybiEwfSxhPSFuKDEzKShmdW5jdGlvbigpe3JldHVybiBjKE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpfSksZj1mdW5jdGlvbihlKXt1KGUscix7dmFsdWU6e2k6XCJPXCIrICsrcyx3Ont9fX0pfSxsPWZ1bmN0aW9uKGUsdCl7aWYoIW8oZSkpcmV0dXJuXCJzeW1ib2xcIj09dHlwZW9mIGU/ZTooXCJzdHJpbmdcIj09dHlwZW9mIGU/XCJTXCI6XCJQXCIpK2U7aWYoIWkoZSxyKSl7aWYoIWMoZSkpcmV0dXJuXCJGXCI7aWYoIXQpcmV0dXJuXCJFXCI7ZihlKX1yZXR1cm4gZVtyXS5pfSxwPWZ1bmN0aW9uKGUsdCl7aWYoIWkoZSxyKSl7aWYoIWMoZSkpcmV0dXJuITA7aWYoIXQpcmV0dXJuITE7ZihlKX1yZXR1cm4gZVtyXS53fSxkPWZ1bmN0aW9uKGUpe3JldHVybiBhJiZ2Lk5FRUQmJmMoZSkmJiFpKGUscikmJmYoZSksZX0sdj1lLmV4cG9ydHM9e0tFWTpyLE5FRUQ6ITEsZmFzdEtleTpsLGdldFdlYWs6cCxvbkZyZWV6ZTpkfX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMjEpLG89big1NSksaT1uKDM1KTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7dmFyIHQ9cihlKSxuPW8uZjtpZihuKWZvcih2YXIgdSxzPW4oZSksYz1pLmYsYT0wO3MubGVuZ3RoPmE7KWMuY2FsbChlLHU9c1thKytdKSYmdC5wdXNoKHUpO3JldHVybiB0fX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMTYpO2UuZXhwb3J0cz1BcnJheS5pc0FycmF5fHxmdW5jdGlvbihlKXtyZXR1cm5cIkFycmF5XCI9PXIoZSl9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9bigxMCksbz1uKDU2KS5mLGk9e30udG9TdHJpbmcsdT1cIm9iamVjdFwiPT10eXBlb2Ygd2luZG93JiZ3aW5kb3cmJk9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzP09iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdyk6W10scz1mdW5jdGlvbihlKXt0cnl7cmV0dXJuIG8oZSl9Y2F0Y2goZSl7cmV0dXJuIHUuc2xpY2UoKX19O2UuZXhwb3J0cy5mPWZ1bmN0aW9uKGUpe3JldHVybiB1JiZcIltvYmplY3QgV2luZG93XVwiPT1pLmNhbGwoZSk/cyhlKTpvKHIoZSkpfX0sZnVuY3Rpb24oZSx0LG4pe24oMzQpKFwiYXN5bmNJdGVyYXRvclwiKX0sZnVuY3Rpb24oZSx0LG4pe24oMzQpKFwib2JzZXJ2YWJsZVwiKX0sZnVuY3Rpb24oZSx0LG4pe2UuZXhwb3J0cz17ZGVmYXVsdDpuKDEwMiksX19lc01vZHVsZTohMH19LGZ1bmN0aW9uKGUsdCxuKXtuKDEwMyksZS5leHBvcnRzPW4oMCkuT2JqZWN0LnNldFByb3RvdHlwZU9mfSxmdW5jdGlvbihlLHQsbil7dmFyIHI9bigzKTtyKHIuUyxcIk9iamVjdFwiLHtzZXRQcm90b3R5cGVPZjpuKDEwNCkuc2V0fSl9LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDYpLG89big0KSxpPWZ1bmN0aW9uKGUsdCl7aWYobyhlKSwhcih0KSYmbnVsbCE9PXQpdGhyb3cgVHlwZUVycm9yKHQrXCI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhXCIpfTtlLmV4cG9ydHM9e3NldDpPYmplY3Quc2V0UHJvdG90eXBlT2Z8fChcIl9fcHJvdG9fX1wiaW57fT9mdW5jdGlvbihlLHQscil7dHJ5e3I9bigxNSkoRnVuY3Rpb24uY2FsbCxuKDQwKS5mKE9iamVjdC5wcm90b3R5cGUsXCJfX3Byb3RvX19cIikuc2V0LDIpLHIoZSxbXSksdD0hKGUgaW5zdGFuY2VvZiBBcnJheSl9Y2F0Y2goZSl7dD0hMH1yZXR1cm4gZnVuY3Rpb24oZSxuKXtyZXR1cm4gaShlLG4pLHQ/ZS5fX3Byb3RvX189bjpyKGUsbiksZX19KHt9LCExKTp2b2lkIDApLGNoZWNrOml9fSxmdW5jdGlvbihlLHQsbil7ZS5leHBvcnRzPXtkZWZhdWx0Om4oMTA2KSxfX2VzTW9kdWxlOiEwfX0sZnVuY3Rpb24oZSx0LG4pe24oMTA3KTt2YXIgcj1uKDApLk9iamVjdDtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gci5jcmVhdGUoZSx0KX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDMpO3Ioci5TLFwiT2JqZWN0XCIse2NyZWF0ZTpuKDMxKX0pfSxmdW5jdGlvbihlLHQsbil7ZS5leHBvcnRzPXtkZWZhdWx0Om4oMTA5KSxfX2VzTW9kdWxlOiEwfX0sZnVuY3Rpb24oZSx0LG4pe24oMTEwKSxlLmV4cG9ydHM9bigwKS5PYmplY3Qua2V5c30sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMzApLG89bigyMSk7bigzOSkoXCJrZXlzXCIsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIG8ocihlKSl9fSl9LCwsLCwsZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciByPW4oNjMpLG89X2ludGVyb3BSZXF1aXJlRGVmYXVsdChyKSxpPW4oMTEpLHU9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChpKSxzPW4oMTIpLGM9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChzKSxhPW4oNjQpLGY9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChhKSxsPW4oNjUpLHA9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChsKSxkPW4oMTE3KSx2PV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZCkseT1mdW5jdGlvbihlKXtmdW5jdGlvbiBNaW5pQnVzKCl7cmV0dXJuKDAsdS5kZWZhdWx0KSh0aGlzLE1pbmlCdXMpLCgwLGYuZGVmYXVsdCkodGhpcywoTWluaUJ1cy5fX3Byb3RvX198fCgwLG8uZGVmYXVsdCkoTWluaUJ1cykpLmNhbGwodGhpcykpfXJldHVybigwLHAuZGVmYXVsdCkoTWluaUJ1cyxlKSwoMCxjLmRlZmF1bHQpKE1pbmlCdXMsW3trZXk6XCJwb3N0TWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10aGlzO3JldHVybiByLl9nZW5JZChlKSxyLl9yZXNwb25zZUNhbGxiYWNrKGUsdCxuKSxyLl9vblBvc3RNZXNzYWdlKGUpLGUuaWR9fSx7a2V5OlwiX29uTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoIXQuX29uUmVzcG9uc2UoZSkpe3ZhciBuPXQuX3N1YnNjcmlwdGlvbnNbZS50b107bj8odC5fcHVibGlzaE9uKG4sZSksZS50by5zdGFydHNXaXRoKFwiaHlwZXJ0eVwiKXx8dC5fcHVibGlzaE9uRGVmYXVsdChlKSk6dC5fcHVibGlzaE9uRGVmYXVsdChlKX19fV0pLE1pbmlCdXN9KHYuZGVmYXVsdCk7dC5kZWZhdWx0PXksZS5leHBvcnRzPXQuZGVmYXVsdH0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciByPW4oNDEpLG89X2ludGVyb3BSZXF1aXJlRGVmYXVsdChyKSxpPW4oMTEpLHU9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChpKSxzPW4oMTIpLGM9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChzKSxhPW4oODcpLGY9ZnVuY3Rpb24oZSl7aWYoZSYmZS5fX2VzTW9kdWxlKXJldHVybiBlO3ZhciB0PXt9O2lmKG51bGwhPWUpZm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJih0W25dPWVbbl0pO3JldHVybiB0LmRlZmF1bHQ9ZSx0fShhKSxsPWYuZ2V0TG9nZ2VyKFwiQnVzXCIpLHA9ZnVuY3Rpb24oKXtmdW5jdGlvbiBCdXMoKXsoMCx1LmRlZmF1bHQpKHRoaXMsQnVzKTt2YXIgZT10aGlzO2UuX21zZ0lkPTAsZS5fc3Vic2NyaXB0aW9ucz17fSxlLl9yZXNwb25zZVRpbWVPdXQ9M2U0LGUuX3Jlc3BvbnNlQ2FsbGJhY2tzPXt9LGUuX3JlZ2lzdGVyRXh0ZXJuYWxMaXN0ZW5lcigpfXJldHVybigwLGMuZGVmYXVsdCkoQnVzLFt7a2V5OlwiYWRkTGlzdGVuZXJcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMscj1uZXcgZChuLl9zdWJzY3JpcHRpb25zLGUsdCksbz1uLl9zdWJzY3JpcHRpb25zW2VdO3JldHVybiBvfHwobz1bXSxuLl9zdWJzY3JpcHRpb25zW2VdPW8pLG8ucHVzaChyKSxyfX0se2tleTpcImFkZFJlc3BvbnNlTGlzdGVuZXJcIix2YWx1ZTpmdW5jdGlvbihlLHQsbil7dGhpcy5fcmVzcG9uc2VDYWxsYmFja3NbZSt0XT1ufX0se2tleTpcInJlbW92ZVJlc3BvbnNlTGlzdGVuZXJcIix2YWx1ZTpmdW5jdGlvbihlLHQpe2RlbGV0ZSB0aGlzLl9yZXNwb25zZUNhbGxiYWNrc1tlK3RdfX0se2tleTpcInJlbW92ZUFsbExpc3RlbmVyc09mXCIsdmFsdWU6ZnVuY3Rpb24oZSl7ZGVsZXRlIHRoaXMuX3N1YnNjcmlwdGlvbnNbZV19fSx7a2V5OlwiYmluZFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10aGlzLG89dGhpcztyZXR1cm57dGhpc0xpc3RlbmVyOm8uYWRkTGlzdGVuZXIoZSxmdW5jdGlvbihlKXtuLnBvc3RNZXNzYWdlKGUpfSksdGFyZ2V0TGlzdGVuZXI6bi5hZGRMaXN0ZW5lcih0LGZ1bmN0aW9uKGUpe28ucG9zdE1lc3NhZ2UoZSl9KSx1bmJpbmQ6ZnVuY3Rpb24oKXtyLnRoaXNMaXN0ZW5lci5yZW1vdmUoKSxyLnRhcmdldExpc3RlbmVyLnJlbW92ZSgpfX19fSx7a2V5OlwiX3B1Ymxpc2hPbkRlZmF1bHRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9zdWJzY3JpcHRpb25zW1wiKlwiXTt0JiZ0aGlzLl9wdWJsaXNoT24odCxlKX19LHtrZXk6XCJfcHVibGlzaE9uXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtlLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5fY2FsbGJhY2sodCl9KX19LHtrZXk6XCJfcmVzcG9uc2VDYWxsYmFja1wiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49IShhcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXSl8fGFyZ3VtZW50c1syXSxyPXRoaXM7aWYodCl7dmFyIG89ZS5mcm9tK2UuaWQ7ci5fcmVzcG9uc2VDYWxsYmFja3Nbb109dCxuJiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dmFyIHQ9ci5fcmVzcG9uc2VDYWxsYmFja3Nbb107aWYoZGVsZXRlIHIuX3Jlc3BvbnNlQ2FsbGJhY2tzW29dLHQpe3Qoe2lkOmUuaWQsdHlwZTpcInJlc3BvbnNlXCIsYm9keTp7Y29kZTo0MDgsZGVzYzpcIlJlc3BvbnNlIHRpbWVvdXQhXCIsdmFsdWU6ZX19KX19LHIuX3Jlc3BvbnNlVGltZU91dCl9fX0se2tleTpcIl9vblJlc3BvbnNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZihcInJlc3BvbnNlXCI9PT1lLnR5cGUpe3ZhciBuPWUudG8rZS5pZCxyPXQuX3Jlc3BvbnNlQ2FsbGJhY2tzW25dO2lmKGUuYm9keS5jb2RlPj0yMDAmJmRlbGV0ZSB0Ll9yZXNwb25zZUNhbGxiYWNrc1tuXSxyKXJldHVybiByKGUpLCEwfXJldHVybiExfX0se2tleTpcIl9vbk1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKCF0Ll9vblJlc3BvbnNlKGUpKXt2YXIgbj10Ll9zdWJzY3JpcHRpb25zW2UudG9dO24/dC5fcHVibGlzaE9uKG4sZSk6dC5fcHVibGlzaE9uRGVmYXVsdChlKX19fSx7a2V5OlwiX2dlbklkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7ZS5pZCYmMCE9PWUuaWR8fCh0aGlzLl9tc2dJZCsrLGUuaWQ9dGhpcy5fbXNnSWQpfX0se2tleTpcInBvc3RNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt9fSx7a2V5OlwicG9zdE1lc3NhZ2VXaXRoUmV0cmllc1wiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10aGlzLGk9MCx1PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBvLmRlZmF1bHQoZnVuY3Rpb24odCxvKXtyLnBvc3RNZXNzYWdlKGUsZnVuY3Rpb24ocil7NDA4PT09ci5ib2R5LmNvZGV8fDUwMD09PXIuYm9keS5jb2RlP28oKToobC5pbmZvKFwiW0J1cy5wb3N0TWVzc2FnZVdpdGhSZXRyaWVzXSBtc2cgZGVsaXZlcmVkOiBcIixlKSxuKHIpLHQoKSl9KX0pfTshZnVuY3Rpb24gdHJ5QWdhaW4oKXt1KCkudGhlbihmdW5jdGlvbigpe30sZnVuY3Rpb24oKXtpZihsLndhcm4oXCJbQnVzLnBvc3RNZXNzYWdlV2l0aFJldHJpZXNdIE1lc3NhZ2UgQm91bmNlZCAocmV0cnkgXCIraStcIik6ICdcIixlKSwhKGkrKzx0KSl7dmFyIG49XCJbRXJyb3JdIE1lc3NhZ2UgQm91bmNlZCAoZGVsaXZlcnkgYXR0ZW1wdHMgXCIrdCtcIik6ICdcIjt0aHJvdyBuZXcgRXJyb3IobitlKX10cnlBZ2FpbigpfSl9KCl9fSx7a2V5OlwiX29uUG9zdE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt9fSx7a2V5OlwiX3JlZ2lzdGVyRXh0ZXJuYWxMaXN0ZW5lclwiLHZhbHVlOmZ1bmN0aW9uKCl7fX1dKSxCdXN9KCksZD1mdW5jdGlvbigpe2Z1bmN0aW9uIE1zZ0xpc3RlbmVyKGUsdCxuKXsoMCx1LmRlZmF1bHQpKHRoaXMsTXNnTGlzdGVuZXIpO3ZhciByPXRoaXM7ci5fc3Vic2NyaXB0aW9ucz1lLHIuX3VybD10LHIuX2NhbGxiYWNrPW59cmV0dXJuKDAsYy5kZWZhdWx0KShNc2dMaXN0ZW5lcixbe2tleTpcInJlbW92ZVwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PWUuX3N1YnNjcmlwdGlvbnNbZS5fdXJsXTtpZih0KXt2YXIgbj10LmluZGV4T2YoZSk7dC5zcGxpY2UobiwxKSwwPT09dC5sZW5ndGgmJmRlbGV0ZSBlLl9zdWJzY3JpcHRpb25zW2UuX3VybF19fX0se2tleTpcInVybFwiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl91cmx9fV0pLE1zZ0xpc3RlbmVyfSgpO3QuZGVmYXVsdD1wLGUuZXhwb3J0cz10LmRlZmF1bHR9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgcj1uKDExKSxvPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQociksaT1uKDEyKSx1PV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoaSkscz1mdW5jdGlvbigpe2Z1bmN0aW9uIFNhbmRib3hSZWdpc3RyeShlKXsoMCxvLmRlZmF1bHQpKHRoaXMsU2FuZGJveFJlZ2lzdHJ5KTt2YXIgdD10aGlzO3QuX2J1cz1lLHQuX2NvbXBvbmVudHM9e30sZS5hZGRMaXN0ZW5lcihTYW5kYm94UmVnaXN0cnkuSW50ZXJuYWxEZXBsb3lBZGRyZXNzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLnR5cGUpe2Nhc2VcImNyZWF0ZVwiOnQuX29uRGVwbG95KGUpO2JyZWFrO2Nhc2VcImRlbGV0ZVwiOnQuX29uUmVtb3ZlKGUpfX0pfXJldHVybigwLHUuZGVmYXVsdCkoU2FuZGJveFJlZ2lzdHJ5LFt7a2V5OlwiX3Jlc3BvbnNlTXNnXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPXtpZDplLmlkLHR5cGU6XCJyZXNwb25zZVwiLGZyb206U2FuZGJveFJlZ2lzdHJ5LkludGVybmFsRGVwbG95QWRkcmVzcyx0bzpTYW5kYm94UmVnaXN0cnkuRXh0ZXJuYWxEZXBsb3lBZGRyZXNzfSxvPXt9O3JldHVybiB0JiYoby5jb2RlPXQpLG4mJihvLmRlc2M9biksci5ib2R5PW8scn19LHtrZXk6XCJfb25EZXBsb3lcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5ib2R5LmNvbmZpZyxyPWUuYm9keS51cmwsbz1lLmJvZHkuc291cmNlQ29kZSxpPXZvaWQgMCx1PXZvaWQgMDtpZih0Ll9jb21wb25lbnRzLmhhc093blByb3BlcnR5KHIpKWk9NTAwLHU9XCJJbnN0YW5jZSBcIityK1wiIGFscmVhZHkgZXhpc3QhXCI7ZWxzZSB0cnl7dC5fY29tcG9uZW50c1tyXT10Ll9jcmVhdGUocixvLG4pLGk9MjAwfWNhdGNoKGUpe2k9NTAwLHU9ZX12YXIgcz10Ll9yZXNwb25zZU1zZyhlLGksdSk7dC5fYnVzLnBvc3RNZXNzYWdlKHMpfX0se2tleTpcIl9vblJlbW92ZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLmJvZHkudXJsLHI9dm9pZCAwLG89dm9pZCAwO3QuX2NvbXBvbmVudHMuaGFzT3duUHJvcGVydHkobik/KGRlbGV0ZSB0Ll9jb21wb25lbnRzW25dLHQuX2J1cy5yZW1vdmVBbGxMaXN0ZW5lcnNPZihuKSxyPTIwMCk6KHI9NTAwLG89XCJJbnN0YW5jZSBcIituK1wiIGRvZXNuJ3QgZXhpc3QhXCIpO3ZhciBpPXQuX3Jlc3BvbnNlTXNnKGUscixvKTt0Ll9idXMucG9zdE1lc3NhZ2UoaSl9fSx7a2V5OlwiX2NyZWF0ZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXt9fSx7a2V5OlwiY29tcG9uZW50c1wiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb21wb25lbnRzfX1dKSxTYW5kYm94UmVnaXN0cnl9KCk7cy5FeHRlcm5hbERlcGxveUFkZHJlc3M9XCJoeXBlcnR5LXJ1bnRpbWU6Ly9zYW5kYm94L2V4dGVybmFsXCIscy5JbnRlcm5hbERlcGxveUFkZHJlc3M9XCJoeXBlcnR5LXJ1bnRpbWU6Ly9zYW5kYm94L2ludGVybmFsXCIsdC5kZWZhdWx0PXMsZS5leHBvcnRzPXQuZGVmYXVsdH0sLCwsLCwsLCwsLCwsLCwsZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuU2FuZGJveFJlZ2lzdHJ5PXQuU2FuZGJveFR5cGU9dC5TYW5kYm94PXZvaWQgMDt2YXIgcj1uKDEzNSksbz1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KHIpLGk9bigxMTgpLHU9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChpKTt0LlNhbmRib3g9by5kZWZhdWx0LHQuU2FuZGJveFR5cGU9ci5TYW5kYm94VHlwZSx0LlNhbmRib3hSZWdpc3RyeT11LmRlZmF1bHR9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LlNhbmRib3hUeXBlPXZvaWQgMDt2YXIgcj1uKDEwOCksbz1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KHIpLGk9big0MSksdT1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KGkpLHM9big2MyksYz1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KHMpLGE9bigxMSksZj1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KGEpLGw9bigxMikscD1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KGwpLGQ9big2NCksdj1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KGQpLHk9big2NSksXz1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KHkpLGg9bigxMTgpLGI9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChoKSxnPW4oMTE2KSxtPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQoZykseD0odC5TYW5kYm94VHlwZT17QVBQOlwiYXBwXCIsTk9STUFMOlwibm9ybWFsXCIsV0lORE9XOlwid2luZG93XCJ9LGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIFNhbmRib3goZSl7KDAsZi5kZWZhdWx0KSh0aGlzLFNhbmRib3gpO3ZhciB0PSgwLHYuZGVmYXVsdCkodGhpcywoU2FuZGJveC5fX3Byb3RvX198fCgwLGMuZGVmYXVsdCkoU2FuZGJveCkpLmNhbGwodGhpcykpLG49dDtyZXR1cm4gZSYmKG4uY2FwYWJpbGl0aWVzPWUpLHR9cmV0dXJuKDAsXy5kZWZhdWx0KShTYW5kYm94LGUpLCgwLHAuZGVmYXVsdCkoU2FuZGJveCxbe2tleTpcImRlcGxveUNvbXBvbmVudFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBvPXRoaXM7cmV0dXJuIG5ldyB1LmRlZmF1bHQoZnVuY3Rpb24oaSx1KXt2YXIgcz17dHlwZTpcImNyZWF0ZVwiLGZyb206Yi5kZWZhdWx0LkV4dGVybmFsRGVwbG95QWRkcmVzcyx0bzpiLmRlZmF1bHQuSW50ZXJuYWxEZXBsb3lBZGRyZXNzLGJvZHk6e3VybDp0LHNvdXJjZUNvZGU6ZSxjb25maWc6bixsaWJzOnJ9fTtvLnBvc3RNZXNzYWdlKHMsZnVuY3Rpb24oZSl7MjAwPT09ZS5ib2R5LmNvZGU/aShcImRlcGxveWVkXCIpOnUoZS5ib2R5LmRlc2MpfSl9KX19LHtrZXk6XCJyZW1vdmVDb21wb25lbnRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO3JldHVybiBuZXcgdS5kZWZhdWx0KGZ1bmN0aW9uKG4scil7dmFyIG89e3R5cGU6XCJkZWxldGVcIixmcm9tOmIuZGVmYXVsdC5FeHRlcm5hbERlcGxveUFkZHJlc3MsdG86Yi5kZWZhdWx0LkludGVybmFsRGVwbG95QWRkcmVzcyxib2R5Ont1cmw6ZX19O3QucG9zdE1lc3NhZ2UobyxmdW5jdGlvbihlKXsyMDA9PT1lLmJvZHkuY29kZT9uKFwidW5kZXBsb3llZFwiKTpyKGUuYm9keS5kZXNjKX0pfSl9fSx7a2V5OlwibWF0Y2hlc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj0oMCxvLmRlZmF1bHQpKGUpLmZpbHRlcihmdW5jdGlvbihuKXtyZXR1cm4hKHQuY2FwYWJpbGl0aWVzW25dJiZ0LmNhcGFiaWxpdGllc1tuXT09PWVbbl0pfSk7cmV0dXJuIDA9PT1uLmxlbmd0aHx8IWVbbl19fV0pLFNhbmRib3h9KG0uZGVmYXVsdCkpO3QuZGVmYXVsdD14fV0pfSk7IiwiLy8gdmVyc2lvbjogMC45LjBcbi8vIGRhdGU6IFdlZCBBdWcgMDEgMjAxOCAwOTozNDozNCBHTVQrMDEwMCAoV2VzdGVybiBFdXJvcGVhbiBTdW1tZXIgVGltZSlcbi8vIGxpY2VuY2U6IFxuLyoqXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXG4qXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4qXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4qXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbioqL1xuXG5cbiFmdW5jdGlvbihlLHQpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPXQoKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiUGVyc2lzdGVuY2VNYW5hZ2VyXCIsW10sdCk6XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHM/ZXhwb3J0cy5QZXJzaXN0ZW5jZU1hbmFnZXI9dCgpOihlW1wiXCJdPWVbXCJcIl18fHt9LGVbXCJcIl0uUGVyc2lzdGVuY2VNYW5hZ2VyPXQoKSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBzZWxmP3NlbGY6dGhpcyxmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihlKXtmdW5jdGlvbiB0KHIpe2lmKG5bcl0pcmV0dXJuIG5bcl0uZXhwb3J0czt2YXIgbz1uW3JdPXtpOnIsbDohMSxleHBvcnRzOnt9fTtyZXR1cm4gZVtyXS5jYWxsKG8uZXhwb3J0cyxvLG8uZXhwb3J0cyx0KSxvLmw9ITAsby5leHBvcnRzfXZhciBuPXt9O3JldHVybiB0Lm09ZSx0LmM9bix0LmQ9ZnVuY3Rpb24oZSxuLHIpe3QubyhlLG4pfHxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxuLHtjb25maWd1cmFibGU6ITEsZW51bWVyYWJsZTohMCxnZXQ6cn0pfSx0Lm49ZnVuY3Rpb24oZSl7dmFyIG49ZSYmZS5fX2VzTW9kdWxlP2Z1bmN0aW9uKCl7cmV0dXJuIGUuZGVmYXVsdH06ZnVuY3Rpb24oKXtyZXR1cm4gZX07cmV0dXJuIHQuZChuLFwiYVwiLG4pLG59LHQubz1mdW5jdGlvbihlLHQpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KX0sdC5wPVwiXCIsdCh0LnM9MTgzKX0oezA6ZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmV4cG9ydHM9e3ZlcnNpb246XCIyLjUuN1wifTtcIm51bWJlclwiPT10eXBlb2YgX19lJiYoX19lPW4pfSwxOmZ1bmN0aW9uKGUsdCl7dmFyIG49ZS5leHBvcnRzPVwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5NYXRoPT1NYXRoP3dpbmRvdzpcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZiYmc2VsZi5NYXRoPT1NYXRoP3NlbGY6RnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1wibnVtYmVyXCI9PXR5cGVvZiBfX2cmJihfX2c9bil9LDEwOmZ1bmN0aW9uKGUsdCl7dmFyIG49e30uaGFzT3duUHJvcGVydHk7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIG4uY2FsbChlLHQpfX0sMTE6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oOCksbz1uKDE2KTtlLmV4cG9ydHM9big0KT9mdW5jdGlvbihlLHQsbil7cmV0dXJuIHIuZihlLHQsbygxLG4pKX06ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBlW3RdPW4sZX19LDEzOmZ1bmN0aW9uKGUsdCl7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3RyeXtyZXR1cm4hIWUoKX1jYXRjaChlKXtyZXR1cm4hMH19fSwxNDpmdW5jdGlvbihlLHQsbil7dmFyIHI9bigyNCk7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuKXtpZihyKGUpLHZvaWQgMD09PXQpcmV0dXJuIGU7c3dpdGNoKG4pe2Nhc2UgMTpyZXR1cm4gZnVuY3Rpb24obil7cmV0dXJuIGUuY2FsbCh0LG4pfTtjYXNlIDI6cmV0dXJuIGZ1bmN0aW9uKG4scil7cmV0dXJuIGUuY2FsbCh0LG4scil9O2Nhc2UgMzpyZXR1cm4gZnVuY3Rpb24obixyLG8pe3JldHVybiBlLmNhbGwodCxuLHIsbyl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBlLmFwcGx5KHQsYXJndW1lbnRzKX19fSwxNjpmdW5jdGlvbihlLHQpe2UuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybntlbnVtZXJhYmxlOiEoMSZlKSxjb25maWd1cmFibGU6ISgyJmUpLHdyaXRhYmxlOiEoNCZlKSx2YWx1ZTp0fX19LDE4MzpmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIHI9bigxODQpLG89ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fShyKTt0LmRlZmF1bHQ9by5kZWZhdWx0LGUuZXhwb3J0cz10LmRlZmF1bHR9LDE4NDpmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIG89big1OCksdT1yKG8pLGk9bigzKSxmPXIoaSksYz1uKDUpLGE9cihjKSxsPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtpZigoMCxmLmRlZmF1bHQpKHRoaXMsZSksIXQpdGhyb3cgRXJyb3IoXCJUaGUgUGVyc2lzdGVuY2UgTWFuYWdlciBuZWVkcyB0aGUgbG9jYWxTdG9yYWdlXCIpO3RoaXMubG9jYWxTdG9yYWdlPXR9cmV0dXJuKDAsYS5kZWZhdWx0KShlLFt7a2V5Olwic2V0XCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe3RoaXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oZSwoMCx1LmRlZmF1bHQpKHt2ZXJzaW9uOnQsdmFsdWU6bn0pKX19LHtrZXk6XCJnZXRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO3RyeXtyZXR1cm4gSlNPTi5wYXJzZSh0LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGUpKS52YWx1ZX1jYXRjaChlKXt9fX0se2tleTpcImdldFZlcnNpb25cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO3RyeXtyZXR1cm4gSlNPTi5wYXJzZSh0LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGUpKS52ZXJzaW9ufWNhdGNoKGUpe319fSx7a2V5OlwiZGVsZXRlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShlKX19XSksZX0oKTt0LmRlZmF1bHQ9bCxlLmV4cG9ydHM9dC5kZWZhdWx0fSwyNDpmdW5jdGlvbihlLHQpe2UuZXhwb3J0cz1mdW5jdGlvbihlKXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBlKXRocm93IFR5cGVFcnJvcihlK1wiIGlzIG5vdCBhIGZ1bmN0aW9uIVwiKTtyZXR1cm4gZX19LDI3OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDcpO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQpe2lmKCFyKGUpKXJldHVybiBlO3ZhciBuLG87aWYodCYmXCJmdW5jdGlvblwiPT10eXBlb2Yobj1lLnRvU3RyaW5nKSYmIXIobz1uLmNhbGwoZSkpKXJldHVybiBvO2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mKG49ZS52YWx1ZU9mKSYmIXIobz1uLmNhbGwoZSkpKXJldHVybiBvO2lmKCF0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZihuPWUudG9TdHJpbmcpJiYhcihvPW4uY2FsbChlKSkpcmV0dXJuIG87dGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlXCIpfX0sMjg6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oNyksbz1uKDEpLmRvY3VtZW50LHU9cihvKSYmcihvLmNyZWF0ZUVsZW1lbnQpO2UuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gdT9vLmNyZWF0ZUVsZW1lbnQoZSk6e319fSwzOmZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjt0Ll9fZXNNb2R1bGU9ITAsdC5kZWZhdWx0PWZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX19LDM5OmZ1bmN0aW9uKGUsdCxuKXtlLmV4cG9ydHM9IW4oNCkmJiFuKDEzKShmdW5jdGlvbigpe3JldHVybiA3IT1PYmplY3QuZGVmaW5lUHJvcGVydHkobigyOCkoXCJkaXZcIiksXCJhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiA3fX0pLmF9KX0sNDpmdW5jdGlvbihlLHQsbil7ZS5leHBvcnRzPSFuKDEzKShmdW5jdGlvbigpe3JldHVybiA3IT1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sXCJhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiA3fX0pLmF9KX0sNTpmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7dC5fX2VzTW9kdWxlPSEwO3ZhciByPW4oNTkpLG89ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fShyKTt0LmRlZmF1bHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciByPXRbbl07ci5lbnVtZXJhYmxlPXIuZW51bWVyYWJsZXx8ITEsci5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gciYmKHIud3JpdGFibGU9ITApLCgwLG8uZGVmYXVsdCkoZSxyLmtleSxyKX19cmV0dXJuIGZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gbiYmZSh0LnByb3RvdHlwZSxuKSxyJiZlKHQsciksdH19KCl9LDU4OmZ1bmN0aW9uKGUsdCxuKXtlLmV4cG9ydHM9e2RlZmF1bHQ6big3NiksX19lc01vZHVsZTohMH19LDU5OmZ1bmN0aW9uKGUsdCxuKXtlLmV4cG9ydHM9e2RlZmF1bHQ6big2MSksX19lc01vZHVsZTohMH19LDY6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMSksbz1uKDApLHU9bigxNCksaT1uKDExKSxmPW4oMTApLGM9ZnVuY3Rpb24oZSx0LG4pe3ZhciBhLGwscyxwPWUmYy5GLGQ9ZSZjLkcseT1lJmMuUyx2PWUmYy5QLGg9ZSZjLkIsZz1lJmMuVyx4PWQ/bzpvW3RdfHwob1t0XT17fSksXz14LnByb3RvdHlwZSxiPWQ/cjp5P3JbdF06KHJbdF18fHt9KS5wcm90b3R5cGU7ZCYmKG49dCk7Zm9yKGEgaW4gbikobD0hcCYmYiYmdm9pZCAwIT09YlthXSkmJmYoeCxhKXx8KHM9bD9iW2FdOm5bYV0seFthXT1kJiZcImZ1bmN0aW9uXCIhPXR5cGVvZiBiW2FdP25bYV06aCYmbD91KHMscik6ZyYmYlthXT09cz9mdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbih0LG4scil7aWYodGhpcyBpbnN0YW5jZW9mIGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIG5ldyBlO2Nhc2UgMTpyZXR1cm4gbmV3IGUodCk7Y2FzZSAyOnJldHVybiBuZXcgZSh0LG4pfXJldHVybiBuZXcgZSh0LG4scil9cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtyZXR1cm4gdC5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdH0ocyk6diYmXCJmdW5jdGlvblwiPT10eXBlb2Ygcz91KEZ1bmN0aW9uLmNhbGwscyk6cyx2JiYoKHgudmlydHVhbHx8KHgudmlydHVhbD17fSkpW2FdPXMsZSZjLlImJl8mJiFfW2FdJiZpKF8sYSxzKSkpfTtjLkY9MSxjLkc9MixjLlM9NCxjLlA9OCxjLkI9MTYsYy5XPTMyLGMuVT02NCxjLlI9MTI4LGUuZXhwb3J0cz1jfSw2MTpmdW5jdGlvbihlLHQsbil7big2Mik7dmFyIHI9bigwKS5PYmplY3Q7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gci5kZWZpbmVQcm9wZXJ0eShlLHQsbil9fSw2MjpmdW5jdGlvbihlLHQsbil7dmFyIHI9big2KTtyKHIuUytyLkYqIW4oNCksXCJPYmplY3RcIix7ZGVmaW5lUHJvcGVydHk6big4KS5mfSl9LDc6ZnVuY3Rpb24oZSx0KXtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIGU/bnVsbCE9PWU6XCJmdW5jdGlvblwiPT10eXBlb2YgZX19LDc2OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDApLG89ci5KU09OfHwoci5KU09OPXtzdHJpbmdpZnk6SlNPTi5zdHJpbmdpZnl9KTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIG8uc3RyaW5naWZ5LmFwcGx5KG8sYXJndW1lbnRzKX19LDg6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oOSksbz1uKDM5KSx1PW4oMjcpLGk9T2JqZWN0LmRlZmluZVByb3BlcnR5O3QuZj1uKDQpP09iamVjdC5kZWZpbmVQcm9wZXJ0eTpmdW5jdGlvbihlLHQsbil7aWYocihlKSx0PXUodCwhMCkscihuKSxvKXRyeXtyZXR1cm4gaShlLHQsbil9Y2F0Y2goZSl7fWlmKFwiZ2V0XCJpbiBufHxcInNldFwiaW4gbil0aHJvdyBUeXBlRXJyb3IoXCJBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCFcIik7cmV0dXJuXCJ2YWx1ZVwiaW4gbiYmKGVbdF09bi52YWx1ZSksZX19LDk6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oNyk7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe2lmKCFyKGUpKXRocm93IFR5cGVFcnJvcihlK1wiIGlzIG5vdCBhbiBvYmplY3QhXCIpO3JldHVybiBlfX19KX0pOyIsIi8vIHZlcnNpb246IDAuOS4wXG4vLyBkYXRlOiBXZWQgQXVnIDAxIDIwMTggMDk6MzQ6MzQgR01UKzAxMDAgKFdlc3Rlcm4gRXVyb3BlYW4gU3VtbWVyIFRpbWUpXG4vLyBsaWNlbmNlOiBcbi8qKlxuKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcbiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSURcbiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMXG4qIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXG4qIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQVxuKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHXG4qIENvcHlyaWdodCAyMDE2IEFwaXplZVxuKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTlxuKlxuKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4qIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuKlxuKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuKlxuKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4qIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4qIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qKi9cblxuXG4hZnVuY3Rpb24odCxlKXtcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cyYmXCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1lKCk6XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShcIlJ1bnRpbWVDYXRhbG9ndWVcIixbXSxlKTpcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cz9leHBvcnRzLlJ1bnRpbWVDYXRhbG9ndWU9ZSgpOih0W1wiXCJdPXRbXCJcIl18fHt9LHRbXCJcIl0uUnVudGltZUNhdGFsb2d1ZT1lKCkpfShcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZj9zZWxmOnRoaXMsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShuKXtpZihyW25dKXJldHVybiByW25dLmV4cG9ydHM7dmFyIGk9cltuXT17aTpuLGw6ITEsZXhwb3J0czp7fX07cmV0dXJuIHRbbl0uY2FsbChpLmV4cG9ydHMsaSxpLmV4cG9ydHMsZSksaS5sPSEwLGkuZXhwb3J0c312YXIgcj17fTtyZXR1cm4gZS5tPXQsZS5jPXIsZS5kPWZ1bmN0aW9uKHQscixuKXtlLm8odCxyKXx8T2JqZWN0LmRlZmluZVByb3BlcnR5KHQscix7Y29uZmlndXJhYmxlOiExLGVudW1lcmFibGU6ITAsZ2V0Om59KX0sZS5uPWZ1bmN0aW9uKHQpe3ZhciByPXQmJnQuX19lc01vZHVsZT9mdW5jdGlvbigpe3JldHVybiB0LmRlZmF1bHR9OmZ1bmN0aW9uKCl7cmV0dXJuIHR9O3JldHVybiBlLmQocixcImFcIixyKSxyfSxlLm89ZnVuY3Rpb24odCxlKXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsZSl9LGUucD1cIlwiLGUoZS5zPTE4NSl9KFtmdW5jdGlvbih0LGUpe3ZhciByPXQuZXhwb3J0cz17dmVyc2lvbjpcIjIuNS43XCJ9O1wibnVtYmVyXCI9PXR5cGVvZiBfX2UmJihfX2U9cil9LGZ1bmN0aW9uKHQsZSl7dmFyIHI9dC5leHBvcnRzPVwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5NYXRoPT1NYXRoP3dpbmRvdzpcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZiYmc2VsZi5NYXRoPT1NYXRoP3NlbGY6RnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1wibnVtYmVyXCI9PXR5cGVvZiBfX2cmJihfX2c9cil9LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDM2KShcIndrc1wiKSxpPXIoMjMpLG89cigxKS5TeW1ib2wsYT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBvOyh0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIG5bdF18fChuW3RdPWEmJm9bdF18fChhP286aSkoXCJTeW1ib2wuXCIrdCkpfSkuc3RvcmU9bn0sZnVuY3Rpb24odCxlLHIpe1widXNlIHN0cmljdFwiO2UuX19lc01vZHVsZT0hMCxlLmRlZmF1bHQ9ZnVuY3Rpb24odCxlKXtpZighKHQgaW5zdGFuY2VvZiBlKSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfX0sZnVuY3Rpb24odCxlLHIpe3QuZXhwb3J0cz0hcigxMykoZnVuY3Rpb24oKXtyZXR1cm4gNyE9T2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LFwiYVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gN319KS5hfSl9LGZ1bmN0aW9uKHQsZSxyKXtcInVzZSBzdHJpY3RcIjtlLl9fZXNNb2R1bGU9ITA7dmFyIG49cig1OSksaT1mdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19KG4pO2UuZGVmYXVsdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXtmb3IodmFyIHI9MDtyPGUubGVuZ3RoO3IrKyl7dmFyIG49ZVtyXTtuLmVudW1lcmFibGU9bi5lbnVtZXJhYmxlfHwhMSxuLmNvbmZpZ3VyYWJsZT0hMCxcInZhbHVlXCJpbiBuJiYobi53cml0YWJsZT0hMCksKDAsaS5kZWZhdWx0KSh0LG4ua2V5LG4pfX1yZXR1cm4gZnVuY3Rpb24oZSxyLG4pe3JldHVybiByJiZ0KGUucHJvdG90eXBlLHIpLG4mJnQoZSxuKSxlfX0oKX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoMSksaT1yKDApLG89cigxNCksYT1yKDExKSx1PXIoMTApLHM9ZnVuY3Rpb24odCxlLHIpe3ZhciBjLGwsZixoPXQmcy5GLHA9dCZzLkcsZD10JnMuUyx2PXQmcy5QLHk9dCZzLkIsbT10JnMuVyxnPXA/aTppW2VdfHwoaVtlXT17fSksXz1nLnByb3RvdHlwZSxPPXA/bjpkP25bZV06KG5bZV18fHt9KS5wcm90b3R5cGU7cCYmKHI9ZSk7Zm9yKGMgaW4gcikobD0haCYmTyYmdm9pZCAwIT09T1tjXSkmJnUoZyxjKXx8KGY9bD9PW2NdOnJbY10sZ1tjXT1wJiZcImZ1bmN0aW9uXCIhPXR5cGVvZiBPW2NdP3JbY106eSYmbD9vKGYsbik6bSYmT1tjXT09Zj9mdW5jdGlvbih0KXt2YXIgZT1mdW5jdGlvbihlLHIsbil7aWYodGhpcyBpbnN0YW5jZW9mIHQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIG5ldyB0O2Nhc2UgMTpyZXR1cm4gbmV3IHQoZSk7Y2FzZSAyOnJldHVybiBuZXcgdChlLHIpfXJldHVybiBuZXcgdChlLHIsbil9cmV0dXJuIHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtyZXR1cm4gZS5wcm90b3R5cGU9dC5wcm90b3R5cGUsZX0oZik6diYmXCJmdW5jdGlvblwiPT10eXBlb2YgZj9vKEZ1bmN0aW9uLmNhbGwsZik6Zix2JiYoKGcudmlydHVhbHx8KGcudmlydHVhbD17fSkpW2NdPWYsdCZzLlImJl8mJiFfW2NdJiZhKF8sYyxmKSkpfTtzLkY9MSxzLkc9MixzLlM9NCxzLlA9OCxzLkI9MTYscy5XPTMyLHMuVT02NCxzLlI9MTI4LHQuZXhwb3J0cz1zfSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgdD9udWxsIT09dDpcImZ1bmN0aW9uXCI9PXR5cGVvZiB0fX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoOSksaT1yKDM5KSxvPXIoMjcpLGE9T2JqZWN0LmRlZmluZVByb3BlcnR5O2UuZj1yKDQpP09iamVjdC5kZWZpbmVQcm9wZXJ0eTpmdW5jdGlvbih0LGUscil7aWYobih0KSxlPW8oZSwhMCksbihyKSxpKXRyeXtyZXR1cm4gYSh0LGUscil9Y2F0Y2godCl7fWlmKFwiZ2V0XCJpbiByfHxcInNldFwiaW4gcil0aHJvdyBUeXBlRXJyb3IoXCJBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCFcIik7cmV0dXJuXCJ2YWx1ZVwiaW4gciYmKHRbZV09ci52YWx1ZSksdH19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDcpO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtpZighbih0KSl0aHJvdyBUeXBlRXJyb3IodCtcIiBpcyBub3QgYW4gb2JqZWN0IVwiKTtyZXR1cm4gdH19LGZ1bmN0aW9uKHQsZSl7dmFyIHI9e30uaGFzT3duUHJvcGVydHk7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHIuY2FsbCh0LGUpfX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoOCksaT1yKDE2KTt0LmV4cG9ydHM9cig0KT9mdW5jdGlvbih0LGUscil7cmV0dXJuIG4uZih0LGUsaSgxLHIpKX06ZnVuY3Rpb24odCxlLHIpe3JldHVybiB0W2VdPXIsdH19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDU1KSxpPXIoMzApO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gbihpKHQpKX19LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3RyeXtyZXR1cm4hIXQoKX1jYXRjaCh0KXtyZXR1cm4hMH19fSxmdW5jdGlvbih0LGUscil7dmFyIG49cigyNCk7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxyKXtpZihuKHQpLHZvaWQgMD09PWUpcmV0dXJuIHQ7c3dpdGNoKHIpe2Nhc2UgMTpyZXR1cm4gZnVuY3Rpb24ocil7cmV0dXJuIHQuY2FsbChlLHIpfTtjYXNlIDI6cmV0dXJuIGZ1bmN0aW9uKHIsbil7cmV0dXJuIHQuY2FsbChlLHIsbil9O2Nhc2UgMzpyZXR1cm4gZnVuY3Rpb24ocixuLGkpe3JldHVybiB0LmNhbGwoZSxyLG4saSl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiB0LmFwcGx5KGUsYXJndW1lbnRzKX19fSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz0hMH0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXtyZXR1cm57ZW51bWVyYWJsZTohKDEmdCksY29uZmlndXJhYmxlOiEoMiZ0KSx3cml0YWJsZTohKDQmdCksdmFsdWU6ZX19fSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz17fX0sZnVuY3Rpb24odCxlLHIpe3QuZXhwb3J0cz17ZGVmYXVsdDpyKDEwMiksX19lc01vZHVsZTohMH19LCxmdW5jdGlvbih0LGUscil7dmFyIG49cig0NSksaT1yKDM3KTt0LmV4cG9ydHM9T2JqZWN0LmtleXN8fGZ1bmN0aW9uKHQpe3JldHVybiBuKHQsaSl9fSxmdW5jdGlvbih0LGUpe3ZhciByPXt9LnRvU3RyaW5nO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gci5jYWxsKHQpLnNsaWNlKDgsLTEpfX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuLGk7IWZ1bmN0aW9uKG8sYSl7XCJ1c2Ugc3RyaWN0XCI7bj1hLHZvaWQgMCE9PShpPVwiZnVuY3Rpb25cIj09dHlwZW9mIG4/bi5jYWxsKGUscixlLHQpOm4pJiYodC5leHBvcnRzPWkpfSgwLGZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdCh0LGUpe3ZhciByPXRbZV07aWYoXCJmdW5jdGlvblwiPT10eXBlb2Ygci5iaW5kKXJldHVybiByLmJpbmQodCk7dHJ5e3JldHVybiBGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5jYWxsKHIsdCl9Y2F0Y2goZSl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseS5hcHBseShyLFt0LGFyZ3VtZW50c10pfX19ZnVuY3Rpb24gZShlKXtyZXR1cm5cImRlYnVnXCI9PT1lJiYoZT1cImxvZ1wiKSx0eXBlb2YgY29uc29sZSE9PXUmJih2b2lkIDAhPT1jb25zb2xlW2VdP3QoY29uc29sZSxlKTp2b2lkIDAhPT1jb25zb2xlLmxvZz90KGNvbnNvbGUsXCJsb2dcIik6YSl9ZnVuY3Rpb24gcih0LGUpe2Zvcih2YXIgcj0wO3I8cy5sZW5ndGg7cisrKXt2YXIgbj1zW3JdO3RoaXNbbl09cjx0P2E6dGhpcy5tZXRob2RGYWN0b3J5KG4sdCxlKX10aGlzLmxvZz10aGlzLmRlYnVnfWZ1bmN0aW9uIG4odCxlLG4pe3JldHVybiBmdW5jdGlvbigpe3R5cGVvZiBjb25zb2xlIT09dSYmKHIuY2FsbCh0aGlzLGUsbiksdGhpc1t0XS5hcHBseSh0aGlzLGFyZ3VtZW50cykpfX1mdW5jdGlvbiBpKHQscixpKXtyZXR1cm4gZSh0KXx8bi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gbyh0LGUsbil7ZnVuY3Rpb24gbyh0KXt2YXIgZT0oc1t0XXx8XCJzaWxlbnRcIikudG9VcHBlckNhc2UoKTtpZih0eXBlb2Ygd2luZG93IT09dSl7dHJ5e3JldHVybiB2b2lkKHdpbmRvdy5sb2NhbFN0b3JhZ2VbZl09ZSl9Y2F0Y2godCl7fXRyeXt3aW5kb3cuZG9jdW1lbnQuY29va2llPWVuY29kZVVSSUNvbXBvbmVudChmKStcIj1cIitlK1wiO1wifWNhdGNoKHQpe319fWZ1bmN0aW9uIGEoKXt2YXIgdDtpZih0eXBlb2Ygd2luZG93IT09dSl7dHJ5e3Q9d2luZG93LmxvY2FsU3RvcmFnZVtmXX1jYXRjaCh0KXt9aWYodHlwZW9mIHQ9PT11KXRyeXt2YXIgZT13aW5kb3cuZG9jdW1lbnQuY29va2llLHI9ZS5pbmRleE9mKGVuY29kZVVSSUNvbXBvbmVudChmKStcIj1cIik7LTEhPT1yJiYodD0vXihbXjtdKykvLmV4ZWMoZS5zbGljZShyKSlbMV0pfWNhdGNoKHQpe31yZXR1cm4gdm9pZCAwPT09bC5sZXZlbHNbdF0mJih0PXZvaWQgMCksdH19dmFyIGMsbD10aGlzLGY9XCJsb2dsZXZlbFwiO3QmJihmKz1cIjpcIit0KSxsLm5hbWU9dCxsLmxldmVscz17VFJBQ0U6MCxERUJVRzoxLElORk86MixXQVJOOjMsRVJST1I6NCxTSUxFTlQ6NX0sbC5tZXRob2RGYWN0b3J5PW58fGksbC5nZXRMZXZlbD1mdW5jdGlvbigpe3JldHVybiBjfSxsLnNldExldmVsPWZ1bmN0aW9uKGUsbil7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGUmJnZvaWQgMCE9PWwubGV2ZWxzW2UudG9VcHBlckNhc2UoKV0mJihlPWwubGV2ZWxzW2UudG9VcHBlckNhc2UoKV0pLCEoXCJudW1iZXJcIj09dHlwZW9mIGUmJmU+PTAmJmU8PWwubGV2ZWxzLlNJTEVOVCkpdGhyb3dcImxvZy5zZXRMZXZlbCgpIGNhbGxlZCB3aXRoIGludmFsaWQgbGV2ZWw6IFwiK2U7aWYoYz1lLCExIT09biYmbyhlKSxyLmNhbGwobCxlLHQpLHR5cGVvZiBjb25zb2xlPT09dSYmZTxsLmxldmVscy5TSUxFTlQpcmV0dXJuXCJObyBjb25zb2xlIGF2YWlsYWJsZSBmb3IgbG9nZ2luZ1wifSxsLnNldERlZmF1bHRMZXZlbD1mdW5jdGlvbih0KXthKCl8fGwuc2V0TGV2ZWwodCwhMSl9LGwuZW5hYmxlQWxsPWZ1bmN0aW9uKHQpe2wuc2V0TGV2ZWwobC5sZXZlbHMuVFJBQ0UsdCl9LGwuZGlzYWJsZUFsbD1mdW5jdGlvbih0KXtsLnNldExldmVsKGwubGV2ZWxzLlNJTEVOVCx0KX07dmFyIGg9YSgpO251bGw9PWgmJihoPW51bGw9PWU/XCJXQVJOXCI6ZSksbC5zZXRMZXZlbChoLCExKX12YXIgYT1mdW5jdGlvbigpe30sdT1cInVuZGVmaW5lZFwiLHM9W1widHJhY2VcIixcImRlYnVnXCIsXCJpbmZvXCIsXCJ3YXJuXCIsXCJlcnJvclwiXSxjPW5ldyBvLGw9e307Yy5nZXRMb2dnZXI9ZnVuY3Rpb24odCl7aWYoXCJzdHJpbmdcIiE9dHlwZW9mIHR8fFwiXCI9PT10KXRocm93IG5ldyBUeXBlRXJyb3IoXCJZb3UgbXVzdCBzdXBwbHkgYSBuYW1lIHdoZW4gY3JlYXRpbmcgYSBsb2dnZXIuXCIpO3ZhciBlPWxbdF07cmV0dXJuIGV8fChlPWxbdF09bmV3IG8odCxjLmdldExldmVsKCksYy5tZXRob2RGYWN0b3J5KSksZX07dmFyIGY9dHlwZW9mIHdpbmRvdyE9PXU/d2luZG93LmxvZzp2b2lkIDA7cmV0dXJuIGMubm9Db25mbGljdD1mdW5jdGlvbigpe3JldHVybiB0eXBlb2Ygd2luZG93IT09dSYmd2luZG93LmxvZz09PWMmJih3aW5kb3cubG9nPWYpLGN9LGMuZ2V0TG9nZ2Vycz1mdW5jdGlvbigpe3JldHVybiBsfSxjfSl9LGZ1bmN0aW9uKHQsZSl7dmFyIHI9MCxuPU1hdGgucmFuZG9tKCk7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVyblwiU3ltYm9sKFwiLmNvbmNhdCh2b2lkIDA9PT10P1wiXCI6dCxcIilfXCIsKCsrcituKS50b1N0cmluZygzNikpfX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgdCl0aHJvdyBUeXBlRXJyb3IodCtcIiBpcyBub3QgYSBmdW5jdGlvbiFcIik7cmV0dXJuIHR9fSxmdW5jdGlvbih0LGUscil7dC5leHBvcnRzPXtkZWZhdWx0OnIoOTEpLF9fZXNNb2R1bGU6ITB9fSxmdW5jdGlvbih0LGUscil7dmFyIG49cig4KS5mLGk9cigxMCksbz1yKDIpKFwidG9TdHJpbmdUYWdcIik7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxyKXt0JiYhaSh0PXI/dDp0LnByb3RvdHlwZSxvKSYmbih0LG8se2NvbmZpZ3VyYWJsZTohMCx2YWx1ZTplfSl9fSxmdW5jdGlvbih0LGUscil7dmFyIG49cig3KTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXtpZighbih0KSlyZXR1cm4gdDt2YXIgcixpO2lmKGUmJlwiZnVuY3Rpb25cIj09dHlwZW9mKHI9dC50b1N0cmluZykmJiFuKGk9ci5jYWxsKHQpKSlyZXR1cm4gaTtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZihyPXQudmFsdWVPZikmJiFuKGk9ci5jYWxsKHQpKSlyZXR1cm4gaTtpZighZSYmXCJmdW5jdGlvblwiPT10eXBlb2Yocj10LnRvU3RyaW5nKSYmIW4oaT1yLmNhbGwodCkpKXJldHVybiBpO3Rocm93IFR5cGVFcnJvcihcIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZVwiKX19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDcpLGk9cigxKS5kb2N1bWVudCxvPW4oaSkmJm4oaS5jcmVhdGVFbGVtZW50KTt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIG8/aS5jcmVhdGVFbGVtZW50KHQpOnt9fX0sZnVuY3Rpb24odCxlKXtlLmY9e30ucHJvcGVydHlJc0VudW1lcmFibGV9LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe2lmKHZvaWQgMD09dCl0aHJvdyBUeXBlRXJyb3IoXCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgXCIrdCk7cmV0dXJuIHR9fSxmdW5jdGlvbih0LGUpe3ZhciByPU1hdGguY2VpbCxuPU1hdGguZmxvb3I7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBpc05hTih0PSt0KT8wOih0PjA/bjpyKSh0KX19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDMwKTt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIE9iamVjdChuKHQpKX19LGZ1bmN0aW9uKHQsZSxyKXtcInVzZSBzdHJpY3RcIjtlLl9fZXNNb2R1bGU9ITA7dmFyIG49cig0NyksaT1mdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19KG4pO2UuZGVmYXVsdD1mdW5jdGlvbih0LGUpe2lmKCF0KXRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTtyZXR1cm4hZXx8XCJvYmplY3RcIiE9PSh2b2lkIDA9PT1lP1widW5kZWZpbmVkXCI6KDAsaS5kZWZhdWx0KShlKSkmJlwiZnVuY3Rpb25cIiE9dHlwZW9mIGU/dDplfX0sZnVuY3Rpb24odCxlLHIpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIG4odCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OntkZWZhdWx0OnR9fWUuX19lc01vZHVsZT0hMDt2YXIgaT1yKDkzKSxvPW4oaSksYT1yKDk3KSx1PW4oYSkscz1yKDQ3KSxjPW4ocyk7ZS5kZWZhdWx0PWZ1bmN0aW9uKHQsZSl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgZSYmbnVsbCE9PWUpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIrKHZvaWQgMD09PWU/XCJ1bmRlZmluZWRcIjooMCxjLmRlZmF1bHQpKGUpKSk7dC5wcm90b3R5cGU9KDAsdS5kZWZhdWx0KShlJiZlLnByb3RvdHlwZSx7Y29uc3RydWN0b3I6e3ZhbHVlOnQsZW51bWVyYWJsZTohMSx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksZSYmKG8uZGVmYXVsdD8oMCxvLmRlZmF1bHQpKHQsZSk6dC5fX3Byb3RvX189ZSl9fSxmdW5jdGlvbih0LGUscil7dmFyIG49cigzNikoXCJrZXlzXCIpLGk9cigyMyk7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBuW3RdfHwoblt0XT1pKHQpKX19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDApLGk9cigxKSxvPWlbXCJfX2NvcmUtanNfc2hhcmVkX19cIl18fChpW1wiX19jb3JlLWpzX3NoYXJlZF9fXCJdPXt9KTsodC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG9bdF18fChvW3RdPXZvaWQgMCE9PWU/ZTp7fSl9KShcInZlcnNpb25zXCIsW10pLnB1c2goe3ZlcnNpb246bi52ZXJzaW9uLG1vZGU6cigxNSk/XCJwdXJlXCI6XCJnbG9iYWxcIixjb3B5cmlnaHQ6XCLCqSAyMDE4IERlbmlzIFB1c2hrYXJldiAoemxvaXJvY2sucnUpXCJ9KX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9XCJjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2ZcIi5zcGxpdChcIixcIil9LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDkpLGk9cig3Miksbz1yKDM3KSxhPXIoMzUpKFwiSUVfUFJPVE9cIiksdT1mdW5jdGlvbigpe30scz1mdW5jdGlvbigpe3ZhciB0LGU9cigyOCkoXCJpZnJhbWVcIiksbj1vLmxlbmd0aDtmb3IoZS5zdHlsZS5kaXNwbGF5PVwibm9uZVwiLHIoNTYpLmFwcGVuZENoaWxkKGUpLGUuc3JjPVwiamF2YXNjcmlwdDpcIix0PWUuY29udGVudFdpbmRvdy5kb2N1bWVudCx0Lm9wZW4oKSx0LndyaXRlKFwiPHNjcmlwdD5kb2N1bWVudC5GPU9iamVjdDxcXC9zY3JpcHQ+XCIpLHQuY2xvc2UoKSxzPXQuRjtuLS07KWRlbGV0ZSBzLnByb3RvdHlwZVtvW25dXTtyZXR1cm4gcygpfTt0LmV4cG9ydHM9T2JqZWN0LmNyZWF0ZXx8ZnVuY3Rpb24odCxlKXt2YXIgcjtyZXR1cm4gbnVsbCE9PXQ/KHUucHJvdG90eXBlPW4odCkscj1uZXcgdSx1LnByb3RvdHlwZT1udWxsLHJbYV09dCk6cj1zKCksdm9pZCAwPT09ZT9yOmkocixlKX19LGZ1bmN0aW9uKHQsZSxyKXt0LmV4cG9ydHM9IXIoNCkmJiFyKDEzKShmdW5jdGlvbigpe3JldHVybiA3IT1PYmplY3QuZGVmaW5lUHJvcGVydHkocigyOCkoXCJkaXZcIiksXCJhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiA3fX0pLmF9KX0sZnVuY3Rpb24odCxlLHIpe2UuZj1yKDIpfSxmdW5jdGlvbih0LGUscil7dmFyIG49cigxKSxpPXIoMCksbz1yKDE1KSxhPXIoNDApLHU9cig4KS5mO3QuZXhwb3J0cz1mdW5jdGlvbih0KXt2YXIgZT1pLlN5bWJvbHx8KGkuU3ltYm9sPW8/e306bi5TeW1ib2x8fHt9KTtcIl9cIj09dC5jaGFyQXQoMCl8fHQgaW4gZXx8dShlLHQse3ZhbHVlOmEuZih0KX0pfX0sLGZ1bmN0aW9uKHQsZSl7ZS5mPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHN9LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDYpLGk9cigwKSxvPXIoMTMpO3QuZXhwb3J0cz1mdW5jdGlvbih0LGUpe3ZhciByPShpLk9iamVjdHx8e30pW3RdfHxPYmplY3RbdF0sYT17fTthW3RdPWUociksbihuLlMrbi5GKm8oZnVuY3Rpb24oKXtyKDEpfSksXCJPYmplY3RcIixhKX19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDEwKSxpPXIoMTIpLG89cig2NCkoITEpLGE9cigzNSkoXCJJRV9QUk9UT1wiKTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXt2YXIgcix1PWkodCkscz0wLGM9W107Zm9yKHIgaW4gdSlyIT1hJiZuKHUscikmJmMucHVzaChyKTtmb3IoO2UubGVuZ3RoPnM7KW4odSxyPWVbcysrXSkmJih+byhjLHIpfHxjLnB1c2gocikpO3JldHVybiBjfX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoMjkpLGk9cigxNiksbz1yKDEyKSxhPXIoMjcpLHU9cigxMCkscz1yKDM5KSxjPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7ZS5mPXIoNCk/YzpmdW5jdGlvbih0LGUpe2lmKHQ9byh0KSxlPWEoZSwhMCkscyl0cnl7cmV0dXJuIGModCxlKX1jYXRjaCh0KXt9aWYodSh0LGUpKXJldHVybiBpKCFuLmYuY2FsbCh0LGUpLHRbZV0pfX0sZnVuY3Rpb24odCxlLHIpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIG4odCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OntkZWZhdWx0OnR9fWUuX19lc01vZHVsZT0hMDt2YXIgaT1yKDc5KSxvPW4oaSksYT1yKDgxKSx1PW4oYSkscz1cImZ1bmN0aW9uXCI9PXR5cGVvZiB1LmRlZmF1bHQmJlwic3ltYm9sXCI9PXR5cGVvZiBvLmRlZmF1bHQ/ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdS5kZWZhdWx0JiZ0LmNvbnN0cnVjdG9yPT09dS5kZWZhdWx0JiZ0IT09dS5kZWZhdWx0LnByb3RvdHlwZT9cInN5bWJvbFwiOnR5cGVvZiB0fTtlLmRlZmF1bHQ9XCJmdW5jdGlvblwiPT10eXBlb2YgdS5kZWZhdWx0JiZcInN5bWJvbFwiPT09cyhvLmRlZmF1bHQpP2Z1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10P1widW5kZWZpbmVkXCI6cyh0KX06ZnVuY3Rpb24odCl7cmV0dXJuIHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHUuZGVmYXVsdCYmdC5jb25zdHJ1Y3Rvcj09PXUuZGVmYXVsdCYmdCE9PXUuZGVmYXVsdC5wcm90b3R5cGU/XCJzeW1ib2xcIjp2b2lkIDA9PT10P1widW5kZWZpbmVkXCI6cyh0KX19LGZ1bmN0aW9uKHQsZSxyKXtcInVzZSBzdHJpY3RcIjt2YXIgbj1yKDE1KSxpPXIoNiksbz1yKDUwKSxhPXIoMTEpLHU9cigxNykscz1yKDcxKSxjPXIoMjYpLGw9cig1MyksZj1yKDIpKFwiaXRlcmF0b3JcIiksaD0hKFtdLmtleXMmJlwibmV4dFwiaW5bXS5rZXlzKCkpLHA9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxyLGQsdix5LG0pe3MocixlLGQpO3ZhciBnLF8sTyxiPWZ1bmN0aW9uKHQpe2lmKCFoJiZ0IGluIHcpcmV0dXJuIHdbdF07c3dpdGNoKHQpe2Nhc2VcImtleXNcIjpjYXNlXCJ2YWx1ZXNcIjpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodGhpcyx0KX19cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyByKHRoaXMsdCl9fSxFPWUrXCIgSXRlcmF0b3JcIixQPVwidmFsdWVzXCI9PXYsUz0hMSx3PXQucHJvdG90eXBlLFI9d1tmXXx8d1tcIkBAaXRlcmF0b3JcIl18fHYmJndbdl0sVD1SfHxiKHYpLGs9dj9QP2IoXCJlbnRyaWVzXCIpOlQ6dm9pZCAwLE09XCJBcnJheVwiPT1lP3cuZW50cmllc3x8UjpSO2lmKE0mJihPPWwoTS5jYWxsKG5ldyB0KSkpIT09T2JqZWN0LnByb3RvdHlwZSYmTy5uZXh0JiYoYyhPLEUsITApLG58fFwiZnVuY3Rpb25cIj09dHlwZW9mIE9bZl18fGEoTyxmLHApKSxQJiZSJiZcInZhbHVlc1wiIT09Ui5uYW1lJiYoUz0hMCxUPWZ1bmN0aW9uKCl7cmV0dXJuIFIuY2FsbCh0aGlzKX0pLG4mJiFtfHwhaCYmIVMmJndbZl18fGEodyxmLFQpLHVbZV09VCx1W0VdPXAsdilpZihnPXt2YWx1ZXM6UD9UOmIoXCJ2YWx1ZXNcIiksa2V5czp5P1Q6YihcImtleXNcIiksZW50cmllczprfSxtKWZvcihfIGluIGcpXyBpbiB3fHxvKHcsXyxnW19dKTtlbHNlIGkoaS5QK2kuRiooaHx8UyksZSxnKTtyZXR1cm4gZ319LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDMxKSxpPU1hdGgubWluO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gdD4wP2kobih0KSw5MDA3MTk5MjU0NzQwOTkxKTowfX0sZnVuY3Rpb24odCxlLHIpe3QuZXhwb3J0cz1yKDExKX0sZnVuY3Rpb24odCxlLHIpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIG4odCl7dmFyIGUscjt0aGlzLnByb21pc2U9bmV3IHQoZnVuY3Rpb24odCxuKXtpZih2b2lkIDAhPT1lfHx2b2lkIDAhPT1yKXRocm93IFR5cGVFcnJvcihcIkJhZCBQcm9taXNlIGNvbnN0cnVjdG9yXCIpO2U9dCxyPW59KSx0aGlzLnJlc29sdmU9aShlKSx0aGlzLnJlamVjdD1pKHIpfXZhciBpPXIoMjQpO3QuZXhwb3J0cy5mPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KX19LGZ1bmN0aW9uKHQsZSxyKXtcInVzZSBzdHJpY3RcIjt2YXIgbj1yKDcwKSghMCk7cig0OCkoU3RyaW5nLFwiU3RyaW5nXCIsZnVuY3Rpb24odCl7dGhpcy5fdD1TdHJpbmcodCksdGhpcy5faT0wfSxmdW5jdGlvbigpe3ZhciB0LGU9dGhpcy5fdCxyPXRoaXMuX2k7cmV0dXJuIHI+PWUubGVuZ3RoP3t2YWx1ZTp2b2lkIDAsZG9uZTohMH06KHQ9bihlLHIpLHRoaXMuX2krPXQubGVuZ3RoLHt2YWx1ZTp0LGRvbmU6ITF9KX0pfSxmdW5jdGlvbih0LGUscil7dmFyIG49cigxMCksaT1yKDMyKSxvPXIoMzUpKFwiSUVfUFJPVE9cIiksYT1PYmplY3QucHJvdG90eXBlO3QuZXhwb3J0cz1PYmplY3QuZ2V0UHJvdG90eXBlT2Z8fGZ1bmN0aW9uKHQpe3JldHVybiB0PWkodCksbih0LG8pP3Rbb106XCJmdW5jdGlvblwiPT10eXBlb2YgdC5jb25zdHJ1Y3RvciYmdCBpbnN0YW5jZW9mIHQuY29uc3RydWN0b3I/dC5jb25zdHJ1Y3Rvci5wcm90b3R5cGU6dCBpbnN0YW5jZW9mIE9iamVjdD9hOm51bGx9fSxmdW5jdGlvbih0LGUscil7cig3Myk7Zm9yKHZhciBuPXIoMSksaT1yKDExKSxvPXIoMTcpLGE9cigyKShcInRvU3RyaW5nVGFnXCIpLHU9XCJDU1NSdWxlTGlzdCxDU1NTdHlsZURlY2xhcmF0aW9uLENTU1ZhbHVlTGlzdCxDbGllbnRSZWN0TGlzdCxET01SZWN0TGlzdCxET01TdHJpbmdMaXN0LERPTVRva2VuTGlzdCxEYXRhVHJhbnNmZXJJdGVtTGlzdCxGaWxlTGlzdCxIVE1MQWxsQ29sbGVjdGlvbixIVE1MQ29sbGVjdGlvbixIVE1MRm9ybUVsZW1lbnQsSFRNTFNlbGVjdEVsZW1lbnQsTWVkaWFMaXN0LE1pbWVUeXBlQXJyYXksTmFtZWROb2RlTWFwLE5vZGVMaXN0LFBhaW50UmVxdWVzdExpc3QsUGx1Z2luLFBsdWdpbkFycmF5LFNWR0xlbmd0aExpc3QsU1ZHTnVtYmVyTGlzdCxTVkdQYXRoU2VnTGlzdCxTVkdQb2ludExpc3QsU1ZHU3RyaW5nTGlzdCxTVkdUcmFuc2Zvcm1MaXN0LFNvdXJjZUJ1ZmZlckxpc3QsU3R5bGVTaGVldExpc3QsVGV4dFRyYWNrQ3VlTGlzdCxUZXh0VHJhY2tMaXN0LFRvdWNoTGlzdFwiLnNwbGl0KFwiLFwiKSxzPTA7czx1Lmxlbmd0aDtzKyspe3ZhciBjPXVbc10sbD1uW2NdLGY9bCYmbC5wcm90b3R5cGU7ZiYmIWZbYV0mJmkoZixhLGMpLG9bY109by5BcnJheX19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDIxKTt0LmV4cG9ydHM9T2JqZWN0KFwielwiKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKT9PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuXCJTdHJpbmdcIj09bih0KT90LnNwbGl0KFwiXCIpOk9iamVjdCh0KX19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDEpLmRvY3VtZW50O3QuZXhwb3J0cz1uJiZuLmRvY3VtZW50RWxlbWVudH0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoNDUpLGk9cigzNykuY29uY2F0KFwibGVuZ3RoXCIsXCJwcm90b3R5cGVcIik7ZS5mPU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzfHxmdW5jdGlvbih0KXtyZXR1cm4gbih0LGkpfX0sZnVuY3Rpb24odCxlLHIpe3QuZXhwb3J0cz17ZGVmYXVsdDpyKDc2KSxfX2VzTW9kdWxlOiEwfX0sZnVuY3Rpb24odCxlLHIpe3QuZXhwb3J0cz17ZGVmYXVsdDpyKDYxKSxfX2VzTW9kdWxlOiEwfX0sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSxyKXtyKDYyKTt2YXIgbj1yKDApLk9iamVjdDt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlLHIpe3JldHVybiBuLmRlZmluZVByb3BlcnR5KHQsZSxyKX19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDYpO24obi5TK24uRiohcig0KSxcIk9iamVjdFwiLHtkZWZpbmVQcm9wZXJ0eTpyKDgpLmZ9KX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoMjEpLGk9cigyKShcInRvU3RyaW5nVGFnXCIpLG89XCJBcmd1bWVudHNcIj09bihmdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHN9KCkpLGE9ZnVuY3Rpb24odCxlKXt0cnl7cmV0dXJuIHRbZV19Y2F0Y2godCl7fX07dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3ZhciBlLHIsdTtyZXR1cm4gdm9pZCAwPT09dD9cIlVuZGVmaW5lZFwiOm51bGw9PT10P1wiTnVsbFwiOlwic3RyaW5nXCI9PXR5cGVvZihyPWEoZT1PYmplY3QodCksaSkpP3I6bz9uKGUpOlwiT2JqZWN0XCI9PSh1PW4oZSkpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBlLmNhbGxlZT9cIkFyZ3VtZW50c1wiOnV9fSxmdW5jdGlvbih0LGUscil7dmFyIG49cigxMiksaT1yKDQ5KSxvPXIoNjUpO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxyLGEpe3ZhciB1LHM9bihlKSxjPWkocy5sZW5ndGgpLGw9byhhLGMpO2lmKHQmJnIhPXIpe2Zvcig7Yz5sOylpZigodT1zW2wrK10pIT11KXJldHVybiEwfWVsc2UgZm9yKDtjPmw7bCsrKWlmKCh0fHxsIGluIHMpJiZzW2xdPT09cilyZXR1cm4gdHx8bHx8MDtyZXR1cm4hdCYmLTF9fX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoMzEpLGk9TWF0aC5tYXgsbz1NYXRoLm1pbjt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD1uKHQpLHQ8MD9pKHQrZSwwKTpvKHQsZSl9fSxmdW5jdGlvbih0LGUscil7dmFyIG49cig5KSxpPXIoMjQpLG89cigyKShcInNwZWNpZXNcIik7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7dmFyIHIsYT1uKHQpLmNvbnN0cnVjdG9yO3JldHVybiB2b2lkIDA9PT1hfHx2b2lkIDA9PShyPW4oYSlbb10pP2U6aShyKX19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbixpLG8sYT1yKDE0KSx1PXIoMTA4KSxzPXIoNTYpLGM9cigyOCksbD1yKDEpLGY9bC5wcm9jZXNzLGg9bC5zZXRJbW1lZGlhdGUscD1sLmNsZWFySW1tZWRpYXRlLGQ9bC5NZXNzYWdlQ2hhbm5lbCx2PWwuRGlzcGF0Y2gseT0wLG09e30sZz1mdW5jdGlvbigpe3ZhciB0PSt0aGlzO2lmKG0uaGFzT3duUHJvcGVydHkodCkpe3ZhciBlPW1bdF07ZGVsZXRlIG1bdF0sZSgpfX0sXz1mdW5jdGlvbih0KXtnLmNhbGwodC5kYXRhKX07aCYmcHx8KGg9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPVtdLHI9MTthcmd1bWVudHMubGVuZ3RoPnI7KWUucHVzaChhcmd1bWVudHNbcisrXSk7cmV0dXJuIG1bKyt5XT1mdW5jdGlvbigpe3UoXCJmdW5jdGlvblwiPT10eXBlb2YgdD90OkZ1bmN0aW9uKHQpLGUpfSxuKHkpLHl9LHA9ZnVuY3Rpb24odCl7ZGVsZXRlIG1bdF19LFwicHJvY2Vzc1wiPT1yKDIxKShmKT9uPWZ1bmN0aW9uKHQpe2YubmV4dFRpY2soYShnLHQsMSkpfTp2JiZ2Lm5vdz9uPWZ1bmN0aW9uKHQpe3Yubm93KGEoZyx0LDEpKX06ZD8oaT1uZXcgZCxvPWkucG9ydDIsaS5wb3J0MS5vbm1lc3NhZ2U9XyxuPWEoby5wb3N0TWVzc2FnZSxvLDEpKTpsLmFkZEV2ZW50TGlzdGVuZXImJlwiZnVuY3Rpb25cIj09dHlwZW9mIHBvc3RNZXNzYWdlJiYhbC5pbXBvcnRTY3JpcHRzPyhuPWZ1bmN0aW9uKHQpe2wucG9zdE1lc3NhZ2UodCtcIlwiLFwiKlwiKX0sbC5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLF8sITEpKTpuPVwib25yZWFkeXN0YXRlY2hhbmdlXCJpbiBjKFwic2NyaXB0XCIpP2Z1bmN0aW9uKHQpe3MuYXBwZW5kQ2hpbGQoYyhcInNjcmlwdFwiKSkub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7cy5yZW1vdmVDaGlsZCh0aGlzKSxnLmNhbGwodCl9fTpmdW5jdGlvbih0KXtzZXRUaW1lb3V0KGEoZyx0LDEpLDApfSksdC5leHBvcnRzPXtzZXQ6aCxjbGVhcjpwfX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7dHJ5e3JldHVybntlOiExLHY6dCgpfX1jYXRjaCh0KXtyZXR1cm57ZTohMCx2OnR9fX19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDkpLGk9cig3KSxvPXIoNTEpO3QuZXhwb3J0cz1mdW5jdGlvbih0LGUpe2lmKG4odCksaShlKSYmZS5jb25zdHJ1Y3Rvcj09PXQpcmV0dXJuIGU7dmFyIHI9by5mKHQpO3JldHVybigwLHIucmVzb2x2ZSkoZSksci5wcm9taXNlfX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoMzEpLGk9cigzMCk7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlLHIpe3ZhciBvLGEsdT1TdHJpbmcoaShlKSkscz1uKHIpLGM9dS5sZW5ndGg7cmV0dXJuIHM8MHx8cz49Yz90P1wiXCI6dm9pZCAwOihvPXUuY2hhckNvZGVBdChzKSxvPDU1Mjk2fHxvPjU2MzE5fHxzKzE9PT1jfHwoYT11LmNoYXJDb2RlQXQocysxKSk8NTYzMjB8fGE+NTczNDM/dD91LmNoYXJBdChzKTpvOnQ/dS5zbGljZShzLHMrMik6YS01NjMyMCsoby01NTI5Njw8MTApKzY1NTM2KX19fSxmdW5jdGlvbih0LGUscil7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49cigzOCksaT1yKDE2KSxvPXIoMjYpLGE9e307cigxMSkoYSxyKDIpKFwiaXRlcmF0b3JcIiksZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLHQuZXhwb3J0cz1mdW5jdGlvbih0LGUscil7dC5wcm90b3R5cGU9bihhLHtuZXh0OmkoMSxyKX0pLG8odCxlK1wiIEl0ZXJhdG9yXCIpfX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoOCksaT1yKDkpLG89cigyMCk7dC5leHBvcnRzPXIoNCk/T2JqZWN0LmRlZmluZVByb3BlcnRpZXM6ZnVuY3Rpb24odCxlKXtpKHQpO2Zvcih2YXIgcixhPW8oZSksdT1hLmxlbmd0aCxzPTA7dT5zOyluLmYodCxyPWFbcysrXSxlW3JdKTtyZXR1cm4gdH19LGZ1bmN0aW9uKHQsZSxyKXtcInVzZSBzdHJpY3RcIjt2YXIgbj1yKDc0KSxpPXIoNzUpLG89cigxNyksYT1yKDEyKTt0LmV4cG9ydHM9cig0OCkoQXJyYXksXCJBcnJheVwiLGZ1bmN0aW9uKHQsZSl7dGhpcy5fdD1hKHQpLHRoaXMuX2k9MCx0aGlzLl9rPWV9LGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fdCxlPXRoaXMuX2sscj10aGlzLl9pKys7cmV0dXJuIXR8fHI+PXQubGVuZ3RoPyh0aGlzLl90PXZvaWQgMCxpKDEpKTpcImtleXNcIj09ZT9pKDAscik6XCJ2YWx1ZXNcIj09ZT9pKDAsdFtyXSk6aSgwLFtyLHRbcl1dKX0sXCJ2YWx1ZXNcIiksby5Bcmd1bWVudHM9by5BcnJheSxuKFwia2V5c1wiKSxuKFwidmFsdWVzXCIpLG4oXCJlbnRyaWVzXCIpfSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbigpe319LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7cmV0dXJue3ZhbHVlOmUsZG9uZTohIXR9fX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoMCksaT1uLkpTT058fChuLkpTT049e3N0cmluZ2lmeTpKU09OLnN0cmluZ2lmeX0pO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gaS5zdHJpbmdpZnkuYXBwbHkoaSxhcmd1bWVudHMpfX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoMjMpKFwibWV0YVwiKSxpPXIoNyksbz1yKDEwKSxhPXIoOCkuZix1PTAscz1PYmplY3QuaXNFeHRlbnNpYmxlfHxmdW5jdGlvbigpe3JldHVybiEwfSxjPSFyKDEzKShmdW5jdGlvbigpe3JldHVybiBzKE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpfSksbD1mdW5jdGlvbih0KXthKHQsbix7dmFsdWU6e2k6XCJPXCIrICsrdSx3Ont9fX0pfSxmPWZ1bmN0aW9uKHQsZSl7aWYoIWkodCkpcmV0dXJuXCJzeW1ib2xcIj09dHlwZW9mIHQ/dDooXCJzdHJpbmdcIj09dHlwZW9mIHQ/XCJTXCI6XCJQXCIpK3Q7aWYoIW8odCxuKSl7aWYoIXModCkpcmV0dXJuXCJGXCI7aWYoIWUpcmV0dXJuXCJFXCI7bCh0KX1yZXR1cm4gdFtuXS5pfSxoPWZ1bmN0aW9uKHQsZSl7aWYoIW8odCxuKSl7aWYoIXModCkpcmV0dXJuITA7aWYoIWUpcmV0dXJuITE7bCh0KX1yZXR1cm4gdFtuXS53fSxwPWZ1bmN0aW9uKHQpe3JldHVybiBjJiZkLk5FRUQmJnModCkmJiFvKHQsbikmJmwodCksdH0sZD10LmV4cG9ydHM9e0tFWTpuLE5FRUQ6ITEsZmFzdEtleTpmLGdldFdlYWs6aCxvbkZyZWV6ZTpwfX0sLGZ1bmN0aW9uKHQsZSxyKXt0LmV4cG9ydHM9e2RlZmF1bHQ6cig4MCksX19lc01vZHVsZTohMH19LGZ1bmN0aW9uKHQsZSxyKXtyKDUyKSxyKDU0KSx0LmV4cG9ydHM9cig0MCkuZihcIml0ZXJhdG9yXCIpfSxmdW5jdGlvbih0LGUscil7dC5leHBvcnRzPXtkZWZhdWx0OnIoODIpLF9fZXNNb2R1bGU6ITB9fSxmdW5jdGlvbih0LGUscil7cig4Mykscig2MCkscig4Nykscig4OCksdC5leHBvcnRzPXIoMCkuU3ltYm9sfSxmdW5jdGlvbih0LGUscil7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49cigxKSxpPXIoMTApLG89cig0KSxhPXIoNiksdT1yKDUwKSxzPXIoNzcpLktFWSxjPXIoMTMpLGw9cigzNiksZj1yKDI2KSxoPXIoMjMpLHA9cigyKSxkPXIoNDApLHY9cig0MSkseT1yKDg0KSxtPXIoODUpLGc9cig5KSxfPXIoNyksTz1yKDEyKSxiPXIoMjcpLEU9cigxNiksUD1yKDM4KSxTPXIoODYpLHc9cig0NiksUj1yKDgpLFQ9cigyMCksaz13LmYsTT1SLmYseD1TLmYsQz1uLlN5bWJvbCxqPW4uSlNPTixBPWomJmouc3RyaW5naWZ5LE49cChcIl9oaWRkZW5cIiksST1wKFwidG9QcmltaXRpdmVcIiksVT17fS5wcm9wZXJ0eUlzRW51bWVyYWJsZSxMPWwoXCJzeW1ib2wtcmVnaXN0cnlcIiksRD1sKFwic3ltYm9sc1wiKSxGPWwoXCJvcC1zeW1ib2xzXCIpLEg9T2JqZWN0LnByb3RvdHlwZSxZPVwiZnVuY3Rpb25cIj09dHlwZW9mIEMsQj1uLlFPYmplY3QsSz0hQnx8IUIucHJvdG90eXBlfHwhQi5wcm90b3R5cGUuZmluZENoaWxkLEc9byYmYyhmdW5jdGlvbigpe3JldHVybiA3IT1QKE0oe30sXCJhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBNKHRoaXMsXCJhXCIse3ZhbHVlOjd9KS5hfX0pKS5hfSk/ZnVuY3Rpb24odCxlLHIpe3ZhciBuPWsoSCxlKTtuJiZkZWxldGUgSFtlXSxNKHQsZSxyKSxuJiZ0IT09SCYmTShILGUsbil9Ok0sSj1mdW5jdGlvbih0KXt2YXIgZT1EW3RdPVAoQy5wcm90b3R5cGUpO3JldHVybiBlLl9rPXQsZX0sVz1ZJiZcInN5bWJvbFwiPT10eXBlb2YgQy5pdGVyYXRvcj9mdW5jdGlvbih0KXtyZXR1cm5cInN5bWJvbFwiPT10eXBlb2YgdH06ZnVuY3Rpb24odCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBDfSxWPWZ1bmN0aW9uKHQsZSxyKXtyZXR1cm4gdD09PUgmJlYoRixlLHIpLGcodCksZT1iKGUsITApLGcociksaShELGUpPyhyLmVudW1lcmFibGU/KGkodCxOKSYmdFtOXVtlXSYmKHRbTl1bZV09ITEpLHI9UChyLHtlbnVtZXJhYmxlOkUoMCwhMSl9KSk6KGkodCxOKXx8TSh0LE4sRSgxLHt9KSksdFtOXVtlXT0hMCksRyh0LGUscikpOk0odCxlLHIpfSxxPWZ1bmN0aW9uKHQsZSl7Zyh0KTtmb3IodmFyIHIsbj15KGU9TyhlKSksaT0wLG89bi5sZW5ndGg7bz5pOylWKHQscj1uW2krK10sZVtyXSk7cmV0dXJuIHR9LHo9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdm9pZCAwPT09ZT9QKHQpOnEoUCh0KSxlKX0sWD1mdW5jdGlvbih0KXt2YXIgZT1VLmNhbGwodGhpcyx0PWIodCwhMCkpO3JldHVybiEodGhpcz09PUgmJmkoRCx0KSYmIWkoRix0KSkmJighKGV8fCFpKHRoaXMsdCl8fCFpKEQsdCl8fGkodGhpcyxOKSYmdGhpc1tOXVt0XSl8fGUpfSwkPWZ1bmN0aW9uKHQsZSl7aWYodD1PKHQpLGU9YihlLCEwKSx0IT09SHx8IWkoRCxlKXx8aShGLGUpKXt2YXIgcj1rKHQsZSk7cmV0dXJuIXJ8fCFpKEQsZSl8fGkodCxOKSYmdFtOXVtlXXx8KHIuZW51bWVyYWJsZT0hMCkscn19LFE9ZnVuY3Rpb24odCl7Zm9yKHZhciBlLHI9eChPKHQpKSxuPVtdLG89MDtyLmxlbmd0aD5vOylpKEQsZT1yW28rK10pfHxlPT1OfHxlPT1zfHxuLnB1c2goZSk7cmV0dXJuIG59LFo9ZnVuY3Rpb24odCl7Zm9yKHZhciBlLHI9dD09PUgsbj14KHI/RjpPKHQpKSxvPVtdLGE9MDtuLmxlbmd0aD5hOykhaShELGU9blthKytdKXx8ciYmIWkoSCxlKXx8by5wdXNoKERbZV0pO3JldHVybiBvfTtZfHwoQz1mdW5jdGlvbigpe2lmKHRoaXMgaW5zdGFuY2VvZiBDKXRocm93IFR5cGVFcnJvcihcIlN5bWJvbCBpcyBub3QgYSBjb25zdHJ1Y3RvciFcIik7dmFyIHQ9aChhcmd1bWVudHMubGVuZ3RoPjA/YXJndW1lbnRzWzBdOnZvaWQgMCksZT1mdW5jdGlvbihyKXt0aGlzPT09SCYmZS5jYWxsKEYsciksaSh0aGlzLE4pJiZpKHRoaXNbTl0sdCkmJih0aGlzW05dW3RdPSExKSxHKHRoaXMsdCxFKDEscikpfTtyZXR1cm4gbyYmSyYmRyhILHQse2NvbmZpZ3VyYWJsZTohMCxzZXQ6ZX0pLEoodCl9LHUoQy5wcm90b3R5cGUsXCJ0b1N0cmluZ1wiLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2t9KSx3LmY9JCxSLmY9VixyKDU3KS5mPVMuZj1RLHIoMjkpLmY9WCxyKDQzKS5mPVosbyYmIXIoMTUpJiZ1KEgsXCJwcm9wZXJ0eUlzRW51bWVyYWJsZVwiLFgsITApLGQuZj1mdW5jdGlvbih0KXtyZXR1cm4gSihwKHQpKX0pLGEoYS5HK2EuVythLkYqIVkse1N5bWJvbDpDfSk7Zm9yKHZhciB0dD1cImhhc0luc3RhbmNlLGlzQ29uY2F0U3ByZWFkYWJsZSxpdGVyYXRvcixtYXRjaCxyZXBsYWNlLHNlYXJjaCxzcGVjaWVzLHNwbGl0LHRvUHJpbWl0aXZlLHRvU3RyaW5nVGFnLHVuc2NvcGFibGVzXCIuc3BsaXQoXCIsXCIpLGV0PTA7dHQubGVuZ3RoPmV0OylwKHR0W2V0KytdKTtmb3IodmFyIHJ0PVQocC5zdG9yZSksbnQ9MDtydC5sZW5ndGg+bnQ7KXYocnRbbnQrK10pO2EoYS5TK2EuRiohWSxcIlN5bWJvbFwiLHtmb3I6ZnVuY3Rpb24odCl7cmV0dXJuIGkoTCx0Kz1cIlwiKT9MW3RdOkxbdF09Qyh0KX0sa2V5Rm9yOmZ1bmN0aW9uKHQpe2lmKCFXKHQpKXRocm93IFR5cGVFcnJvcih0K1wiIGlzIG5vdCBhIHN5bWJvbCFcIik7Zm9yKHZhciBlIGluIEwpaWYoTFtlXT09PXQpcmV0dXJuIGV9LHVzZVNldHRlcjpmdW5jdGlvbigpe0s9ITB9LHVzZVNpbXBsZTpmdW5jdGlvbigpe0s9ITF9fSksYShhLlMrYS5GKiFZLFwiT2JqZWN0XCIse2NyZWF0ZTp6LGRlZmluZVByb3BlcnR5OlYsZGVmaW5lUHJvcGVydGllczpxLGdldE93blByb3BlcnR5RGVzY3JpcHRvcjokLGdldE93blByb3BlcnR5TmFtZXM6USxnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6Wn0pLGomJmEoYS5TK2EuRiooIVl8fGMoZnVuY3Rpb24oKXt2YXIgdD1DKCk7cmV0dXJuXCJbbnVsbF1cIiE9QShbdF0pfHxcInt9XCIhPUEoe2E6dH0pfHxcInt9XCIhPUEoT2JqZWN0KHQpKX0pKSxcIkpTT05cIix7c3RyaW5naWZ5OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSxyLG49W3RdLGk9MTthcmd1bWVudHMubGVuZ3RoPmk7KW4ucHVzaChhcmd1bWVudHNbaSsrXSk7aWYocj1lPW5bMV0sKF8oZSl8fHZvaWQgMCE9PXQpJiYhVyh0KSlyZXR1cm4gbShlKXx8KGU9ZnVuY3Rpb24odCxlKXtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiByJiYoZT1yLmNhbGwodGhpcyx0LGUpKSwhVyhlKSlyZXR1cm4gZX0pLG5bMV09ZSxBLmFwcGx5KGosbil9fSksQy5wcm90b3R5cGVbSV18fHIoMTEpKEMucHJvdG90eXBlLEksQy5wcm90b3R5cGUudmFsdWVPZiksZihDLFwiU3ltYm9sXCIpLGYoTWF0aCxcIk1hdGhcIiwhMCksZihuLkpTT04sXCJKU09OXCIsITApfSxmdW5jdGlvbih0LGUscil7dmFyIG49cigyMCksaT1yKDQzKSxvPXIoMjkpO3QuZXhwb3J0cz1mdW5jdGlvbih0KXt2YXIgZT1uKHQpLHI9aS5mO2lmKHIpZm9yKHZhciBhLHU9cih0KSxzPW8uZixjPTA7dS5sZW5ndGg+Yzspcy5jYWxsKHQsYT11W2MrK10pJiZlLnB1c2goYSk7cmV0dXJuIGV9fSxmdW5jdGlvbih0LGUscil7dmFyIG49cigyMSk7dC5leHBvcnRzPUFycmF5LmlzQXJyYXl8fGZ1bmN0aW9uKHQpe3JldHVyblwiQXJyYXlcIj09bih0KX19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDEyKSxpPXIoNTcpLmYsbz17fS50b1N0cmluZyxhPVwib2JqZWN0XCI9PXR5cGVvZiB3aW5kb3cmJndpbmRvdyYmT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXM/T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMod2luZG93KTpbXSx1PWZ1bmN0aW9uKHQpe3RyeXtyZXR1cm4gaSh0KX1jYXRjaCh0KXtyZXR1cm4gYS5zbGljZSgpfX07dC5leHBvcnRzLmY9ZnVuY3Rpb24odCl7cmV0dXJuIGEmJlwiW29iamVjdCBXaW5kb3ddXCI9PW8uY2FsbCh0KT91KHQpOmkobih0KSl9fSxmdW5jdGlvbih0LGUscil7cig0MSkoXCJhc3luY0l0ZXJhdG9yXCIpfSxmdW5jdGlvbih0LGUscil7cig0MSkoXCJvYnNlcnZhYmxlXCIpfSwsLGZ1bmN0aW9uKHQsZSxyKXtyKDkyKSx0LmV4cG9ydHM9cigwKS5PYmplY3QuZ2V0UHJvdG90eXBlT2Z9LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDMyKSxpPXIoNTMpO3IoNDQpKFwiZ2V0UHJvdG90eXBlT2ZcIixmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gaShuKHQpKX19KX0sZnVuY3Rpb24odCxlLHIpe3QuZXhwb3J0cz17ZGVmYXVsdDpyKDk0KSxfX2VzTW9kdWxlOiEwfX0sZnVuY3Rpb24odCxlLHIpe3IoOTUpLHQuZXhwb3J0cz1yKDApLk9iamVjdC5zZXRQcm90b3R5cGVPZn0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoNik7bihuLlMsXCJPYmplY3RcIix7c2V0UHJvdG90eXBlT2Y6cig5Nikuc2V0fSl9LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDcpLGk9cig5KSxvPWZ1bmN0aW9uKHQsZSl7aWYoaSh0KSwhbihlKSYmbnVsbCE9PWUpdGhyb3cgVHlwZUVycm9yKGUrXCI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhXCIpfTt0LmV4cG9ydHM9e3NldDpPYmplY3Quc2V0UHJvdG90eXBlT2Z8fChcIl9fcHJvdG9fX1wiaW57fT9mdW5jdGlvbih0LGUsbil7dHJ5e249cigxNCkoRnVuY3Rpb24uY2FsbCxyKDQ2KS5mKE9iamVjdC5wcm90b3R5cGUsXCJfX3Byb3RvX19cIikuc2V0LDIpLG4odCxbXSksZT0hKHQgaW5zdGFuY2VvZiBBcnJheSl9Y2F0Y2godCl7ZT0hMH1yZXR1cm4gZnVuY3Rpb24odCxyKXtyZXR1cm4gbyh0LHIpLGU/dC5fX3Byb3RvX189cjpuKHQsciksdH19KHt9LCExKTp2b2lkIDApLGNoZWNrOm99fSxmdW5jdGlvbih0LGUscil7dC5leHBvcnRzPXtkZWZhdWx0OnIoOTgpLF9fZXNNb2R1bGU6ITB9fSxmdW5jdGlvbih0LGUscil7cig5OSk7dmFyIG49cigwKS5PYmplY3Q7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG4uY3JlYXRlKHQsZSl9fSxmdW5jdGlvbih0LGUscil7dmFyIG49cig2KTtuKG4uUyxcIk9iamVjdFwiLHtjcmVhdGU6cigzOCl9KX0sLGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDYzKSxpPXIoMikoXCJpdGVyYXRvclwiKSxvPXIoMTcpO3QuZXhwb3J0cz1yKDApLmdldEl0ZXJhdG9yTWV0aG9kPWZ1bmN0aW9uKHQpe2lmKHZvaWQgMCE9dClyZXR1cm4gdFtpXXx8dFtcIkBAaXRlcmF0b3JcIl18fG9bbih0KV19fSxmdW5jdGlvbih0LGUscil7cig2MCkscig1Mikscig1NCkscigxMDMpLHIoMTE0KSxyKDExNSksdC5leHBvcnRzPXIoMCkuUHJvbWlzZX0sZnVuY3Rpb24odCxlLHIpe1widXNlIHN0cmljdFwiO3ZhciBuLGksbyxhLHU9cigxNSkscz1yKDEpLGM9cigxNCksbD1yKDYzKSxmPXIoNiksaD1yKDcpLHA9cigyNCksZD1yKDEwNCksdj1yKDEwNSkseT1yKDY2KSxtPXIoNjcpLnNldCxnPXIoMTA5KSgpLF89cig1MSksTz1yKDY4KSxiPXIoMTEwKSxFPXIoNjkpLFA9cy5UeXBlRXJyb3IsUz1zLnByb2Nlc3Msdz1TJiZTLnZlcnNpb25zLFI9dyYmdy52OHx8XCJcIixUPXMuUHJvbWlzZSxrPVwicHJvY2Vzc1wiPT1sKFMpLE09ZnVuY3Rpb24oKXt9LHg9aT1fLmYsQz0hIWZ1bmN0aW9uKCl7dHJ5e3ZhciB0PVQucmVzb2x2ZSgxKSxlPSh0LmNvbnN0cnVjdG9yPXt9KVtyKDIpKFwic3BlY2llc1wiKV09ZnVuY3Rpb24odCl7dChNLE0pfTtyZXR1cm4oa3x8XCJmdW5jdGlvblwiPT10eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50KSYmdC50aGVuKE0paW5zdGFuY2VvZiBlJiYwIT09Ui5pbmRleE9mKFwiNi42XCIpJiYtMT09PWIuaW5kZXhPZihcIkNocm9tZS82NlwiKX1jYXRjaCh0KXt9fSgpLGo9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuISghaCh0KXx8XCJmdW5jdGlvblwiIT10eXBlb2YoZT10LnRoZW4pKSYmZX0sQT1mdW5jdGlvbih0LGUpe2lmKCF0Ll9uKXt0Ll9uPSEwO3ZhciByPXQuX2M7ZyhmdW5jdGlvbigpe2Zvcih2YXIgbj10Ll92LGk9MT09dC5fcyxvPTA7ci5sZW5ndGg+bzspIWZ1bmN0aW9uKGUpe3ZhciByLG8sYSx1PWk/ZS5vazplLmZhaWwscz1lLnJlc29sdmUsYz1lLnJlamVjdCxsPWUuZG9tYWluO3RyeXt1PyhpfHwoMj09dC5faCYmVSh0KSx0Ll9oPTEpLCEwPT09dT9yPW46KGwmJmwuZW50ZXIoKSxyPXUobiksbCYmKGwuZXhpdCgpLGE9ITApKSxyPT09ZS5wcm9taXNlP2MoUChcIlByb21pc2UtY2hhaW4gY3ljbGVcIikpOihvPWoocikpP28uY2FsbChyLHMsYyk6cyhyKSk6YyhuKX1jYXRjaCh0KXtsJiYhYSYmbC5leGl0KCksYyh0KX19KHJbbysrXSk7dC5fYz1bXSx0Ll9uPSExLGUmJiF0Ll9oJiZOKHQpfSl9fSxOPWZ1bmN0aW9uKHQpe20uY2FsbChzLGZ1bmN0aW9uKCl7dmFyIGUscixuLGk9dC5fdixvPUkodCk7aWYobyYmKGU9TyhmdW5jdGlvbigpe2s/Uy5lbWl0KFwidW5oYW5kbGVkUmVqZWN0aW9uXCIsaSx0KToocj1zLm9udW5oYW5kbGVkcmVqZWN0aW9uKT9yKHtwcm9taXNlOnQscmVhc29uOml9KToobj1zLmNvbnNvbGUpJiZuLmVycm9yJiZuLmVycm9yKFwiVW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uXCIsaSl9KSx0Ll9oPWt8fEkodCk/MjoxKSx0Ll9hPXZvaWQgMCxvJiZlLmUpdGhyb3cgZS52fSl9LEk9ZnVuY3Rpb24odCl7cmV0dXJuIDEhPT10Ll9oJiYwPT09KHQuX2F8fHQuX2MpLmxlbmd0aH0sVT1mdW5jdGlvbih0KXttLmNhbGwocyxmdW5jdGlvbigpe3ZhciBlO2s/Uy5lbWl0KFwicmVqZWN0aW9uSGFuZGxlZFwiLHQpOihlPXMub25yZWplY3Rpb25oYW5kbGVkKSYmZSh7cHJvbWlzZTp0LHJlYXNvbjp0Ll92fSl9KX0sTD1mdW5jdGlvbih0KXt2YXIgZT10aGlzO2UuX2R8fChlLl9kPSEwLGU9ZS5fd3x8ZSxlLl92PXQsZS5fcz0yLGUuX2F8fChlLl9hPWUuX2Muc2xpY2UoKSksQShlLCEwKSl9LEQ9ZnVuY3Rpb24odCl7dmFyIGUscj10aGlzO2lmKCFyLl9kKXtyLl9kPSEwLHI9ci5fd3x8cjt0cnl7aWYocj09PXQpdGhyb3cgUChcIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmXCIpOyhlPWoodCkpP2coZnVuY3Rpb24oKXt2YXIgbj17X3c6cixfZDohMX07dHJ5e2UuY2FsbCh0LGMoRCxuLDEpLGMoTCxuLDEpKX1jYXRjaCh0KXtMLmNhbGwobix0KX19KTooci5fdj10LHIuX3M9MSxBKHIsITEpKX1jYXRjaCh0KXtMLmNhbGwoe193OnIsX2Q6ITF9LHQpfX19O0N8fChUPWZ1bmN0aW9uKHQpe2QodGhpcyxULFwiUHJvbWlzZVwiLFwiX2hcIikscCh0KSxuLmNhbGwodGhpcyk7dHJ5e3QoYyhELHRoaXMsMSksYyhMLHRoaXMsMSkpfWNhdGNoKHQpe0wuY2FsbCh0aGlzLHQpfX0sbj1mdW5jdGlvbih0KXt0aGlzLl9jPVtdLHRoaXMuX2E9dm9pZCAwLHRoaXMuX3M9MCx0aGlzLl9kPSExLHRoaXMuX3Y9dm9pZCAwLHRoaXMuX2g9MCx0aGlzLl9uPSExfSxuLnByb3RvdHlwZT1yKDExMSkoVC5wcm90b3R5cGUse3RoZW46ZnVuY3Rpb24odCxlKXt2YXIgcj14KHkodGhpcyxUKSk7cmV0dXJuIHIub2s9XCJmdW5jdGlvblwiIT10eXBlb2YgdHx8dCxyLmZhaWw9XCJmdW5jdGlvblwiPT10eXBlb2YgZSYmZSxyLmRvbWFpbj1rP1MuZG9tYWluOnZvaWQgMCx0aGlzLl9jLnB1c2gociksdGhpcy5fYSYmdGhpcy5fYS5wdXNoKHIpLHRoaXMuX3MmJkEodGhpcywhMSksci5wcm9taXNlfSxjYXRjaDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50aGVuKHZvaWQgMCx0KX19KSxvPWZ1bmN0aW9uKCl7dmFyIHQ9bmV3IG47dGhpcy5wcm9taXNlPXQsdGhpcy5yZXNvbHZlPWMoRCx0LDEpLHRoaXMucmVqZWN0PWMoTCx0LDEpfSxfLmY9eD1mdW5jdGlvbih0KXtyZXR1cm4gdD09PVR8fHQ9PT1hP25ldyBvKHQpOmkodCl9KSxmKGYuRytmLlcrZi5GKiFDLHtQcm9taXNlOlR9KSxyKDI2KShULFwiUHJvbWlzZVwiKSxyKDExMikoXCJQcm9taXNlXCIpLGE9cigwKS5Qcm9taXNlLGYoZi5TK2YuRiohQyxcIlByb21pc2VcIix7cmVqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPXgodGhpcyk7cmV0dXJuKDAsZS5yZWplY3QpKHQpLGUucHJvbWlzZX19KSxmKGYuUytmLkYqKHV8fCFDKSxcIlByb21pc2VcIix7cmVzb2x2ZTpmdW5jdGlvbih0KXtyZXR1cm4gRSh1JiZ0aGlzPT09YT9UOnRoaXMsdCl9fSksZihmLlMrZi5GKiEoQyYmcigxMTMpKGZ1bmN0aW9uKHQpe1QuYWxsKHQpLmNhdGNoKE0pfSkpLFwiUHJvbWlzZVwiLHthbGw6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxyPXgoZSksbj1yLnJlc29sdmUsaT1yLnJlamVjdCxvPU8oZnVuY3Rpb24oKXt2YXIgcj1bXSxvPTAsYT0xO3YodCwhMSxmdW5jdGlvbih0KXt2YXIgdT1vKysscz0hMTtyLnB1c2godm9pZCAwKSxhKyssZS5yZXNvbHZlKHQpLnRoZW4oZnVuY3Rpb24odCl7c3x8KHM9ITAsclt1XT10LC0tYXx8bihyKSl9LGkpfSksLS1hfHxuKHIpfSk7cmV0dXJuIG8uZSYmaShvLnYpLHIucHJvbWlzZX0scmFjZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLHI9eChlKSxuPXIucmVqZWN0LGk9TyhmdW5jdGlvbigpe3YodCwhMSxmdW5jdGlvbih0KXtlLnJlc29sdmUodCkudGhlbihyLnJlc29sdmUsbil9KX0pO3JldHVybiBpLmUmJm4oaS52KSxyLnByb21pc2V9fSl9LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxyLG4pe2lmKCEodCBpbnN0YW5jZW9mIGUpfHx2b2lkIDAhPT1uJiZuIGluIHQpdGhyb3cgVHlwZUVycm9yKHIrXCI6IGluY29ycmVjdCBpbnZvY2F0aW9uIVwiKTtyZXR1cm4gdH19LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDE0KSxpPXIoMTA2KSxvPXIoMTA3KSxhPXIoOSksdT1yKDQ5KSxzPXIoMTAxKSxjPXt9LGw9e30sZT10LmV4cG9ydHM9ZnVuY3Rpb24odCxlLHIsZixoKXt2YXIgcCxkLHYseSxtPWg/ZnVuY3Rpb24oKXtyZXR1cm4gdH06cyh0KSxnPW4ocixmLGU/MjoxKSxfPTA7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgbSl0aHJvdyBUeXBlRXJyb3IodCtcIiBpcyBub3QgaXRlcmFibGUhXCIpO2lmKG8obSkpe2ZvcihwPXUodC5sZW5ndGgpO3A+XztfKyspaWYoKHk9ZT9nKGEoZD10W19dKVswXSxkWzFdKTpnKHRbX10pKT09PWN8fHk9PT1sKXJldHVybiB5fWVsc2UgZm9yKHY9bS5jYWxsKHQpOyEoZD12Lm5leHQoKSkuZG9uZTspaWYoKHk9aSh2LGcsZC52YWx1ZSxlKSk9PT1jfHx5PT09bClyZXR1cm4geX07ZS5CUkVBSz1jLGUuUkVUVVJOPWx9LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDkpO3QuZXhwb3J0cz1mdW5jdGlvbih0LGUscixpKXt0cnl7cmV0dXJuIGk/ZShuKHIpWzBdLHJbMV0pOmUocil9Y2F0Y2goZSl7dmFyIG89dC5yZXR1cm47dGhyb3cgdm9pZCAwIT09byYmbihvLmNhbGwodCkpLGV9fX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoMTcpLGk9cigyKShcIml0ZXJhdG9yXCIpLG89QXJyYXkucHJvdG90eXBlO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gdm9pZCAwIT09dCYmKG4uQXJyYXk9PT10fHxvW2ldPT09dCl9fSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0LGUscil7dmFyIG49dm9pZCAwPT09cjtzd2l0Y2goZS5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gbj90KCk6dC5jYWxsKHIpO2Nhc2UgMTpyZXR1cm4gbj90KGVbMF0pOnQuY2FsbChyLGVbMF0pO2Nhc2UgMjpyZXR1cm4gbj90KGVbMF0sZVsxXSk6dC5jYWxsKHIsZVswXSxlWzFdKTtjYXNlIDM6cmV0dXJuIG4/dChlWzBdLGVbMV0sZVsyXSk6dC5jYWxsKHIsZVswXSxlWzFdLGVbMl0pO2Nhc2UgNDpyZXR1cm4gbj90KGVbMF0sZVsxXSxlWzJdLGVbM10pOnQuY2FsbChyLGVbMF0sZVsxXSxlWzJdLGVbM10pfXJldHVybiB0LmFwcGx5KHIsZSl9fSxmdW5jdGlvbih0LGUscil7dmFyIG49cigxKSxpPXIoNjcpLnNldCxvPW4uTXV0YXRpb25PYnNlcnZlcnx8bi5XZWJLaXRNdXRhdGlvbk9ic2VydmVyLGE9bi5wcm9jZXNzLHU9bi5Qcm9taXNlLHM9XCJwcm9jZXNzXCI9PXIoMjEpKGEpO3QuZXhwb3J0cz1mdW5jdGlvbigpe3ZhciB0LGUscixjPWZ1bmN0aW9uKCl7dmFyIG4saTtmb3IocyYmKG49YS5kb21haW4pJiZuLmV4aXQoKTt0Oyl7aT10LmZuLHQ9dC5uZXh0O3RyeXtpKCl9Y2F0Y2gobil7dGhyb3cgdD9yKCk6ZT12b2lkIDAsbn19ZT12b2lkIDAsbiYmbi5lbnRlcigpfTtpZihzKXI9ZnVuY3Rpb24oKXthLm5leHRUaWNrKGMpfTtlbHNlIGlmKCFvfHxuLm5hdmlnYXRvciYmbi5uYXZpZ2F0b3Iuc3RhbmRhbG9uZSlpZih1JiZ1LnJlc29sdmUpe3ZhciBsPXUucmVzb2x2ZSh2b2lkIDApO3I9ZnVuY3Rpb24oKXtsLnRoZW4oYyl9fWVsc2Ugcj1mdW5jdGlvbigpe2kuY2FsbChuLGMpfTtlbHNle3ZhciBmPSEwLGg9ZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJcIik7bmV3IG8oYykub2JzZXJ2ZShoLHtjaGFyYWN0ZXJEYXRhOiEwfSkscj1mdW5jdGlvbigpe2guZGF0YT1mPSFmfX1yZXR1cm4gZnVuY3Rpb24obil7dmFyIGk9e2ZuOm4sbmV4dDp2b2lkIDB9O2UmJihlLm5leHQ9aSksdHx8KHQ9aSxyKCkpLGU9aX19fSxmdW5jdGlvbih0LGUscil7dmFyIG49cigxKSxpPW4ubmF2aWdhdG9yO3QuZXhwb3J0cz1pJiZpLnVzZXJBZ2VudHx8XCJcIn0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoMTEpO3QuZXhwb3J0cz1mdW5jdGlvbih0LGUscil7Zm9yKHZhciBpIGluIGUpciYmdFtpXT90W2ldPWVbaV06bih0LGksZVtpXSk7cmV0dXJuIHR9fSxmdW5jdGlvbih0LGUscil7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49cigxKSxpPXIoMCksbz1yKDgpLGE9cig0KSx1PXIoMikoXCJzcGVjaWVzXCIpO3QuZXhwb3J0cz1mdW5jdGlvbih0KXt2YXIgZT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBpW3RdP2lbdF06blt0XTthJiZlJiYhZVt1XSYmby5mKGUsdSx7Y29uZmlndXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzfX0pfX0sZnVuY3Rpb24odCxlLHIpe3ZhciBuPXIoMikoXCJpdGVyYXRvclwiKSxpPSExO3RyeXt2YXIgbz1bN11bbl0oKTtvLnJldHVybj1mdW5jdGlvbigpe2k9ITB9LEFycmF5LmZyb20obyxmdW5jdGlvbigpe3Rocm93IDJ9KX1jYXRjaCh0KXt9dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7aWYoIWUmJiFpKXJldHVybiExO3ZhciByPSExO3RyeXt2YXIgbz1bN10sYT1vW25dKCk7YS5uZXh0PWZ1bmN0aW9uKCl7cmV0dXJue2RvbmU6cj0hMH19LG9bbl09ZnVuY3Rpb24oKXtyZXR1cm4gYX0sdChvKX1jYXRjaCh0KXt9cmV0dXJuIHJ9fSxmdW5jdGlvbih0LGUscil7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49cig2KSxpPXIoMCksbz1yKDEpLGE9cig2NiksdT1yKDY5KTtuKG4uUCtuLlIsXCJQcm9taXNlXCIse2ZpbmFsbHk6ZnVuY3Rpb24odCl7dmFyIGU9YSh0aGlzLGkuUHJvbWlzZXx8by5Qcm9taXNlKSxyPVwiZnVuY3Rpb25cIj09dHlwZW9mIHQ7cmV0dXJuIHRoaXMudGhlbihyP2Z1bmN0aW9uKHIpe3JldHVybiB1KGUsdCgpKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHJ9KX06dCxyP2Z1bmN0aW9uKHIpe3JldHVybiB1KGUsdCgpKS50aGVuKGZ1bmN0aW9uKCl7dGhyb3cgcn0pfTp0KX19KX0sZnVuY3Rpb24odCxlLHIpe1widXNlIHN0cmljdFwiO3ZhciBuPXIoNiksaT1yKDUxKSxvPXIoNjgpO24obi5TLFwiUHJvbWlzZVwiLHt0cnk6ZnVuY3Rpb24odCl7dmFyIGU9aS5mKHRoaXMpLHI9byh0KTtyZXR1cm4oci5lP2UucmVqZWN0OmUucmVzb2x2ZSkoci52KSxlLnByb21pc2V9fSl9LGZ1bmN0aW9uKHQsZSxyKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBuKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX1PYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSxlLkRhdGFPYmplY3RTb3VyY2VMYW5ndWFnZT1lLkNhdGFsb2d1ZU9iamVjdFR5cGU9dm9pZCAwO3ZhciBpPXIoMjUpLG89bihpKSxhPXIoMyksdT1uKGEpLHM9cig1KSxjPW4ocyksbD1yKDMzKSxmPW4obCksaD1yKDM0KSxwPW4oaCksZD1yKDEzNiksdj1uKGQpLHk9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZSh0LHIsbixpLGEscyxjKXsoMCx1LmRlZmF1bHQpKHRoaXMsZSk7dmFyIGw9KDAsZi5kZWZhdWx0KSh0aGlzLChlLl9fcHJvdG9fX3x8KDAsby5kZWZhdWx0KShlKSkuY2FsbCh0aGlzKSk7cmV0dXJuIGwuX2d1aWQ9dCxsLl90eXBlPXIsbC5fdmVyc2lvbj1uLGwuX29iamVjdE5hbWU9aSxsLl9kZXNjcmlwdGlvbj1hLGwuX2xhbmd1YWdlPXMsbC5fc291cmNlUGFja2FnZVVSTD1jLGwuX3NpZ25hdHVyZT1udWxsLGwuX3NvdXJjZVBhY2thZ2U9bnVsbCxsfXJldHVybigwLHAuZGVmYXVsdCkoZSx0KSwoMCxjLmRlZmF1bHQpKGUsW3trZXk6XCJndWlkXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2d1aWR9LHNldDpmdW5jdGlvbih0KXt0JiYodGhpcy5fZ3VpZD10KX19LHtrZXk6XCJ0eXBlXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3R5cGV9LHNldDpmdW5jdGlvbih0KXt0JiYodGhpcy5fdHlwZT10KX19LHtrZXk6XCJ2ZXJzaW9uXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3ZlcnNpb259LHNldDpmdW5jdGlvbih0KXt0JiYodGhpcy5fdmVyc2lvbj10KX19LHtrZXk6XCJvYmplY3ROYW1lXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29iamVjdE5hbWV9LHNldDpmdW5jdGlvbih0KXt0JiYodGhpcy5fb2JqZWN0TmFtZT10KX19LHtrZXk6XCJkZXNjcmlwdGlvblwiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kZXNjcmlwdGlvbn0sc2V0OmZ1bmN0aW9uKHQpe3QmJih0aGlzLl9kZXNjcmlwdGlvbj10KX19LHtrZXk6XCJsYW5ndWFnZVwiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sYW5ndWFnZX0sc2V0OmZ1bmN0aW9uKHQpe3QmJih0aGlzLl9sYW5ndWFnZT10KX19LHtrZXk6XCJzaWduYXR1cmVcIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2lnbmF0dXJlfSxzZXQ6ZnVuY3Rpb24odCl7dCYmKHRoaXMuX3NpZ25hdHVyZT10KX19LHtrZXk6XCJzb3VyY2VQYWNrYWdlXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvdXJjZVBhY2thZ2V9LHNldDpmdW5jdGlvbih0KXt0JiYodGhpcy5fc291cmNlUGFja2FnZT10KX19LHtrZXk6XCJzb3VyY2VQYWNrYWdlVVJMXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvdXJjZVBhY2thZ2VVUkx9LHNldDpmdW5jdGlvbih0KXt0JiYodGhpcy5fc291cmNlUGFja2FnZVVSTD10KX19XSksZX0odi5kZWZhdWx0KTtlLkNhdGFsb2d1ZU9iamVjdFR5cGU9e0hZUEVSVFk6XCJoeXBlcnR5XCIsUFJPVE9TVFVCOlwicHJvdG9zdHViXCIsSFlQRVJUWV9SVU5USU1FOlwiaHlwZXJ0eV9ydW50aW1lXCIsSFlQRVJUWV9JTlRFUkNFUFRPUjpcImh5cGVydHlfaW5zcGVjdG9yXCIsSFlQRVJUWV9EQVRBX09CSkVDVDpcImh5cGVydHlfZGF0YV9vYmplY3RcIn0sZS5EYXRhT2JqZWN0U291cmNlTGFuZ3VhZ2U9e0pBVkFTQ1JJUFRfRUNNQTY6XCJqYXZhc2NyaXB0X2VjbWE2XCIsSkFWQVNDUklQVF9FQ01BNTpcImphdmFzY3JpcHRfZWNtYTVcIixKU09OX1NDSEVNQV9WNDpcImpzb25fc2NoZW1hX3Y0XCIsUFlUSE9OOlwicHl0aG9uXCIsVFlQRVNDUklQVDpcInR5cGVzY3JpcHRcIn07ZS5kZWZhdWx0PXl9LCwsLCwsLCwsLCwsLCwsLCwsLCxmdW5jdGlvbih0LGUscil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksZS5SZXRoaW5rT2JqZWN0PXZvaWQgMDt2YXIgaT1yKDU4KSxvPW4oaSksYT1yKDMpLHU9bihhKSxzPXIoNSksYz1uKHMpLGw9cigxMzcpLGY9bihsKSxoPWUuUmV0aGlua09iamVjdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXsoMCx1LmRlZmF1bHQpKHRoaXMsdCl9cmV0dXJuKDAsYy5kZWZhdWx0KSh0LFt7a2V5OlwidmFsaWRhdGVcIix2YWx1ZTpmdW5jdGlvbih0KXtmLmRlZmF1bHQuYWRkU2NoZW1hKHQuaWQsdCk7dmFyIGU9Zi5kZWZhdWx0LnZhbGlkYXRlTXVsdGlwbGUoSlNPTi5wYXJzZSgoMCxvLmRlZmF1bHQpKHRoaXMpKSx0KTtyZXR1cm4gZS5lcnJvcnMuZm9yRWFjaChmdW5jdGlvbih0KXtkZWxldGUgdC5zdGFja30pLCghZS52YWxpZHx8ZS5taXNzaW5nLmxlbmd0aD4wKSYmKGNvbnNvbGUud2FybihcIk9iamVjdCB2YWxpZGF0aW9uIFwiKyhlLnZhbGlkP1wic3VjY2VlZGVkLCBidXQgc2NoZW1hIGNvbnRhaW5lZCByZWZlcmVuY2VzOlwiOlwiZmFpbGVkOlwiKSwoMCxvLmRlZmF1bHQpKGUsbnVsbCwyKSksY29uc29sZS5sb2coXCJPYmplY3Q6XCIsKDAsby5kZWZhdWx0KSh0aGlzLG51bGwsMikpKSxlLnZhbGlkfX1dKSx0fSgpO2UuZGVmYXVsdD1ofSxmdW5jdGlvbih0LGUscil7dmFyIG4saSxvOyFmdW5jdGlvbihyLGEpe2k9W10sbj1hLHZvaWQgMCE9PShvPVwiZnVuY3Rpb25cIj09dHlwZW9mIG4/bi5hcHBseShlLGkpOm4pJiYodC5leHBvcnRzPW8pfSgwLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm4gZW5jb2RlVVJJKHQpLnJlcGxhY2UoLyUyNVswLTldWzAtOV0vZyxmdW5jdGlvbih0KXtyZXR1cm5cIiVcIit0LnN1YnN0cmluZygzKX0pfWZ1bmN0aW9uIGUoZSl7dmFyIHI9XCJcIjtoW2UuY2hhckF0KDApXSYmKHI9ZS5jaGFyQXQoMCksZT1lLnN1YnN0cmluZygxKSk7dmFyIG49XCJcIixpPVwiXCIsbz0hMCxhPSExLHU9ITE7XCIrXCI9PT1yP289ITE6XCIuXCI9PT1yPyhpPVwiLlwiLG49XCIuXCIpOlwiL1wiPT09cj8oaT1cIi9cIixuPVwiL1wiKTpcIiNcIj09PXI/KGk9XCIjXCIsbz0hMSk6XCI7XCI9PT1yPyhpPVwiO1wiLG49XCI7XCIsYT0hMCx1PSEwKTpcIj9cIj09PXI/KGk9XCI/XCIsbj1cIiZcIixhPSEwKTpcIiZcIj09PXImJihpPVwiJlwiLG49XCImXCIsYT0hMCk7Zm9yKHZhciBzPVtdLGM9ZS5zcGxpdChcIixcIiksbD1bXSxmPXt9LGQ9MDtkPGMubGVuZ3RoO2QrKyl7dmFyIHY9Y1tkXSx5PW51bGw7aWYoLTEhPT12LmluZGV4T2YoXCI6XCIpKXt2YXIgbT12LnNwbGl0KFwiOlwiKTt2PW1bMF0seT1wYXJzZUludChtWzFdLDEwKX1mb3IodmFyIGc9e307cFt2LmNoYXJBdCh2Lmxlbmd0aC0xKV07KWdbdi5jaGFyQXQodi5sZW5ndGgtMSldPSEwLHY9di5zdWJzdHJpbmcoMCx2Lmxlbmd0aC0xKTt2YXIgXz17dHJ1bmNhdGU6eSxuYW1lOnYsc3VmZmljZXM6Z307bC5wdXNoKF8pLGZbdl09XyxzLnB1c2godil9dmFyIE89ZnVuY3Rpb24oZSl7Zm9yKHZhciByPVwiXCIscz0wLGM9MDtjPGwubGVuZ3RoO2MrKyl7dmFyIGY9bFtjXSxoPWUoZi5uYW1lKTtpZihudWxsPT09aHx8dm9pZCAwPT09aHx8QXJyYXkuaXNBcnJheShoKSYmMD09PWgubGVuZ3RofHxcIm9iamVjdFwiPT10eXBlb2YgaCYmMD09PU9iamVjdC5rZXlzKGgpLmxlbmd0aClzKys7ZWxzZSBpZihyKz1jPT09cz9pOm58fFwiLFwiLEFycmF5LmlzQXJyYXkoaCkpe2EmJihyKz1mLm5hbWUrXCI9XCIpO2Zvcih2YXIgcD0wO3A8aC5sZW5ndGg7cCsrKXA+MCYmKHIrPWYuc3VmZmljZXNbXCIqXCJdP258fFwiLFwiOlwiLFwiLGYuc3VmZmljZXNbXCIqXCJdJiZhJiYocis9Zi5uYW1lK1wiPVwiKSkscis9bz9lbmNvZGVVUklDb21wb25lbnQoaFtwXSkucmVwbGFjZSgvIS9nLFwiJTIxXCIpOnQoaFtwXSl9ZWxzZSBpZihcIm9iamVjdFwiPT10eXBlb2YgaCl7YSYmIWYuc3VmZmljZXNbXCIqXCJdJiYocis9Zi5uYW1lK1wiPVwiKTt2YXIgZD0hMDtmb3IodmFyIHYgaW4gaClkfHwocis9Zi5zdWZmaWNlc1tcIipcIl0/bnx8XCIsXCI6XCIsXCIpLGQ9ITEscis9bz9lbmNvZGVVUklDb21wb25lbnQodikucmVwbGFjZSgvIS9nLFwiJTIxXCIpOnQodikscis9Zi5zdWZmaWNlc1tcIipcIl0/XCI9XCI6XCIsXCIscis9bz9lbmNvZGVVUklDb21wb25lbnQoaFt2XSkucmVwbGFjZSgvIS9nLFwiJTIxXCIpOnQoaFt2XSl9ZWxzZSBhJiYocis9Zi5uYW1lLHUmJlwiXCI9PT1ofHwocis9XCI9XCIpKSxudWxsIT1mLnRydW5jYXRlJiYoaD1oLnN1YnN0cmluZygwLGYudHJ1bmNhdGUpKSxyKz1vP2VuY29kZVVSSUNvbXBvbmVudChoKS5yZXBsYWNlKC8hL2csXCIlMjFcIik6dChoKX1yZXR1cm4gcn07cmV0dXJuIE8udmFyTmFtZXM9cyx7cHJlZml4Omksc3Vic3RpdHV0aW9uOk99fWZ1bmN0aW9uIHIodCl7aWYoISh0aGlzIGluc3RhbmNlb2YgcikpcmV0dXJuIG5ldyByKHQpO2Zvcih2YXIgbj10LnNwbGl0KFwie1wiKSxpPVtuLnNoaWZ0KCldLG89W10sYT1bXSx1PVtdO24ubGVuZ3RoPjA7KXt2YXIgcz1uLnNoaWZ0KCksYz1zLnNwbGl0KFwifVwiKVswXSxsPXMuc3Vic3RyaW5nKGMubGVuZ3RoKzEpLGY9ZShjKTthLnB1c2goZi5zdWJzdGl0dXRpb24pLG8ucHVzaChmLnByZWZpeCksaS5wdXNoKGwpLHU9dS5jb25jYXQoZi5zdWJzdGl0dXRpb24udmFyTmFtZXMpfXRoaXMuZmlsbD1mdW5jdGlvbih0KXtmb3IodmFyIGU9aVswXSxyPTA7cjxhLmxlbmd0aDtyKyspe2UrPSgwLGFbcl0pKHQpLGUrPWlbcisxXX1yZXR1cm4gZX0sdGhpcy52YXJOYW1lcz11LHRoaXMudGVtcGxhdGU9dH1mdW5jdGlvbiBuKHQsZSl7aWYodD09PWUpcmV0dXJuITA7aWYodCYmZSYmXCJvYmplY3RcIj09dHlwZW9mIHQmJlwib2JqZWN0XCI9PXR5cGVvZiBlKXtpZihBcnJheS5pc0FycmF5KHQpIT09QXJyYXkuaXNBcnJheShlKSlyZXR1cm4hMTtpZihBcnJheS5pc0FycmF5KHQpKXtpZih0Lmxlbmd0aCE9PWUubGVuZ3RoKXJldHVybiExO2Zvcih2YXIgcj0wO3I8dC5sZW5ndGg7cisrKWlmKCFuKHRbcl0sZVtyXSkpcmV0dXJuITF9ZWxzZXt2YXIgaTtmb3IoaSBpbiB0KWlmKHZvaWQgMD09PWVbaV0mJnZvaWQgMCE9PXRbaV0pcmV0dXJuITE7Zm9yKGkgaW4gZSlpZih2b2lkIDA9PT10W2ldJiZ2b2lkIDAhPT1lW2ldKXJldHVybiExO2ZvcihpIGluIHQpaWYoIW4odFtpXSxlW2ldKSlyZXR1cm4hMX1yZXR1cm4hMH1yZXR1cm4hMX1mdW5jdGlvbiBpKHQpe3ZhciBlPVN0cmluZyh0KS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLFwiXCIpLm1hdGNoKC9eKFteOlxcLz8jXSs6KT8oXFwvXFwvKD86W146QF0qKD86OlteOkBdKik/QCk/KChbXjpcXC8/I10qKSg/OjooXFxkKikpPykpPyhbXj8jXSopKFxcP1teI10qKT8oI1tcXHNcXFNdKik/Lyk7cmV0dXJuIGU/e2hyZWY6ZVswXXx8XCJcIixwcm90b2NvbDplWzFdfHxcIlwiLGF1dGhvcml0eTplWzJdfHxcIlwiLGhvc3Q6ZVszXXx8XCJcIixob3N0bmFtZTplWzRdfHxcIlwiLHBvcnQ6ZVs1XXx8XCJcIixwYXRobmFtZTplWzZdfHxcIlwiLHNlYXJjaDplWzddfHxcIlwiLGhhc2g6ZVs4XXx8XCJcIn06bnVsbH1mdW5jdGlvbiBvKHQsZSl7cmV0dXJuIGU9aShlfHxcIlwiKSx0PWkodHx8XCJcIiksZSYmdD8oZS5wcm90b2NvbHx8dC5wcm90b2NvbCkrKGUucHJvdG9jb2x8fGUuYXV0aG9yaXR5P2UuYXV0aG9yaXR5OnQuYXV0aG9yaXR5KStmdW5jdGlvbih0KXt2YXIgZT1bXTtyZXR1cm4gdC5yZXBsYWNlKC9eKFxcLlxcLj8oXFwvfCQpKSsvLFwiXCIpLnJlcGxhY2UoL1xcLyhcXC4oXFwvfCQpKSsvZyxcIi9cIikucmVwbGFjZSgvXFwvXFwuXFwuJC8sXCIvLi4vXCIpLnJlcGxhY2UoL1xcLz9bXlxcL10qL2csZnVuY3Rpb24odCl7XCIvLi5cIj09PXQ/ZS5wb3AoKTplLnB1c2godCl9KSxlLmpvaW4oXCJcIikucmVwbGFjZSgvXlxcLy8sXCIvXCI9PT10LmNoYXJBdCgwKT9cIi9cIjpcIlwiKX0oZS5wcm90b2NvbHx8ZS5hdXRob3JpdHl8fFwiL1wiPT09ZS5wYXRobmFtZS5jaGFyQXQoMCk/ZS5wYXRobmFtZTplLnBhdGhuYW1lPyh0LmF1dGhvcml0eSYmIXQucGF0aG5hbWU/XCIvXCI6XCJcIikrdC5wYXRobmFtZS5zbGljZSgwLHQucGF0aG5hbWUubGFzdEluZGV4T2YoXCIvXCIpKzEpK2UucGF0aG5hbWU6dC5wYXRobmFtZSkrKGUucHJvdG9jb2x8fGUuYXV0aG9yaXR5fHxlLnBhdGhuYW1lP2Uuc2VhcmNoOmUuc2VhcmNofHx0LnNlYXJjaCkrZS5oYXNoOm51bGx9ZnVuY3Rpb24gYSh0KXtyZXR1cm4gdC5zcGxpdChcIiNcIilbMF19ZnVuY3Rpb24gdSh0LGUpe2lmKHQmJlwib2JqZWN0XCI9PXR5cGVvZiB0KWlmKHZvaWQgMD09PWU/ZT10LmlkOlwic3RyaW5nXCI9PXR5cGVvZiB0LmlkJiYoZT1vKGUsdC5pZCksdC5pZD1lKSxBcnJheS5pc0FycmF5KHQpKWZvcih2YXIgcj0wO3I8dC5sZW5ndGg7cisrKXUodFtyXSxlKTtlbHNle1wic3RyaW5nXCI9PXR5cGVvZiB0LiRyZWYmJih0LiRyZWY9byhlLHQuJHJlZikpO2Zvcih2YXIgbiBpbiB0KVwiZW51bVwiIT09biYmdSh0W25dLGUpfX1mdW5jdGlvbiBzKHQpe3Q9dHx8XCJlblwiO3ZhciBlPWJbdF07cmV0dXJuIGZ1bmN0aW9uKHQpe3ZhciByPWVbdC5jb2RlXXx8T1t0LmNvZGVdO2lmKFwic3RyaW5nXCIhPXR5cGVvZiByKXJldHVyblwiVW5rbm93biBlcnJvciBjb2RlIFwiK3QuY29kZStcIjogXCIrSlNPTi5zdHJpbmdpZnkodC5tZXNzYWdlUGFyYW1zKTt2YXIgbj10LnBhcmFtcztyZXR1cm4gci5yZXBsYWNlKC9cXHsoW157fV0qKVxcfS9nLGZ1bmN0aW9uKHQsZSl7dmFyIHI9bltlXTtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2Ygcnx8XCJudW1iZXJcIj09dHlwZW9mIHI/cjp0fSl9fWZ1bmN0aW9uIGModCxlLHIsbixpKXtpZihFcnJvci5jYWxsKHRoaXMpLHZvaWQgMD09PXQpdGhyb3cgbmV3IEVycm9yKFwiTm8gZXJyb3IgY29kZSBzdXBwbGllZDogXCIrbik7dGhpcy5tZXNzYWdlPVwiXCIsdGhpcy5wYXJhbXM9ZSx0aGlzLmNvZGU9dCx0aGlzLmRhdGFQYXRoPXJ8fFwiXCIsdGhpcy5zY2hlbWFQYXRoPW58fFwiXCIsdGhpcy5zdWJFcnJvcnM9aXx8bnVsbDt2YXIgbz1uZXcgRXJyb3IodGhpcy5tZXNzYWdlKTtpZih0aGlzLnN0YWNrPW8uc3RhY2t8fG8uc3RhY2t0cmFjZSwhdGhpcy5zdGFjayl0cnl7dGhyb3cgb31jYXRjaChvKXt0aGlzLnN0YWNrPW8uc3RhY2t8fG8uc3RhY2t0cmFjZX19ZnVuY3Rpb24gbCh0LGUpe2lmKGUuc3Vic3RyaW5nKDAsdC5sZW5ndGgpPT09dCl7dmFyIHI9ZS5zdWJzdHJpbmcodC5sZW5ndGgpO2lmKGUubGVuZ3RoPjAmJlwiL1wiPT09ZS5jaGFyQXQodC5sZW5ndGgtMSl8fFwiI1wiPT09ci5jaGFyQXQoMCl8fFwiP1wiPT09ci5jaGFyQXQoMCkpcmV0dXJuITB9cmV0dXJuITF9ZnVuY3Rpb24gZih0KXt2YXIgZSxyLG49bmV3IGQsaT17c2V0RXJyb3JSZXBvcnRlcjpmdW5jdGlvbih0KXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgdD90aGlzLmxhbmd1YWdlKHQpOihyPXQsITApfSxhZGRGb3JtYXQ6ZnVuY3Rpb24oKXtuLmFkZEZvcm1hdC5hcHBseShuLGFyZ3VtZW50cyl9LGxhbmd1YWdlOmZ1bmN0aW9uKHQpe3JldHVybiB0PyhiW3RdfHwodD10LnNwbGl0KFwiLVwiKVswXSksISFiW3RdJiYoZT10LHQpKTplfSxhZGRMYW5ndWFnZTpmdW5jdGlvbih0LGUpe3ZhciByO2ZvcihyIGluIG0pZVtyXSYmIWVbbVtyXV0mJihlW21bcl1dPWVbcl0pO3ZhciBuPXQuc3BsaXQoXCItXCIpWzBdO2lmKGJbbl0pe2JbdF09T2JqZWN0LmNyZWF0ZShiW25dKTtmb3IociBpbiBlKXZvaWQgMD09PWJbbl1bcl0mJihiW25dW3JdPWVbcl0pLGJbdF1bcl09ZVtyXX1lbHNlIGJbdF09ZSxiW25dPWU7cmV0dXJuIHRoaXN9LGZyZXNoQXBpOmZ1bmN0aW9uKHQpe3ZhciBlPWYoKTtyZXR1cm4gdCYmZS5sYW5ndWFnZSh0KSxlfSx2YWxpZGF0ZTpmdW5jdGlvbih0LGksbyxhKXt2YXIgdT1zKGUpLGM9cj9mdW5jdGlvbih0LGUsbil7cmV0dXJuIHIodCxlLG4pfHx1KHQsZSxuKX06dSxsPW5ldyBkKG4sITEsYyxvLGEpO1wic3RyaW5nXCI9PXR5cGVvZiBpJiYoaT17JHJlZjppfSksbC5hZGRTY2hlbWEoXCJcIixpKTt2YXIgZj1sLnZhbGlkYXRlQWxsKHQsaSxudWxsLG51bGwsXCJcIik7cmV0dXJuIWYmJmEmJihmPWwuYmFuVW5rbm93blByb3BlcnRpZXModCxpKSksdGhpcy5lcnJvcj1mLHRoaXMubWlzc2luZz1sLm1pc3NpbmcsdGhpcy52YWxpZD1udWxsPT09Zix0aGlzLnZhbGlkfSx2YWxpZGF0ZVJlc3VsdDpmdW5jdGlvbigpe3ZhciB0PXt0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLnZhbGlkP1widmFsaWRcIjp0aGlzLmVycm9yLm1lc3NhZ2V9fTtyZXR1cm4gdGhpcy52YWxpZGF0ZS5hcHBseSh0LGFyZ3VtZW50cyksdH0sdmFsaWRhdGVNdWx0aXBsZTpmdW5jdGlvbih0LGksbyxhKXt2YXIgdT1zKGUpLGM9cj9mdW5jdGlvbih0LGUsbil7cmV0dXJuIHIodCxlLG4pfHx1KHQsZSxuKX06dSxsPW5ldyBkKG4sITAsYyxvLGEpO1wic3RyaW5nXCI9PXR5cGVvZiBpJiYoaT17JHJlZjppfSksbC5hZGRTY2hlbWEoXCJcIixpKSxsLnZhbGlkYXRlQWxsKHQsaSxudWxsLG51bGwsXCJcIiksYSYmbC5iYW5Vbmtub3duUHJvcGVydGllcyh0LGkpO3ZhciBmPXt0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLnZhbGlkP1widmFsaWRcIjp0aGlzLmVycm9yLm1lc3NhZ2V9fTtyZXR1cm4gZi5lcnJvcnM9bC5lcnJvcnMsZi5taXNzaW5nPWwubWlzc2luZyxmLnZhbGlkPTA9PT1mLmVycm9ycy5sZW5ndGgsZn0sYWRkU2NoZW1hOmZ1bmN0aW9uKCl7cmV0dXJuIG4uYWRkU2NoZW1hLmFwcGx5KG4sYXJndW1lbnRzKX0sZ2V0U2NoZW1hOmZ1bmN0aW9uKCl7cmV0dXJuIG4uZ2V0U2NoZW1hLmFwcGx5KG4sYXJndW1lbnRzKX0sZ2V0U2NoZW1hTWFwOmZ1bmN0aW9uKCl7cmV0dXJuIG4uZ2V0U2NoZW1hTWFwLmFwcGx5KG4sYXJndW1lbnRzKX0sZ2V0U2NoZW1hVXJpczpmdW5jdGlvbigpe3JldHVybiBuLmdldFNjaGVtYVVyaXMuYXBwbHkobixhcmd1bWVudHMpfSxnZXRNaXNzaW5nVXJpczpmdW5jdGlvbigpe3JldHVybiBuLmdldE1pc3NpbmdVcmlzLmFwcGx5KG4sYXJndW1lbnRzKX0sZHJvcFNjaGVtYXM6ZnVuY3Rpb24oKXtuLmRyb3BTY2hlbWFzLmFwcGx5KG4sYXJndW1lbnRzKX0sZGVmaW5lS2V5d29yZDpmdW5jdGlvbigpe24uZGVmaW5lS2V5d29yZC5hcHBseShuLGFyZ3VtZW50cyl9LGRlZmluZUVycm9yOmZ1bmN0aW9uKHQsZSxyKXtpZihcInN0cmluZ1wiIT10eXBlb2YgdHx8IS9eW0EtWl0rKF9bQS1aXSspKiQvLnRlc3QodCkpdGhyb3cgbmV3IEVycm9yKFwiQ29kZSBuYW1lIG11c3QgYmUgYSBzdHJpbmcgaW4gVVBQRVJfQ0FTRV9XSVRIX1VOREVSU0NPUkVTXCIpO2lmKFwibnVtYmVyXCIhPXR5cGVvZiBlfHxlJTEhPTB8fGU8MWU0KXRocm93IG5ldyBFcnJvcihcIkNvZGUgbnVtYmVyIG11c3QgYmUgYW4gaW50ZWdlciA+IDEwMDAwXCIpO2lmKHZvaWQgMCE9PW1bdF0pdGhyb3cgbmV3IEVycm9yKFwiRXJyb3IgYWxyZWFkeSBkZWZpbmVkOiBcIit0K1wiIGFzIFwiK21bdF0pO2lmKHZvaWQgMCE9PWdbZV0pdGhyb3cgbmV3IEVycm9yKFwiRXJyb3IgY29kZSBhbHJlYWR5IHVzZWQ6IFwiK2dbZV0rXCIgYXMgXCIrZSk7bVt0XT1lLGdbZV09dCxPW3RdPU9bZV09cjtmb3IodmFyIG4gaW4gYil7dmFyIGk9YltuXTtpW3RdJiYoaVtlXT1pW2VdfHxpW3RdKX19LHJlc2V0OmZ1bmN0aW9uKCl7bi5yZXNldCgpLHRoaXMuZXJyb3I9bnVsbCx0aGlzLm1pc3Npbmc9W10sdGhpcy52YWxpZD0hMH0sbWlzc2luZzpbXSxlcnJvcjpudWxsLHZhbGlkOiEwLG5vcm1TY2hlbWE6dSxyZXNvbHZlVXJsOm8sZ2V0RG9jdW1lbnRVcmk6YSxlcnJvckNvZGVzOm19O3JldHVybiBpLmxhbmd1YWdlKHR8fFwiZW5cIiksaX1PYmplY3Qua2V5c3x8KE9iamVjdC5rZXlzPWZ1bmN0aW9uKCl7dmFyIHQ9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxlPSF7dG9TdHJpbmc6bnVsbH0ucHJvcGVydHlJc0VudW1lcmFibGUoXCJ0b1N0cmluZ1wiKSxyPVtcInRvU3RyaW5nXCIsXCJ0b0xvY2FsZVN0cmluZ1wiLFwidmFsdWVPZlwiLFwiaGFzT3duUHJvcGVydHlcIixcImlzUHJvdG90eXBlT2ZcIixcInByb3BlcnR5SXNFbnVtZXJhYmxlXCIsXCJjb25zdHJ1Y3RvclwiXSxuPXIubGVuZ3RoO3JldHVybiBmdW5jdGlvbihpKXtpZihcIm9iamVjdFwiIT10eXBlb2YgaSYmXCJmdW5jdGlvblwiIT10eXBlb2YgaXx8bnVsbD09PWkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIk9iamVjdC5rZXlzIGNhbGxlZCBvbiBub24tb2JqZWN0XCIpO3ZhciBvPVtdO2Zvcih2YXIgYSBpbiBpKXQuY2FsbChpLGEpJiZvLnB1c2goYSk7aWYoZSlmb3IodmFyIHU9MDt1PG47dSsrKXQuY2FsbChpLHJbdV0pJiZvLnB1c2goclt1XSk7cmV0dXJuIG99fSgpKSxPYmplY3QuY3JlYXRlfHwoT2JqZWN0LmNyZWF0ZT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9cmV0dXJuIGZ1bmN0aW9uKGUpe2lmKDEhPT1hcmd1bWVudHMubGVuZ3RoKXRocm93IG5ldyBFcnJvcihcIk9iamVjdC5jcmVhdGUgaW1wbGVtZW50YXRpb24gb25seSBhY2NlcHRzIG9uZSBwYXJhbWV0ZXIuXCIpO3JldHVybiB0LnByb3RvdHlwZT1lLG5ldyB0fX0oKSksQXJyYXkuaXNBcnJheXx8KEFycmF5LmlzQXJyYXk9ZnVuY3Rpb24odCl7cmV0dXJuXCJbb2JqZWN0IEFycmF5XVwiPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSksQXJyYXkucHJvdG90eXBlLmluZGV4T2Z8fChBcnJheS5wcm90b3R5cGUuaW5kZXhPZj1mdW5jdGlvbih0KXtpZihudWxsPT09dGhpcyl0aHJvdyBuZXcgVHlwZUVycm9yO3ZhciBlPU9iamVjdCh0aGlzKSxyPWUubGVuZ3RoPj4+MDtpZigwPT09cilyZXR1cm4tMTt2YXIgbj0wO2lmKGFyZ3VtZW50cy5sZW5ndGg+MSYmKG49TnVtYmVyKGFyZ3VtZW50c1sxXSksbiE9PW4/bj0wOjAhPT1uJiZuIT09MS8wJiZuIT09LTEvMCYmKG49KG4+MHx8LTEpKk1hdGguZmxvb3IoTWF0aC5hYnMobikpKSksbj49cilyZXR1cm4tMTtmb3IodmFyIGk9bj49MD9uOk1hdGgubWF4KHItTWF0aC5hYnMobiksMCk7aTxyO2krKylpZihpIGluIGUmJmVbaV09PT10KXJldHVybiBpO3JldHVybi0xfSksT2JqZWN0LmlzRnJvemVufHwoT2JqZWN0LmlzRnJvemVuPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1cInR2NF90ZXN0X2Zyb3plbl9rZXlcIjt0Lmhhc093blByb3BlcnR5KGUpOyllKz1NYXRoLnJhbmRvbSgpO3RyeXtyZXR1cm4gdFtlXT0hMCxkZWxldGUgdFtlXSwhMX1jYXRjaCh0KXtyZXR1cm4hMH19KTt2YXIgaD17XCIrXCI6ITAsXCIjXCI6ITAsXCIuXCI6ITAsXCIvXCI6ITAsXCI7XCI6ITAsXCI/XCI6ITAsXCImXCI6ITB9LHA9e1wiKlwiOiEwfTtyLnByb3RvdHlwZT17dG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50ZW1wbGF0ZX0sZmlsbEZyb21PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZmlsbChmdW5jdGlvbihlKXtyZXR1cm4gdFtlXX0pfX07dmFyIGQ9ZnVuY3Rpb24odCxlLHIsbixpKXtpZih0aGlzLm1pc3Npbmc9W10sdGhpcy5taXNzaW5nTWFwPXt9LHRoaXMuZm9ybWF0VmFsaWRhdG9ycz10P09iamVjdC5jcmVhdGUodC5mb3JtYXRWYWxpZGF0b3JzKTp7fSx0aGlzLnNjaGVtYXM9dD9PYmplY3QuY3JlYXRlKHQuc2NoZW1hcyk6e30sdGhpcy5jb2xsZWN0TXVsdGlwbGU9ZSx0aGlzLmVycm9ycz1bXSx0aGlzLmhhbmRsZUVycm9yPWU/dGhpcy5jb2xsZWN0RXJyb3I6dGhpcy5yZXR1cm5FcnJvcixuJiYodGhpcy5jaGVja1JlY3Vyc2l2ZT0hMCx0aGlzLnNjYW5uZWQ9W10sdGhpcy5zY2FubmVkRnJvemVuPVtdLHRoaXMuc2Nhbm5lZEZyb3plblNjaGVtYXM9W10sdGhpcy5zY2FubmVkRnJvemVuVmFsaWRhdGlvbkVycm9ycz1bXSx0aGlzLnZhbGlkYXRlZFNjaGVtYXNLZXk9XCJ0djRfdmFsaWRhdGlvbl9pZFwiLHRoaXMudmFsaWRhdGlvbkVycm9yc0tleT1cInR2NF92YWxpZGF0aW9uX2Vycm9yc19pZFwiKSxpJiYodGhpcy50cmFja1Vua25vd25Qcm9wZXJ0aWVzPSEwLHRoaXMua25vd25Qcm9wZXJ0eVBhdGhzPXt9LHRoaXMudW5rbm93blByb3BlcnR5UGF0aHM9e30pLHRoaXMuZXJyb3JSZXBvcnRlcj1yfHxzKFwiZW5cIiksXCJzdHJpbmdcIj09dHlwZW9mIHRoaXMuZXJyb3JSZXBvcnRlcil0aHJvdyBuZXcgRXJyb3IoXCJkZWJ1Z1wiKTtpZih0aGlzLmRlZmluZWRLZXl3b3Jkcz17fSx0KWZvcih2YXIgbyBpbiB0LmRlZmluZWRLZXl3b3Jkcyl0aGlzLmRlZmluZWRLZXl3b3Jkc1tvXT10LmRlZmluZWRLZXl3b3Jkc1tvXS5zbGljZSgwKX07ZC5wcm90b3R5cGUuZGVmaW5lS2V5d29yZD1mdW5jdGlvbih0LGUpe3RoaXMuZGVmaW5lZEtleXdvcmRzW3RdPXRoaXMuZGVmaW5lZEtleXdvcmRzW3RdfHxbXSx0aGlzLmRlZmluZWRLZXl3b3Jkc1t0XS5wdXNoKGUpfSxkLnByb3RvdHlwZS5jcmVhdGVFcnJvcj1mdW5jdGlvbih0LGUscixuLGksbyxhKXt2YXIgdT1uZXcgYyh0LGUscixuLGkpO3JldHVybiB1Lm1lc3NhZ2U9dGhpcy5lcnJvclJlcG9ydGVyKHUsbyxhKSx1fSxkLnByb3RvdHlwZS5yZXR1cm5FcnJvcj1mdW5jdGlvbih0KXtyZXR1cm4gdH0sZC5wcm90b3R5cGUuY29sbGVjdEVycm9yPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0aGlzLmVycm9ycy5wdXNoKHQpLG51bGx9LGQucHJvdG90eXBlLnByZWZpeEVycm9ycz1mdW5jdGlvbih0LGUscil7Zm9yKHZhciBuPXQ7bjx0aGlzLmVycm9ycy5sZW5ndGg7bisrKXRoaXMuZXJyb3JzW25dPXRoaXMuZXJyb3JzW25dLnByZWZpeFdpdGgoZSxyKTtyZXR1cm4gdGhpc30sZC5wcm90b3R5cGUuYmFuVW5rbm93blByb3BlcnRpZXM9ZnVuY3Rpb24odCxlKXtmb3IodmFyIHIgaW4gdGhpcy51bmtub3duUHJvcGVydHlQYXRocyl7dmFyIG49dGhpcy5jcmVhdGVFcnJvcihtLlVOS05PV05fUFJPUEVSVFkse3BhdGg6cn0scixcIlwiLG51bGwsdCxlKSxpPXRoaXMuaGFuZGxlRXJyb3Iobik7aWYoaSlyZXR1cm4gaX1yZXR1cm4gbnVsbH0sZC5wcm90b3R5cGUuYWRkRm9ybWF0PWZ1bmN0aW9uKHQsZSl7aWYoXCJvYmplY3RcIj09dHlwZW9mIHQpe2Zvcih2YXIgciBpbiB0KXRoaXMuYWRkRm9ybWF0KHIsdFtyXSk7cmV0dXJuIHRoaXN9dGhpcy5mb3JtYXRWYWxpZGF0b3JzW3RdPWV9LGQucHJvdG90eXBlLnJlc29sdmVSZWZzPWZ1bmN0aW9uKHQsZSl7aWYodm9pZCAwIT09dC4kcmVmKXtpZihlPWV8fHt9LGVbdC4kcmVmXSlyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihtLkNJUkNVTEFSX1JFRkVSRU5DRSx7dXJsczpPYmplY3Qua2V5cyhlKS5qb2luKFwiLCBcIil9LFwiXCIsXCJcIixudWxsLHZvaWQgMCx0KTtlW3QuJHJlZl09ITAsdD10aGlzLmdldFNjaGVtYSh0LiRyZWYsZSl9cmV0dXJuIHR9LGQucHJvdG90eXBlLmdldFNjaGVtYT1mdW5jdGlvbih0LGUpe3ZhciByO2lmKHZvaWQgMCE9PXRoaXMuc2NoZW1hc1t0XSlyZXR1cm4gcj10aGlzLnNjaGVtYXNbdF0sdGhpcy5yZXNvbHZlUmVmcyhyLGUpO3ZhciBuPXQsaT1cIlwiO2lmKC0xIT09dC5pbmRleE9mKFwiI1wiKSYmKGk9dC5zdWJzdHJpbmcodC5pbmRleE9mKFwiI1wiKSsxKSxuPXQuc3Vic3RyaW5nKDAsdC5pbmRleE9mKFwiI1wiKSkpLFwib2JqZWN0XCI9PXR5cGVvZiB0aGlzLnNjaGVtYXNbbl0pe3I9dGhpcy5zY2hlbWFzW25dO3ZhciBvPWRlY29kZVVSSUNvbXBvbmVudChpKTtpZihcIlwiPT09bylyZXR1cm4gdGhpcy5yZXNvbHZlUmVmcyhyLGUpO2lmKFwiL1wiIT09by5jaGFyQXQoMCkpcmV0dXJuO2Zvcih2YXIgYT1vLnNwbGl0KFwiL1wiKS5zbGljZSgxKSx1PTA7dTxhLmxlbmd0aDt1Kyspe3ZhciBzPWFbdV0ucmVwbGFjZSgvfjEvZyxcIi9cIikucmVwbGFjZSgvfjAvZyxcIn5cIik7aWYodm9pZCAwPT09cltzXSl7cj12b2lkIDA7YnJlYWt9cj1yW3NdfWlmKHZvaWQgMCE9PXIpcmV0dXJuIHRoaXMucmVzb2x2ZVJlZnMocixlKX12b2lkIDA9PT10aGlzLm1pc3Npbmdbbl0mJih0aGlzLm1pc3NpbmcucHVzaChuKSx0aGlzLm1pc3Npbmdbbl09bix0aGlzLm1pc3NpbmdNYXBbbl09bil9LGQucHJvdG90eXBlLnNlYXJjaFNjaGVtYXM9ZnVuY3Rpb24odCxlKXtpZihBcnJheS5pc0FycmF5KHQpKWZvcih2YXIgcj0wO3I8dC5sZW5ndGg7cisrKXRoaXMuc2VhcmNoU2NoZW1hcyh0W3JdLGUpO2Vsc2UgaWYodCYmXCJvYmplY3RcIj09dHlwZW9mIHQpe1wic3RyaW5nXCI9PXR5cGVvZiB0LmlkJiZsKGUsdC5pZCkmJnZvaWQgMD09PXRoaXMuc2NoZW1hc1t0LmlkXSYmKHRoaXMuc2NoZW1hc1t0LmlkXT10KTtmb3IodmFyIG4gaW4gdClpZihcImVudW1cIiE9PW4paWYoXCJvYmplY3RcIj09dHlwZW9mIHRbbl0pdGhpcy5zZWFyY2hTY2hlbWFzKHRbbl0sZSk7ZWxzZSBpZihcIiRyZWZcIj09PW4pe3ZhciBpPWEodFtuXSk7aSYmdm9pZCAwPT09dGhpcy5zY2hlbWFzW2ldJiZ2b2lkIDA9PT10aGlzLm1pc3NpbmdNYXBbaV0mJih0aGlzLm1pc3NpbmdNYXBbaV09aSl9fX0sZC5wcm90b3R5cGUuYWRkU2NoZW1hPWZ1bmN0aW9uKHQsZSl7aWYoXCJzdHJpbmdcIiE9dHlwZW9mIHR8fHZvaWQgMD09PWUpe2lmKFwib2JqZWN0XCIhPXR5cGVvZiB0fHxcInN0cmluZ1wiIT10eXBlb2YgdC5pZClyZXR1cm47ZT10LHQ9ZS5pZH10PT09YSh0KStcIiNcIiYmKHQ9YSh0KSksdGhpcy5zY2hlbWFzW3RdPWUsZGVsZXRlIHRoaXMubWlzc2luZ01hcFt0XSx1KGUsdCksdGhpcy5zZWFyY2hTY2hlbWFzKGUsdCl9LGQucHJvdG90eXBlLmdldFNjaGVtYU1hcD1mdW5jdGlvbigpe3ZhciB0PXt9O2Zvcih2YXIgZSBpbiB0aGlzLnNjaGVtYXMpdFtlXT10aGlzLnNjaGVtYXNbZV07cmV0dXJuIHR9LGQucHJvdG90eXBlLmdldFNjaGVtYVVyaXM9ZnVuY3Rpb24odCl7dmFyIGU9W107Zm9yKHZhciByIGluIHRoaXMuc2NoZW1hcyl0JiYhdC50ZXN0KHIpfHxlLnB1c2gocik7cmV0dXJuIGV9LGQucHJvdG90eXBlLmdldE1pc3NpbmdVcmlzPWZ1bmN0aW9uKHQpe3ZhciBlPVtdO2Zvcih2YXIgciBpbiB0aGlzLm1pc3NpbmdNYXApdCYmIXQudGVzdChyKXx8ZS5wdXNoKHIpO3JldHVybiBlfSxkLnByb3RvdHlwZS5kcm9wU2NoZW1hcz1mdW5jdGlvbigpe3RoaXMuc2NoZW1hcz17fSx0aGlzLnJlc2V0KCl9LGQucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7dGhpcy5taXNzaW5nPVtdLHRoaXMubWlzc2luZ01hcD17fSx0aGlzLmVycm9ycz1bXX0sZC5wcm90b3R5cGUudmFsaWRhdGVBbGw9ZnVuY3Rpb24odCxlLHIsbixpKXt2YXIgbztpZighKGU9dGhpcy5yZXNvbHZlUmVmcyhlKSkpcmV0dXJuIG51bGw7aWYoZSBpbnN0YW5jZW9mIGMpcmV0dXJuIHRoaXMuZXJyb3JzLnB1c2goZSksZTt2YXIgYSx1PXRoaXMuZXJyb3JzLmxlbmd0aCxzPW51bGwsbD1udWxsO2lmKHRoaXMuY2hlY2tSZWN1cnNpdmUmJnQmJlwib2JqZWN0XCI9PXR5cGVvZiB0KXtpZihvPSF0aGlzLnNjYW5uZWQubGVuZ3RoLHRbdGhpcy52YWxpZGF0ZWRTY2hlbWFzS2V5XSl7dmFyIGY9dFt0aGlzLnZhbGlkYXRlZFNjaGVtYXNLZXldLmluZGV4T2YoZSk7aWYoLTEhPT1mKXJldHVybiB0aGlzLmVycm9ycz10aGlzLmVycm9ycy5jb25jYXQodFt0aGlzLnZhbGlkYXRpb25FcnJvcnNLZXldW2ZdKSxudWxsfWlmKE9iamVjdC5pc0Zyb3plbih0KSYmLTEhPT0oYT10aGlzLnNjYW5uZWRGcm96ZW4uaW5kZXhPZih0KSkpe3ZhciBoPXRoaXMuc2Nhbm5lZEZyb3plblNjaGVtYXNbYV0uaW5kZXhPZihlKTtpZigtMSE9PWgpcmV0dXJuIHRoaXMuZXJyb3JzPXRoaXMuZXJyb3JzLmNvbmNhdCh0aGlzLnNjYW5uZWRGcm96ZW5WYWxpZGF0aW9uRXJyb3JzW2FdW2hdKSxudWxsfWlmKHRoaXMuc2Nhbm5lZC5wdXNoKHQpLE9iamVjdC5pc0Zyb3plbih0KSktMT09PWEmJihhPXRoaXMuc2Nhbm5lZEZyb3plbi5sZW5ndGgsdGhpcy5zY2FubmVkRnJvemVuLnB1c2godCksdGhpcy5zY2FubmVkRnJvemVuU2NoZW1hcy5wdXNoKFtdKSkscz10aGlzLnNjYW5uZWRGcm96ZW5TY2hlbWFzW2FdLmxlbmd0aCx0aGlzLnNjYW5uZWRGcm96ZW5TY2hlbWFzW2FdW3NdPWUsdGhpcy5zY2FubmVkRnJvemVuVmFsaWRhdGlvbkVycm9yc1thXVtzXT1bXTtlbHNle2lmKCF0W3RoaXMudmFsaWRhdGVkU2NoZW1hc0tleV0pdHJ5e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LHRoaXMudmFsaWRhdGVkU2NoZW1hc0tleSx7dmFsdWU6W10sY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsdGhpcy52YWxpZGF0aW9uRXJyb3JzS2V5LHt2YWx1ZTpbXSxjb25maWd1cmFibGU6ITB9KX1jYXRjaChlKXt0W3RoaXMudmFsaWRhdGVkU2NoZW1hc0tleV09W10sdFt0aGlzLnZhbGlkYXRpb25FcnJvcnNLZXldPVtdfWw9dFt0aGlzLnZhbGlkYXRlZFNjaGVtYXNLZXldLmxlbmd0aCx0W3RoaXMudmFsaWRhdGVkU2NoZW1hc0tleV1bbF09ZSx0W3RoaXMudmFsaWRhdGlvbkVycm9yc0tleV1bbF09W119fXZhciBwPXRoaXMuZXJyb3JzLmxlbmd0aCxkPXRoaXMudmFsaWRhdGVCYXNpYyh0LGUsaSl8fHRoaXMudmFsaWRhdGVOdW1lcmljKHQsZSxpKXx8dGhpcy52YWxpZGF0ZVN0cmluZyh0LGUsaSl8fHRoaXMudmFsaWRhdGVBcnJheSh0LGUsaSl8fHRoaXMudmFsaWRhdGVPYmplY3QodCxlLGkpfHx0aGlzLnZhbGlkYXRlQ29tYmluYXRpb25zKHQsZSxpKXx8dGhpcy52YWxpZGF0ZUh5cGVybWVkaWEodCxlLGkpfHx0aGlzLnZhbGlkYXRlRm9ybWF0KHQsZSxpKXx8dGhpcy52YWxpZGF0ZURlZmluZWRLZXl3b3Jkcyh0LGUsaSl8fG51bGw7aWYobyl7Zm9yKDt0aGlzLnNjYW5uZWQubGVuZ3RoOyl7ZGVsZXRlIHRoaXMuc2Nhbm5lZC5wb3AoKVt0aGlzLnZhbGlkYXRlZFNjaGVtYXNLZXldfXRoaXMuc2Nhbm5lZEZyb3plbj1bXSx0aGlzLnNjYW5uZWRGcm96ZW5TY2hlbWFzPVtdfWlmKGR8fHAhPT10aGlzLmVycm9ycy5sZW5ndGgpZm9yKDtyJiZyLmxlbmd0aHx8biYmbi5sZW5ndGg7KXt2YXIgdj1yJiZyLmxlbmd0aD9cIlwiK3IucG9wKCk6bnVsbCx5PW4mJm4ubGVuZ3RoP1wiXCIrbi5wb3AoKTpudWxsO2QmJihkPWQucHJlZml4V2l0aCh2LHkpKSx0aGlzLnByZWZpeEVycm9ycyhwLHYseSl9cmV0dXJuIG51bGwhPT1zP3RoaXMuc2Nhbm5lZEZyb3plblZhbGlkYXRpb25FcnJvcnNbYV1bc109dGhpcy5lcnJvcnMuc2xpY2UodSk6bnVsbCE9PWwmJih0W3RoaXMudmFsaWRhdGlvbkVycm9yc0tleV1bbF09dGhpcy5lcnJvcnMuc2xpY2UodSkpLHRoaXMuaGFuZGxlRXJyb3IoZCl9LGQucHJvdG90eXBlLnZhbGlkYXRlRm9ybWF0PWZ1bmN0aW9uKHQsZSl7aWYoXCJzdHJpbmdcIiE9dHlwZW9mIGUuZm9ybWF0fHwhdGhpcy5mb3JtYXRWYWxpZGF0b3JzW2UuZm9ybWF0XSlyZXR1cm4gbnVsbDt2YXIgcj10aGlzLmZvcm1hdFZhbGlkYXRvcnNbZS5mb3JtYXRdLmNhbGwobnVsbCx0LGUpO3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiByfHxcIm51bWJlclwiPT10eXBlb2Ygcj90aGlzLmNyZWF0ZUVycm9yKG0uRk9STUFUX0NVU1RPTSx7bWVzc2FnZTpyfSxcIlwiLFwiL2Zvcm1hdFwiLG51bGwsdCxlKTpyJiZcIm9iamVjdFwiPT10eXBlb2Ygcj90aGlzLmNyZWF0ZUVycm9yKG0uRk9STUFUX0NVU1RPTSx7bWVzc2FnZTpyLm1lc3NhZ2V8fFwiP1wifSxyLmRhdGFQYXRofHxcIlwiLHIuc2NoZW1hUGF0aHx8XCIvZm9ybWF0XCIsbnVsbCx0LGUpOm51bGx9LGQucHJvdG90eXBlLnZhbGlkYXRlRGVmaW5lZEtleXdvcmRzPWZ1bmN0aW9uKHQsZSxyKXtmb3IodmFyIG4gaW4gdGhpcy5kZWZpbmVkS2V5d29yZHMpaWYodm9pZCAwIT09ZVtuXSlmb3IodmFyIGk9dGhpcy5kZWZpbmVkS2V5d29yZHNbbl0sbz0wO288aS5sZW5ndGg7bysrKXt2YXIgYT1pW29dLHU9YSh0LGVbbl0sZSxyKTtpZihcInN0cmluZ1wiPT10eXBlb2YgdXx8XCJudW1iZXJcIj09dHlwZW9mIHUpcmV0dXJuIHRoaXMuY3JlYXRlRXJyb3IobS5LRVlXT1JEX0NVU1RPTSx7a2V5Om4sbWVzc2FnZTp1fSxcIlwiLFwiXCIsbnVsbCx0LGUpLnByZWZpeFdpdGgobnVsbCxuKTtpZih1JiZcIm9iamVjdFwiPT10eXBlb2YgdSl7dmFyIHM9dS5jb2RlO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBzKXtpZighbVtzXSl0aHJvdyBuZXcgRXJyb3IoXCJVbmRlZmluZWQgZXJyb3IgY29kZSAodXNlIGRlZmluZUVycm9yKTogXCIrcyk7cz1tW3NdfWVsc2VcIm51bWJlclwiIT10eXBlb2YgcyYmKHM9bS5LRVlXT1JEX0NVU1RPTSk7dmFyIGM9XCJvYmplY3RcIj09dHlwZW9mIHUubWVzc2FnZT91Lm1lc3NhZ2U6e2tleTpuLG1lc3NhZ2U6dS5tZXNzYWdlfHxcIj9cIn0sbD11LnNjaGVtYVBhdGh8fFwiL1wiK24ucmVwbGFjZSgvfi9nLFwifjBcIikucmVwbGFjZSgvXFwvL2csXCJ+MVwiKTtyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihzLGMsdS5kYXRhUGF0aHx8bnVsbCxsLG51bGwsdCxlKX19cmV0dXJuIG51bGx9LGQucHJvdG90eXBlLnZhbGlkYXRlQmFzaWM9ZnVuY3Rpb24odCxlLHIpe3ZhciBuO3JldHVybihuPXRoaXMudmFsaWRhdGVUeXBlKHQsZSxyKSk/bi5wcmVmaXhXaXRoKG51bGwsXCJ0eXBlXCIpOihuPXRoaXMudmFsaWRhdGVFbnVtKHQsZSxyKSk/bi5wcmVmaXhXaXRoKG51bGwsXCJ0eXBlXCIpOm51bGx9LGQucHJvdG90eXBlLnZhbGlkYXRlVHlwZT1mdW5jdGlvbih0LGUpe2lmKHZvaWQgMD09PWUudHlwZSlyZXR1cm4gbnVsbDt2YXIgcj10eXBlb2YgdDtudWxsPT09dD9yPVwibnVsbFwiOkFycmF5LmlzQXJyYXkodCkmJihyPVwiYXJyYXlcIik7dmFyIG49ZS50eXBlO0FycmF5LmlzQXJyYXkobil8fChuPVtuXSk7Zm9yKHZhciBpPTA7aTxuLmxlbmd0aDtpKyspe3ZhciBvPW5baV07aWYobz09PXJ8fFwiaW50ZWdlclwiPT09byYmXCJudW1iZXJcIj09PXImJnQlMT09MClyZXR1cm4gbnVsbH1yZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihtLklOVkFMSURfVFlQRSx7dHlwZTpyLGV4cGVjdGVkOm4uam9pbihcIi9cIil9LFwiXCIsXCJcIixudWxsLHQsZSl9LGQucHJvdG90eXBlLnZhbGlkYXRlRW51bT1mdW5jdGlvbih0LGUpe2lmKHZvaWQgMD09PWUuZW51bSlyZXR1cm4gbnVsbDtmb3IodmFyIHI9MDtyPGUuZW51bS5sZW5ndGg7cisrKXtpZihuKHQsZS5lbnVtW3JdKSlyZXR1cm4gbnVsbH1yZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihtLkVOVU1fTUlTTUFUQ0gse3ZhbHVlOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBKU09OP0pTT04uc3RyaW5naWZ5KHQpOnR9LFwiXCIsXCJcIixudWxsLHQsZSl9LGQucHJvdG90eXBlLnZhbGlkYXRlTnVtZXJpYz1mdW5jdGlvbih0LGUscil7cmV0dXJuIHRoaXMudmFsaWRhdGVNdWx0aXBsZU9mKHQsZSxyKXx8dGhpcy52YWxpZGF0ZU1pbk1heCh0LGUscil8fHRoaXMudmFsaWRhdGVOYU4odCxlLHIpfHxudWxsfTt2YXIgdj1NYXRoLnBvdygyLC01MSkseT0xLXY7ZC5wcm90b3R5cGUudmFsaWRhdGVNdWx0aXBsZU9mPWZ1bmN0aW9uKHQsZSl7dmFyIHI9ZS5tdWx0aXBsZU9mfHxlLmRpdmlzaWJsZUJ5O2lmKHZvaWQgMD09PXIpcmV0dXJuIG51bGw7aWYoXCJudW1iZXJcIj09dHlwZW9mIHQpe3ZhciBuPXQvciUxO2lmKG4+PXYmJm48eSlyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihtLk5VTUJFUl9NVUxUSVBMRV9PRix7dmFsdWU6dCxtdWx0aXBsZU9mOnJ9LFwiXCIsXCJcIixudWxsLHQsZSl9cmV0dXJuIG51bGx9LGQucHJvdG90eXBlLnZhbGlkYXRlTWluTWF4PWZ1bmN0aW9uKHQsZSl7aWYoXCJudW1iZXJcIiE9dHlwZW9mIHQpcmV0dXJuIG51bGw7aWYodm9pZCAwIT09ZS5taW5pbXVtKXtpZih0PGUubWluaW11bSlyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihtLk5VTUJFUl9NSU5JTVVNLHt2YWx1ZTp0LG1pbmltdW06ZS5taW5pbXVtfSxcIlwiLFwiL21pbmltdW1cIixudWxsLHQsZSk7aWYoZS5leGNsdXNpdmVNaW5pbXVtJiZ0PT09ZS5taW5pbXVtKXJldHVybiB0aGlzLmNyZWF0ZUVycm9yKG0uTlVNQkVSX01JTklNVU1fRVhDTFVTSVZFLHt2YWx1ZTp0LG1pbmltdW06ZS5taW5pbXVtfSxcIlwiLFwiL2V4Y2x1c2l2ZU1pbmltdW1cIixudWxsLHQsZSl9aWYodm9pZCAwIT09ZS5tYXhpbXVtKXtpZih0PmUubWF4aW11bSlyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcihtLk5VTUJFUl9NQVhJTVVNLHt2YWx1ZTp0LG1heGltdW06ZS5tYXhpbXVtfSxcIlwiLFwiL21heGltdW1cIixudWxsLHQsZSk7aWYoZS5leGNsdXNpdmVNYXhpbXVtJiZ0PT09ZS5tYXhpbXVtKXJldHVybiB0aGlzLmNyZWF0ZUVycm9yKG0uTlVNQkVSX01BWElNVU1fRVhDTFVTSVZFLHt2YWx1ZTp0LG1heGltdW06ZS5tYXhpbXVtfSxcIlwiLFwiL2V4Y2x1c2l2ZU1heGltdW1cIixudWxsLHQsZSl9cmV0dXJuIG51bGx9LGQucHJvdG90eXBlLnZhbGlkYXRlTmFOPWZ1bmN0aW9uKHQsZSl7cmV0dXJuXCJudW1iZXJcIiE9dHlwZW9mIHQ/bnVsbDohMD09PWlzTmFOKHQpfHx0PT09MS8wfHx0PT09LTEvMD90aGlzLmNyZWF0ZUVycm9yKG0uTlVNQkVSX05PVF9BX05VTUJFUix7dmFsdWU6dH0sXCJcIixcIi90eXBlXCIsbnVsbCx0LGUpOm51bGx9LGQucHJvdG90eXBlLnZhbGlkYXRlU3RyaW5nPWZ1bmN0aW9uKHQsZSxyKXtyZXR1cm4gdGhpcy52YWxpZGF0ZVN0cmluZ0xlbmd0aCh0LGUscil8fHRoaXMudmFsaWRhdGVTdHJpbmdQYXR0ZXJuKHQsZSxyKXx8bnVsbH0sZC5wcm90b3R5cGUudmFsaWRhdGVTdHJpbmdMZW5ndGg9ZnVuY3Rpb24odCxlKXtyZXR1cm5cInN0cmluZ1wiIT10eXBlb2YgdD9udWxsOnZvaWQgMCE9PWUubWluTGVuZ3RoJiZ0Lmxlbmd0aDxlLm1pbkxlbmd0aD90aGlzLmNyZWF0ZUVycm9yKG0uU1RSSU5HX0xFTkdUSF9TSE9SVCx7bGVuZ3RoOnQubGVuZ3RoLG1pbmltdW06ZS5taW5MZW5ndGh9LFwiXCIsXCIvbWluTGVuZ3RoXCIsbnVsbCx0LGUpOnZvaWQgMCE9PWUubWF4TGVuZ3RoJiZ0Lmxlbmd0aD5lLm1heExlbmd0aD90aGlzLmNyZWF0ZUVycm9yKG0uU1RSSU5HX0xFTkdUSF9MT05HLHtsZW5ndGg6dC5sZW5ndGgsbWF4aW11bTplLm1heExlbmd0aH0sXCJcIixcIi9tYXhMZW5ndGhcIixudWxsLHQsZSk6bnVsbH0sZC5wcm90b3R5cGUudmFsaWRhdGVTdHJpbmdQYXR0ZXJuPWZ1bmN0aW9uKHQsZSl7aWYoXCJzdHJpbmdcIiE9dHlwZW9mIHR8fFwic3RyaW5nXCIhPXR5cGVvZiBlLnBhdHRlcm4mJiEoZS5wYXR0ZXJuIGluc3RhbmNlb2YgUmVnRXhwKSlyZXR1cm4gbnVsbDt2YXIgcjtpZihlLnBhdHRlcm4gaW5zdGFuY2VvZiBSZWdFeHApcj1lLnBhdHRlcm47ZWxzZXt2YXIgbixpPVwiXCIsbz1lLnBhdHRlcm4ubWF0Y2goL15cXC8oLispXFwvKFtpbWddKikkLyk7bz8obj1vWzFdLGk9b1syXSk6bj1lLnBhdHRlcm4scj1uZXcgUmVnRXhwKG4saSl9cmV0dXJuIHIudGVzdCh0KT9udWxsOnRoaXMuY3JlYXRlRXJyb3IobS5TVFJJTkdfUEFUVEVSTix7cGF0dGVybjplLnBhdHRlcm59LFwiXCIsXCIvcGF0dGVyblwiLG51bGwsdCxlKX0sZC5wcm90b3R5cGUudmFsaWRhdGVBcnJheT1mdW5jdGlvbih0LGUscil7cmV0dXJuIEFycmF5LmlzQXJyYXkodCk/dGhpcy52YWxpZGF0ZUFycmF5TGVuZ3RoKHQsZSxyKXx8dGhpcy52YWxpZGF0ZUFycmF5VW5pcXVlSXRlbXModCxlLHIpfHx0aGlzLnZhbGlkYXRlQXJyYXlJdGVtcyh0LGUscil8fG51bGw6bnVsbH0sZC5wcm90b3R5cGUudmFsaWRhdGVBcnJheUxlbmd0aD1mdW5jdGlvbih0LGUpe3ZhciByO3JldHVybiB2b2lkIDAhPT1lLm1pbkl0ZW1zJiZ0Lmxlbmd0aDxlLm1pbkl0ZW1zJiYocj10aGlzLmNyZWF0ZUVycm9yKG0uQVJSQVlfTEVOR1RIX1NIT1JULHtsZW5ndGg6dC5sZW5ndGgsbWluaW11bTplLm1pbkl0ZW1zfSxcIlwiLFwiL21pbkl0ZW1zXCIsbnVsbCx0LGUpLHRoaXMuaGFuZGxlRXJyb3IocikpP3I6dm9pZCAwIT09ZS5tYXhJdGVtcyYmdC5sZW5ndGg+ZS5tYXhJdGVtcyYmKHI9dGhpcy5jcmVhdGVFcnJvcihtLkFSUkFZX0xFTkdUSF9MT05HLHtsZW5ndGg6dC5sZW5ndGgsbWF4aW11bTplLm1heEl0ZW1zfSxcIlwiLFwiL21heEl0ZW1zXCIsbnVsbCx0LGUpLHRoaXMuaGFuZGxlRXJyb3IocikpP3I6bnVsbH0sZC5wcm90b3R5cGUudmFsaWRhdGVBcnJheVVuaXF1ZUl0ZW1zPWZ1bmN0aW9uKHQsZSl7aWYoZS51bmlxdWVJdGVtcylmb3IodmFyIHI9MDtyPHQubGVuZ3RoO3IrKylmb3IodmFyIGk9cisxO2k8dC5sZW5ndGg7aSsrKWlmKG4odFtyXSx0W2ldKSl7dmFyIG89dGhpcy5jcmVhdGVFcnJvcihtLkFSUkFZX1VOSVFVRSx7bWF0Y2gxOnIsbWF0Y2gyOml9LFwiXCIsXCIvdW5pcXVlSXRlbXNcIixudWxsLHQsZSk7aWYodGhpcy5oYW5kbGVFcnJvcihvKSlyZXR1cm4gb31yZXR1cm4gbnVsbH0sZC5wcm90b3R5cGUudmFsaWRhdGVBcnJheUl0ZW1zPWZ1bmN0aW9uKHQsZSxyKXtpZih2b2lkIDA9PT1lLml0ZW1zKXJldHVybiBudWxsO3ZhciBuLGk7aWYoQXJyYXkuaXNBcnJheShlLml0ZW1zKSl7Zm9yKGk9MDtpPHQubGVuZ3RoO2krKylpZihpPGUuaXRlbXMubGVuZ3RoKXtpZihuPXRoaXMudmFsaWRhdGVBbGwodFtpXSxlLml0ZW1zW2ldLFtpXSxbXCJpdGVtc1wiLGldLHIrXCIvXCIraSkpcmV0dXJuIG59ZWxzZSBpZih2b2lkIDAhPT1lLmFkZGl0aW9uYWxJdGVtcylpZihcImJvb2xlYW5cIj09dHlwZW9mIGUuYWRkaXRpb25hbEl0ZW1zKXtpZighZS5hZGRpdGlvbmFsSXRlbXMmJihuPXRoaXMuY3JlYXRlRXJyb3IobS5BUlJBWV9BRERJVElPTkFMX0lURU1TLHt9LFwiL1wiK2ksXCIvYWRkaXRpb25hbEl0ZW1zXCIsbnVsbCx0LGUpLHRoaXMuaGFuZGxlRXJyb3IobikpKXJldHVybiBufWVsc2UgaWYobj10aGlzLnZhbGlkYXRlQWxsKHRbaV0sZS5hZGRpdGlvbmFsSXRlbXMsW2ldLFtcImFkZGl0aW9uYWxJdGVtc1wiXSxyK1wiL1wiK2kpKXJldHVybiBufWVsc2UgZm9yKGk9MDtpPHQubGVuZ3RoO2krKylpZihuPXRoaXMudmFsaWRhdGVBbGwodFtpXSxlLml0ZW1zLFtpXSxbXCJpdGVtc1wiXSxyK1wiL1wiK2kpKXJldHVybiBuO3JldHVybiBudWxsfSxkLnByb3RvdHlwZS52YWxpZGF0ZU9iamVjdD1mdW5jdGlvbih0LGUscil7cmV0dXJuXCJvYmplY3RcIiE9dHlwZW9mIHR8fG51bGw9PT10fHxBcnJheS5pc0FycmF5KHQpP251bGw6dGhpcy52YWxpZGF0ZU9iamVjdE1pbk1heFByb3BlcnRpZXModCxlLHIpfHx0aGlzLnZhbGlkYXRlT2JqZWN0UmVxdWlyZWRQcm9wZXJ0aWVzKHQsZSxyKXx8dGhpcy52YWxpZGF0ZU9iamVjdFByb3BlcnRpZXModCxlLHIpfHx0aGlzLnZhbGlkYXRlT2JqZWN0RGVwZW5kZW5jaWVzKHQsZSxyKXx8bnVsbH0sZC5wcm90b3R5cGUudmFsaWRhdGVPYmplY3RNaW5NYXhQcm9wZXJ0aWVzPWZ1bmN0aW9uKHQsZSl7dmFyIHIsbj1PYmplY3Qua2V5cyh0KTtyZXR1cm4gdm9pZCAwIT09ZS5taW5Qcm9wZXJ0aWVzJiZuLmxlbmd0aDxlLm1pblByb3BlcnRpZXMmJihyPXRoaXMuY3JlYXRlRXJyb3IobS5PQkpFQ1RfUFJPUEVSVElFU19NSU5JTVVNLHtwcm9wZXJ0eUNvdW50Om4ubGVuZ3RoLG1pbmltdW06ZS5taW5Qcm9wZXJ0aWVzfSxcIlwiLFwiL21pblByb3BlcnRpZXNcIixudWxsLHQsZSksdGhpcy5oYW5kbGVFcnJvcihyKSk/cjp2b2lkIDAhPT1lLm1heFByb3BlcnRpZXMmJm4ubGVuZ3RoPmUubWF4UHJvcGVydGllcyYmKHI9dGhpcy5jcmVhdGVFcnJvcihtLk9CSkVDVF9QUk9QRVJUSUVTX01BWElNVU0se3Byb3BlcnR5Q291bnQ6bi5sZW5ndGgsbWF4aW11bTplLm1heFByb3BlcnRpZXN9LFwiXCIsXCIvbWF4UHJvcGVydGllc1wiLG51bGwsdCxlKSx0aGlzLmhhbmRsZUVycm9yKHIpKT9yOm51bGx9LGQucHJvdG90eXBlLnZhbGlkYXRlT2JqZWN0UmVxdWlyZWRQcm9wZXJ0aWVzPWZ1bmN0aW9uKHQsZSl7aWYodm9pZCAwIT09ZS5yZXF1aXJlZClmb3IodmFyIHI9MDtyPGUucmVxdWlyZWQubGVuZ3RoO3IrKyl7dmFyIG49ZS5yZXF1aXJlZFtyXTtpZih2b2lkIDA9PT10W25dKXt2YXIgaT10aGlzLmNyZWF0ZUVycm9yKG0uT0JKRUNUX1JFUVVJUkVELHtrZXk6bn0sXCJcIixcIi9yZXF1aXJlZC9cIityLG51bGwsdCxlKTtpZih0aGlzLmhhbmRsZUVycm9yKGkpKXJldHVybiBpfX1yZXR1cm4gbnVsbH0sZC5wcm90b3R5cGUudmFsaWRhdGVPYmplY3RQcm9wZXJ0aWVzPWZ1bmN0aW9uKHQsZSxyKXt2YXIgbjtmb3IodmFyIGkgaW4gdCl7dmFyIG89citcIi9cIitpLnJlcGxhY2UoL34vZyxcIn4wXCIpLnJlcGxhY2UoL1xcLy9nLFwifjFcIiksYT0hMTtpZih2b2lkIDAhPT1lLnByb3BlcnRpZXMmJnZvaWQgMCE9PWUucHJvcGVydGllc1tpXSYmKGE9ITAsbj10aGlzLnZhbGlkYXRlQWxsKHRbaV0sZS5wcm9wZXJ0aWVzW2ldLFtpXSxbXCJwcm9wZXJ0aWVzXCIsaV0sbykpKXJldHVybiBuO2lmKHZvaWQgMCE9PWUucGF0dGVyblByb3BlcnRpZXMpZm9yKHZhciB1IGluIGUucGF0dGVyblByb3BlcnRpZXMpe3ZhciBzPW5ldyBSZWdFeHAodSk7aWYocy50ZXN0KGkpJiYoYT0hMCxuPXRoaXMudmFsaWRhdGVBbGwodFtpXSxlLnBhdHRlcm5Qcm9wZXJ0aWVzW3VdLFtpXSxbXCJwYXR0ZXJuUHJvcGVydGllc1wiLHVdLG8pKSlyZXR1cm4gbn1pZihhKXRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcyYmKHRoaXMua25vd25Qcm9wZXJ0eVBhdGhzW29dPSEwLGRlbGV0ZSB0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzW29dKTtlbHNlIGlmKHZvaWQgMCE9PWUuYWRkaXRpb25hbFByb3BlcnRpZXMpe2lmKHRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcyYmKHRoaXMua25vd25Qcm9wZXJ0eVBhdGhzW29dPSEwLGRlbGV0ZSB0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzW29dKSxcImJvb2xlYW5cIj09dHlwZW9mIGUuYWRkaXRpb25hbFByb3BlcnRpZXMpe2lmKCFlLmFkZGl0aW9uYWxQcm9wZXJ0aWVzJiYobj10aGlzLmNyZWF0ZUVycm9yKG0uT0JKRUNUX0FERElUSU9OQUxfUFJPUEVSVElFUyx7a2V5Oml9LFwiXCIsXCIvYWRkaXRpb25hbFByb3BlcnRpZXNcIixudWxsLHQsZSkucHJlZml4V2l0aChpLG51bGwpLHRoaXMuaGFuZGxlRXJyb3IobikpKXJldHVybiBufWVsc2UgaWYobj10aGlzLnZhbGlkYXRlQWxsKHRbaV0sZS5hZGRpdGlvbmFsUHJvcGVydGllcyxbaV0sW1wiYWRkaXRpb25hbFByb3BlcnRpZXNcIl0sbykpcmV0dXJuIG59ZWxzZSB0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMmJiF0aGlzLmtub3duUHJvcGVydHlQYXRoc1tvXSYmKHRoaXMudW5rbm93blByb3BlcnR5UGF0aHNbb109ITApfXJldHVybiBudWxsfSxkLnByb3RvdHlwZS52YWxpZGF0ZU9iamVjdERlcGVuZGVuY2llcz1mdW5jdGlvbih0LGUscil7dmFyIG47aWYodm9pZCAwIT09ZS5kZXBlbmRlbmNpZXMpZm9yKHZhciBpIGluIGUuZGVwZW5kZW5jaWVzKWlmKHZvaWQgMCE9PXRbaV0pe3ZhciBvPWUuZGVwZW5kZW5jaWVzW2ldO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBvKXtpZih2b2lkIDA9PT10W29dJiYobj10aGlzLmNyZWF0ZUVycm9yKG0uT0JKRUNUX0RFUEVOREVOQ1lfS0VZLHtrZXk6aSxtaXNzaW5nOm99LFwiXCIsXCJcIixudWxsLHQsZSkucHJlZml4V2l0aChudWxsLGkpLnByZWZpeFdpdGgobnVsbCxcImRlcGVuZGVuY2llc1wiKSx0aGlzLmhhbmRsZUVycm9yKG4pKSlyZXR1cm4gbn1lbHNlIGlmKEFycmF5LmlzQXJyYXkobykpZm9yKHZhciBhPTA7YTxvLmxlbmd0aDthKyspe3ZhciB1PW9bYV07aWYodm9pZCAwPT09dFt1XSYmKG49dGhpcy5jcmVhdGVFcnJvcihtLk9CSkVDVF9ERVBFTkRFTkNZX0tFWSx7a2V5OmksbWlzc2luZzp1fSxcIlwiLFwiL1wiK2EsbnVsbCx0LGUpLnByZWZpeFdpdGgobnVsbCxpKS5wcmVmaXhXaXRoKG51bGwsXCJkZXBlbmRlbmNpZXNcIiksdGhpcy5oYW5kbGVFcnJvcihuKSkpcmV0dXJuIG59ZWxzZSBpZihuPXRoaXMudmFsaWRhdGVBbGwodCxvLFtdLFtcImRlcGVuZGVuY2llc1wiLGldLHIpKXJldHVybiBufXJldHVybiBudWxsfSxkLnByb3RvdHlwZS52YWxpZGF0ZUNvbWJpbmF0aW9ucz1mdW5jdGlvbih0LGUscil7cmV0dXJuIHRoaXMudmFsaWRhdGVBbGxPZih0LGUscil8fHRoaXMudmFsaWRhdGVBbnlPZih0LGUscil8fHRoaXMudmFsaWRhdGVPbmVPZih0LGUscil8fHRoaXMudmFsaWRhdGVOb3QodCxlLHIpfHxudWxsfSxkLnByb3RvdHlwZS52YWxpZGF0ZUFsbE9mPWZ1bmN0aW9uKHQsZSxyKXtpZih2b2lkIDA9PT1lLmFsbE9mKXJldHVybiBudWxsO2Zvcih2YXIgbixpPTA7aTxlLmFsbE9mLmxlbmd0aDtpKyspe3ZhciBvPWUuYWxsT2ZbaV07aWYobj10aGlzLnZhbGlkYXRlQWxsKHQsbyxbXSxbXCJhbGxPZlwiLGldLHIpKXJldHVybiBufXJldHVybiBudWxsfSxkLnByb3RvdHlwZS52YWxpZGF0ZUFueU9mPWZ1bmN0aW9uKHQsZSxyKXtpZih2b2lkIDA9PT1lLmFueU9mKXJldHVybiBudWxsO3ZhciBuLGksbz1bXSxhPXRoaXMuZXJyb3JzLmxlbmd0aDt0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMmJihuPXRoaXMudW5rbm93blByb3BlcnR5UGF0aHMsaT10aGlzLmtub3duUHJvcGVydHlQYXRocyk7Zm9yKHZhciB1PSEwLHM9MDtzPGUuYW55T2YubGVuZ3RoO3MrKyl7dGhpcy50cmFja1Vua25vd25Qcm9wZXJ0aWVzJiYodGhpcy51bmtub3duUHJvcGVydHlQYXRocz17fSx0aGlzLmtub3duUHJvcGVydHlQYXRocz17fSk7dmFyIGM9ZS5hbnlPZltzXSxsPXRoaXMuZXJyb3JzLmxlbmd0aCxmPXRoaXMudmFsaWRhdGVBbGwodCxjLFtdLFtcImFueU9mXCIsc10scik7aWYobnVsbD09PWYmJmw9PT10aGlzLmVycm9ycy5sZW5ndGgpe2lmKHRoaXMuZXJyb3JzPXRoaXMuZXJyb3JzLnNsaWNlKDAsYSksdGhpcy50cmFja1Vua25vd25Qcm9wZXJ0aWVzKXtmb3IodmFyIGggaW4gdGhpcy5rbm93blByb3BlcnR5UGF0aHMpaVtoXT0hMCxkZWxldGUgbltoXTtmb3IodmFyIHAgaW4gdGhpcy51bmtub3duUHJvcGVydHlQYXRocylpW3BdfHwobltwXT0hMCk7dT0hMTtjb250aW51ZX1yZXR1cm4gbnVsbH1mJiZvLnB1c2goZi5wcmVmaXhXaXRoKG51bGwsXCJcIitzKS5wcmVmaXhXaXRoKG51bGwsXCJhbnlPZlwiKSl9cmV0dXJuIHRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcyYmKHRoaXMudW5rbm93blByb3BlcnR5UGF0aHM9bix0aGlzLmtub3duUHJvcGVydHlQYXRocz1pKSx1PyhvPW8uY29uY2F0KHRoaXMuZXJyb3JzLnNsaWNlKGEpKSx0aGlzLmVycm9ycz10aGlzLmVycm9ycy5zbGljZSgwLGEpLHRoaXMuY3JlYXRlRXJyb3IobS5BTllfT0ZfTUlTU0lORyx7fSxcIlwiLFwiL2FueU9mXCIsbyx0LGUpKTp2b2lkIDB9LGQucHJvdG90eXBlLnZhbGlkYXRlT25lT2Y9ZnVuY3Rpb24odCxlLHIpe2lmKHZvaWQgMD09PWUub25lT2YpcmV0dXJuIG51bGw7dmFyIG4saSxvPW51bGwsYT1bXSx1PXRoaXMuZXJyb3JzLmxlbmd0aDt0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMmJihuPXRoaXMudW5rbm93blByb3BlcnR5UGF0aHMsaT10aGlzLmtub3duUHJvcGVydHlQYXRocyk7Zm9yKHZhciBzPTA7czxlLm9uZU9mLmxlbmd0aDtzKyspe3RoaXMudHJhY2tVbmtub3duUHJvcGVydGllcyYmKHRoaXMudW5rbm93blByb3BlcnR5UGF0aHM9e30sdGhpcy5rbm93blByb3BlcnR5UGF0aHM9e30pO3ZhciBjPWUub25lT2Zbc10sbD10aGlzLmVycm9ycy5sZW5ndGgsZj10aGlzLnZhbGlkYXRlQWxsKHQsYyxbXSxbXCJvbmVPZlwiLHNdLHIpO2lmKG51bGw9PT1mJiZsPT09dGhpcy5lcnJvcnMubGVuZ3RoKXtpZihudWxsIT09bylyZXR1cm4gdGhpcy5lcnJvcnM9dGhpcy5lcnJvcnMuc2xpY2UoMCx1KSx0aGlzLmNyZWF0ZUVycm9yKG0uT05FX09GX01VTFRJUExFLHtpbmRleDE6byxpbmRleDI6c30sXCJcIixcIi9vbmVPZlwiLG51bGwsdCxlKTtpZihvPXMsdGhpcy50cmFja1Vua25vd25Qcm9wZXJ0aWVzKXtmb3IodmFyIGggaW4gdGhpcy5rbm93blByb3BlcnR5UGF0aHMpaVtoXT0hMCxkZWxldGUgbltoXTtmb3IodmFyIHAgaW4gdGhpcy51bmtub3duUHJvcGVydHlQYXRocylpW3BdfHwobltwXT0hMCl9fWVsc2UgZiYmYS5wdXNoKGYpfXJldHVybiB0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMmJih0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzPW4sdGhpcy5rbm93blByb3BlcnR5UGF0aHM9aSksbnVsbD09PW8/KGE9YS5jb25jYXQodGhpcy5lcnJvcnMuc2xpY2UodSkpLHRoaXMuZXJyb3JzPXRoaXMuZXJyb3JzLnNsaWNlKDAsdSksdGhpcy5jcmVhdGVFcnJvcihtLk9ORV9PRl9NSVNTSU5HLHt9LFwiXCIsXCIvb25lT2ZcIixhLHQsZSkpOih0aGlzLmVycm9ycz10aGlzLmVycm9ycy5zbGljZSgwLHUpLG51bGwpfSxkLnByb3RvdHlwZS52YWxpZGF0ZU5vdD1mdW5jdGlvbih0LGUscil7aWYodm9pZCAwPT09ZS5ub3QpcmV0dXJuIG51bGw7dmFyIG4saSxvPXRoaXMuZXJyb3JzLmxlbmd0aDt0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMmJihuPXRoaXMudW5rbm93blByb3BlcnR5UGF0aHMsaT10aGlzLmtub3duUHJvcGVydHlQYXRocyx0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzPXt9LHRoaXMua25vd25Qcm9wZXJ0eVBhdGhzPXt9KTt2YXIgYT10aGlzLnZhbGlkYXRlQWxsKHQsZS5ub3QsbnVsbCxudWxsLHIpLHU9dGhpcy5lcnJvcnMuc2xpY2Uobyk7cmV0dXJuIHRoaXMuZXJyb3JzPXRoaXMuZXJyb3JzLnNsaWNlKDAsbyksdGhpcy50cmFja1Vua25vd25Qcm9wZXJ0aWVzJiYodGhpcy51bmtub3duUHJvcGVydHlQYXRocz1uLHRoaXMua25vd25Qcm9wZXJ0eVBhdGhzPWkpLG51bGw9PT1hJiYwPT09dS5sZW5ndGg/dGhpcy5jcmVhdGVFcnJvcihtLk5PVF9QQVNTRUQse30sXCJcIixcIi9ub3RcIixudWxsLHQsZSk6bnVsbH0sZC5wcm90b3R5cGUudmFsaWRhdGVIeXBlcm1lZGlhPWZ1bmN0aW9uKHQsZSxuKXtpZighZS5saW5rcylyZXR1cm4gbnVsbDtmb3IodmFyIGksbz0wO288ZS5saW5rcy5sZW5ndGg7bysrKXt2YXIgYT1lLmxpbmtzW29dO2lmKFwiZGVzY3JpYmVkYnlcIj09PWEucmVsKXtmb3IodmFyIHU9bmV3IHIoYS5ocmVmKSxzPSEwLGM9MDtjPHUudmFyTmFtZXMubGVuZ3RoO2MrKylpZighKHUudmFyTmFtZXNbY11pbiB0KSl7cz0hMTticmVha31pZihzKXt2YXIgbD11LmZpbGxGcm9tT2JqZWN0KHQpLGY9eyRyZWY6bH07aWYoaT10aGlzLnZhbGlkYXRlQWxsKHQsZixbXSxbXCJsaW5rc1wiLG9dLG4pKXJldHVybiBpfX19fTt2YXIgbT17SU5WQUxJRF9UWVBFOjAsRU5VTV9NSVNNQVRDSDoxLEFOWV9PRl9NSVNTSU5HOjEwLE9ORV9PRl9NSVNTSU5HOjExLE9ORV9PRl9NVUxUSVBMRToxMixOT1RfUEFTU0VEOjEzLE5VTUJFUl9NVUxUSVBMRV9PRjoxMDAsTlVNQkVSX01JTklNVU06MTAxLE5VTUJFUl9NSU5JTVVNX0VYQ0xVU0lWRToxMDIsTlVNQkVSX01BWElNVU06MTAzLE5VTUJFUl9NQVhJTVVNX0VYQ0xVU0lWRToxMDQsTlVNQkVSX05PVF9BX05VTUJFUjoxMDUsU1RSSU5HX0xFTkdUSF9TSE9SVDoyMDAsU1RSSU5HX0xFTkdUSF9MT05HOjIwMSxTVFJJTkdfUEFUVEVSTjoyMDIsT0JKRUNUX1BST1BFUlRJRVNfTUlOSU1VTTozMDAsT0JKRUNUX1BST1BFUlRJRVNfTUFYSU1VTTozMDEsT0JKRUNUX1JFUVVJUkVEOjMwMixPQkpFQ1RfQURESVRJT05BTF9QUk9QRVJUSUVTOjMwMyxPQkpFQ1RfREVQRU5ERU5DWV9LRVk6MzA0LEFSUkFZX0xFTkdUSF9TSE9SVDo0MDAsQVJSQVlfTEVOR1RIX0xPTkc6NDAxLEFSUkFZX1VOSVFVRTo0MDIsQVJSQVlfQURESVRJT05BTF9JVEVNUzo0MDMsRk9STUFUX0NVU1RPTTo1MDAsS0VZV09SRF9DVVNUT006NTAxLENJUkNVTEFSX1JFRkVSRU5DRTo2MDAsVU5LTk9XTl9QUk9QRVJUWToxZTN9LGc9e307Zm9yKHZhciBfIGluIG0pZ1ttW19dXT1fO3ZhciBPPXtJTlZBTElEX1RZUEU6XCJJbnZhbGlkIHR5cGU6IHt0eXBlfSAoZXhwZWN0ZWQge2V4cGVjdGVkfSlcIixFTlVNX01JU01BVENIOlwiTm8gZW51bSBtYXRjaCBmb3I6IHt2YWx1ZX1cIixBTllfT0ZfTUlTU0lORzonRGF0YSBkb2VzIG5vdCBtYXRjaCBhbnkgc2NoZW1hcyBmcm9tIFwiYW55T2ZcIicsT05FX09GX01JU1NJTkc6J0RhdGEgZG9lcyBub3QgbWF0Y2ggYW55IHNjaGVtYXMgZnJvbSBcIm9uZU9mXCInLE9ORV9PRl9NVUxUSVBMRTonRGF0YSBpcyB2YWxpZCBhZ2FpbnN0IG1vcmUgdGhhbiBvbmUgc2NoZW1hIGZyb20gXCJvbmVPZlwiOiBpbmRpY2VzIHtpbmRleDF9IGFuZCB7aW5kZXgyfScsTk9UX1BBU1NFRDonRGF0YSBtYXRjaGVzIHNjaGVtYSBmcm9tIFwibm90XCInLE5VTUJFUl9NVUxUSVBMRV9PRjpcIlZhbHVlIHt2YWx1ZX0gaXMgbm90IGEgbXVsdGlwbGUgb2Yge211bHRpcGxlT2Z9XCIsTlVNQkVSX01JTklNVU06XCJWYWx1ZSB7dmFsdWV9IGlzIGxlc3MgdGhhbiBtaW5pbXVtIHttaW5pbXVtfVwiLE5VTUJFUl9NSU5JTVVNX0VYQ0xVU0lWRTpcIlZhbHVlIHt2YWx1ZX0gaXMgZXF1YWwgdG8gZXhjbHVzaXZlIG1pbmltdW0ge21pbmltdW19XCIsTlVNQkVSX01BWElNVU06XCJWYWx1ZSB7dmFsdWV9IGlzIGdyZWF0ZXIgdGhhbiBtYXhpbXVtIHttYXhpbXVtfVwiLE5VTUJFUl9NQVhJTVVNX0VYQ0xVU0lWRTpcIlZhbHVlIHt2YWx1ZX0gaXMgZXF1YWwgdG8gZXhjbHVzaXZlIG1heGltdW0ge21heGltdW19XCIsTlVNQkVSX05PVF9BX05VTUJFUjpcIlZhbHVlIHt2YWx1ZX0gaXMgbm90IGEgdmFsaWQgbnVtYmVyXCIsU1RSSU5HX0xFTkdUSF9TSE9SVDpcIlN0cmluZyBpcyB0b28gc2hvcnQgKHtsZW5ndGh9IGNoYXJzKSwgbWluaW11bSB7bWluaW11bX1cIixTVFJJTkdfTEVOR1RIX0xPTkc6XCJTdHJpbmcgaXMgdG9vIGxvbmcgKHtsZW5ndGh9IGNoYXJzKSwgbWF4aW11bSB7bWF4aW11bX1cIixTVFJJTkdfUEFUVEVSTjpcIlN0cmluZyBkb2VzIG5vdCBtYXRjaCBwYXR0ZXJuOiB7cGF0dGVybn1cIixPQkpFQ1RfUFJPUEVSVElFU19NSU5JTVVNOlwiVG9vIGZldyBwcm9wZXJ0aWVzIGRlZmluZWQgKHtwcm9wZXJ0eUNvdW50fSksIG1pbmltdW0ge21pbmltdW19XCIsT0JKRUNUX1BST1BFUlRJRVNfTUFYSU1VTTpcIlRvbyBtYW55IHByb3BlcnRpZXMgZGVmaW5lZCAoe3Byb3BlcnR5Q291bnR9KSwgbWF4aW11bSB7bWF4aW11bX1cIixPQkpFQ1RfUkVRVUlSRUQ6XCJNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnR5OiB7a2V5fVwiLE9CSkVDVF9BRERJVElPTkFMX1BST1BFUlRJRVM6XCJBZGRpdGlvbmFsIHByb3BlcnRpZXMgbm90IGFsbG93ZWRcIixPQkpFQ1RfREVQRU5ERU5DWV9LRVk6XCJEZXBlbmRlbmN5IGZhaWxlZCAtIGtleSBtdXN0IGV4aXN0OiB7bWlzc2luZ30gKGR1ZSB0byBrZXk6IHtrZXl9KVwiLEFSUkFZX0xFTkdUSF9TSE9SVDpcIkFycmF5IGlzIHRvbyBzaG9ydCAoe2xlbmd0aH0pLCBtaW5pbXVtIHttaW5pbXVtfVwiLEFSUkFZX0xFTkdUSF9MT05HOlwiQXJyYXkgaXMgdG9vIGxvbmcgKHtsZW5ndGh9KSwgbWF4aW11bSB7bWF4aW11bX1cIixBUlJBWV9VTklRVUU6XCJBcnJheSBpdGVtcyBhcmUgbm90IHVuaXF1ZSAoaW5kaWNlcyB7bWF0Y2gxfSBhbmQge21hdGNoMn0pXCIsQVJSQVlfQURESVRJT05BTF9JVEVNUzpcIkFkZGl0aW9uYWwgaXRlbXMgbm90IGFsbG93ZWRcIixGT1JNQVRfQ1VTVE9NOlwiRm9ybWF0IHZhbGlkYXRpb24gZmFpbGVkICh7bWVzc2FnZX0pXCIsS0VZV09SRF9DVVNUT006XCJLZXl3b3JkIGZhaWxlZDoge2tleX0gKHttZXNzYWdlfSlcIixDSVJDVUxBUl9SRUZFUkVOQ0U6XCJDaXJjdWxhciAkcmVmczoge3VybHN9XCIsVU5LTk9XTl9QUk9QRVJUWTpcIlVua25vd24gcHJvcGVydHkgKG5vdCBpbiBzY2hlbWEpXCJ9O2MucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKSxjLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1jLGMucHJvdG90eXBlLm5hbWU9XCJWYWxpZGF0aW9uRXJyb3JcIixjLnByb3RvdHlwZS5wcmVmaXhXaXRoPWZ1bmN0aW9uKHQsZSl7aWYobnVsbCE9PXQmJih0PXQucmVwbGFjZSgvfi9nLFwifjBcIikucmVwbGFjZSgvXFwvL2csXCJ+MVwiKSx0aGlzLmRhdGFQYXRoPVwiL1wiK3QrdGhpcy5kYXRhUGF0aCksbnVsbCE9PWUmJihlPWUucmVwbGFjZSgvfi9nLFwifjBcIikucmVwbGFjZSgvXFwvL2csXCJ+MVwiKSx0aGlzLnNjaGVtYVBhdGg9XCIvXCIrZSt0aGlzLnNjaGVtYVBhdGgpLG51bGwhPT10aGlzLnN1YkVycm9ycylmb3IodmFyIHI9MDtyPHRoaXMuc3ViRXJyb3JzLmxlbmd0aDtyKyspdGhpcy5zdWJFcnJvcnNbcl0ucHJlZml4V2l0aCh0LGUpO3JldHVybiB0aGlzfTt2YXIgYj17fSxFPWYoKTtyZXR1cm4gRS5hZGRMYW5ndWFnZShcImVuLWdiXCIsTyksRS50djQ9RSxFfSl9LCwsZnVuY3Rpb24odCxlLHIpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIG4odCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OntkZWZhdWx0OnR9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBpPXIoMyksbz1uKGkpLGE9cig1KSx1PW4oYSkscz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSxyKXsoMCxvLmRlZmF1bHQpKHRoaXMsdCksdGhpcy5fc291cmNlQ29kZT1yLHRoaXMuX3NvdXJjZUNvZGVDbGFzc25hbWU9ZSx0aGlzLl9lbmNvZGluZz1udWxsLHRoaXMuX3NpZ25hdHVyZT1udWxsfXJldHVybigwLHUuZGVmYXVsdCkodCxbe2tleTpcInNvdXJjZUNvZGVcIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlQ29kZX0sc2V0OmZ1bmN0aW9uKHQpe3QmJih0aGlzLl9zb3VyY2VDb2RlPXQpfX0se2tleTpcInNvdXJjZUNvZGVDbGFzc25hbWVcIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlQ29kZUNsYXNzbmFtZX0sc2V0OmZ1bmN0aW9uKHQpe3QmJih0aGlzLl9zb3VyY2VDb2RlQ2xhc3NuYW1lPXQpfX0se2tleTpcImVuY29kaW5nXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VuY29kaW5nfSxzZXQ6ZnVuY3Rpb24odCl7dCYmKHRoaXMuX2VuY29kaW5nPXQpfX0se2tleTpcInNpZ25hdHVyZVwiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaWduYXR1cmV9LHNldDpmdW5jdGlvbih0KXt0JiYodGhpcy5fc2lnbmF0dXJlPXQpfX1dKSx0fSgpO2UuZGVmYXVsdD1zLHQuZXhwb3J0cz1lLmRlZmF1bHR9LGZ1bmN0aW9uKHQsZSxyKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBuKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX1PYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSxlLkh5cGVydHlSZXNvdXJjZVR5cGU9ZS5IeXBlcnR5VHlwZT1lLlJ1bnRpbWVIeXBlcnR5Q2FwYWJpbGl0eVR5cGU9dm9pZCAwO3ZhciBpPXIoMjUpLG89bihpKSxhPXIoMyksdT1uKGEpLHM9cig1KSxjPW4ocyksbD1yKDMzKSxmPW4obCksaD1yKDM0KSxwPW4oaCksZD1yKDExNiksdj1uKGQpLHk9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZSh0LHIsbixpLGEscyxjLGwsaCl7KDAsdS5kZWZhdWx0KSh0aGlzLGUpO3ZhciBwPSgwLGYuZGVmYXVsdCkodGhpcywoZS5fX3Byb3RvX198fCgwLG8uZGVmYXVsdCkoZSkpLmNhbGwodGhpcyx0LHIsbixpLGEscyxjKSk7cmV0dXJuIHAuX2NvbmZpZ3VyYXRpb249e30scC5fY29uc3RyYWludHM9e30scC5fcG9saWNpZXM9e30scC5fbWVzc2FnZVNjaGVtYT1udWxsLHAuX2h5cGVydHlUeXBlPWwscC5fZGF0YU9iamVjdHM9aCxwfXJldHVybigwLHAuZGVmYXVsdCkoZSx0KSwoMCxjLmRlZmF1bHQpKGUsW3trZXk6XCJoeXBlcnR5VHlwZVwiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9oeXBlcnR5VHlwZX0sc2V0OmZ1bmN0aW9uKHQpe3QmJih0aGlzLl9oeXBlcnR5VHlwZT10KX19LHtrZXk6XCJkYXRhT2JqZWN0c1wiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kYXRhT2JqZWN0c30sc2V0OmZ1bmN0aW9uKHQpe3QmJih0aGlzLl9kYXRhT2JqZWN0cz10KX19LHtrZXk6XCJjb25maWd1cmF0aW9uXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbmZpZ3VyYXRpb259LHNldDpmdW5jdGlvbih0KXt0JiYodGhpcy5fY29uZmlndXJhdGlvbj10KX19LHtrZXk6XCJjb25zdHJhaW50c1wiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb25zdHJhaW50c30sc2V0OmZ1bmN0aW9uKHQpe3QmJih0aGlzLl9jb25zdHJhaW50cz10KX19LHtrZXk6XCJtZXNzYWdlU2NoZW1hXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21lc3NhZ2VTY2hlbWF9LHNldDpmdW5jdGlvbih0KXt0JiYodGhpcy5fbWVzc2FnZVNjaGVtYT10KX19LHtrZXk6XCJwb2xpY2llc1wiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wb2xpY2llc30sc2V0OmZ1bmN0aW9uKHQpe3QmJih0aGlzLl9wb2xpY2llcz10KX19XSksZX0odi5kZWZhdWx0KTtlLlJ1bnRpbWVIeXBlcnR5Q2FwYWJpbGl0eVR5cGU9e30sZS5IeXBlcnR5VHlwZT17Q09NTVVOSUNBVE9SOlwiY29tbXVuaWNhdG9yXCIsSURFTlRJVFk6XCJpZGVudGl0eVwiLENPTlRFWFQ6XCJjb250ZXh0XCJ9LGUuSHlwZXJ0eVJlc291cmNlVHlwZT17Y2hhdDpcIkNIQVRcIixhdWRpbzpcIkF1ZGlvXCIsdmlkZW86XCJWaWRlb1wiLGF2OlwiQVZcIixzY3JlZW46XCJTQ1JFRU5cIixmaWxlOlwiRklMZVwiLG1pZGk6XCJNSURJXCJ9O2UuZGVmYXVsdD15fSxmdW5jdGlvbih0LGUscil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGk9cigyNSksbz1uKGkpLGE9cigzKSx1PW4oYSkscz1yKDUpLGM9bihzKSxsPXIoMzMpLGY9bihsKSxoPXIoMzQpLHA9bihoKSxkPXIoMTE2KSx2PW4oZCkseT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQscixuLGksYSxzLGMsbCxoLHAsZCx2LHksbSxnKXsoMCx1LmRlZmF1bHQpKHRoaXMsZSk7dmFyIF89KDAsZi5kZWZhdWx0KSh0aGlzLChlLl9fcHJvdG9fX3x8KDAsby5kZWZhdWx0KShlKSkuY2FsbCh0aGlzLHQscixuLGksYSxzLGMpKTtyZXR1cm4gXy5fbWVzc2FnZVNjaGVtYXM9bCxfLl9jb25maWd1cmF0aW9uPWh8fHt9LF8uX2NvbnN0cmFpbnRzPXB8fHt9LF8uX2h5cGVydHlUeXBlPWQsXy5fZGF0YU9iamVjdHM9dnx8W10sXy5faW50ZXJ3b3JraW5nPXksXy5faWRwUHJveHk9bSxfLl9tdXR1YWxBdXRoZW50aWNhdGlvbj1nLF99cmV0dXJuKDAscC5kZWZhdWx0KShlLHQpLCgwLGMuZGVmYXVsdCkoZSxbe2tleTpcIm1lc3NhZ2VTY2hlbWFzXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21lc3NhZ2VTY2hlbWFzfSxzZXQ6ZnVuY3Rpb24odCl7dCYmKHRoaXMuX21lc3NhZ2VTY2hlbWFzPXQpfX0se2tleTpcImNvbnN0cmFpbnRzXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbnN0cmFpbnRzfSxzZXQ6ZnVuY3Rpb24odCl7dCYmKHRoaXMuX2NvbnN0cmFpbnRzPXQpfX0se2tleTpcImNvbmZpZ3VyYXRpb25cIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29uZmlndXJhdGlvbn0sc2V0OmZ1bmN0aW9uKHQpe3QmJih0aGlzLl9jb25maWd1cmF0aW9uPXQpfX0se2tleTpcImh5cGVydHlUeXBlXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2h5cGVydHlUeXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5faHlwZXJ0eVR5cGU9dH19LHtrZXk6XCJkYXRhT2JqZWN0c1wiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kYXRhT2JqZWN0c30sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2RhdGFPYmplY3RzPXR9fSx7a2V5OlwiaW50ZXJ3b3JraW5nXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ludGVyd29ya2luZ30sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2ludGVyd29ya2luZz10fX0se2tleTpcImlkcFByb3h5XCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lkcFByb3h5fSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5faWRwUHJveHk9dH19LHtrZXk6XCJtdXR1YWxBdXRoZW50aWNhdGlvblwiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbn0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uPXR9fV0pLGV9KHYuZGVmYXVsdCk7ZS5kZWZhdWx0PXksdC5leHBvcnRzPWUuZGVmYXVsdH0sLGZ1bmN0aW9uKHQsZSxyKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBuKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX1PYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgaT1yKDMpLG89bihpKSxhPXIoNSksdT1uKGEpLHM9cigxMTYpLGM9bihzKSxsPXIoMTQwKSxmPW4obCksaD1yKDE0MSkscD1uKGgpLGQ9cigxNDIpLHY9bihkKSx5PXIoMTQ1KSxtPW4oeSksZz1yKDE0NiksXz1uKGcpLE89cigxNDcpLGI9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7KDAsby5kZWZhdWx0KSh0aGlzLHQpfXJldHVybigwLHUuZGVmYXVsdCkodCxbe2tleTpcImNyZWF0ZUNhdGFsb2d1ZURhdGFPYmplY3RcIix2YWx1ZTpmdW5jdGlvbih0LGUscixuLGksbyxhKXtpZih2b2lkIDA9PT10fHx2b2lkIDA9PT1lfHx2b2lkIDA9PT1yfHx2b2lkIDA9PT1ufHx2b2lkIDA9PT1pfHx2b2lkIDA9PT1vfHx2b2lkIDA9PT1hKXRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGFyYW1ldGVycyFcIik7cmV0dXJuIG5ldyBjLmRlZmF1bHQodCxlLHIsbixpLG8sYSl9fSx7a2V5OlwiY3JlYXRlSHlwZXJ0eURlc2NyaXB0b3JPYmplY3RcIix2YWx1ZTpmdW5jdGlvbih0LGUscixuLGksbyxhLHUpe2lmKHZvaWQgMD09PXR8fHZvaWQgMD09PWV8fHZvaWQgMD09PXJ8fHZvaWQgMD09PW58fHZvaWQgMD09PWl8fHZvaWQgMD09PW98fHZvaWQgMD09PWF8fHZvaWQgMD09PXUpdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXJhbWV0ZXJzIVwiKTtyZXR1cm4gbmV3IHAuZGVmYXVsdCh0LHMuQ2F0YWxvZ3VlT2JqZWN0VHlwZS5IWVBFUlRZLGUscixuLGksbyxhLHUpfX0se2tleTpcImNyZWF0ZVByb3RvU3R1YkRlc2NyaXB0b3JPYmplY3RcIix2YWx1ZTpmdW5jdGlvbih0LGUscixuLGksbyxhLHUsYyxsLGYsaCxwLGQpe2lmKHZvaWQgMD09PXR8fHZvaWQgMD09PWV8fHZvaWQgMD09PXJ8fHZvaWQgMD09PW58fHZvaWQgMD09PWl8fHZvaWQgMD09PW98fHZvaWQgMD09PWF8fHZvaWQgMD09PXV8fHZvaWQgMD09PWMpdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXJhbWV0ZXJzIVwiKTtyZXR1cm4gbmV3IHYuZGVmYXVsdCh0LHMuQ2F0YWxvZ3VlT2JqZWN0VHlwZS5QUk9UT1NUVUIsZSxyLG4saSxvLGEsdSxjLGwsZixoLHAsZCl9fSx7a2V5OlwiY3JlYXRlSHlwZXJ0eVJ1bnRpbWVEZXNjcmlwdG9yT2JqZWN0XCIsdmFsdWU6ZnVuY3Rpb24odCxlLHIsbixpLG8sYSx1LGMsbCxmKXtpZih2b2lkIDA9PT10fHx2b2lkIDA9PT1lfHx2b2lkIDA9PT1yfHx2b2lkIDA9PT1ufHx2b2lkIDA9PT1pfHx2b2lkIDA9PT1vfHx2b2lkIDA9PT1hKXRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGFyYW1ldGVycyFcIik7cmV0dXJuIG5ldyBtLmRlZmF1bHQodCxzLkNhdGFsb2d1ZU9iamVjdFR5cGUuSFlQRVJUWV9SVU5USU1FLGUscixuLGksbyxhLHUsYyxsLGYpfX0se2tleTpcImNyZWF0ZUh5cGVydHlJbnRlcmNlcHRvckRlc2NyaXB0b3JPYmplY3RcIix2YWx1ZTpmdW5jdGlvbih0LGUscixuLGksbyxhLHUpe2lmKHZvaWQgMD09PXR8fHZvaWQgMD09PWV8fHZvaWQgMD09PXJ8fHZvaWQgMD09PW58fHZvaWQgMD09PWl8fHZvaWQgMD09PW8pdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXJhbWV0ZXJzIVwiKTtyZXR1cm4gbmV3IF8uZGVmYXVsdCh0LHMuQ2F0YWxvZ3VlT2JqZWN0VHlwZS5IWVBFUlRZX0lOVEVSQ0VQVE9SLGUscixuLGksbyxhLHUpfX0se2tleTpcImNyZWF0ZURhdGFPYmplY3RTY2hlbWFcIix2YWx1ZTpmdW5jdGlvbih0LGUscixuLGksbyl7aWYodm9pZCAwPT09dHx8dm9pZCAwPT09ZXx8dm9pZCAwPT09cnx8dm9pZCAwPT09bnx8dm9pZCAwPT09aXx8dm9pZCAwPT09byl0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHBhcmFtZXRlcnMhXCIpO3JldHVybiBuZXcgTy5EYXRhT2JqZWN0U2NoZW1hKHQscy5DYXRhbG9ndWVPYmplY3RUeXBlLkhZUEVSVFlfREFUQV9PQkpFQ1QsZSxyLG4saSxvKX19LHtrZXk6XCJjcmVhdGVNZXNzYWdlRGF0YU9iamVjdFNjaGVtYVwiLHZhbHVlOmZ1bmN0aW9uKHQsZSxyLG4saSxvKXtpZih2b2lkIDA9PT10fHx2b2lkIDA9PT1lfHx2b2lkIDA9PT1yfHx2b2lkIDA9PT1ufHx2b2lkIDA9PT1pfHx2b2lkIDA9PT1vKXRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGFyYW1ldGVycyFcIik7cmV0dXJuIG5ldyBPLkRhdGFPYmplY3RTY2hlbWEodCxzLkNhdGFsb2d1ZU9iamVjdFR5cGUuSFlQRVJUWV9EQVRBX09CSkVDVCxlLHIsbixpLG8pfX0se2tleTpcImNyZWF0ZUh5cGVydHlEYXRhT2JqZWN0U2NoZW1hXCIsdmFsdWU6ZnVuY3Rpb24odCxlLHIsbixpLG8sYSx1KXtpZih2b2lkIDA9PT10fHx2b2lkIDA9PT1lfHx2b2lkIDA9PT1yfHx2b2lkIDA9PT1ufHx2b2lkIDA9PT1pfHx2b2lkIDA9PT1vfHx2b2lkIDA9PT11fHx2b2lkIDA9PT1hKXRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGFyYW1ldGVycyFcIik7cmV0dXJuIHU9PT1PLkRhdGFVcmxTY2hlbWUuQ09NTT9uZXcgTy5Db21tdW5pY2F0aW9uRGF0YU9iamVjdFNjaGVtYSh0LHMuQ2F0YWxvZ3VlT2JqZWN0VHlwZS5IWVBFUlRZX0RBVEFfT0JKRUNULGUscixuLGksbyx1LGEpOnU9PT1PLkRhdGFVcmxTY2hlbWUuQ09OTkVDVElPTj9uZXcgTy5Db25uZWN0aW9uRGF0YU9iamVjdFNjaGVtYSh0LHMuQ2F0YWxvZ3VlT2JqZWN0VHlwZS5IWVBFUlRZX0RBVEFfT0JKRUNULGUscixuLGksbyx1LGEpOnU9PT1PLkRhdGFVcmxTY2hlbWUuQ1RYVD9uZXcgTy5Db250ZXh0RGF0YU9iamVjdFNjaGVtYSh0LHMuQ2F0YWxvZ3VlT2JqZWN0VHlwZS5IWVBFUlRZX0RBVEFfT0JKRUNULGUscixuLGksbyx1LGEpOnU9PT1PLkRhdGFVcmxTY2hlbWUuSURFTlRJVFk/bmV3IE8uSWRlbnRpdHlEYXRhT2JqZWN0U2NoZW1hKHQscy5DYXRhbG9ndWVPYmplY3RUeXBlLkhZUEVSVFlfREFUQV9PQkpFQ1QsZSxyLG4saSxvLHUsYSk6dm9pZCAwfX0se2tleTpcImNyZWF0ZVNvdXJjZVBhY2thZ2VcIix2YWx1ZTpmdW5jdGlvbih0LGUpe2lmKHZvaWQgMD09PWV8fHZvaWQgMD09PXQpdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXJhbWV0ZXJzIVwiKTtyZXR1cm4gbmV3IGYuZGVmYXVsdCh0LGUpfX1dKSx0fSgpO2UuZGVmYXVsdD1iLHQuZXhwb3J0cz1lLmRlZmF1bHR9LGZ1bmN0aW9uKHQsZSxyKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBuKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX1PYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSxlLlJ1bnRpbWVUeXBlPWUuUnVudGltZVByb3RvY29sQ2FwYWJpbGl0eT1lLlJ1bnRpbWVIeXBlcnR5Q2FwYWJpbGl0eT12b2lkIDA7dmFyIGk9cig1OCksbz1uKGkpLGE9cigyNSksdT1uKGEpLHM9cigzKSxjPW4ocyksbD1yKDUpLGY9bihsKSxoPXIoMzMpLHA9bihoKSxkPXIoMzQpLHY9bihkKSx5PXIoMTE2KSxtPW4oeSksZz1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQscixuLGksbyxhLHMsbCxmLGgsZCx2KXsoMCxjLmRlZmF1bHQpKHRoaXMsZSk7dmFyIHk9KDAscC5kZWZhdWx0KSh0aGlzLChlLl9fcHJvdG9fX3x8KDAsdS5kZWZhdWx0KShlKSkuY2FsbCh0aGlzLHQscixuLGksbyxhLHMpKTtyZXR1cm4geS5fcnVudGltZVR5cGU9bCx5Ll9oeXBlcnR5Q2FwYWJpbGl0aWVzPWZ8fG5ldyBfKCEwLCExLCExLCExLCExKSx5Ll9wcm90b2NvbENhcGFiaWxpdGllcz1ofHxuZXcgTyghMCwhMSwhMCwhMSwhMSwhMSkseS5fcDJwSGFuZGxlclN0dWI9ZCx5Ll9wMnBSZXF1ZXN0ZXJTdHViPXYseX1yZXR1cm4oMCx2LmRlZmF1bHQpKGUsdCksKDAsZi5kZWZhdWx0KShlLFt7a2V5OlwicnVudGltZVR5cGVcIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcnVudGltZVR5cGV9LHNldDpmdW5jdGlvbih0KXt0JiYodGhpcy5fcnVudGltZVR5cGU9dCl9fSx7a2V5OlwiaHlwZXJ0eUNhcGFiaWxpdGllc1wiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9oeXBlcnR5Q2FwYWJpbGl0aWVzfSxzZXQ6ZnVuY3Rpb24odCl7dCYmKHRoaXMuX2h5cGVydHlDYXBhYmlsaXRpZXM9dCl9fSx7a2V5OlwicHJvdG9jb2xDYXBhYmlsaXRpZXNcIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faHlwZXJ0eUNhcGFiaWxpdGllc30sc2V0OmZ1bmN0aW9uKHQpe3QmJih0aGlzLl9wcm90b2NvbENhcGFiaWxpdGllcz10KX19LHtrZXk6XCJwMnBIYW5kbGVyU3R1YlwiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wMnBIYW5kbGVyU3R1Yn0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3AycEhhbmRsZXJTdHViPXR9fSx7a2V5OlwicDJwUmVxdWVzdGVyU3R1YlwiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wMnBSZXF1ZXN0ZXJTdHVifSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fcDJwUmVxdWVzdGVyU3R1Yj10fX1dKSxlfShtLmRlZmF1bHQpLF89ZS5SdW50aW1lSHlwZXJ0eUNhcGFiaWxpdHk9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUscixuLGksbyl7KDAsYy5kZWZhdWx0KSh0aGlzLHQpLHRoaXMuX2lzV2ViUlRDPWUsdGhpcy5faXNNaWM9cix0aGlzLl9pc0NhbWVyYT1uLHRoaXMuX2lzU2Vuc29yPWksdGhpcy5faXNPUlRDPW99cmV0dXJuKDAsZi5kZWZhdWx0KSh0LFt7a2V5OlwiZ2V0Q2FwYWJpbGl0eVNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuKDAsby5kZWZhdWx0KSh0aGlzKX19LHtrZXk6XCJpc01pY1wiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc01pY319LHtrZXk6XCJpc0NhbWVyYVwiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0NhbWVyYX19LHtrZXk6XCJpc1NlbnNvclwiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc1NlbnNvcn19LHtrZXk6XCJpc1dlYlJUQ1wiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc1dlYlJUQ319LHtrZXk6XCJpc09SVENTXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzT1JUQ319XSksdH0oKSxPPWUuUnVudGltZVByb3RvY29sQ2FwYWJpbGl0eT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSxyLG4saSxvLGEpeygwLGMuZGVmYXVsdCkodGhpcyx0KSx0aGlzLl9pc0h0dHA9ZSx0aGlzLl9pc0h0dHBzPXIsdGhpcy5faXNXUz1uLHRoaXMuX2lzV1NTPWksdGhpcy5faXNDb2FwPW8sdGhpcy5faXNEYXRhQ2hhbm5lbD1hfXJldHVybigwLGYuZGVmYXVsdCkodCxbe2tleTpcImlzSHR0cFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzSHR0cH19LHtrZXk6XCJpc0h0dHBzXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNIdHRwc319LHtrZXk6XCJpc1dTXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNXU319LHtrZXk6XCJpc1NlbnNvclN1cHBvcnRlZFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzU2Vuc29yfX0se2tleTpcImlzV1NTXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNXU1N9fSx7a2V5OlwiaXNDb2FwXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNDb2FwfX0se2tleTpcImlzRGF0YUNoYW5uZWxcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0RhdGFDaGFubmVsfX0se2tleTpcImdldENhcGFiaWxpdHlTZXRcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybigwLG8uZGVmYXVsdCkodGhpcyl9fV0pLHR9KCk7ZS5SdW50aW1lVHlwZT17QlJPV1NFUjpcImJyb3dzZXJcIixTVEFOREFMT05FOlwic3RhbmRhbG9uZVwiLFNFUlZFUjpcInNlcnZlclwiLEdBVEVXQVk6XCJnYXRld2F5XCJ9O2UuZGVmYXVsdD1nfSxmdW5jdGlvbih0LGUscil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGk9cigyNSksbz1uKGkpLGE9cigzKSx1PW4oYSkscz1yKDUpLGM9bihzKSxsPXIoMzMpLGY9bihsKSxoPXIoMzQpLHA9bihoKSxkPXIoMTE2KSx2PW4oZCkseT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQscixuLGksYSxzLGMsbCxoKXsoMCx1LmRlZmF1bHQpKHRoaXMsZSk7dmFyIHA9KDAsZi5kZWZhdWx0KSh0aGlzLChlLl9fcHJvdG9fX3x8KDAsby5kZWZhdWx0KShlKSkuY2FsbCh0aGlzLHQscixuLGksYSxzLGMpKTtyZXR1cm4gcC5fY29uZmlndXJhdGlvbj1sLHAuX3BvbGljaWVzPWgscH1yZXR1cm4oMCxwLmRlZmF1bHQpKGUsdCksKDAsYy5kZWZhdWx0KShlLFt7a2V5OlwiY29uZmlndXJhdGlvblwiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb25maWd1cmF0aW9ufSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fY29uZmlndXJhdGlvbj10fX0se2tleTpcInBvbGljaWVzXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BvbGljaWVzfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fcG9saWNpZXM9dH19XSksZX0odi5kZWZhdWx0KTtlLmRlZmF1bHQ9eSx0LmV4cG9ydHM9ZS5kZWZhdWx0fSxmdW5jdGlvbih0LGUscil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksZS5EYXRhVXJsU2NoZW1lPWUuQ29udGV4dERhdGFPYmplY3RTY2hlbWE9ZS5JZGVudGl0eURhdGFPYmplY3RTY2hlbWE9ZS5Db25uZWN0aW9uRGF0YU9iamVjdFNjaGVtYT1lLkNvbW11bmljYXRpb25EYXRhT2JqZWN0U2NoZW1hPWUuSHlwZXJ0eURhdGFPYmplY3RTY2hlbWE9ZS5NZXNzYWdlRGF0YU9iamVjdFNjaGVtYT1lLkRhdGFPYmplY3RTY2hlbWE9dm9pZCAwO3ZhciBpPXIoMjUpLG89bihpKSxhPXIoMyksdT1uKGEpLHM9cigzMyksYz1uKHMpLGw9cigzNCksZj1uKGwpLGg9cigxMTYpLHA9bihoKSxkPWUuRGF0YU9iamVjdFNjaGVtYT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQscixuLGksYSxzLGwpe3JldHVybigwLHUuZGVmYXVsdCkodGhpcyxlKSwoMCxjLmRlZmF1bHQpKHRoaXMsKGUuX19wcm90b19ffHwoMCxvLmRlZmF1bHQpKGUpKS5jYWxsKHRoaXMsdCxyLG4saSxhLHMsbCkpfXJldHVybigwLGYuZGVmYXVsdCkoZSx0KSxlfShwLmRlZmF1bHQpLHY9KGUuTWVzc2FnZURhdGFPYmplY3RTY2hlbWE9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZSh0LHIsbixpLGEscyxsKXtyZXR1cm4oMCx1LmRlZmF1bHQpKHRoaXMsZSksKDAsYy5kZWZhdWx0KSh0aGlzLChlLl9fcHJvdG9fX3x8KDAsby5kZWZhdWx0KShlKSkuY2FsbCh0aGlzLHQscixuLGksYSxzLGwpKX1yZXR1cm4oMCxmLmRlZmF1bHQpKGUsdCksZX0oZCksZS5IeXBlcnR5RGF0YU9iamVjdFNjaGVtYT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQscixuLGksYSxzLGwsZixoKXsoMCx1LmRlZmF1bHQpKHRoaXMsZSk7dmFyIHA9KDAsYy5kZWZhdWx0KSh0aGlzLChlLl9fcHJvdG9fX3x8KDAsby5kZWZhdWx0KShlKSkuY2FsbCh0aGlzLHQscixuLGksYSxzLGwpKTtyZXR1cm4gcC5fYWNjZXNzQ29udHJvbFBvbGljeT1mLHAuX3NjaGVtZT1oLHB9cmV0dXJuKDAsZi5kZWZhdWx0KShlLHQpLGV9KGQpKTtlLkNvbW11bmljYXRpb25EYXRhT2JqZWN0U2NoZW1hPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUodCxyLG4saSxhLHMsbCxmKXtyZXR1cm4oMCx1LmRlZmF1bHQpKHRoaXMsZSksKDAsYy5kZWZhdWx0KSh0aGlzLChlLl9fcHJvdG9fX3x8KDAsby5kZWZhdWx0KShlKSkuY2FsbCh0aGlzLHQscixuLGksYSxzLGwsZikpfXJldHVybigwLGYuZGVmYXVsdCkoZSx0KSxlfSh2KSxlLkNvbm5lY3Rpb25EYXRhT2JqZWN0U2NoZW1hPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUodCxyLG4saSxhLHMsbCxmKXtyZXR1cm4oMCx1LmRlZmF1bHQpKHRoaXMsZSksKDAsYy5kZWZhdWx0KSh0aGlzLChlLl9fcHJvdG9fX3x8KDAsby5kZWZhdWx0KShlKSkuY2FsbCh0aGlzLHQscixuLGksYSxzLGwsZikpfXJldHVybigwLGYuZGVmYXVsdCkoZSx0KSxlfSh2KSxlLklkZW50aXR5RGF0YU9iamVjdFNjaGVtYT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQscixuLGksYSxzLGwsZil7cmV0dXJuKDAsdS5kZWZhdWx0KSh0aGlzLGUpLCgwLGMuZGVmYXVsdCkodGhpcywoZS5fX3Byb3RvX198fCgwLG8uZGVmYXVsdCkoZSkpLmNhbGwodGhpcyx0LHIsbixpLGEscyxsLGYpKX1yZXR1cm4oMCxmLmRlZmF1bHQpKGUsdCksZX0odiksZS5Db250ZXh0RGF0YU9iamVjdFNjaGVtYT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQscixuLGksYSxzLGwsZil7cmV0dXJuKDAsdS5kZWZhdWx0KSh0aGlzLGUpLCgwLGMuZGVmYXVsdCkodGhpcywoZS5fX3Byb3RvX198fCgwLG8uZGVmYXVsdCkoZSkpLmNhbGwodGhpcyx0LHIsbixpLGEscyxsLGYpKX1yZXR1cm4oMCxmLmRlZmF1bHQpKGUsdCksZX0odiksZS5EYXRhVXJsU2NoZW1lPXtDT01NOlwiQ09NTVwiLENPTk5FQ1RJT046XCJDT05ORUNUSU9OXCIsQ1RYVDpcIkNUWFRcIixJREVOVElUWTpcIklERU5USVRZXCJ9O2UuZGVmYXVsdD1kfSwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsZnVuY3Rpb24odCxlLHIpe1widXNlIHN0cmljdFwiO09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLGUuUnVudGltZUNhdGFsb2d1ZT12b2lkIDA7dmFyIG49cigyMiksaT1mdW5jdGlvbih0KXtpZih0JiZ0Ll9fZXNNb2R1bGUpcmV0dXJuIHQ7dmFyIGU9e307aWYobnVsbCE9dClmb3IodmFyIHIgaW4gdClPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxyKSYmKGVbcl09dFtyXSk7cmV0dXJuIGUuZGVmYXVsdD10LGV9KG4pLG89cigxODYpLGE9ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OntkZWZhdWx0OnR9fShvKTtpLmdldExvZ2dlcihcIlJ1bnRpbWVDYXRhbG9ndWVcIikuc2V0TGV2ZWwoMCksZS5SdW50aW1lQ2F0YWxvZ3VlPWEuZGVmYXVsdH0sZnVuY3Rpb24odCxlLHIpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIG4odCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OntkZWZhdWx0OnR9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBpPXIoMTg3KSxvPW4oaSksYT1yKDU4KSx1PW4oYSkscz1yKDE4KSxjPW4ocyksbD1yKDMpLGY9bihsKSxoPXIoNSkscD1uKGgpLGQ9cigyMiksdj1mdW5jdGlvbih0KXtpZih0JiZ0Ll9fZXNNb2R1bGUpcmV0dXJuIHQ7dmFyIGU9e307aWYobnVsbCE9dClmb3IodmFyIHIgaW4gdClPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxyKSYmKGVbcl09dFtyXSk7cmV0dXJuIGUuZGVmYXVsdD10LGV9KGQpLHk9cigxNDQpLG09bih5KSxnPXYuZ2V0TG9nZ2VyKFwiUnVudGltZUNhdGFsb2d1ZVwiKSxfPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlLHIsbil7aWYoKDAsZi5kZWZhdWx0KSh0aGlzLHQpLCFlKXRocm93IEVycm9yKFwiVGhlIGNhdGFsb2d1ZSBuZWVkcyB0aGUgcnVudGltZUZhY3RvcnlcIik7dGhpcy5fZmFjdG9yeT1uZXcgbS5kZWZhdWx0LHRoaXMuaHR0cFJlcXVlc3Q9ZS5jcmVhdGVIdHRwUmVxdWVzdCgpLHRoaXMuYXRvYj1lLmF0b2I/ZS5hdG9iOmF0b2I7dmFyIGk9cnx8XCJydW50aW1lQ2F0YWxvZ3VlXCIsbz1ufHxcIiZjZ3VpZCwgYWNjZXNzQ29udHJvbFBvbGljeSwgY29uc3RyYWludHMsIGRhdGFPYmplY3RzLCBoeXBlcnR5VHlwZSwgb2JqZWN0TmFtZSwgc291cmNlUGFja2FnZSwgdmVyc2lvblwiLGE9e307YVtpXT1vLHRoaXMuc3RvcmFnZU1hbmFnZXI9ZS5zdG9yYWdlTWFuYWdlcihpLGEpfXJldHVybigwLHAuZGVmYXVsdCkodCxbe2tleTpcImdldERlc2NyaXB0b3JcIix2YWx1ZTpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMsbj0hKGFyZ3VtZW50cy5sZW5ndGg+MiYmdm9pZCAwIT09YXJndW1lbnRzWzJdKXx8YXJndW1lbnRzWzJdLGk9YXJndW1lbnRzWzNdO2cuaW5mbyhcIltSdW50aW1lQ2F0YWxvZ3VlXSAtIGdldHRpbmcgZGVzY3JpcHRvciBmcm9tOiBcIix0LFwiIHdpdGggY29uc3RyYWludHM6IFwiLGkpO3ZhciBhPSExLHM9ITEsbD12b2lkIDA7bD12b2lkIDAhPWk/Yy5kZWZhdWx0LmFsbChbdGhpcy5odHRwUmVxdWVzdC5wb3N0KHQrXCIvdmVyc2lvblwiLHtib2R5OigwLHUuZGVmYXVsdCkoaSl9KSx0aGlzLmh0dHBSZXF1ZXN0LnBvc3QodCtcIi9jZ3VpZFwiLHtib2R5OigwLHUuZGVmYXVsdCkoaSl9KV0pOmMuZGVmYXVsdC5hbGwoW3RoaXMuaHR0cFJlcXVlc3QuZ2V0KHQrXCIvdmVyc2lvblwiKSx0aGlzLmh0dHBSZXF1ZXN0LmdldCh0K1wiL2NndWlkXCIpXSksbD1sLnRoZW4oZnVuY3Rpb24oZSl7dmFyIG49KDAsby5kZWZhdWx0KShlLDIpLHM9blswXSxjPW5bMV07cmV0dXJuIGcuaW5mbyhcIltSdW50aW1lQ2F0YWxvZ3VlXSAtIGdvdCB2ZXJzaW9uIChcIitzK1wiKSBhbmQgY2d1aWQgKFwiK2MrXCIpIGZvciBkZXNjcmlwdG9yIFwiK3QpLHIuc3RvcmFnZU1hbmFnZXIuZ2V0VmVyc2lvbihcImNndWlkXCIsYykudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gZT49cz8oZy53YXJuKFwic3RvcmFnZU1hbmFnZXIgY29udGFpbnMgc2F2ZWQgdmVyc2lvbiB0aGF0IGlzIHRoZSBzYW1lIG9yIG5ld2VyIHRoYW4gcmVxdWVzdGVkXCIpLGE9ITAsci5zdG9yYWdlTWFuYWdlci5nZXQoXCJjZ3VpZFwiLGMpKTooZy53YXJuKFwic3RvcmFnZU1hbmFnZXIgZG9lcyBub3QgY29udGFpbiBzYXZlZCB2ZXJzaW9uXCIpLCh2b2lkIDAhPWk/ci5odHRwUmVxdWVzdC5wb3N0KHQse2JvZHk6KDAsdS5kZWZhdWx0KShpKX0pOnIuaHR0cFJlcXVlc3QuZ2V0KHQpKS50aGVuKGZ1bmN0aW9uKHQpe2lmKHQ9SlNPTi5wYXJzZSh0KSx0LkVSUk9SKXRocm93IG5ldyBFcnJvcih0KTtyZXR1cm4gdH0pKX0pfSkuY2F0Y2goZnVuY3Rpb24oZSl7dmFyIHI9XCJVbmFibGUgdG8gZ2V0IGRlc2NyaXB0b3IgZm9yIFwiK3QrKHZvaWQgMCE9aT9cIiB3aXRoIGNvbnN0cmFpbnRzIFwiK2k6XCJcIikrXCI6IFwiK2U7dGhyb3cgZy5lcnJvcihyKSxuZXcgRXJyb3Iocil9KTt2YXIgZj1sO3JldHVybiBuJiYoZy5sb2coXCJhZGRpbmcgcHJvbWlzZSB0byBhdHRhY2ggc291cmNlUGFja2FnZVwiKSxmPWwudGhlbihmdW5jdGlvbih0KXtyZXR1cm4gdC5zb3VyY2VQYWNrYWdlPyhzPSEwLHQpOihzPSExLHIuYXR0YWNoUmF3U291cmNlUGFja2FnZSh0KSl9KSksZj1mLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuKCFhfHxhJiYhcyYmbikmJnIuc3RvcmFnZU1hbmFnZXIuc2V0KHQuY2d1aWQsdC52ZXJzaW9uLHQpLGUuYXBwbHkocixbdCxpXSl9KX19LHtrZXk6XCJhdHRhY2hSYXdTb3VyY2VQYWNrYWdlXCIsdmFsdWU6ZnVuY3Rpb24odCxlKXt2YXIgcj10aGlzO3JldHVybiBnLmxvZyhcImF0dGFjaGluZyByYXcgc291cmNlUGFja2FnZSBmcm9tOlwiLHQuc291cmNlUGFja2FnZVVSTCksbmV3IGMuZGVmYXVsdChmdW5jdGlvbihuLGkpeyh2b2lkIDAhPWU/ci5odHRwUmVxdWVzdC5wb3N0KHQuc291cmNlUGFja2FnZVVSTCx7Ym9keTooMCx1LmRlZmF1bHQpKGUpfSk6ci5odHRwUmVxdWVzdC5nZXQodC5zb3VyY2VQYWNrYWdlVVJMKSkudGhlbihmdW5jdGlvbihlKXtlPUpTT04ucGFyc2UoZSksdC5zb3VyY2VQYWNrYWdlPWUsbih0KX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2kodCl9KX0pfX0se2tleTpcImdldEh5cGVydHlEZXNjcmlwdG9yXCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9IShhcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXSl8fGFyZ3VtZW50c1sxXSxyPWFyZ3VtZW50c1syXTtyZXR1cm4gdGhpcy5nZXREZXNjcmlwdG9yKHQsdGhpcy5jcmVhdGVIeXBlcnR5LGUscil9fSx7a2V5OlwiZ2V0U3R1YkRlc2NyaXB0b3JcIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgZT0hKGFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdKXx8YXJndW1lbnRzWzFdLHI9YXJndW1lbnRzWzJdO3JldHVybiB0aGlzLmdldERlc2NyaXB0b3IodCx0aGlzLmNyZWF0ZVN0dWIsZSxyKX19LHtrZXk6XCJnZXRSdW50aW1lRGVzY3JpcHRvclwiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPSEoYXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0pfHxhcmd1bWVudHNbMV0scj1hcmd1bWVudHNbMl07cmV0dXJuIHRoaXMuZ2V0RGVzY3JpcHRvcih0LHRoaXMuY3JlYXRlUnVudGltZURlc2NyaXB0b3IsZSxyKX19LHtrZXk6XCJnZXREYXRhU2NoZW1hRGVzY3JpcHRvclwiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPSEoYXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0pfHxhcmd1bWVudHNbMV0scj1hcmd1bWVudHNbMl07cmV0dXJuIHRoaXMuZ2V0RGVzY3JpcHRvcih0LHRoaXMuY3JlYXRlRGF0YVNjaGVtYSxlLHIpfX0se2tleTpcImdldElkcFByb3h5RGVzY3JpcHRvclwiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPSEoYXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0pfHxhcmd1bWVudHNbMV0scj1hcmd1bWVudHNbMl07cmV0dXJuIHRoaXMuZ2V0RGVzY3JpcHRvcih0LHRoaXMuY3JlYXRlSWRwUHJveHksZSxyKX19LHtrZXk6XCJjcmVhdGVIeXBlcnR5XCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZmFjdG9yeS5jcmVhdGVIeXBlcnR5RGVzY3JpcHRvck9iamVjdCh0LmNndWlkLHQudmVyc2lvbix0Lm9iamVjdE5hbWUsdC5kZXNjcmlwdGlvbix0Lmxhbmd1YWdlLHQuc291cmNlUGFja2FnZVVSTCx0LnR5cGV8fHQuaHlwZXJ0eVR5cGUsdC5kYXRhT2JqZWN0cyk7ZS5jb25maWd1cmF0aW9uPXQuY29uZmlndXJhdGlvbixlLmNvbnN0cmFpbnRzPXQuY29uc3RyYWludHMsZS5tZXNzYWdlU2NoZW1hPXQubWVzc2FnZVNjaGVtYSxlLnBvbGljaWVzPXQucG9saWNpZXMsZS5zaWduYXR1cmU9dC5zaWduYXR1cmU7dmFyIHI9dC5zb3VyY2VQYWNrYWdlO3JldHVybiByJiYoZS5zb3VyY2VQYWNrYWdlPXRoaXMuY3JlYXRlU291cmNlUGFja2FnZShyKSksZX19LHtrZXk6XCJjcmVhdGVTdHViXCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZmFjdG9yeS5jcmVhdGVQcm90b1N0dWJEZXNjcmlwdG9yT2JqZWN0KHQuY2d1aWQsdC52ZXJzaW9uLHQub2JqZWN0TmFtZSx0LmRlc2NyaXB0aW9uLHQubGFuZ3VhZ2UsdC5zb3VyY2VQYWNrYWdlVVJMLHQubWVzc2FnZVNjaGVtYXMsdC5jb25maWd1cmF0aW9uLHQuY29uc3RyYWludHMsdC5oeXBlcnR5VHlwZSx0LmRhdGFPYmplY3RzLHQuaW50ZXJ3b3JraW5nLHQuaWRwUHJveHksdC5tdXR1YWxBdXRoZW50aWNhdGlvbik7ZS5zaWduYXR1cmU9dC5zaWduYXR1cmU7dmFyIHI9dC5zb3VyY2VQYWNrYWdlO3JldHVybiByJiYoZS5zb3VyY2VQYWNrYWdlPXRoaXMuY3JlYXRlU291cmNlUGFja2FnZShyKSksZX19LHtrZXk6XCJjcmVhdGVSdW50aW1lRGVzY3JpcHRvclwiLHZhbHVlOmZ1bmN0aW9uKHQpe3RyeXt0Lmh5cGVydHlDYXBhYmlsaXRpZXM9SlNPTi5wYXJzZSh0Lmh5cGVydHlDYXBhYmlsaXRpZXMpLHQucHJvdG9jb2xDYXBhYmlsaXRpZXM9SlNPTi5wYXJzZSh0LnByb3RvY29sQ2FwYWJpbGl0aWVzKX1jYXRjaCh0KXt9dmFyIGU9dGhpcy5fZmFjdG9yeS5jcmVhdGVIeXBlcnR5UnVudGltZURlc2NyaXB0b3JPYmplY3QodC5jZ3VpZCx0LnZlcnNpb24sdC5vYmplY3ROYW1lLHQuZGVzY3JpcHRpb24sdC5sYW5ndWFnZSx0LnNvdXJjZVBhY2thZ2VVUkwsdC50eXBlfHx0LnJ1bnRpbWVUeXBlLHQuaHlwZXJ0eUNhcGFiaWxpdGllcyx0LnByb3RvY29sQ2FwYWJpbGl0aWVzLHQucDJwSGFuZGxlclN0dWIsdC5wMnBSZXF1ZXN0ZXJTdHViKTtlLnNpZ25hdHVyZT10LnNpZ25hdHVyZTt2YXIgcj10LnNvdXJjZVBhY2thZ2U7cmV0dXJuIHImJihlLnNvdXJjZVBhY2thZ2U9dGhpcy5jcmVhdGVTb3VyY2VQYWNrYWdlKHIpKSxlfX0se2tleTpcImNyZWF0ZURhdGFTY2hlbWFcIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgZT12b2lkIDA7ZT10LmFjY2Vzc0NvbnRyb2xQb2xpY3kmJnQuc2NoZW1lP3RoaXMuX2ZhY3RvcnkuY3JlYXRlSHlwZXJ0eURhdGFPYmplY3RTY2hlbWEodC5jZ3VpZCx0LnZlcnNpb24sdC5vYmplY3ROYW1lLHQuZGVzY3JpcHRpb24sdC5sYW5ndWFnZSx0LnNvdXJjZVBhY2thZ2VVUkwsdC5hY2Nlc3NDb250cm9sUG9saWN5LHQuc2NoZW1lKTp0aGlzLl9mYWN0b3J5LmNyZWF0ZU1lc3NhZ2VEYXRhT2JqZWN0U2NoZW1hKHQuY2d1aWQsdC52ZXJzaW9uLHQub2JqZWN0TmFtZSx0LmRlc2NyaXB0aW9uLHQubGFuZ3VhZ2UsdC5zb3VyY2VQYWNrYWdlVVJMKSxlLnNpZ25hdHVyZT10LnNpZ25hdHVyZTt2YXIgcj10LnNvdXJjZVBhY2thZ2U7aWYocil7ZS5zb3VyY2VQYWNrYWdlPXRoaXMuY3JlYXRlU291cmNlUGFja2FnZShyKTt0cnl7ZS5zb3VyY2VQYWNrYWdlLnNvdXJjZUNvZGU9SlNPTi5wYXJzZShlLnNvdXJjZVBhY2thZ2Uuc291cmNlQ29kZSl9Y2F0Y2godCl7Zy5sb2coXCJEYXRhU2NoZW1hIFNvdXJjZSBjb2RlIGlzIGFscmVhZHkgcGFyc2VkXCIpfXJldHVybiBlfXJldHVybiBlfX0se2tleTpcImNyZWF0ZUlkcFByb3h5XCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZmFjdG9yeS5jcmVhdGVQcm90b1N0dWJEZXNjcmlwdG9yT2JqZWN0KHQuY2d1aWQsdC52ZXJzaW9uLHQub2JqZWN0TmFtZSx0LmRlc2NyaXB0aW9uLHQubGFuZ3VhZ2UsdC5zb3VyY2VQYWNrYWdlVVJMLHQubWVzc2FnZVNjaGVtYXMsdC5jb25maWd1cmF0aW9uLHQuY29uc3RyYWludHMsdC5oeXBlcnR5VHlwZSx0LmRhdGFPYmplY3RzLHQuaW50ZXJ3b3JraW5nLHQuaWRwUHJveHksdC5tdXR1YWxBdXRoZW50aWNhdGlvbik7ZS5zaWduYXR1cmU9dC5zaWduYXR1cmU7dmFyIHI9dC5zb3VyY2VQYWNrYWdlO3JldHVybiByJiYocj10aGlzLmNyZWF0ZVNvdXJjZVBhY2thZ2UociksZS5zb3VyY2VQYWNrYWdlPXIpLGV9fSx7a2V5OlwiY3JlYXRlU291cmNlUGFja2FnZVwiLHZhbHVlOmZ1bmN0aW9uKHQpe1wiYmFzZTY0XCI9PT10LmVuY29kaW5nJiYodC5zb3VyY2VDb2RlPXRoaXMuYXRvYih0LnNvdXJjZUNvZGUpLHQuZW5jb2Rpbmc9XCJ1dGYtOFwiKTt2YXIgZT10aGlzLl9mYWN0b3J5LmNyZWF0ZVNvdXJjZVBhY2thZ2UodC5zb3VyY2VDb2RlQ2xhc3NuYW1lLHQuc291cmNlQ29kZSk7cmV0dXJuIHQuZW5jb2RpbmcmJihlLmVuY29kaW5nPXQuZW5jb2RpbmcpLHQuc2lnbmF0dXJlJiYoZS5zaWduYXR1cmU9dC5zaWduYXR1cmUpLGV9fSx7a2V5OlwiZ2V0U291cmNlUGFja2FnZUZyb21VUkxcIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzO3JldHVybiBnLmxvZyhcImdldHRpbmcgc291cmNlUGFja2FnZSBmcm9tOlwiLHQpLG5ldyBjLmRlZmF1bHQoZnVuY3Rpb24ocixuKXtlLmh0dHBSZXF1ZXN0LmdldCh0KS50aGVuKGZ1bmN0aW9uKHQpe2lmKHQuRVJST1Ipbih0KTtlbHNle3Q9SlNPTi5wYXJzZSh0KTt2YXIgaT1lLmNyZWF0ZVNvdXJjZVBhY2thZ2UodCk7cihpKX19KS5jYXRjaChmdW5jdGlvbih0KXtuKHQpfSl9KX19LHtrZXk6XCJnZXRTb3VyY2VDb2RlRnJvbURlc2NyaXB0b3JcIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzO3JldHVybiBuZXcgYy5kZWZhdWx0KGZ1bmN0aW9uKHIsbil7dC5zb3VyY2VQYWNrYWdlP3IodC5zb3VyY2VQYWNrYWdlLnNvdXJjZUNvZGUpOmUuc3RvcmFnZU1hbmFnZXIuZ2V0VmVyc2lvbih0LnNvdXJjZVBhY2thZ2VVUkwrXCIvc291cmNlQ29kZVwiKS50aGVuKGZ1bmN0aW9uKGkpe2k+PXQudmVyc2lvbj8oZy5sb2coXCJyZXR1cm5pbmcgY2FjaGVkIHZlcnNpb24gZnJvbSBzdG9yYWdlTWFuYWdlclwiKSxlLnN0b3JhZ2VNYW5hZ2VyLmdldCh0LnNvdXJjZVBhY2thZ2VVUkwrXCIvc291cmNlQ29kZVwiKS50aGVuKGZ1bmN0aW9uKHQpe3IodCl9KS5jYXRjaChmdW5jdGlvbih0KXtuKHQpfSkpOmUuaHR0cFJlcXVlc3QuZ2V0KHQuc291cmNlUGFja2FnZVVSTCtcIi9zb3VyY2VDb2RlXCIpLnRoZW4oZnVuY3Rpb24oaSl7aS5FUlJPUj9uKGkpOihlLnN0b3JhZ2VNYW5hZ2VyLnNldCh0LnNvdXJjZVBhY2thZ2VVUkwrXCIvc291cmNlQ29kZVwiLHQudmVyc2lvbixpKSxyKGkpKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe24odCl9KX0pLmNhdGNoKGZ1bmN0aW9uKHQpe24odCl9KX0pfX0se2tleTpcImdldFR5cGVMaXN0XCIsdmFsdWU6ZnVuY3Rpb24odCxlKXt2YXIgcj10aGlzO3JldHVybiBuZXcgYy5kZWZhdWx0KGZ1bmN0aW9uKG4saSl7KHZvaWQgMCE9ZT9yLmh0dHBSZXF1ZXN0LnBvc3QodCx7Ym9keTooMCx1LmRlZmF1bHQpKGUpfSk6ci5odHRwUmVxdWVzdC5nZXQodCkpLnRoZW4oZnVuY3Rpb24odCl7dD1KU09OLnBhcnNlKHQpLG4odCl9KS5jYXRjaChmdW5jdGlvbih0KXtpKHQpfSl9KX19LHtrZXk6XCJkZWxldGVGcm9tUE1cIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zdG9yYWdlTWFuYWdlci5kZWxldGUodCl9fSx7a2V5OlwicnVudGltZVVSTFwiLHNldDpmdW5jdGlvbih0KXt0aGlzLl9ydW50aW1lVVJMPXR9LGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ydW50aW1lVVJMfX1dKSx0fSgpO2UuZGVmYXVsdD1fLHQuZXhwb3J0cz1lLmRlZmF1bHR9LGZ1bmN0aW9uKHQsZSxyKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBuKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX1lLl9fZXNNb2R1bGU9ITA7dmFyIGk9cigxODgpLG89bihpKSxhPXIoMTkxKSx1PW4oYSk7ZS5kZWZhdWx0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3ZhciByPVtdLG49ITAsaT0hMSxvPXZvaWQgMDt0cnl7Zm9yKHZhciBhLHM9KDAsdS5kZWZhdWx0KSh0KTshKG49KGE9cy5uZXh0KCkpLmRvbmUpJiYoci5wdXNoKGEudmFsdWUpLCFlfHxyLmxlbmd0aCE9PWUpO249ITApO31jYXRjaCh0KXtpPSEwLG89dH1maW5hbGx5e3RyeXshbiYmcy5yZXR1cm4mJnMucmV0dXJuKCl9ZmluYWxseXtpZihpKXRocm93IG99fXJldHVybiByfXJldHVybiBmdW5jdGlvbihlLHIpe2lmKEFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIGU7aWYoKDAsby5kZWZhdWx0KShPYmplY3QoZSkpKXJldHVybiB0KGUscik7dGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2VcIil9fSgpfSxmdW5jdGlvbih0LGUscil7dC5leHBvcnRzPXtkZWZhdWx0OnIoMTg5KSxfX2VzTW9kdWxlOiEwfX0sZnVuY3Rpb24odCxlLHIpe3IoNTQpLHIoNTIpLHQuZXhwb3J0cz1yKDE5MCl9LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDYzKSxpPXIoMikoXCJpdGVyYXRvclwiKSxvPXIoMTcpO3QuZXhwb3J0cz1yKDApLmlzSXRlcmFibGU9ZnVuY3Rpb24odCl7dmFyIGU9T2JqZWN0KHQpO3JldHVybiB2b2lkIDAhPT1lW2ldfHxcIkBAaXRlcmF0b3JcImluIGV8fG8uaGFzT3duUHJvcGVydHkobihlKSl9fSxmdW5jdGlvbih0LGUscil7dC5leHBvcnRzPXtkZWZhdWx0OnIoMTkyKSxfX2VzTW9kdWxlOiEwfX0sZnVuY3Rpb24odCxlLHIpe3IoNTQpLHIoNTIpLHQuZXhwb3J0cz1yKDE5Myl9LGZ1bmN0aW9uKHQsZSxyKXt2YXIgbj1yKDkpLGk9cigxMDEpO3QuZXhwb3J0cz1yKDApLmdldEl0ZXJhdG9yPWZ1bmN0aW9uKHQpe3ZhciBlPWkodCk7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgZSl0aHJvdyBUeXBlRXJyb3IodCtcIiBpcyBub3QgaXRlcmFibGUhXCIpO3JldHVybiBuKGUuY2FsbCh0KSl9fV0pfSk7IiwiLy8gdmVyc2lvbjogMC45LjBcbi8vIGRhdGU6IFdlZCBBdWcgMDEgMjAxOCAwOTozNDozNCBHTVQrMDEwMCAoV2VzdGVybiBFdXJvcGVhbiBTdW1tZXIgVGltZSlcbi8vIGxpY2VuY2U6IFxuLyoqXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXG4qXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4qXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4qXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbioqL1xuXG5cbiFmdW5jdGlvbih0LGUpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPWUoKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiU3RvcmFnZU1hbmFnZXJcIixbXSxlKTpcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cz9leHBvcnRzLlN0b3JhZ2VNYW5hZ2VyPWUoKToodFtcIlwiXT10W1wiXCJdfHx7fSx0W1wiXCJdLlN0b3JhZ2VNYW5hZ2VyPWUoKSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBzZWxmP3NlbGY6dGhpcyxmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbih0KXtmdW5jdGlvbiBlKHIpe2lmKG5bcl0pcmV0dXJuIG5bcl0uZXhwb3J0czt2YXIgbz1uW3JdPXtpOnIsbDohMSxleHBvcnRzOnt9fTtyZXR1cm4gdFtyXS5jYWxsKG8uZXhwb3J0cyxvLG8uZXhwb3J0cyxlKSxvLmw9ITAsby5leHBvcnRzfXZhciBuPXt9O3JldHVybiBlLm09dCxlLmM9bixlLmQ9ZnVuY3Rpb24odCxuLHIpe2Uubyh0LG4pfHxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxuLHtjb25maWd1cmFibGU6ITEsZW51bWVyYWJsZTohMCxnZXQ6cn0pfSxlLm49ZnVuY3Rpb24odCl7dmFyIG49dCYmdC5fX2VzTW9kdWxlP2Z1bmN0aW9uKCl7cmV0dXJuIHQuZGVmYXVsdH06ZnVuY3Rpb24oKXtyZXR1cm4gdH07cmV0dXJuIGUuZChuLFwiYVwiLG4pLG59LGUubz1mdW5jdGlvbih0LGUpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxlKX0sZS5wPVwiXCIsZShlLnM9MTUzKX0oW2Z1bmN0aW9uKHQsZSl7dmFyIG49dC5leHBvcnRzPXt2ZXJzaW9uOlwiMi41LjdcIn07XCJudW1iZXJcIj09dHlwZW9mIF9fZSYmKF9fZT1uKX0sZnVuY3Rpb24odCxlKXt2YXIgbj10LmV4cG9ydHM9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdyYmd2luZG93Lk1hdGg9PU1hdGg/d2luZG93OlwidW5kZWZpbmVkXCIhPXR5cGVvZiBzZWxmJiZzZWxmLk1hdGg9PU1hdGg/c2VsZjpGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCk7XCJudW1iZXJcIj09dHlwZW9mIF9fZyYmKF9fZz1uKX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMzYpKFwid2tzXCIpLG89bigyMyksaT1uKDEpLlN5bWJvbCx1PVwiZnVuY3Rpb25cIj09dHlwZW9mIGk7KHQuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gclt0XXx8KHJbdF09dSYmaVt0XXx8KHU/aTpvKShcIlN5bWJvbC5cIit0KSl9KS5zdG9yZT1yfSxmdW5jdGlvbih0LGUsbil7XCJ1c2Ugc3RyaWN0XCI7ZS5fX2VzTW9kdWxlPSEwLGUuZGVmYXVsdD1mdW5jdGlvbih0LGUpe2lmKCEodCBpbnN0YW5jZW9mIGUpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9fSxmdW5jdGlvbih0LGUsbil7dC5leHBvcnRzPSFuKDEzKShmdW5jdGlvbigpe3JldHVybiA3IT1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sXCJhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiA3fX0pLmF9KX0sZnVuY3Rpb24odCxlLG4pe1widXNlIHN0cmljdFwiO2UuX19lc01vZHVsZT0hMDt2YXIgcj1uKDU5KSxvPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX0ocik7ZS5kZWZhdWx0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe2Zvcih2YXIgbj0wO248ZS5sZW5ndGg7bisrKXt2YXIgcj1lW25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSwoMCxvLmRlZmF1bHQpKHQsci5rZXkscil9fXJldHVybiBmdW5jdGlvbihlLG4scil7cmV0dXJuIG4mJnQoZS5wcm90b3R5cGUsbiksciYmdChlLHIpLGV9fSgpfSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigxKSxvPW4oMCksaT1uKDE0KSx1PW4oMTEpLGY9bigxMCksYz1mdW5jdGlvbih0LGUsbil7dmFyIGEscyxsLHA9dCZjLkYsdj10JmMuRyx5PXQmYy5TLGQ9dCZjLlAsaD10JmMuQixnPXQmYy5XLGI9dj9vOm9bZV18fChvW2VdPXt9KSxtPWIucHJvdG90eXBlLHc9dj9yOnk/cltlXToocltlXXx8e30pLnByb3RvdHlwZTt2JiYobj1lKTtmb3IoYSBpbiBuKShzPSFwJiZ3JiZ2b2lkIDAhPT13W2FdKSYmZihiLGEpfHwobD1zP3dbYV06blthXSxiW2FdPXYmJlwiZnVuY3Rpb25cIiE9dHlwZW9mIHdbYV0/blthXTpoJiZzP2kobCxyKTpnJiZ3W2FdPT1sP2Z1bmN0aW9uKHQpe3ZhciBlPWZ1bmN0aW9uKGUsbixyKXtpZih0aGlzIGluc3RhbmNlb2YgdCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gbmV3IHQ7Y2FzZSAxOnJldHVybiBuZXcgdChlKTtjYXNlIDI6cmV0dXJuIG5ldyB0KGUsbil9cmV0dXJuIG5ldyB0KGUsbixyKX1yZXR1cm4gdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O3JldHVybiBlLnByb3RvdHlwZT10LnByb3RvdHlwZSxlfShsKTpkJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBsP2koRnVuY3Rpb24uY2FsbCxsKTpsLGQmJigoYi52aXJ0dWFsfHwoYi52aXJ0dWFsPXt9KSlbYV09bCx0JmMuUiYmbSYmIW1bYV0mJnUobSxhLGwpKSl9O2MuRj0xLGMuRz0yLGMuUz00LGMuUD04LGMuQj0xNixjLlc9MzIsYy5VPTY0LGMuUj0xMjgsdC5leHBvcnRzPWN9LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiB0P251bGwhPT10OlwiZnVuY3Rpb25cIj09dHlwZW9mIHR9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big5KSxvPW4oMzkpLGk9bigyNyksdT1PYmplY3QuZGVmaW5lUHJvcGVydHk7ZS5mPW4oNCk/T2JqZWN0LmRlZmluZVByb3BlcnR5OmZ1bmN0aW9uKHQsZSxuKXtpZihyKHQpLGU9aShlLCEwKSxyKG4pLG8pdHJ5e3JldHVybiB1KHQsZSxuKX1jYXRjaCh0KXt9aWYoXCJnZXRcImluIG58fFwic2V0XCJpbiBuKXRocm93IFR5cGVFcnJvcihcIkFjY2Vzc29ycyBub3Qgc3VwcG9ydGVkIVwiKTtyZXR1cm5cInZhbHVlXCJpbiBuJiYodFtlXT1uLnZhbHVlKSx0fX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oNyk7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe2lmKCFyKHQpKXRocm93IFR5cGVFcnJvcih0K1wiIGlzIG5vdCBhbiBvYmplY3QhXCIpO3JldHVybiB0fX0sZnVuY3Rpb24odCxlKXt2YXIgbj17fS5oYXNPd25Qcm9wZXJ0eTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXtyZXR1cm4gbi5jYWxsKHQsZSl9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big4KSxvPW4oMTYpO3QuZXhwb3J0cz1uKDQpP2Z1bmN0aW9uKHQsZSxuKXtyZXR1cm4gci5mKHQsZSxvKDEsbikpfTpmdW5jdGlvbih0LGUsbil7cmV0dXJuIHRbZV09bix0fX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oNTUpLG89bigzMCk7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiByKG8odCkpfX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7dHJ5e3JldHVybiEhdCgpfWNhdGNoKHQpe3JldHVybiEwfX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDI0KTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlLG4pe2lmKHIodCksdm9pZCAwPT09ZSlyZXR1cm4gdDtzd2l0Y2gobil7Y2FzZSAxOnJldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gdC5jYWxsKGUsbil9O2Nhc2UgMjpyZXR1cm4gZnVuY3Rpb24obixyKXtyZXR1cm4gdC5jYWxsKGUsbixyKX07Y2FzZSAzOnJldHVybiBmdW5jdGlvbihuLHIsbyl7cmV0dXJuIHQuY2FsbChlLG4scixvKX19cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuYXBwbHkoZSxhcmd1bWVudHMpfX19LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPSEwfSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0LGUpe3JldHVybntlbnVtZXJhYmxlOiEoMSZ0KSxjb25maWd1cmFibGU6ISgyJnQpLHdyaXRhYmxlOiEoNCZ0KSx2YWx1ZTplfX19LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPXt9fSwsLGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDQ1KSxvPW4oMzcpO3QuZXhwb3J0cz1PYmplY3Qua2V5c3x8ZnVuY3Rpb24odCl7cmV0dXJuIHIodCxvKX19LGZ1bmN0aW9uKHQsZSl7dmFyIG49e30udG9TdHJpbmc7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBuLmNhbGwodCkuc2xpY2UoOCwtMSl9fSxmdW5jdGlvbih0LGUsbil7dmFyIHIsbzshZnVuY3Rpb24oaSx1KXtcInVzZSBzdHJpY3RcIjtyPXUsdm9pZCAwIT09KG89XCJmdW5jdGlvblwiPT10eXBlb2Ygcj9yLmNhbGwoZSxuLGUsdCk6cikmJih0LmV4cG9ydHM9byl9KDAsZnVuY3Rpb24oKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KHQsZSl7dmFyIG49dFtlXTtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmJpbmQpcmV0dXJuIG4uYmluZCh0KTt0cnl7cmV0dXJuIEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwobix0KX1jYXRjaChlKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5LmFwcGx5KG4sW3QsYXJndW1lbnRzXSl9fX1mdW5jdGlvbiBlKGUpe3JldHVyblwiZGVidWdcIj09PWUmJihlPVwibG9nXCIpLHR5cGVvZiBjb25zb2xlIT09ZiYmKHZvaWQgMCE9PWNvbnNvbGVbZV0/dChjb25zb2xlLGUpOnZvaWQgMCE9PWNvbnNvbGUubG9nP3QoY29uc29sZSxcImxvZ1wiKTp1KX1mdW5jdGlvbiBuKHQsZSl7Zm9yKHZhciBuPTA7bjxjLmxlbmd0aDtuKyspe3ZhciByPWNbbl07dGhpc1tyXT1uPHQ/dTp0aGlzLm1ldGhvZEZhY3Rvcnkocix0LGUpfXRoaXMubG9nPXRoaXMuZGVidWd9ZnVuY3Rpb24gcih0LGUscil7cmV0dXJuIGZ1bmN0aW9uKCl7dHlwZW9mIGNvbnNvbGUhPT1mJiYobi5jYWxsKHRoaXMsZSxyKSx0aGlzW3RdLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl9fWZ1bmN0aW9uIG8odCxuLG8pe3JldHVybiBlKHQpfHxyLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBpKHQsZSxyKXtmdW5jdGlvbiBpKHQpe3ZhciBlPShjW3RdfHxcInNpbGVudFwiKS50b1VwcGVyQ2FzZSgpO2lmKHR5cGVvZiB3aW5kb3chPT1mKXt0cnl7cmV0dXJuIHZvaWQod2luZG93LmxvY2FsU3RvcmFnZVtsXT1lKX1jYXRjaCh0KXt9dHJ5e3dpbmRvdy5kb2N1bWVudC5jb29raWU9ZW5jb2RlVVJJQ29tcG9uZW50KGwpK1wiPVwiK2UrXCI7XCJ9Y2F0Y2godCl7fX19ZnVuY3Rpb24gdSgpe3ZhciB0O2lmKHR5cGVvZiB3aW5kb3chPT1mKXt0cnl7dD13aW5kb3cubG9jYWxTdG9yYWdlW2xdfWNhdGNoKHQpe31pZih0eXBlb2YgdD09PWYpdHJ5e3ZhciBlPXdpbmRvdy5kb2N1bWVudC5jb29raWUsbj1lLmluZGV4T2YoZW5jb2RlVVJJQ29tcG9uZW50KGwpK1wiPVwiKTstMSE9PW4mJih0PS9eKFteO10rKS8uZXhlYyhlLnNsaWNlKG4pKVsxXSl9Y2F0Y2godCl7fXJldHVybiB2b2lkIDA9PT1zLmxldmVsc1t0XSYmKHQ9dm9pZCAwKSx0fX12YXIgYSxzPXRoaXMsbD1cImxvZ2xldmVsXCI7dCYmKGwrPVwiOlwiK3QpLHMubmFtZT10LHMubGV2ZWxzPXtUUkFDRTowLERFQlVHOjEsSU5GTzoyLFdBUk46MyxFUlJPUjo0LFNJTEVOVDo1fSxzLm1ldGhvZEZhY3Rvcnk9cnx8byxzLmdldExldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIGF9LHMuc2V0TGV2ZWw9ZnVuY3Rpb24oZSxyKXtpZihcInN0cmluZ1wiPT10eXBlb2YgZSYmdm9pZCAwIT09cy5sZXZlbHNbZS50b1VwcGVyQ2FzZSgpXSYmKGU9cy5sZXZlbHNbZS50b1VwcGVyQ2FzZSgpXSksIShcIm51bWJlclwiPT10eXBlb2YgZSYmZT49MCYmZTw9cy5sZXZlbHMuU0lMRU5UKSl0aHJvd1wibG9nLnNldExldmVsKCkgY2FsbGVkIHdpdGggaW52YWxpZCBsZXZlbDogXCIrZTtpZihhPWUsITEhPT1yJiZpKGUpLG4uY2FsbChzLGUsdCksdHlwZW9mIGNvbnNvbGU9PT1mJiZlPHMubGV2ZWxzLlNJTEVOVClyZXR1cm5cIk5vIGNvbnNvbGUgYXZhaWxhYmxlIGZvciBsb2dnaW5nXCJ9LHMuc2V0RGVmYXVsdExldmVsPWZ1bmN0aW9uKHQpe3UoKXx8cy5zZXRMZXZlbCh0LCExKX0scy5lbmFibGVBbGw9ZnVuY3Rpb24odCl7cy5zZXRMZXZlbChzLmxldmVscy5UUkFDRSx0KX0scy5kaXNhYmxlQWxsPWZ1bmN0aW9uKHQpe3Muc2V0TGV2ZWwocy5sZXZlbHMuU0lMRU5ULHQpfTt2YXIgcD11KCk7bnVsbD09cCYmKHA9bnVsbD09ZT9cIldBUk5cIjplKSxzLnNldExldmVsKHAsITEpfXZhciB1PWZ1bmN0aW9uKCl7fSxmPVwidW5kZWZpbmVkXCIsYz1bXCJ0cmFjZVwiLFwiZGVidWdcIixcImluZm9cIixcIndhcm5cIixcImVycm9yXCJdLGE9bmV3IGkscz17fTthLmdldExvZ2dlcj1mdW5jdGlvbih0KXtpZihcInN0cmluZ1wiIT10eXBlb2YgdHx8XCJcIj09PXQpdGhyb3cgbmV3IFR5cGVFcnJvcihcIllvdSBtdXN0IHN1cHBseSBhIG5hbWUgd2hlbiBjcmVhdGluZyBhIGxvZ2dlci5cIik7dmFyIGU9c1t0XTtyZXR1cm4gZXx8KGU9c1t0XT1uZXcgaSh0LGEuZ2V0TGV2ZWwoKSxhLm1ldGhvZEZhY3RvcnkpKSxlfTt2YXIgbD10eXBlb2Ygd2luZG93IT09Zj93aW5kb3cubG9nOnZvaWQgMDtyZXR1cm4gYS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHR5cGVvZiB3aW5kb3chPT1mJiZ3aW5kb3cubG9nPT09YSYmKHdpbmRvdy5sb2c9bCksYX0sYS5nZXRMb2dnZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIHN9LGF9KX0sZnVuY3Rpb24odCxlKXt2YXIgbj0wLHI9TWF0aC5yYW5kb20oKTt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuXCJTeW1ib2woXCIuY29uY2F0KHZvaWQgMD09PXQ/XCJcIjp0LFwiKV9cIiwoKytuK3IpLnRvU3RyaW5nKDM2KSl9fSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiB0KXRocm93IFR5cGVFcnJvcih0K1wiIGlzIG5vdCBhIGZ1bmN0aW9uIVwiKTtyZXR1cm4gdH19LCxmdW5jdGlvbih0LGUsbil7dmFyIHI9big4KS5mLG89bigxMCksaT1uKDIpKFwidG9TdHJpbmdUYWdcIik7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxuKXt0JiYhbyh0PW4/dDp0LnByb3RvdHlwZSxpKSYmcih0LGkse2NvbmZpZ3VyYWJsZTohMCx2YWx1ZTplfSl9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big3KTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXtpZighcih0KSlyZXR1cm4gdDt2YXIgbixvO2lmKGUmJlwiZnVuY3Rpb25cIj09dHlwZW9mKG49dC50b1N0cmluZykmJiFyKG89bi5jYWxsKHQpKSlyZXR1cm4gbztpZihcImZ1bmN0aW9uXCI9PXR5cGVvZihuPXQudmFsdWVPZikmJiFyKG89bi5jYWxsKHQpKSlyZXR1cm4gbztpZighZSYmXCJmdW5jdGlvblwiPT10eXBlb2Yobj10LnRvU3RyaW5nKSYmIXIobz1uLmNhbGwodCkpKXJldHVybiBvO3Rocm93IFR5cGVFcnJvcihcIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZVwiKX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDcpLG89bigxKS5kb2N1bWVudCxpPXIobykmJnIoby5jcmVhdGVFbGVtZW50KTt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIGk/by5jcmVhdGVFbGVtZW50KHQpOnt9fX0sZnVuY3Rpb24odCxlKXtlLmY9e30ucHJvcGVydHlJc0VudW1lcmFibGV9LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe2lmKHZvaWQgMD09dCl0aHJvdyBUeXBlRXJyb3IoXCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgXCIrdCk7cmV0dXJuIHR9fSxmdW5jdGlvbih0LGUpe3ZhciBuPU1hdGguY2VpbCxyPU1hdGguZmxvb3I7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBpc05hTih0PSt0KT8wOih0PjA/cjpuKSh0KX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDMwKTt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIE9iamVjdChyKHQpKX19LCwsZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMzYpKFwia2V5c1wiKSxvPW4oMjMpO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gclt0XXx8KHJbdF09byh0KSl9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigwKSxvPW4oMSksaT1vW1wiX19jb3JlLWpzX3NoYXJlZF9fXCJdfHwob1tcIl9fY29yZS1qc19zaGFyZWRfX1wiXT17fSk7KHQuZXhwb3J0cz1mdW5jdGlvbih0LGUpe3JldHVybiBpW3RdfHwoaVt0XT12b2lkIDAhPT1lP2U6e30pfSkoXCJ2ZXJzaW9uc1wiLFtdKS5wdXNoKHt2ZXJzaW9uOnIudmVyc2lvbixtb2RlOm4oMTUpP1wicHVyZVwiOlwiZ2xvYmFsXCIsY29weXJpZ2h0OlwiwqkgMjAxOCBEZW5pcyBQdXNoa2FyZXYgKHpsb2lyb2NrLnJ1KVwifSl9LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPVwiY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mXCIuc3BsaXQoXCIsXCIpfSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big5KSxvPW4oNzIpLGk9bigzNyksdT1uKDM1KShcIklFX1BST1RPXCIpLGY9ZnVuY3Rpb24oKXt9LGM9ZnVuY3Rpb24oKXt2YXIgdCxlPW4oMjgpKFwiaWZyYW1lXCIpLHI9aS5sZW5ndGg7Zm9yKGUuc3R5bGUuZGlzcGxheT1cIm5vbmVcIixuKDU2KS5hcHBlbmRDaGlsZChlKSxlLnNyYz1cImphdmFzY3JpcHQ6XCIsdD1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQsdC5vcGVuKCksdC53cml0ZShcIjxzY3JpcHQ+ZG9jdW1lbnQuRj1PYmplY3Q8XFwvc2NyaXB0PlwiKSx0LmNsb3NlKCksYz10LkY7ci0tOylkZWxldGUgYy5wcm90b3R5cGVbaVtyXV07cmV0dXJuIGMoKX07dC5leHBvcnRzPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uKHQsZSl7dmFyIG47cmV0dXJuIG51bGwhPT10PyhmLnByb3RvdHlwZT1yKHQpLG49bmV3IGYsZi5wcm90b3R5cGU9bnVsbCxuW3VdPXQpOm49YygpLHZvaWQgMD09PWU/bjpvKG4sZSl9fSxmdW5jdGlvbih0LGUsbil7dC5leHBvcnRzPSFuKDQpJiYhbigxMykoZnVuY3Rpb24oKXtyZXR1cm4gNyE9T2JqZWN0LmRlZmluZVByb3BlcnR5KG4oMjgpKFwiZGl2XCIpLFwiYVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gN319KS5hfSl9LGZ1bmN0aW9uKHQsZSxuKXtlLmY9bigyKX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMSksbz1uKDApLGk9bigxNSksdT1uKDQwKSxmPW4oOCkuZjt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7dmFyIGU9by5TeW1ib2x8fChvLlN5bWJvbD1pP3t9OnIuU3ltYm9sfHx7fSk7XCJfXCI9PXQuY2hhckF0KDApfHx0IGluIGV8fGYoZSx0LHt2YWx1ZTp1LmYodCl9KX19LGZ1bmN0aW9uKHQsZSxuKXt0LmV4cG9ydHM9e2RlZmF1bHQ6big4OSksX19lc01vZHVsZTohMH19LGZ1bmN0aW9uKHQsZSl7ZS5mPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHN9LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDYpLG89bigwKSxpPW4oMTMpO3QuZXhwb3J0cz1mdW5jdGlvbih0LGUpe3ZhciBuPShvLk9iamVjdHx8e30pW3RdfHxPYmplY3RbdF0sdT17fTt1W3RdPWUobikscihyLlMrci5GKmkoZnVuY3Rpb24oKXtuKDEpfSksXCJPYmplY3RcIix1KX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDEwKSxvPW4oMTIpLGk9big2NCkoITEpLHU9bigzNSkoXCJJRV9QUk9UT1wiKTt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXt2YXIgbixmPW8odCksYz0wLGE9W107Zm9yKG4gaW4gZiluIT11JiZyKGYsbikmJmEucHVzaChuKTtmb3IoO2UubGVuZ3RoPmM7KXIoZixuPWVbYysrXSkmJih+aShhLG4pfHxhLnB1c2gobikpO3JldHVybiBhfX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMjkpLG89bigxNiksaT1uKDEyKSx1PW4oMjcpLGY9bigxMCksYz1uKDM5KSxhPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7ZS5mPW4oNCk/YTpmdW5jdGlvbih0LGUpe2lmKHQ9aSh0KSxlPXUoZSwhMCksYyl0cnl7cmV0dXJuIGEodCxlKX1jYXRjaCh0KXt9aWYoZih0LGUpKXJldHVybiBvKCFyLmYuY2FsbCh0LGUpLHRbZV0pfX0sZnVuY3Rpb24odCxlLG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIodCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OntkZWZhdWx0OnR9fWUuX19lc01vZHVsZT0hMDt2YXIgbz1uKDc5KSxpPXIobyksdT1uKDgxKSxmPXIodSksYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiBmLmRlZmF1bHQmJlwic3ltYm9sXCI9PXR5cGVvZiBpLmRlZmF1bHQ/ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgZi5kZWZhdWx0JiZ0LmNvbnN0cnVjdG9yPT09Zi5kZWZhdWx0JiZ0IT09Zi5kZWZhdWx0LnByb3RvdHlwZT9cInN5bWJvbFwiOnR5cGVvZiB0fTtlLmRlZmF1bHQ9XCJmdW5jdGlvblwiPT10eXBlb2YgZi5kZWZhdWx0JiZcInN5bWJvbFwiPT09YyhpLmRlZmF1bHQpP2Z1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10P1widW5kZWZpbmVkXCI6Yyh0KX06ZnVuY3Rpb24odCl7cmV0dXJuIHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGYuZGVmYXVsdCYmdC5jb25zdHJ1Y3Rvcj09PWYuZGVmYXVsdCYmdCE9PWYuZGVmYXVsdC5wcm90b3R5cGU/XCJzeW1ib2xcIjp2b2lkIDA9PT10P1widW5kZWZpbmVkXCI6Yyh0KX19LGZ1bmN0aW9uKHQsZSxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj1uKDE1KSxvPW4oNiksaT1uKDUwKSx1PW4oMTEpLGY9bigxNyksYz1uKDcxKSxhPW4oMjYpLHM9big1MyksbD1uKDIpKFwiaXRlcmF0b3JcIikscD0hKFtdLmtleXMmJlwibmV4dFwiaW5bXS5rZXlzKCkpLHY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxuLHksZCxoLGcpe2MobixlLHkpO3ZhciBiLG0sdyxPPWZ1bmN0aW9uKHQpe2lmKCFwJiZ0IGluIGopcmV0dXJuIGpbdF07c3dpdGNoKHQpe2Nhc2VcImtleXNcIjpjYXNlXCJ2YWx1ZXNcIjpyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG4odGhpcyx0KX19cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKHRoaXMsdCl9fSxTPWUrXCIgSXRlcmF0b3JcIixfPVwidmFsdWVzXCI9PWQseD0hMSxqPXQucHJvdG90eXBlLFA9altsXXx8altcIkBAaXRlcmF0b3JcIl18fGQmJmpbZF0sTT1QfHxPKGQpLEw9ZD9fP08oXCJlbnRyaWVzXCIpOk06dm9pZCAwLFQ9XCJBcnJheVwiPT1lP2ouZW50cmllc3x8UDpQO2lmKFQmJih3PXMoVC5jYWxsKG5ldyB0KSkpIT09T2JqZWN0LnByb3RvdHlwZSYmdy5uZXh0JiYoYSh3LFMsITApLHJ8fFwiZnVuY3Rpb25cIj09dHlwZW9mIHdbbF18fHUodyxsLHYpKSxfJiZQJiZcInZhbHVlc1wiIT09UC5uYW1lJiYoeD0hMCxNPWZ1bmN0aW9uKCl7cmV0dXJuIFAuY2FsbCh0aGlzKX0pLHImJiFnfHwhcCYmIXgmJmpbbF18fHUoaixsLE0pLGZbZV09TSxmW1NdPXYsZClpZihiPXt2YWx1ZXM6Xz9NOk8oXCJ2YWx1ZXNcIiksa2V5czpoP006TyhcImtleXNcIiksZW50cmllczpMfSxnKWZvcihtIGluIGIpbSBpbiBqfHxpKGosbSxiW21dKTtlbHNlIG8oby5QK28uRioocHx8eCksZSxiKTtyZXR1cm4gYn19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDMxKSxvPU1hdGgubWluO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gdD4wP28ocih0KSw5MDA3MTk5MjU0NzQwOTkxKTowfX0sZnVuY3Rpb24odCxlLG4pe3QuZXhwb3J0cz1uKDExKX0sLGZ1bmN0aW9uKHQsZSxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj1uKDcwKSghMCk7big0OCkoU3RyaW5nLFwiU3RyaW5nXCIsZnVuY3Rpb24odCl7dGhpcy5fdD1TdHJpbmcodCksdGhpcy5faT0wfSxmdW5jdGlvbigpe3ZhciB0LGU9dGhpcy5fdCxuPXRoaXMuX2k7cmV0dXJuIG4+PWUubGVuZ3RoP3t2YWx1ZTp2b2lkIDAsZG9uZTohMH06KHQ9cihlLG4pLHRoaXMuX2krPXQubGVuZ3RoLHt2YWx1ZTp0LGRvbmU6ITF9KX0pfSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigxMCksbz1uKDMyKSxpPW4oMzUpKFwiSUVfUFJPVE9cIiksdT1PYmplY3QucHJvdG90eXBlO3QuZXhwb3J0cz1PYmplY3QuZ2V0UHJvdG90eXBlT2Z8fGZ1bmN0aW9uKHQpe3JldHVybiB0PW8odCkscih0LGkpP3RbaV06XCJmdW5jdGlvblwiPT10eXBlb2YgdC5jb25zdHJ1Y3RvciYmdCBpbnN0YW5jZW9mIHQuY29uc3RydWN0b3I/dC5jb25zdHJ1Y3Rvci5wcm90b3R5cGU6dCBpbnN0YW5jZW9mIE9iamVjdD91Om51bGx9fSxmdW5jdGlvbih0LGUsbil7big3Myk7Zm9yKHZhciByPW4oMSksbz1uKDExKSxpPW4oMTcpLHU9bigyKShcInRvU3RyaW5nVGFnXCIpLGY9XCJDU1NSdWxlTGlzdCxDU1NTdHlsZURlY2xhcmF0aW9uLENTU1ZhbHVlTGlzdCxDbGllbnRSZWN0TGlzdCxET01SZWN0TGlzdCxET01TdHJpbmdMaXN0LERPTVRva2VuTGlzdCxEYXRhVHJhbnNmZXJJdGVtTGlzdCxGaWxlTGlzdCxIVE1MQWxsQ29sbGVjdGlvbixIVE1MQ29sbGVjdGlvbixIVE1MRm9ybUVsZW1lbnQsSFRNTFNlbGVjdEVsZW1lbnQsTWVkaWFMaXN0LE1pbWVUeXBlQXJyYXksTmFtZWROb2RlTWFwLE5vZGVMaXN0LFBhaW50UmVxdWVzdExpc3QsUGx1Z2luLFBsdWdpbkFycmF5LFNWR0xlbmd0aExpc3QsU1ZHTnVtYmVyTGlzdCxTVkdQYXRoU2VnTGlzdCxTVkdQb2ludExpc3QsU1ZHU3RyaW5nTGlzdCxTVkdUcmFuc2Zvcm1MaXN0LFNvdXJjZUJ1ZmZlckxpc3QsU3R5bGVTaGVldExpc3QsVGV4dFRyYWNrQ3VlTGlzdCxUZXh0VHJhY2tMaXN0LFRvdWNoTGlzdFwiLnNwbGl0KFwiLFwiKSxjPTA7YzxmLmxlbmd0aDtjKyspe3ZhciBhPWZbY10scz1yW2FdLGw9cyYmcy5wcm90b3R5cGU7bCYmIWxbdV0mJm8obCx1LGEpLGlbYV09aS5BcnJheX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDIxKTt0LmV4cG9ydHM9T2JqZWN0KFwielwiKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKT9PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuXCJTdHJpbmdcIj09cih0KT90LnNwbGl0KFwiXCIpOk9iamVjdCh0KX19LGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDEpLmRvY3VtZW50O3QuZXhwb3J0cz1yJiZyLmRvY3VtZW50RWxlbWVudH0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oNDUpLG89bigzNykuY29uY2F0KFwibGVuZ3RoXCIsXCJwcm90b3R5cGVcIik7ZS5mPU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzfHxmdW5jdGlvbih0KXtyZXR1cm4gcih0LG8pfX0sLGZ1bmN0aW9uKHQsZSxuKXt0LmV4cG9ydHM9e2RlZmF1bHQ6big2MSksX19lc01vZHVsZTohMH19LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUsbil7big2Mik7dmFyIHI9bigwKS5PYmplY3Q7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSxuKXtyZXR1cm4gci5kZWZpbmVQcm9wZXJ0eSh0LGUsbil9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big2KTtyKHIuUytyLkYqIW4oNCksXCJPYmplY3RcIix7ZGVmaW5lUHJvcGVydHk6big4KS5mfSl9LCxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigxMiksbz1uKDQ5KSxpPW4oNjUpO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxuLHUpe3ZhciBmLGM9cihlKSxhPW8oYy5sZW5ndGgpLHM9aSh1LGEpO2lmKHQmJm4hPW4pe2Zvcig7YT5zOylpZigoZj1jW3MrK10pIT1mKXJldHVybiEwfWVsc2UgZm9yKDthPnM7cysrKWlmKCh0fHxzIGluIGMpJiZjW3NdPT09bilyZXR1cm4gdHx8c3x8MDtyZXR1cm4hdCYmLTF9fX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMzEpLG89TWF0aC5tYXgsaT1NYXRoLm1pbjt0LmV4cG9ydHM9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD1yKHQpLHQ8MD9vKHQrZSwwKTppKHQsZSl9fSwsLCwsZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMzEpLG89bigzMCk7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlLG4pe3ZhciBpLHUsZj1TdHJpbmcobyhlKSksYz1yKG4pLGE9Zi5sZW5ndGg7cmV0dXJuIGM8MHx8Yz49YT90P1wiXCI6dm9pZCAwOihpPWYuY2hhckNvZGVBdChjKSxpPDU1Mjk2fHxpPjU2MzE5fHxjKzE9PT1hfHwodT1mLmNoYXJDb2RlQXQoYysxKSk8NTYzMjB8fHU+NTczNDM/dD9mLmNoYXJBdChjKTppOnQ/Zi5zbGljZShjLGMrMik6dS01NjMyMCsoaS01NTI5Njw8MTApKzY1NTM2KX19fSxmdW5jdGlvbih0LGUsbil7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9bigzOCksbz1uKDE2KSxpPW4oMjYpLHU9e307bigxMSkodSxuKDIpKFwiaXRlcmF0b3JcIiksZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLHQuZXhwb3J0cz1mdW5jdGlvbih0LGUsbil7dC5wcm90b3R5cGU9cih1LHtuZXh0Om8oMSxuKX0pLGkodCxlK1wiIEl0ZXJhdG9yXCIpfX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oOCksbz1uKDkpLGk9bigyMCk7dC5leHBvcnRzPW4oNCk/T2JqZWN0LmRlZmluZVByb3BlcnRpZXM6ZnVuY3Rpb24odCxlKXtvKHQpO2Zvcih2YXIgbix1PWkoZSksZj11Lmxlbmd0aCxjPTA7Zj5jOylyLmYodCxuPXVbYysrXSxlW25dKTtyZXR1cm4gdH19LGZ1bmN0aW9uKHQsZSxuKXtcInVzZSBzdHJpY3RcIjt2YXIgcj1uKDc0KSxvPW4oNzUpLGk9bigxNyksdT1uKDEyKTt0LmV4cG9ydHM9big0OCkoQXJyYXksXCJBcnJheVwiLGZ1bmN0aW9uKHQsZSl7dGhpcy5fdD11KHQpLHRoaXMuX2k9MCx0aGlzLl9rPWV9LGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fdCxlPXRoaXMuX2ssbj10aGlzLl9pKys7cmV0dXJuIXR8fG4+PXQubGVuZ3RoPyh0aGlzLl90PXZvaWQgMCxvKDEpKTpcImtleXNcIj09ZT9vKDAsbik6XCJ2YWx1ZXNcIj09ZT9vKDAsdFtuXSk6bygwLFtuLHRbbl1dKX0sXCJ2YWx1ZXNcIiksaS5Bcmd1bWVudHM9aS5BcnJheSxyKFwia2V5c1wiKSxyKFwidmFsdWVzXCIpLHIoXCJlbnRyaWVzXCIpfSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbigpe319LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQsZSl7cmV0dXJue3ZhbHVlOmUsZG9uZTohIXR9fX0sLGZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uKDIzKShcIm1ldGFcIiksbz1uKDcpLGk9bigxMCksdT1uKDgpLmYsZj0wLGM9T2JqZWN0LmlzRXh0ZW5zaWJsZXx8ZnVuY3Rpb24oKXtyZXR1cm4hMH0sYT0hbigxMykoZnVuY3Rpb24oKXtyZXR1cm4gYyhPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe30pKX0pLHM9ZnVuY3Rpb24odCl7dSh0LHIse3ZhbHVlOntpOlwiT1wiKyArK2Ysdzp7fX19KX0sbD1mdW5jdGlvbih0LGUpe2lmKCFvKHQpKXJldHVyblwic3ltYm9sXCI9PXR5cGVvZiB0P3Q6KFwic3RyaW5nXCI9PXR5cGVvZiB0P1wiU1wiOlwiUFwiKSt0O2lmKCFpKHQscikpe2lmKCFjKHQpKXJldHVyblwiRlwiO2lmKCFlKXJldHVyblwiRVwiO3ModCl9cmV0dXJuIHRbcl0uaX0scD1mdW5jdGlvbih0LGUpe2lmKCFpKHQscikpe2lmKCFjKHQpKXJldHVybiEwO2lmKCFlKXJldHVybiExO3ModCl9cmV0dXJuIHRbcl0ud30sdj1mdW5jdGlvbih0KXtyZXR1cm4gYSYmeS5ORUVEJiZjKHQpJiYhaSh0LHIpJiZzKHQpLHR9LHk9dC5leHBvcnRzPXtLRVk6cixORUVEOiExLGZhc3RLZXk6bCxnZXRXZWFrOnAsb25GcmVlemU6dn19LGZ1bmN0aW9uKHQsZSxuKXt0LmV4cG9ydHM9e2RlZmF1bHQ6bigxMTkpLF9fZXNNb2R1bGU6ITB9fSxmdW5jdGlvbih0LGUsbil7dC5leHBvcnRzPXtkZWZhdWx0Om4oODApLF9fZXNNb2R1bGU6ITB9fSxmdW5jdGlvbih0LGUsbil7big1Miksbig1NCksdC5leHBvcnRzPW4oNDApLmYoXCJpdGVyYXRvclwiKX0sZnVuY3Rpb24odCxlLG4pe3QuZXhwb3J0cz17ZGVmYXVsdDpuKDgyKSxfX2VzTW9kdWxlOiEwfX0sZnVuY3Rpb24odCxlLG4pe24oODMpLG4oNjApLG4oODcpLG4oODgpLHQuZXhwb3J0cz1uKDApLlN5bWJvbH0sZnVuY3Rpb24odCxlLG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oMSksbz1uKDEwKSxpPW4oNCksdT1uKDYpLGY9big1MCksYz1uKDc3KS5LRVksYT1uKDEzKSxzPW4oMzYpLGw9bigyNikscD1uKDIzKSx2PW4oMikseT1uKDQwKSxkPW4oNDEpLGg9big4NCksZz1uKDg1KSxiPW4oOSksbT1uKDcpLHc9bigxMiksTz1uKDI3KSxTPW4oMTYpLF89bigzOCkseD1uKDg2KSxqPW4oNDYpLFA9big4KSxNPW4oMjApLEw9ai5mLFQ9UC5mLEU9eC5mLGs9ci5TeW1ib2wsQT1yLkpTT04sRj1BJiZBLnN0cmluZ2lmeSxOPXYoXCJfaGlkZGVuXCIpLEM9dihcInRvUHJpbWl0aXZlXCIpLEk9e30ucHJvcGVydHlJc0VudW1lcmFibGUsUj1zKFwic3ltYm9sLXJlZ2lzdHJ5XCIpLEQ9cyhcInN5bWJvbHNcIiksRz1zKFwib3Atc3ltYm9sc1wiKSxLPU9iamVjdC5wcm90b3R5cGUsVj1cImZ1bmN0aW9uXCI9PXR5cGVvZiBrLFc9ci5RT2JqZWN0LFU9IVd8fCFXLnByb3RvdHlwZXx8IVcucHJvdG90eXBlLmZpbmRDaGlsZCxxPWkmJmEoZnVuY3Rpb24oKXtyZXR1cm4gNyE9XyhUKHt9LFwiYVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gVCh0aGlzLFwiYVwiLHt2YWx1ZTo3fSkuYX19KSkuYX0pP2Z1bmN0aW9uKHQsZSxuKXt2YXIgcj1MKEssZSk7ciYmZGVsZXRlIEtbZV0sVCh0LGUsbiksciYmdCE9PUsmJlQoSyxlLHIpfTpULEI9ZnVuY3Rpb24odCl7dmFyIGU9RFt0XT1fKGsucHJvdG90eXBlKTtyZXR1cm4gZS5faz10LGV9LEg9ViYmXCJzeW1ib2xcIj09dHlwZW9mIGsuaXRlcmF0b3I/ZnVuY3Rpb24odCl7cmV0dXJuXCJzeW1ib2xcIj09dHlwZW9mIHR9OmZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2Yga30sSj1mdW5jdGlvbih0LGUsbil7cmV0dXJuIHQ9PT1LJiZKKEcsZSxuKSxiKHQpLGU9TyhlLCEwKSxiKG4pLG8oRCxlKT8obi5lbnVtZXJhYmxlPyhvKHQsTikmJnRbTl1bZV0mJih0W05dW2VdPSExKSxuPV8obix7ZW51bWVyYWJsZTpTKDAsITEpfSkpOihvKHQsTil8fFQodCxOLFMoMSx7fSkpLHRbTl1bZV09ITApLHEodCxlLG4pKTpUKHQsZSxuKX0sWT1mdW5jdGlvbih0LGUpe2IodCk7Zm9yKHZhciBuLHI9aChlPXcoZSkpLG89MCxpPXIubGVuZ3RoO2k+bzspSih0LG49cltvKytdLGVbbl0pO3JldHVybiB0fSx6PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHZvaWQgMD09PWU/Xyh0KTpZKF8odCksZSl9LFE9ZnVuY3Rpb24odCl7dmFyIGU9SS5jYWxsKHRoaXMsdD1PKHQsITApKTtyZXR1cm4hKHRoaXM9PT1LJiZvKEQsdCkmJiFvKEcsdCkpJiYoIShlfHwhbyh0aGlzLHQpfHwhbyhELHQpfHxvKHRoaXMsTikmJnRoaXNbTl1bdF0pfHxlKX0sWD1mdW5jdGlvbih0LGUpe2lmKHQ9dyh0KSxlPU8oZSwhMCksdCE9PUt8fCFvKEQsZSl8fG8oRyxlKSl7dmFyIG49TCh0LGUpO3JldHVybiFufHwhbyhELGUpfHxvKHQsTikmJnRbTl1bZV18fChuLmVudW1lcmFibGU9ITApLG59fSxaPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZSxuPUUodyh0KSkscj1bXSxpPTA7bi5sZW5ndGg+aTspbyhELGU9bltpKytdKXx8ZT09Tnx8ZT09Y3x8ci5wdXNoKGUpO3JldHVybiByfSwkPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZSxuPXQ9PT1LLHI9RShuP0c6dyh0KSksaT1bXSx1PTA7ci5sZW5ndGg+dTspIW8oRCxlPXJbdSsrXSl8fG4mJiFvKEssZSl8fGkucHVzaChEW2VdKTtyZXR1cm4gaX07Vnx8KGs9ZnVuY3Rpb24oKXtpZih0aGlzIGluc3RhbmNlb2Ygayl0aHJvdyBUeXBlRXJyb3IoXCJTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3IhXCIpO3ZhciB0PXAoYXJndW1lbnRzLmxlbmd0aD4wP2FyZ3VtZW50c1swXTp2b2lkIDApLGU9ZnVuY3Rpb24obil7dGhpcz09PUsmJmUuY2FsbChHLG4pLG8odGhpcyxOKSYmbyh0aGlzW05dLHQpJiYodGhpc1tOXVt0XT0hMSkscSh0aGlzLHQsUygxLG4pKX07cmV0dXJuIGkmJlUmJnEoSyx0LHtjb25maWd1cmFibGU6ITAsc2V0OmV9KSxCKHQpfSxmKGsucHJvdG90eXBlLFwidG9TdHJpbmdcIixmdW5jdGlvbigpe3JldHVybiB0aGlzLl9rfSksai5mPVgsUC5mPUosbig1NykuZj14LmY9WixuKDI5KS5mPVEsbig0MykuZj0kLGkmJiFuKDE1KSYmZihLLFwicHJvcGVydHlJc0VudW1lcmFibGVcIixRLCEwKSx5LmY9ZnVuY3Rpb24odCl7cmV0dXJuIEIodih0KSl9KSx1KHUuRyt1LlcrdS5GKiFWLHtTeW1ib2w6a30pO2Zvcih2YXIgdHQ9XCJoYXNJbnN0YW5jZSxpc0NvbmNhdFNwcmVhZGFibGUsaXRlcmF0b3IsbWF0Y2gscmVwbGFjZSxzZWFyY2gsc3BlY2llcyxzcGxpdCx0b1ByaW1pdGl2ZSx0b1N0cmluZ1RhZyx1bnNjb3BhYmxlc1wiLnNwbGl0KFwiLFwiKSxldD0wO3R0Lmxlbmd0aD5ldDspdih0dFtldCsrXSk7Zm9yKHZhciBudD1NKHYuc3RvcmUpLHJ0PTA7bnQubGVuZ3RoPnJ0OylkKG50W3J0KytdKTt1KHUuUyt1LkYqIVYsXCJTeW1ib2xcIix7Zm9yOmZ1bmN0aW9uKHQpe3JldHVybiBvKFIsdCs9XCJcIik/Ult0XTpSW3RdPWsodCl9LGtleUZvcjpmdW5jdGlvbih0KXtpZighSCh0KSl0aHJvdyBUeXBlRXJyb3IodCtcIiBpcyBub3QgYSBzeW1ib2whXCIpO2Zvcih2YXIgZSBpbiBSKWlmKFJbZV09PT10KXJldHVybiBlfSx1c2VTZXR0ZXI6ZnVuY3Rpb24oKXtVPSEwfSx1c2VTaW1wbGU6ZnVuY3Rpb24oKXtVPSExfX0pLHUodS5TK3UuRiohVixcIk9iamVjdFwiLHtjcmVhdGU6eixkZWZpbmVQcm9wZXJ0eTpKLGRlZmluZVByb3BlcnRpZXM6WSxnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6WCxnZXRPd25Qcm9wZXJ0eU5hbWVzOlosZ2V0T3duUHJvcGVydHlTeW1ib2xzOiR9KSxBJiZ1KHUuUyt1LkYqKCFWfHxhKGZ1bmN0aW9uKCl7dmFyIHQ9aygpO3JldHVyblwiW251bGxdXCIhPUYoW3RdKXx8XCJ7fVwiIT1GKHthOnR9KXx8XCJ7fVwiIT1GKE9iamVjdCh0KSl9KSksXCJKU09OXCIse3N0cmluZ2lmeTpmdW5jdGlvbih0KXtmb3IodmFyIGUsbixyPVt0XSxvPTE7YXJndW1lbnRzLmxlbmd0aD5vOylyLnB1c2goYXJndW1lbnRzW28rK10pO2lmKG49ZT1yWzFdLChtKGUpfHx2b2lkIDAhPT10KSYmIUgodCkpcmV0dXJuIGcoZSl8fChlPWZ1bmN0aW9uKHQsZSl7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgbiYmKGU9bi5jYWxsKHRoaXMsdCxlKSksIUgoZSkpcmV0dXJuIGV9KSxyWzFdPWUsRi5hcHBseShBLHIpfX0pLGsucHJvdG90eXBlW0NdfHxuKDExKShrLnByb3RvdHlwZSxDLGsucHJvdG90eXBlLnZhbHVlT2YpLGwoayxcIlN5bWJvbFwiKSxsKE1hdGgsXCJNYXRoXCIsITApLGwoci5KU09OLFwiSlNPTlwiLCEwKX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMjApLG89big0MyksaT1uKDI5KTt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7dmFyIGU9cih0KSxuPW8uZjtpZihuKWZvcih2YXIgdSxmPW4odCksYz1pLmYsYT0wO2YubGVuZ3RoPmE7KWMuY2FsbCh0LHU9ZlthKytdKSYmZS5wdXNoKHUpO3JldHVybiBlfX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMjEpO3QuZXhwb3J0cz1BcnJheS5pc0FycmF5fHxmdW5jdGlvbih0KXtyZXR1cm5cIkFycmF5XCI9PXIodCl9fSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigxMiksbz1uKDU3KS5mLGk9e30udG9TdHJpbmcsdT1cIm9iamVjdFwiPT10eXBlb2Ygd2luZG93JiZ3aW5kb3cmJk9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzP09iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdyk6W10sZj1mdW5jdGlvbih0KXt0cnl7cmV0dXJuIG8odCl9Y2F0Y2godCl7cmV0dXJuIHUuc2xpY2UoKX19O3QuZXhwb3J0cy5mPWZ1bmN0aW9uKHQpe3JldHVybiB1JiZcIltvYmplY3QgV2luZG93XVwiPT1pLmNhbGwodCk/Zih0KTpvKHIodCkpfX0sZnVuY3Rpb24odCxlLG4pe24oNDEpKFwiYXN5bmNJdGVyYXRvclwiKX0sZnVuY3Rpb24odCxlLG4pe24oNDEpKFwib2JzZXJ2YWJsZVwiKX0sZnVuY3Rpb24odCxlLG4pe24oOTApLHQuZXhwb3J0cz1uKDApLk9iamVjdC5rZXlzfSxmdW5jdGlvbih0LGUsbil7dmFyIHI9bigzMiksbz1uKDIwKTtuKDQ0KShcImtleXNcIixmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gbyhyKHQpKX19KX0sLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLGZ1bmN0aW9uKHQsZSxuKXtuKDEyMCksdC5leHBvcnRzPW4oMCkuT2JqZWN0LmFzc2lnbn0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oNik7cihyLlMrci5GLFwiT2JqZWN0XCIse2Fzc2lnbjpuKDEyMSl9KX0sZnVuY3Rpb24odCxlLG4pe1widXNlIHN0cmljdFwiO3ZhciByPW4oMjApLG89big0MyksaT1uKDI5KSx1PW4oMzIpLGY9big1NSksYz1PYmplY3QuYXNzaWduO3QuZXhwb3J0cz0hY3x8bigxMykoZnVuY3Rpb24oKXt2YXIgdD17fSxlPXt9LG49U3ltYm9sKCkscj1cImFiY2RlZmdoaWprbG1ub3BxcnN0XCI7cmV0dXJuIHRbbl09NyxyLnNwbGl0KFwiXCIpLmZvckVhY2goZnVuY3Rpb24odCl7ZVt0XT10fSksNyE9Yyh7fSx0KVtuXXx8T2JqZWN0LmtleXMoYyh7fSxlKSkuam9pbihcIlwiKSE9cn0pP2Z1bmN0aW9uKHQsZSl7Zm9yKHZhciBuPXUodCksYz1hcmd1bWVudHMubGVuZ3RoLGE9MSxzPW8uZixsPWkuZjtjPmE7KWZvcih2YXIgcCx2PWYoYXJndW1lbnRzW2ErK10pLHk9cz9yKHYpLmNvbmNhdChzKHYpKTpyKHYpLGQ9eS5sZW5ndGgsaD0wO2Q+aDspbC5jYWxsKHYscD15W2grK10pJiYobltwXT12W3BdKTtyZXR1cm4gbn06Y30sLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLGZ1bmN0aW9uKHQsZSxuKXtcInVzZSBzdHJpY3RcIjtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgcj1uKDIyKSxvPWZ1bmN0aW9uKHQpe2lmKHQmJnQuX19lc01vZHVsZSlyZXR1cm4gdDt2YXIgZT17fTtpZihudWxsIT10KWZvcih2YXIgbiBpbiB0KU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LG4pJiYoZVtuXT10W25dKTtyZXR1cm4gZS5kZWZhdWx0PXQsZX0ociksaT1uKDE1NCksdT1mdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19KGkpO28uZ2V0TG9nZ2VyKFwiU3RvcmFnZU1hbmFnZXJcIikuc2V0TGV2ZWwoMCksZS5kZWZhdWx0PXUuZGVmYXVsdCx0LmV4cG9ydHM9ZS5kZWZhdWx0fSxmdW5jdGlvbih0LGUsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIG89bigxNTUpLGk9cihvKSx1PW4oNDIpLGY9cih1KSxjPW4oNDcpLGE9cihjKSxzPW4oNzgpLGw9cihzKSxwPW4oMyksdj1yKHApLHk9big1KSxkPXIoeSksaD1uKDIyKSxnPWZ1bmN0aW9uKHQpe2lmKHQmJnQuX19lc01vZHVsZSlyZXR1cm4gdDt2YXIgZT17fTtpZihudWxsIT10KWZvcih2YXIgbiBpbiB0KU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LG4pJiYoZVtuXT10W25dKTtyZXR1cm4gZS5kZWZhdWx0PXQsZX0oaCksYj1nLmdldExvZ2dlcihcIlN0b3JhZ2VNYW5hZ2VyXCIpLG09ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUsbixyKXt2YXIgbz1hcmd1bWVudHMubGVuZ3RoPjMmJnZvaWQgMCE9PWFyZ3VtZW50c1szXT9hcmd1bWVudHNbM106MTtpZigoMCx2LmRlZmF1bHQpKHRoaXMsdCksIWUpdGhyb3cgRXJyb3IoXCJUaGUgU3RvcmFnZSBNYW5hZ2VyIG5lZWRzIHRoZSBkYXRhYmFzZSBpbnN0YW5jZVwiKTtpZighbil0aHJvdyBFcnJvcihcIlRoZSBTdG9yYWdlIE1hbmFnZXIgbmVlZHMgdGhlIHN0b3JhZ2UgbmFtZVwiKTt2YXIgaT17fTtyP2k9cjppW25dPVwia2V5LHZlcnNpb24sdmFsdWVcIixlLnZlcnNpb24obykuc3RvcmVzKGkpLGUub3BlbigpLnRoZW4oZnVuY3Rpb24odCl7Yi5pbmZvKFwiRm91bmQgZGF0YWJhc2UgbmFtZSBcIit0Lm5hbWUrXCIgd2l0aCB2ZXJzaW9uIG5vOiBcIit0LnZlcm5vKX0pLmNhdGNoKGIuZXJyb3IpLHRoaXMuZGI9ZSx0aGlzLnN0b3JhZ2VOYW1lPW59cmV0dXJuKDAsZC5kZWZhdWx0KSh0LFt7a2V5OlwiX2NoZWNrS2V5XCIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuXCJzdHJpbmdcIiE9dHlwZW9mIHQ/dC50b1N0cmluZygpOnR9fSx7a2V5OlwiX2dldFRhYmxlXCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dm9pZCAwO3RyeXtlPXRoaXMuZGIudGFibGUodGhpcy5zdG9yYWdlTmFtZSkubmFtZX1jYXRjaChuKXtlPXRoaXMuZGIudGFibGUodCkubmFtZX1yZXR1cm4gZX19LHtrZXk6XCJfZ2V0UHJpbWFyeUtleVwiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRiLnRhYmxlKHQpLnNjaGVtYS5wcmltS2V5Lm5hbWV9fSx7a2V5OlwiX2lzRGVmYXVsdFNjaGVtYVwiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2dldFRhYmxlKHQpLG49dGhpcy5kYltlXS5zY2hlbWEuaW5zdGFuY2VUZW1wbGF0ZTtyZXR1cm4gbi5oYXNPd25Qcm9wZXJ0eShcInZhbHVlXCIpJiZuLmhhc093blByb3BlcnR5KFwidmVyc2lvblwiKSYmbi5oYXNPd25Qcm9wZXJ0eShcImtleVwiKX19LHtrZXk6XCJzZXRcIix2YWx1ZTpmdW5jdGlvbih0LGUsbixyKXtiLmluZm8oXCJbU3RvcmFnZU1hbmFnZXJdIC0gc2V0IFwiLHQsbikscj1yfHx0O3ZhciBvPXRoaXMuX2dldFRhYmxlKHIpLGk9dGhpcy5fZ2V0UHJpbWFyeUtleShvKSx1PW47aWYodGhpcy5faXNEZWZhdWx0U2NoZW1hKHIpKXU9e2tleTp0LHZlcnNpb246ZSx2YWx1ZTpufTtlbHNle3ZhciBmPXt9O2ZbaV09dCwoMCxsLmRlZmF1bHQpKHUsZil9cmV0dXJuIHRoaXMuZGJbb10ucHV0KHUpfX0se2tleTpcImdldFwiLHZhbHVlOmZ1bmN0aW9uKHQsZSxuKXt2YXIgcj10aGlzO2NvbnNvbGUuaW5mbyhcIltTdG9yYWdlTWFuYWdlcl0gLSBnZXQgXCIsdCxlKSxuPW58fHQ7dmFyIG89dGhpcy5fZ2V0VGFibGUobiksdT10aGlzLl9nZXRQcmltYXJ5S2V5KG8pO3JldHVybiB0aGlzLmRiLnRyYW5zYWN0aW9uKFwicnchXCIsdGhpcy5kYltvXSxmdW5jdGlvbigpe2lmKCF0JiYhZSlyZXR1cm4gci5kYltvXS50b0FycmF5KCkudGhlbihmdW5jdGlvbih0KXtyZXR1cm4gdC5yZWR1Y2UoZnVuY3Rpb24odCxlKXtyZXR1cm4gdFtlW3VdXT1lLHR9LHt9KX0pO2lmKCFlKXJldHVybiByLmRiW29dLndoZXJlKHUpLmVxdWFscyh0KS5maXJzdCgpLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQuaGFzT3duUHJvcGVydHkoXCJ2YWx1ZVwiKT90LnZhbHVlOnR9KTt2YXIgbj12b2lkIDA9PT1lP1widW5kZWZpbmVkXCI6KDAsYS5kZWZhdWx0KShlKTtzd2l0Y2goQXJyYXkuaXNBcnJheShlKSYmKG49XCJhcnJheVwiKSxuKXtjYXNlXCJzdHJpbmdcIjpyZXR1cm4gci5kYltvXS53aGVyZSh0KS5lcXVhbHMoZSkuZmlyc3QoKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Lmhhc093blByb3BlcnR5KFwidmFsdWVcIik/dC52YWx1ZTp0fSk7Y2FzZVwib2JqZWN0XCI6dmFyIGM9XCJ2YWx1ZS5cIisoMCxmLmRlZmF1bHQpKGUpLnRvU3RyaW5nKCkscz0oMCxpLmRlZmF1bHQpKGUpO3JldHVybiBjb25zb2xlLmxvZyhjLHMpLHIuZGJbb10ud2hlcmUoYykuYW55T2YocykuZmlyc3QoKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Lmhhc093blByb3BlcnR5KFwidmFsdWVcIik/dC52YWx1ZTp0fSk7Y2FzZVwiYXJyYXlcIjpyZXR1cm4gY29uc29sZS5sb2coXCJBUlJBWTpcIixlKSxyLmRiW29dLndoZXJlKGUpLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQuaGFzT3duUHJvcGVydHkoXCJ2YWx1ZVwiKT90LnZhbHVlOnR9KX19KX19LHtrZXk6XCJnZXRWZXJzaW9uXCIsdmFsdWU6ZnVuY3Rpb24odCxlLG4pe3ZhciByPXRoaXM7Yi5pbmZvKFwiW1N0b3JhZ2VNYW5hZ2VyXSAtIGdldFZlcnNpb24gZm9yIGtleSBcIix0KSxuPW58fHQ7dmFyIG89dGhpcy5fZ2V0VGFibGUobiksaT10aGlzLl9nZXRQcmltYXJ5S2V5KG8pLHU9ZTtyZXR1cm4gZXx8KHU9dCksdGhpcy5kYi50cmFuc2FjdGlvbihcInJ3IVwiLHRoaXMuZGJbb10sZnVuY3Rpb24oKXtyZXR1cm4gci5kYltvXS53aGVyZShpKS5lcXVhbHModSkuZmlyc3QoKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Lmhhc093blByb3BlcnR5KFwidmVyc2lvblwiKT90LnZlcnNpb246dH0pLmNhdGNoKGZ1bmN0aW9uKGUpe2IuaW5mbyhcImVycm9yIGdldHRpbmcgdGhlIHZlcnNpb24gZm9yIFwiLHQsXCIgd2l0aCBlcnJvcjogXCIsZSl9KX0pfX0se2tleTpcImRlbGV0ZVwiLHZhbHVlOmZ1bmN0aW9uKHQsZSxuKXtuPW58fHQ7dmFyIHI9dGhpcy5fZ2V0VGFibGUobiksbz10aGlzLl9nZXRQcmltYXJ5S2V5KHIpLGk9ZTtyZXR1cm4gZXx8KGk9dCksdGhpcy5kYltyXS53aGVyZShvKS5lcXVhbHMoaSkuZGVsZXRlKCl9fV0pLHR9KCk7ZS5kZWZhdWx0PW0sdC5leHBvcnRzPWUuZGVmYXVsdH0sZnVuY3Rpb24odCxlLG4pe3QuZXhwb3J0cz17ZGVmYXVsdDpuKDE1NiksX19lc01vZHVsZTohMH19LGZ1bmN0aW9uKHQsZSxuKXtuKDE1NyksdC5leHBvcnRzPW4oMCkuT2JqZWN0LnZhbHVlc30sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oNiksbz1uKDE1OCkoITEpO3Ioci5TLFwiT2JqZWN0XCIse3ZhbHVlczpmdW5jdGlvbih0KXtyZXR1cm4gbyh0KX19KX0sZnVuY3Rpb24odCxlLG4pe3ZhciByPW4oMjApLG89bigxMiksaT1uKDI5KS5mO3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSl7Zm9yKHZhciBuLHU9byhlKSxmPXIodSksYz1mLmxlbmd0aCxhPTAscz1bXTtjPmE7KWkuY2FsbCh1LG49ZlthKytdKSYmcy5wdXNoKHQ/W24sdVtuXV06dVtuXSk7cmV0dXJuIHN9fX1dKX0pOyIsInZhciBuZXh0VGljayA9IHJlcXVpcmUoJ3Byb2Nlc3MvYnJvd3Nlci5qcycpLm5leHRUaWNrO1xudmFyIGFwcGx5ID0gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5O1xudmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xudmFyIGltbWVkaWF0ZUlkcyA9IHt9O1xudmFyIG5leHRJbW1lZGlhdGVJZCA9IDA7XG5cbi8vIERPTSBBUElzLCBmb3IgY29tcGxldGVuZXNzXG5cbmV4cG9ydHMuc2V0VGltZW91dCA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFRpbWVvdXQoYXBwbHkuY2FsbChzZXRUaW1lb3V0LCB3aW5kb3csIGFyZ3VtZW50cyksIGNsZWFyVGltZW91dCk7XG59O1xuZXhwb3J0cy5zZXRJbnRlcnZhbCA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFRpbWVvdXQoYXBwbHkuY2FsbChzZXRJbnRlcnZhbCwgd2luZG93LCBhcmd1bWVudHMpLCBjbGVhckludGVydmFsKTtcbn07XG5leHBvcnRzLmNsZWFyVGltZW91dCA9XG5leHBvcnRzLmNsZWFySW50ZXJ2YWwgPSBmdW5jdGlvbih0aW1lb3V0KSB7IHRpbWVvdXQuY2xvc2UoKTsgfTtcblxuZnVuY3Rpb24gVGltZW91dChpZCwgY2xlYXJGbikge1xuICB0aGlzLl9pZCA9IGlkO1xuICB0aGlzLl9jbGVhckZuID0gY2xlYXJGbjtcbn1cblRpbWVvdXQucHJvdG90eXBlLnVucmVmID0gVGltZW91dC5wcm90b3R5cGUucmVmID0gZnVuY3Rpb24oKSB7fTtcblRpbWVvdXQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuX2NsZWFyRm4uY2FsbCh3aW5kb3csIHRoaXMuX2lkKTtcbn07XG5cbi8vIERvZXMgbm90IHN0YXJ0IHRoZSB0aW1lLCBqdXN0IHNldHMgdXAgdGhlIG1lbWJlcnMgbmVlZGVkLlxuZXhwb3J0cy5lbnJvbGwgPSBmdW5jdGlvbihpdGVtLCBtc2Vjcykge1xuICBjbGVhclRpbWVvdXQoaXRlbS5faWRsZVRpbWVvdXRJZCk7XG4gIGl0ZW0uX2lkbGVUaW1lb3V0ID0gbXNlY3M7XG59O1xuXG5leHBvcnRzLnVuZW5yb2xsID0gZnVuY3Rpb24oaXRlbSkge1xuICBjbGVhclRpbWVvdXQoaXRlbS5faWRsZVRpbWVvdXRJZCk7XG4gIGl0ZW0uX2lkbGVUaW1lb3V0ID0gLTE7XG59O1xuXG5leHBvcnRzLl91bnJlZkFjdGl2ZSA9IGV4cG9ydHMuYWN0aXZlID0gZnVuY3Rpb24oaXRlbSkge1xuICBjbGVhclRpbWVvdXQoaXRlbS5faWRsZVRpbWVvdXRJZCk7XG5cbiAgdmFyIG1zZWNzID0gaXRlbS5faWRsZVRpbWVvdXQ7XG4gIGlmIChtc2VjcyA+PSAwKSB7XG4gICAgaXRlbS5faWRsZVRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gb25UaW1lb3V0KCkge1xuICAgICAgaWYgKGl0ZW0uX29uVGltZW91dClcbiAgICAgICAgaXRlbS5fb25UaW1lb3V0KCk7XG4gICAgfSwgbXNlY3MpO1xuICB9XG59O1xuXG4vLyBUaGF0J3Mgbm90IGhvdyBub2RlLmpzIGltcGxlbWVudHMgaXQgYnV0IHRoZSBleHBvc2VkIGFwaSBpcyB0aGUgc2FtZS5cbmV4cG9ydHMuc2V0SW1tZWRpYXRlID0gdHlwZW9mIHNldEltbWVkaWF0ZSA9PT0gXCJmdW5jdGlvblwiID8gc2V0SW1tZWRpYXRlIDogZnVuY3Rpb24oZm4pIHtcbiAgdmFyIGlkID0gbmV4dEltbWVkaWF0ZUlkKys7XG4gIHZhciBhcmdzID0gYXJndW1lbnRzLmxlbmd0aCA8IDIgPyBmYWxzZSA6IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcblxuICBpbW1lZGlhdGVJZHNbaWRdID0gdHJ1ZTtcblxuICBuZXh0VGljayhmdW5jdGlvbiBvbk5leHRUaWNrKCkge1xuICAgIGlmIChpbW1lZGlhdGVJZHNbaWRdKSB7XG4gICAgICAvLyBmbi5jYWxsKCkgaXMgZmFzdGVyIHNvIHdlIG9wdGltaXplIGZvciB0aGUgY29tbW9uIHVzZS1jYXNlXG4gICAgICAvLyBAc2VlIGh0dHA6Ly9qc3BlcmYuY29tL2NhbGwtYXBwbHktc2VndVxuICAgICAgaWYgKGFyZ3MpIHtcbiAgICAgICAgZm4uYXBwbHkobnVsbCwgYXJncyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmbi5jYWxsKG51bGwpO1xuICAgICAgfVxuICAgICAgLy8gUHJldmVudCBpZHMgZnJvbSBsZWFraW5nXG4gICAgICBleHBvcnRzLmNsZWFySW1tZWRpYXRlKGlkKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBpZDtcbn07XG5cbmV4cG9ydHMuY2xlYXJJbW1lZGlhdGUgPSB0eXBlb2YgY2xlYXJJbW1lZGlhdGUgPT09IFwiZnVuY3Rpb25cIiA/IGNsZWFySW1tZWRpYXRlIDogZnVuY3Rpb24oaWQpIHtcbiAgZGVsZXRlIGltbWVkaWF0ZUlkc1tpZF07XG59OyIsIi8qIVxuICogVVJJLmpzIC0gTXV0YXRpbmcgVVJMc1xuICogSVB2NiBTdXBwb3J0XG4gKlxuICogVmVyc2lvbjogMS4xOS4xXG4gKlxuICogQXV0aG9yOiBSb2RuZXkgUmVobVxuICogV2ViOiBodHRwOi8vbWVkaWFsaXplLmdpdGh1Yi5pby9VUkkuanMvXG4gKlxuICogTGljZW5zZWQgdW5kZXJcbiAqICAgTUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZVxuICpcbiAqL1xuXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICAvLyBodHRwczovL2dpdGh1Yi5jb20vdW1kanMvdW1kL2Jsb2IvbWFzdGVyL3JldHVybkV4cG9ydHMuanNcbiAgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgLy8gTm9kZVxuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cbiAgICBkZWZpbmUoZmFjdG9yeSk7XG4gIH0gZWxzZSB7XG4gICAgLy8gQnJvd3NlciBnbG9iYWxzIChyb290IGlzIHdpbmRvdylcbiAgICByb290LklQdjYgPSBmYWN0b3J5KHJvb3QpO1xuICB9XG59KHRoaXMsIGZ1bmN0aW9uIChyb290KSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKlxuICB2YXIgX2luID0gXCJmZTgwOjAwMDA6MDAwMDowMDAwOjAyMDQ6NjFmZjpmZTlkOmYxNTZcIjtcbiAgdmFyIF9vdXQgPSBJUHY2LmJlc3QoX2luKTtcbiAgdmFyIF9leHBlY3RlZCA9IFwiZmU4MDo6MjA0OjYxZmY6ZmU5ZDpmMTU2XCI7XG5cbiAgY29uc29sZS5sb2coX2luLCBfb3V0LCBfZXhwZWN0ZWQsIF9vdXQgPT09IF9leHBlY3RlZCk7XG4gICovXG5cbiAgLy8gc2F2ZSBjdXJyZW50IElQdjYgdmFyaWFibGUsIGlmIGFueVxuICB2YXIgX0lQdjYgPSByb290ICYmIHJvb3QuSVB2NjtcblxuICBmdW5jdGlvbiBiZXN0UHJlc2VudGF0aW9uKGFkZHJlc3MpIHtcbiAgICAvLyBiYXNlZCBvbjpcbiAgICAvLyBKYXZhc2NyaXB0IHRvIHRlc3QgYW4gSVB2NiBhZGRyZXNzIGZvciBwcm9wZXIgZm9ybWF0LCBhbmQgdG9cbiAgICAvLyBwcmVzZW50IHRoZSBcImJlc3QgdGV4dCByZXByZXNlbnRhdGlvblwiIGFjY29yZGluZyB0byBJRVRGIERyYWZ0IFJGQyBhdFxuICAgIC8vIGh0dHA6Ly90b29scy5pZXRmLm9yZy9odG1sL2RyYWZ0LWlldGYtNm1hbi10ZXh0LWFkZHItcmVwcmVzZW50YXRpb24tMDRcbiAgICAvLyA4IEZlYiAyMDEwIFJpY2ggQnJvd24sIERhcnR3YXJlLCBMTENcbiAgICAvLyBQbGVhc2UgZmVlbCBmcmVlIHRvIHVzZSB0aGlzIGNvZGUgYXMgbG9uZyBhcyB5b3UgcHJvdmlkZSBhIGxpbmsgdG9cbiAgICAvLyBodHRwOi8vd3d3LmludGVybWFwcGVyLmNvbVxuICAgIC8vIGh0dHA6Ly9pbnRlcm1hcHBlci5jb20vc3VwcG9ydC90b29scy9JUFY2LVZhbGlkYXRvci5hc3B4XG4gICAgLy8gaHR0cDovL2Rvd25sb2FkLmRhcnR3YXJlLmNvbS90aGlyZHBhcnR5L2lwdjZ2YWxpZGF0b3IuanNcblxuICAgIHZhciBfYWRkcmVzcyA9IGFkZHJlc3MudG9Mb3dlckNhc2UoKTtcbiAgICB2YXIgc2VnbWVudHMgPSBfYWRkcmVzcy5zcGxpdCgnOicpO1xuICAgIHZhciBsZW5ndGggPSBzZWdtZW50cy5sZW5ndGg7XG4gICAgdmFyIHRvdGFsID0gODtcblxuICAgIC8vIHRyaW0gY29sb25zICg6OiBvciA6OmE6Yjpj4oCmIG9yIOKApmE6YjpjOjopXG4gICAgaWYgKHNlZ21lbnRzWzBdID09PSAnJyAmJiBzZWdtZW50c1sxXSA9PT0gJycgJiYgc2VnbWVudHNbMl0gPT09ICcnKSB7XG4gICAgICAvLyBtdXN0IGhhdmUgYmVlbiA6OlxuICAgICAgLy8gcmVtb3ZlIGZpcnN0IHR3byBpdGVtc1xuICAgICAgc2VnbWVudHMuc2hpZnQoKTtcbiAgICAgIHNlZ21lbnRzLnNoaWZ0KCk7XG4gICAgfSBlbHNlIGlmIChzZWdtZW50c1swXSA9PT0gJycgJiYgc2VnbWVudHNbMV0gPT09ICcnKSB7XG4gICAgICAvLyBtdXN0IGhhdmUgYmVlbiA6Onh4eHhcbiAgICAgIC8vIHJlbW92ZSB0aGUgZmlyc3QgaXRlbVxuICAgICAgc2VnbWVudHMuc2hpZnQoKTtcbiAgICB9IGVsc2UgaWYgKHNlZ21lbnRzW2xlbmd0aCAtIDFdID09PSAnJyAmJiBzZWdtZW50c1tsZW5ndGggLSAyXSA9PT0gJycpIHtcbiAgICAgIC8vIG11c3QgaGF2ZSBiZWVuIHh4eHg6OlxuICAgICAgc2VnbWVudHMucG9wKCk7XG4gICAgfVxuXG4gICAgbGVuZ3RoID0gc2VnbWVudHMubGVuZ3RoO1xuXG4gICAgLy8gYWRqdXN0IHRvdGFsIHNlZ21lbnRzIGZvciBJUHY0IHRyYWlsZXJcbiAgICBpZiAoc2VnbWVudHNbbGVuZ3RoIC0gMV0uaW5kZXhPZignLicpICE9PSAtMSkge1xuICAgICAgLy8gZm91bmQgYSBcIi5cIiB3aGljaCBtZWFucyBJUHY0XG4gICAgICB0b3RhbCA9IDc7XG4gICAgfVxuXG4gICAgLy8gZmlsbCBlbXB0eSBzZWdtZW50cyB0aGVtIHdpdGggXCIwMDAwXCJcbiAgICB2YXIgcG9zO1xuICAgIGZvciAocG9zID0gMDsgcG9zIDwgbGVuZ3RoOyBwb3MrKykge1xuICAgICAgaWYgKHNlZ21lbnRzW3Bvc10gPT09ICcnKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwb3MgPCB0b3RhbCkge1xuICAgICAgc2VnbWVudHMuc3BsaWNlKHBvcywgMSwgJzAwMDAnKTtcbiAgICAgIHdoaWxlIChzZWdtZW50cy5sZW5ndGggPCB0b3RhbCkge1xuICAgICAgICBzZWdtZW50cy5zcGxpY2UocG9zLCAwLCAnMDAwMCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIHN0cmlwIGxlYWRpbmcgemVyb3NcbiAgICB2YXIgX3NlZ21lbnRzO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG90YWw7IGkrKykge1xuICAgICAgX3NlZ21lbnRzID0gc2VnbWVudHNbaV0uc3BsaXQoJycpO1xuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAzIDsgaisrKSB7XG4gICAgICAgIGlmIChfc2VnbWVudHNbMF0gPT09ICcwJyAmJiBfc2VnbWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgIF9zZWdtZW50cy5zcGxpY2UoMCwxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBzZWdtZW50c1tpXSA9IF9zZWdtZW50cy5qb2luKCcnKTtcbiAgICB9XG5cbiAgICAvLyBmaW5kIGxvbmdlc3Qgc2VxdWVuY2Ugb2YgemVyb2VzIGFuZCBjb2FsZXNjZSB0aGVtIGludG8gb25lIHNlZ21lbnRcbiAgICB2YXIgYmVzdCA9IC0xO1xuICAgIHZhciBfYmVzdCA9IDA7XG4gICAgdmFyIF9jdXJyZW50ID0gMDtcbiAgICB2YXIgY3VycmVudCA9IC0xO1xuICAgIHZhciBpbnplcm9lcyA9IGZhbHNlO1xuICAgIC8vIGk7IGFscmVhZHkgZGVjbGFyZWRcblxuICAgIGZvciAoaSA9IDA7IGkgPCB0b3RhbDsgaSsrKSB7XG4gICAgICBpZiAoaW56ZXJvZXMpIHtcbiAgICAgICAgaWYgKHNlZ21lbnRzW2ldID09PSAnMCcpIHtcbiAgICAgICAgICBfY3VycmVudCArPSAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGluemVyb2VzID0gZmFsc2U7XG4gICAgICAgICAgaWYgKF9jdXJyZW50ID4gX2Jlc3QpIHtcbiAgICAgICAgICAgIGJlc3QgPSBjdXJyZW50O1xuICAgICAgICAgICAgX2Jlc3QgPSBfY3VycmVudDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChzZWdtZW50c1tpXSA9PT0gJzAnKSB7XG4gICAgICAgICAgaW56ZXJvZXMgPSB0cnVlO1xuICAgICAgICAgIGN1cnJlbnQgPSBpO1xuICAgICAgICAgIF9jdXJyZW50ID0gMTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChfY3VycmVudCA+IF9iZXN0KSB7XG4gICAgICBiZXN0ID0gY3VycmVudDtcbiAgICAgIF9iZXN0ID0gX2N1cnJlbnQ7XG4gICAgfVxuXG4gICAgaWYgKF9iZXN0ID4gMSkge1xuICAgICAgc2VnbWVudHMuc3BsaWNlKGJlc3QsIF9iZXN0LCAnJyk7XG4gICAgfVxuXG4gICAgbGVuZ3RoID0gc2VnbWVudHMubGVuZ3RoO1xuXG4gICAgLy8gYXNzZW1ibGUgcmVtYWluaW5nIHNlZ21lbnRzXG4gICAgdmFyIHJlc3VsdCA9ICcnO1xuICAgIGlmIChzZWdtZW50c1swXSA9PT0gJycpICB7XG4gICAgICByZXN1bHQgPSAnOic7XG4gICAgfVxuXG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHQgKz0gc2VnbWVudHNbaV07XG4gICAgICBpZiAoaSA9PT0gbGVuZ3RoIC0gMSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgcmVzdWx0ICs9ICc6JztcbiAgICB9XG5cbiAgICBpZiAoc2VnbWVudHNbbGVuZ3RoIC0gMV0gPT09ICcnKSB7XG4gICAgICByZXN1bHQgKz0gJzonO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBmdW5jdGlvbiBub0NvbmZsaWN0KCkge1xuICAgIC8qanNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgIGlmIChyb290LklQdjYgPT09IHRoaXMpIHtcbiAgICAgIHJvb3QuSVB2NiA9IF9JUHY2O1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBiZXN0OiBiZXN0UHJlc2VudGF0aW9uLFxuICAgIG5vQ29uZmxpY3Q6IG5vQ29uZmxpY3RcbiAgfTtcbn0pKTtcbiIsIi8qIVxuICogVVJJLmpzIC0gTXV0YXRpbmcgVVJMc1xuICogU2Vjb25kIExldmVsIERvbWFpbiAoU0xEKSBTdXBwb3J0XG4gKlxuICogVmVyc2lvbjogMS4xOS4xXG4gKlxuICogQXV0aG9yOiBSb2RuZXkgUmVobVxuICogV2ViOiBodHRwOi8vbWVkaWFsaXplLmdpdGh1Yi5pby9VUkkuanMvXG4gKlxuICogTGljZW5zZWQgdW5kZXJcbiAqICAgTUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZVxuICpcbiAqL1xuXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICAvLyBodHRwczovL2dpdGh1Yi5jb20vdW1kanMvdW1kL2Jsb2IvbWFzdGVyL3JldHVybkV4cG9ydHMuanNcbiAgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgLy8gTm9kZVxuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cbiAgICBkZWZpbmUoZmFjdG9yeSk7XG4gIH0gZWxzZSB7XG4gICAgLy8gQnJvd3NlciBnbG9iYWxzIChyb290IGlzIHdpbmRvdylcbiAgICByb290LlNlY29uZExldmVsRG9tYWlucyA9IGZhY3Rvcnkocm9vdCk7XG4gIH1cbn0odGhpcywgZnVuY3Rpb24gKHJvb3QpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vIHNhdmUgY3VycmVudCBTZWNvbmRMZXZlbERvbWFpbnMgdmFyaWFibGUsIGlmIGFueVxuICB2YXIgX1NlY29uZExldmVsRG9tYWlucyA9IHJvb3QgJiYgcm9vdC5TZWNvbmRMZXZlbERvbWFpbnM7XG5cbiAgdmFyIFNMRCA9IHtcbiAgICAvLyBsaXN0IG9mIGtub3duIFNlY29uZCBMZXZlbCBEb21haW5zXG4gICAgLy8gY29udmVydGVkIGxpc3Qgb2YgU0xEcyBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9nYXZpbmdtaWxsZXIvc2Vjb25kLWxldmVsLWRvbWFpbnNcbiAgICAvLyAtLS0tXG4gICAgLy8gcHVibGljc3VmZml4Lm9yZyBpcyBtb3JlIGN1cnJlbnQgYW5kIGFjdHVhbGx5IHVzZWQgYnkgYSBjb3VwbGUgb2YgYnJvd3NlcnMgaW50ZXJuYWxseS5cbiAgICAvLyBkb3duc2lkZSBpcyBpdCBhbHNvIGNvbnRhaW5zIGRvbWFpbnMgbGlrZSBcImR5bmRucy5vcmdcIiAtIHdoaWNoIGlzIGZpbmUgZm9yIHRoZSBzZWN1cml0eVxuICAgIC8vIGlzc3VlcyBicm93c2VyIGhhdmUgdG8gZGVhbCB3aXRoIChTT1AgZm9yIGNvb2tpZXMsIGV0YykgLSBidXQgaXMgd2F5IG92ZXJib2FyZCBmb3IgVVJJLmpzXG4gICAgLy8gLS0tLVxuICAgIGxpc3Q6IHtcbiAgICAgICdhYyc6JyBjb20gZ292IG1pbCBuZXQgb3JnICcsXG4gICAgICAnYWUnOicgYWMgY28gZ292IG1pbCBuYW1lIG5ldCBvcmcgcHJvIHNjaCAnLFxuICAgICAgJ2FmJzonIGNvbSBlZHUgZ292IG5ldCBvcmcgJyxcbiAgICAgICdhbCc6JyBjb20gZWR1IGdvdiBtaWwgbmV0IG9yZyAnLFxuICAgICAgJ2FvJzonIGNvIGVkIGd2IGl0IG9nIHBiICcsXG4gICAgICAnYXInOicgY29tIGVkdSBnb2IgZ292IGludCBtaWwgbmV0IG9yZyB0dXIgJyxcbiAgICAgICdhdCc6JyBhYyBjbyBndiBvciAnLFxuICAgICAgJ2F1JzonIGFzbiBjb20gY3Npcm8gZWR1IGdvdiBpZCBuZXQgb3JnICcsXG4gICAgICAnYmEnOicgY28gY29tIGVkdSBnb3YgbWlsIG5ldCBvcmcgcnMgdW5iaSB1bm1vIHVuc2EgdW50eiB1bnplICcsXG4gICAgICAnYmInOicgYml6IGNvIGNvbSBlZHUgZ292IGluZm8gbmV0IG9yZyBzdG9yZSB0diAnLFxuICAgICAgJ2JoJzonIGJpeiBjYyBjb20gZWR1IGdvdiBpbmZvIG5ldCBvcmcgJyxcbiAgICAgICdibic6JyBjb20gZWR1IGdvdiBuZXQgb3JnICcsXG4gICAgICAnYm8nOicgY29tIGVkdSBnb2IgZ292IGludCBtaWwgbmV0IG9yZyB0diAnLFxuICAgICAgJ2JyJzonIGFkbSBhZHYgYWdyIGFtIGFycSBhcnQgYXRvIGIgYmlvIGJsb2cgYm1kIGNpbSBjbmcgY250IGNvbSBjb29wIGVjbiBlZHUgZW5nIGVzcCBldGMgZXRpIGZhciBmbG9nIGZtIGZuZCBmb3QgZnN0IGcxMiBnZ2YgZ292IGltYiBpbmQgaW5mIGpvciBqdXMgbGVsIG1hdCBtZWQgbWlsIG11cyBuZXQgbm9tIG5vdCBudHIgb2RvIG9yZyBwcGcgcHJvIHBzYyBwc2kgcXNsIHJlYyBzbGcgc3J2IHRtcCB0cmQgdHVyIHR2IHZldCB2bG9nIHdpa2kgemxnICcsXG4gICAgICAnYnMnOicgY29tIGVkdSBnb3YgbmV0IG9yZyAnLFxuICAgICAgJ2J6JzonIGR1IGV0IG9tIG92IHJnICcsXG4gICAgICAnY2EnOicgYWIgYmMgbWIgbmIgbmYgbmwgbnMgbnQgbnUgb24gcGUgcWMgc2sgeWsgJyxcbiAgICAgICdjayc6JyBiaXogY28gZWR1IGdlbiBnb3YgaW5mbyBuZXQgb3JnICcsXG4gICAgICAnY24nOicgYWMgYWggYmogY29tIGNxIGVkdSBmaiBnZCBnb3YgZ3MgZ3ggZ3ogaGEgaGIgaGUgaGkgaGwgaG4gamwganMganggbG4gbWlsIG5ldCBubSBueCBvcmcgcWggc2Mgc2Qgc2ggc24gc3ggdGogdHcgeGogeHogeW4gemogJyxcbiAgICAgICdjbyc6JyBjb20gZWR1IGdvdiBtaWwgbmV0IG5vbSBvcmcgJyxcbiAgICAgICdjcic6JyBhYyBjIGNvIGVkIGZpIGdvIG9yIHNhICcsXG4gICAgICAnY3knOicgYWMgYml6IGNvbSBla2xvZ2VzIGdvdiBsdGQgbmFtZSBuZXQgb3JnIHBhcmxpYW1lbnQgcHJlc3MgcHJvIHRtICcsXG4gICAgICAnZG8nOicgYXJ0IGNvbSBlZHUgZ29iIGdvdiBtaWwgbmV0IG9yZyBzbGQgd2ViICcsXG4gICAgICAnZHonOicgYXJ0IGFzc28gY29tIGVkdSBnb3YgbmV0IG9yZyBwb2wgJyxcbiAgICAgICdlYyc6JyBjb20gZWR1IGZpbiBnb3YgaW5mbyBtZWQgbWlsIG5ldCBvcmcgcHJvICcsXG4gICAgICAnZWcnOicgY29tIGVkdSBldW4gZ292IG1pbCBuYW1lIG5ldCBvcmcgc2NpICcsXG4gICAgICAnZXInOicgY29tIGVkdSBnb3YgaW5kIG1pbCBuZXQgb3JnIHJvY2hlc3QgdyAnLFxuICAgICAgJ2VzJzonIGNvbSBlZHUgZ29iIG5vbSBvcmcgJyxcbiAgICAgICdldCc6JyBiaXogY29tIGVkdSBnb3YgaW5mbyBuYW1lIG5ldCBvcmcgJyxcbiAgICAgICdmaic6JyBhYyBiaXogY29tIGluZm8gbWlsIG5hbWUgbmV0IG9yZyBwcm8gJyxcbiAgICAgICdmayc6JyBhYyBjbyBnb3YgbmV0IG5vbSBvcmcgJyxcbiAgICAgICdmcic6JyBhc3NvIGNvbSBmIGdvdXYgbm9tIHByZCBwcmVzc2UgdG0gJyxcbiAgICAgICdnZyc6JyBjbyBuZXQgb3JnICcsXG4gICAgICAnZ2gnOicgY29tIGVkdSBnb3YgbWlsIG9yZyAnLFxuICAgICAgJ2duJzonIGFjIGNvbSBnb3YgbmV0IG9yZyAnLFxuICAgICAgJ2dyJzonIGNvbSBlZHUgZ292IG1pbCBuZXQgb3JnICcsXG4gICAgICAnZ3QnOicgY29tIGVkdSBnb2IgaW5kIG1pbCBuZXQgb3JnICcsXG4gICAgICAnZ3UnOicgY29tIGVkdSBnb3YgbmV0IG9yZyAnLFxuICAgICAgJ2hrJzonIGNvbSBlZHUgZ292IGlkdiBuZXQgb3JnICcsXG4gICAgICAnaHUnOicgMjAwMCBhZ3JhciBib2x0IGNhc2lubyBjaXR5IGNvIGVyb3RpY2EgZXJvdGlrYSBmaWxtIGZvcnVtIGdhbWVzIGhvdGVsIGluZm8gaW5nYXRsYW4gam9nYXN6IGtvbnl2ZWxvIGxha2FzIG1lZGlhIG5ld3Mgb3JnIHByaXYgcmVrbGFtIHNleCBzaG9wIHNwb3J0IHN1bGkgc3pleCB0bSB0b3pzZGUgdXRhemFzIHZpZGVvICcsXG4gICAgICAnaWQnOicgYWMgY28gZ28gbWlsIG5ldCBvciBzY2ggd2ViICcsXG4gICAgICAnaWwnOicgYWMgY28gZ292IGlkZiBrMTIgbXVuaSBuZXQgb3JnICcsXG4gICAgICAnaW4nOicgYWMgY28gZWR1IGVybmV0IGZpcm0gZ2VuIGdvdiBpIGluZCBtaWwgbmV0IG5pYyBvcmcgcmVzICcsXG4gICAgICAnaXEnOicgY29tIGVkdSBnb3YgaSBtaWwgbmV0IG9yZyAnLFxuICAgICAgJ2lyJzonIGFjIGNvIGRuc3NlYyBnb3YgaSBpZCBuZXQgb3JnIHNjaCAnLFxuICAgICAgJ2l0JzonIGVkdSBnb3YgJyxcbiAgICAgICdqZSc6JyBjbyBuZXQgb3JnICcsXG4gICAgICAnam8nOicgY29tIGVkdSBnb3YgbWlsIG5hbWUgbmV0IG9yZyBzY2ggJyxcbiAgICAgICdqcCc6JyBhYyBhZCBjbyBlZCBnbyBnciBsZyBuZSBvciAnLFxuICAgICAgJ2tlJzonIGFjIGNvIGdvIGluZm8gbWUgbW9iaSBuZSBvciBzYyAnLFxuICAgICAgJ2toJzonIGNvbSBlZHUgZ292IG1pbCBuZXQgb3JnIHBlciAnLFxuICAgICAgJ2tpJzonIGJpeiBjb20gZGUgZWR1IGdvdiBpbmZvIG1vYiBuZXQgb3JnIHRlbCAnLFxuICAgICAgJ2ttJzonIGFzc28gY29tIGNvb3AgZWR1IGdvdXYgayBtZWRlY2luIG1pbCBub20gbm90YWlyZXMgcGhhcm1hY2llbnMgcHJlc3NlIHRtIHZldGVyaW5haXJlICcsXG4gICAgICAna24nOicgZWR1IGdvdiBuZXQgb3JnICcsXG4gICAgICAna3InOicgYWMgYnVzYW4gY2h1bmdidWsgY2h1bmduYW0gY28gZGFlZ3UgZGFlamVvbiBlcyBnYW5nd29uIGdvIGd3YW5nanUgZ3llb25nYnVrIGd5ZW9uZ2dpIGd5ZW9uZ25hbSBocyBpbmNoZW9uIGplanUgamVvbmJ1ayBqZW9ubmFtIGsga2cgbWlsIG1zIG5lIG9yIHBlIHJlIHNjIHNlb3VsIHVsc2FuICcsXG4gICAgICAna3cnOicgY29tIGVkdSBnb3YgbmV0IG9yZyAnLFxuICAgICAgJ2t5JzonIGNvbSBlZHUgZ292IG5ldCBvcmcgJyxcbiAgICAgICdreic6JyBjb20gZWR1IGdvdiBtaWwgbmV0IG9yZyAnLFxuICAgICAgJ2xiJzonIGNvbSBlZHUgZ292IG5ldCBvcmcgJyxcbiAgICAgICdsayc6JyBhc3NuIGNvbSBlZHUgZ292IGdycCBob3RlbCBpbnQgbHRkIG5ldCBuZ28gb3JnIHNjaCBzb2Mgd2ViICcsXG4gICAgICAnbHInOicgY29tIGVkdSBnb3YgbmV0IG9yZyAnLFxuICAgICAgJ2x2JzonIGFzbiBjb20gY29uZiBlZHUgZ292IGlkIG1pbCBuZXQgb3JnICcsXG4gICAgICAnbHknOicgY29tIGVkdSBnb3YgaWQgbWVkIG5ldCBvcmcgcGxjIHNjaCAnLFxuICAgICAgJ21hJzonIGFjIGNvIGdvdiBtIG5ldCBvcmcgcHJlc3MgJyxcbiAgICAgICdtYyc6JyBhc3NvIHRtICcsXG4gICAgICAnbWUnOicgYWMgY28gZWR1IGdvdiBpdHMgbmV0IG9yZyBwcml2ICcsXG4gICAgICAnbWcnOicgY29tIGVkdSBnb3YgbWlsIG5vbSBvcmcgcHJkIHRtICcsXG4gICAgICAnbWsnOicgY29tIGVkdSBnb3YgaW5mIG5hbWUgbmV0IG9yZyBwcm8gJyxcbiAgICAgICdtbCc6JyBjb20gZWR1IGdvdiBuZXQgb3JnIHByZXNzZSAnLFxuICAgICAgJ21uJzonIGVkdSBnb3Ygb3JnICcsXG4gICAgICAnbW8nOicgY29tIGVkdSBnb3YgbmV0IG9yZyAnLFxuICAgICAgJ210JzonIGNvbSBlZHUgZ292IG5ldCBvcmcgJyxcbiAgICAgICdtdic6JyBhZXJvIGJpeiBjb20gY29vcCBlZHUgZ292IGluZm8gaW50IG1pbCBtdXNldW0gbmFtZSBuZXQgb3JnIHBybyAnLFxuICAgICAgJ213JzonIGFjIGNvIGNvbSBjb29wIGVkdSBnb3YgaW50IG11c2V1bSBuZXQgb3JnICcsXG4gICAgICAnbXgnOicgY29tIGVkdSBnb2IgbmV0IG9yZyAnLFxuICAgICAgJ215JzonIGNvbSBlZHUgZ292IG1pbCBuYW1lIG5ldCBvcmcgc2NoICcsXG4gICAgICAnbmYnOicgYXJ0cyBjb20gZmlybSBpbmZvIG5ldCBvdGhlciBwZXIgcmVjIHN0b3JlIHdlYiAnLFxuICAgICAgJ25nJzonIGJpeiBjb20gZWR1IGdvdiBtaWwgbW9iaSBuYW1lIG5ldCBvcmcgc2NoICcsXG4gICAgICAnbmknOicgYWMgY28gY29tIGVkdSBnb2IgbWlsIG5ldCBub20gb3JnICcsXG4gICAgICAnbnAnOicgY29tIGVkdSBnb3YgbWlsIG5ldCBvcmcgJyxcbiAgICAgICducic6JyBiaXogY29tIGVkdSBnb3YgaW5mbyBuZXQgb3JnICcsXG4gICAgICAnb20nOicgYWMgYml6IGNvIGNvbSBlZHUgZ292IG1lZCBtaWwgbXVzZXVtIG5ldCBvcmcgcHJvIHNjaCAnLFxuICAgICAgJ3BlJzonIGNvbSBlZHUgZ29iIG1pbCBuZXQgbm9tIG9yZyBzbGQgJyxcbiAgICAgICdwaCc6JyBjb20gZWR1IGdvdiBpIG1pbCBuZXQgbmdvIG9yZyAnLFxuICAgICAgJ3BrJzonIGJpeiBjb20gZWR1IGZhbSBnb2IgZ29rIGdvbiBnb3AgZ29zIGdvdiBuZXQgb3JnIHdlYiAnLFxuICAgICAgJ3BsJzonIGFydCBiaWFseXN0b2sgYml6IGNvbSBlZHUgZ2RhIGdkYW5zayBnb3J6b3cgZ292IGluZm8ga2F0b3dpY2Uga3Jha293IGxvZHogbHVibGluIG1pbCBuZXQgbmdvIG9sc3p0eW4gb3JnIHBvem5hbiBwd3IgcmFkb20gc2x1cHNrIHN6Y3plY2luIHRvcnVuIHdhcnN6YXdhIHdhdyB3cm9jIHdyb2NsYXcgemdvcmEgJyxcbiAgICAgICdwcic6JyBhYyBiaXogY29tIGVkdSBlc3QgZ292IGluZm8gaXNsYSBuYW1lIG5ldCBvcmcgcHJvIHByb2YgJyxcbiAgICAgICdwcyc6JyBjb20gZWR1IGdvdiBuZXQgb3JnIHBsbyBzZWMgJyxcbiAgICAgICdwdyc6JyBiZWxhdSBjbyBlZCBnbyBuZSBvciAnLFxuICAgICAgJ3JvJzonIGFydHMgY29tIGZpcm0gaW5mbyBub20gbnQgb3JnIHJlYyBzdG9yZSB0bSB3d3cgJyxcbiAgICAgICdycyc6JyBhYyBjbyBlZHUgZ292IGluIG9yZyAnLFxuICAgICAgJ3NiJzonIGNvbSBlZHUgZ292IG5ldCBvcmcgJyxcbiAgICAgICdzYyc6JyBjb20gZWR1IGdvdiBuZXQgb3JnICcsXG4gICAgICAnc2gnOicgY28gY29tIGVkdSBnb3YgbmV0IG5vbSBvcmcgJyxcbiAgICAgICdzbCc6JyBjb20gZWR1IGdvdiBuZXQgb3JnICcsXG4gICAgICAnc3QnOicgY28gY29tIGNvbnN1bGFkbyBlZHUgZW1iYWl4YWRhIGdvdiBtaWwgbmV0IG9yZyBwcmluY2lwZSBzYW90b21lIHN0b3JlICcsXG4gICAgICAnc3YnOicgY29tIGVkdSBnb2Igb3JnIHJlZCAnLFxuICAgICAgJ3N6JzonIGFjIGNvIG9yZyAnLFxuICAgICAgJ3RyJzonIGF2IGJicyBiZWwgYml6IGNvbSBkciBlZHUgZ2VuIGdvdiBpbmZvIGsxMiBuYW1lIG5ldCBvcmcgcG9sIHRlbCB0c2sgdHYgd2ViICcsXG4gICAgICAndHQnOicgYWVybyBiaXogY2F0IGNvIGNvbSBjb29wIGVkdSBnb3YgaW5mbyBpbnQgam9icyBtaWwgbW9iaSBtdXNldW0gbmFtZSBuZXQgb3JnIHBybyB0ZWwgdHJhdmVsICcsXG4gICAgICAndHcnOicgY2x1YiBjb20gZWJpeiBlZHUgZ2FtZSBnb3YgaWR2IG1pbCBuZXQgb3JnICcsXG4gICAgICAnbXUnOicgYWMgY28gY29tIGdvdiBuZXQgb3Igb3JnICcsXG4gICAgICAnbXonOicgYWMgY28gZWR1IGdvdiBvcmcgJyxcbiAgICAgICduYSc6JyBjbyBjb20gJyxcbiAgICAgICdueic6JyBhYyBjbyBjcmkgZ2VlayBnZW4gZ292dCBoZWFsdGggaXdpIG1hb3JpIG1pbCBuZXQgb3JnIHBhcmxpYW1lbnQgc2Nob29sICcsXG4gICAgICAncGEnOicgYWJvIGFjIGNvbSBlZHUgZ29iIGluZyBtZWQgbmV0IG5vbSBvcmcgc2xkICcsXG4gICAgICAncHQnOicgY29tIGVkdSBnb3YgaW50IG5ldCBub21lIG9yZyBwdWJsICcsXG4gICAgICAncHknOicgY29tIGVkdSBnb3YgbWlsIG5ldCBvcmcgJyxcbiAgICAgICdxYSc6JyBjb20gZWR1IGdvdiBtaWwgbmV0IG9yZyAnLFxuICAgICAgJ3JlJzonIGFzc28gY29tIG5vbSAnLFxuICAgICAgJ3J1JzonIGFjIGFkeWdleWEgYWx0YWkgYW11ciBhcmtoYW5nZWxzayBhc3RyYWtoYW4gYmFzaGtpcmlhIGJlbGdvcm9kIGJpciBicnlhbnNrIGJ1cnlhdGlhIGNiZyBjaGVsIGNoZWx5YWJpbnNrIGNoaXRhIGNodWtvdGthIGNodXZhc2hpYSBjb20gZGFnZXN0YW4gZS1idXJnIGVkdSBnb3YgZ3Jvem55IGludCBpcmt1dHNrIGl2YW5vdm8gaXpoZXZzayBqYXIgam9zaGthci1vbGEga2FsbXlraWEga2FsdWdhIGthbWNoYXRrYSBrYXJlbGlhIGthemFuIGtjaHIga2VtZXJvdm8ga2hhYmFyb3ZzayBraGFrYXNzaWEga2h2IGtpcm92IGtvZW5pZyBrb21pIGtvc3Ryb21hIGtyYW5veWFyc2sga3ViYW4ga3VyZ2FuIGt1cnNrIGxpcGV0c2sgbWFnYWRhbiBtYXJpIG1hcmktZWwgbWFyaW5lIG1pbCBtb3Jkb3ZpYSBtb3NyZWcgbXNrIG11cm1hbnNrIG5hbGNoaWsgbmV0IG5ub3Ygbm92IG5vdm9zaWJpcnNrIG5zayBvbXNrIG9yZW5idXJnIG9yZyBvcnlvbCBwZW56YSBwZXJtIHBwIHBza292IHB0eiBybmQgcnlhemFuIHNha2hhbGluIHNhbWFyYSBzYXJhdG92IHNpbWJpcnNrIHNtb2xlbnNrIHNwYiBzdGF2cm9wb2wgc3R2IHN1cmd1dCB0YW1ib3YgdGF0YXJzdGFuIHRvbSB0b21zayB0c2FyaXRzeW4gdHNrIHR1bGEgdHV2YSB0dmVyIHR5dW1lbiB1ZG0gdWRtdXJ0aWEgdWxhbi11ZGUgdmxhZGlrYXZrYXogdmxhZGltaXIgdmxhZGl2b3N0b2sgdm9sZ29ncmFkIHZvbG9nZGEgdm9yb25lemggdnJuIHZ5YXRrYSB5YWt1dGlhIHlhbWFsIHlla2F0ZXJpbmJ1cmcgeXV6aG5vLXNha2hhbGluc2sgJyxcbiAgICAgICdydyc6JyBhYyBjbyBjb20gZWR1IGdvdXYgZ292IGludCBtaWwgbmV0ICcsXG4gICAgICAnc2EnOicgY29tIGVkdSBnb3YgbWVkIG5ldCBvcmcgcHViIHNjaCAnLFxuICAgICAgJ3NkJzonIGNvbSBlZHUgZ292IGluZm8gbWVkIG5ldCBvcmcgdHYgJyxcbiAgICAgICdzZSc6JyBhIGFjIGIgYmQgYyBkIGUgZiBnIGggaSBrIGwgbSBuIG8gb3JnIHAgcGFydGkgcHAgcHJlc3MgciBzIHQgdG0gdSB3IHggeSB6ICcsXG4gICAgICAnc2cnOicgY29tIGVkdSBnb3YgaWRuIG5ldCBvcmcgcGVyICcsXG4gICAgICAnc24nOicgYXJ0IGNvbSBlZHUgZ291diBvcmcgcGVyc28gdW5pdiAnLFxuICAgICAgJ3N5JzonIGNvbSBlZHUgZ292IG1pbCBuZXQgbmV3cyBvcmcgJyxcbiAgICAgICd0aCc6JyBhYyBjbyBnbyBpbiBtaSBuZXQgb3IgJyxcbiAgICAgICd0aic6JyBhYyBiaXogY28gY29tIGVkdSBnbyBnb3YgaW5mbyBpbnQgbWlsIG5hbWUgbmV0IG5pYyBvcmcgdGVzdCB3ZWIgJyxcbiAgICAgICd0bic6JyBhZ3JpbmV0IGNvbSBkZWZlbnNlIGVkdW5ldCBlbnMgZmluIGdvdiBpbmQgaW5mbyBpbnRsIG1pbmNvbSBuYXQgbmV0IG9yZyBwZXJzbyBybnJ0IHJucyBybnUgdG91cmlzbSAnLFxuICAgICAgJ3R6JzonIGFjIGNvIGdvIG5lIG9yICcsXG4gICAgICAndWEnOicgYml6IGNoZXJrYXNzeSBjaGVybmlnb3YgY2hlcm5vdnRzeSBjayBjbiBjbyBjb20gY3JpbWVhIGN2IGRuIGRuZXByb3BldHJvdnNrIGRvbmV0c2sgZHAgZWR1IGdvdiBpZiBpbiBpdmFuby1mcmFua2l2c2sga2gga2hhcmtvdiBraGVyc29uIGtobWVsbml0c2tpeSBraWV2IGtpcm92b2dyYWQga20ga3Iga3Mga3YgbGcgbHVnYW5zayBsdXRzayBsdml2IG1lIG1rIG5ldCBuaWtvbGFldiBvZCBvZGVzc2Egb3JnIHBsIHBvbHRhdmEgcHAgcm92bm8gcnYgc2ViYXN0b3BvbCBzdW15IHRlIHRlcm5vcGlsIHV6aGdvcm9kIHZpbm5pY2Egdm4gemFwb3Jpemh6aGUgemhpdG9taXIgenAgenQgJyxcbiAgICAgICd1Zyc6JyBhYyBjbyBnbyBuZSBvciBvcmcgc2MgJyxcbiAgICAgICd1ayc6JyBhYyBibCBicml0aXNoLWxpYnJhcnkgY28gY3ltIGdvdiBnb3Z0IGljbmV0IGpldCBsZWEgbHRkIG1lIG1pbCBtb2QgbmF0aW9uYWwtbGlicmFyeS1zY290bGFuZCBuZWwgbmV0IG5ocyBuaWMgbmxzIG9yZyBvcmduIHBhcmxpYW1lbnQgcGxjIHBvbGljZSBzY2ggc2NvdCBzb2MgJyxcbiAgICAgICd1cyc6JyBkbmkgZmVkIGlzYSBraWRzIG5zbiAnLFxuICAgICAgJ3V5JzonIGNvbSBlZHUgZ3ViIG1pbCBuZXQgb3JnICcsXG4gICAgICAndmUnOicgY28gY29tIGVkdSBnb2IgaW5mbyBtaWwgbmV0IG9yZyB3ZWIgJyxcbiAgICAgICd2aSc6JyBjbyBjb20gazEyIG5ldCBvcmcgJyxcbiAgICAgICd2bic6JyBhYyBiaXogY29tIGVkdSBnb3YgaGVhbHRoIGluZm8gaW50IG5hbWUgbmV0IG9yZyBwcm8gJyxcbiAgICAgICd5ZSc6JyBjbyBjb20gZ292IGx0ZCBtZSBuZXQgb3JnIHBsYyAnLFxuICAgICAgJ3l1JzonIGFjIGNvIGVkdSBnb3Ygb3JnICcsXG4gICAgICAnemEnOicgYWMgYWdyaWMgYWx0IGJvdXJzZSBjaXR5IGNvIGN5YmVybmV0IGRiIGVkdSBnb3YgZ3JvbmRhciBpYWNjZXNzIGltdCBpbmNhIGxhbmRlc2lnbiBsYXcgbWlsIG5ldCBuZ28gbmlzIG5vbSBvbGl2ZXR0aSBvcmcgcGl4IHNjaG9vbCB0bSB3ZWIgJyxcbiAgICAgICd6bSc6JyBhYyBjbyBjb20gZWR1IGdvdiBuZXQgb3JnIHNjaCAnLFxuICAgICAgLy8gaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ2VudHJhbE5pYyNTZWNvbmQtbGV2ZWxfZG9tYWluc1xuICAgICAgJ2NvbSc6ICdhciBiciBjbiBkZSBldSBnYiBnciBodSBqcG4ga3Igbm8gcWMgcnUgc2Egc2UgdWsgdXMgdXkgemEgJyxcbiAgICAgICduZXQnOiAnZ2IganAgc2UgdWsgJyxcbiAgICAgICdvcmcnOiAnYWUnLFxuICAgICAgJ2RlJzogJ2NvbSAnXG4gICAgfSxcbiAgICAvLyBnb3JoaWxsIDIwMTMtMTAtMjU6IFVzaW5nIGluZGV4T2YoKSBpbnN0ZWFkIFJlZ2V4cCgpLiBTaWduaWZpY2FudCBib29zdFxuICAgIC8vIGluIGJvdGggcGVyZm9ybWFuY2UgYW5kIG1lbW9yeSBmb290cHJpbnQuIE5vIGluaXRpYWxpemF0aW9uIHJlcXVpcmVkLlxuICAgIC8vIGh0dHA6Ly9qc3BlcmYuY29tL3VyaS1qcy1zbGQtcmVnZXgtdnMtYmluYXJ5LXNlYXJjaC80XG4gICAgLy8gRm9sbG93aW5nIG1ldGhvZHMgdXNlIGxhc3RJbmRleE9mKCkgcmF0aGVyIHRoYW4gYXJyYXkuc3BsaXQoKSBpbiBvcmRlclxuICAgIC8vIHRvIGF2b2lkIGFueSBtZW1vcnkgYWxsb2NhdGlvbnMuXG4gICAgaGFzOiBmdW5jdGlvbihkb21haW4pIHtcbiAgICAgIHZhciB0bGRPZmZzZXQgPSBkb21haW4ubGFzdEluZGV4T2YoJy4nKTtcbiAgICAgIGlmICh0bGRPZmZzZXQgPD0gMCB8fCB0bGRPZmZzZXQgPj0gKGRvbWFpbi5sZW5ndGgtMSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIHNsZE9mZnNldCA9IGRvbWFpbi5sYXN0SW5kZXhPZignLicsIHRsZE9mZnNldC0xKTtcbiAgICAgIGlmIChzbGRPZmZzZXQgPD0gMCB8fCBzbGRPZmZzZXQgPj0gKHRsZE9mZnNldC0xKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgc2xkTGlzdCA9IFNMRC5saXN0W2RvbWFpbi5zbGljZSh0bGRPZmZzZXQrMSldO1xuICAgICAgaWYgKCFzbGRMaXN0KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzbGRMaXN0LmluZGV4T2YoJyAnICsgZG9tYWluLnNsaWNlKHNsZE9mZnNldCsxLCB0bGRPZmZzZXQpICsgJyAnKSA+PSAwO1xuICAgIH0sXG4gICAgaXM6IGZ1bmN0aW9uKGRvbWFpbikge1xuICAgICAgdmFyIHRsZE9mZnNldCA9IGRvbWFpbi5sYXN0SW5kZXhPZignLicpO1xuICAgICAgaWYgKHRsZE9mZnNldCA8PSAwIHx8IHRsZE9mZnNldCA+PSAoZG9tYWluLmxlbmd0aC0xKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgc2xkT2Zmc2V0ID0gZG9tYWluLmxhc3RJbmRleE9mKCcuJywgdGxkT2Zmc2V0LTEpO1xuICAgICAgaWYgKHNsZE9mZnNldCA+PSAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHZhciBzbGRMaXN0ID0gU0xELmxpc3RbZG9tYWluLnNsaWNlKHRsZE9mZnNldCsxKV07XG4gICAgICBpZiAoIXNsZExpc3QpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNsZExpc3QuaW5kZXhPZignICcgKyBkb21haW4uc2xpY2UoMCwgdGxkT2Zmc2V0KSArICcgJykgPj0gMDtcbiAgICB9LFxuICAgIGdldDogZnVuY3Rpb24oZG9tYWluKSB7XG4gICAgICB2YXIgdGxkT2Zmc2V0ID0gZG9tYWluLmxhc3RJbmRleE9mKCcuJyk7XG4gICAgICBpZiAodGxkT2Zmc2V0IDw9IDAgfHwgdGxkT2Zmc2V0ID49IChkb21haW4ubGVuZ3RoLTEpKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgdmFyIHNsZE9mZnNldCA9IGRvbWFpbi5sYXN0SW5kZXhPZignLicsIHRsZE9mZnNldC0xKTtcbiAgICAgIGlmIChzbGRPZmZzZXQgPD0gMCB8fCBzbGRPZmZzZXQgPj0gKHRsZE9mZnNldC0xKSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHZhciBzbGRMaXN0ID0gU0xELmxpc3RbZG9tYWluLnNsaWNlKHRsZE9mZnNldCsxKV07XG4gICAgICBpZiAoIXNsZExpc3QpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAoc2xkTGlzdC5pbmRleE9mKCcgJyArIGRvbWFpbi5zbGljZShzbGRPZmZzZXQrMSwgdGxkT2Zmc2V0KSArICcgJykgPCAwKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRvbWFpbi5zbGljZShzbGRPZmZzZXQrMSk7XG4gICAgfSxcbiAgICBub0NvbmZsaWN0OiBmdW5jdGlvbigpe1xuICAgICAgaWYgKHJvb3QuU2Vjb25kTGV2ZWxEb21haW5zID09PSB0aGlzKSB7XG4gICAgICAgIHJvb3QuU2Vjb25kTGV2ZWxEb21haW5zID0gX1NlY29uZExldmVsRG9tYWlucztcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gU0xEO1xufSkpO1xuIiwiLyohXG4gKiBVUkkuanMgLSBNdXRhdGluZyBVUkxzXG4gKlxuICogVmVyc2lvbjogMS4xOS4xXG4gKlxuICogQXV0aG9yOiBSb2RuZXkgUmVobVxuICogV2ViOiBodHRwOi8vbWVkaWFsaXplLmdpdGh1Yi5pby9VUkkuanMvXG4gKlxuICogTGljZW5zZWQgdW5kZXJcbiAqICAgTUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZVxuICpcbiAqL1xuKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3VtZGpzL3VtZC9ibG9iL21hc3Rlci9yZXR1cm5FeHBvcnRzLmpzXG4gIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIC8vIE5vZGVcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgnLi9wdW55Y29kZScpLCByZXF1aXJlKCcuL0lQdjYnKSwgcmVxdWlyZSgnLi9TZWNvbmRMZXZlbERvbWFpbnMnKSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgLy8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuICAgIGRlZmluZShbJy4vcHVueWNvZGUnLCAnLi9JUHY2JywgJy4vU2Vjb25kTGV2ZWxEb21haW5zJ10sIGZhY3RvcnkpO1xuICB9IGVsc2Uge1xuICAgIC8vIEJyb3dzZXIgZ2xvYmFscyAocm9vdCBpcyB3aW5kb3cpXG4gICAgcm9vdC5VUkkgPSBmYWN0b3J5KHJvb3QucHVueWNvZGUsIHJvb3QuSVB2Niwgcm9vdC5TZWNvbmRMZXZlbERvbWFpbnMsIHJvb3QpO1xuICB9XG59KHRoaXMsIGZ1bmN0aW9uIChwdW55Y29kZSwgSVB2NiwgU0xELCByb290KSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgLypnbG9iYWwgbG9jYXRpb24sIGVzY2FwZSwgdW5lc2NhcGUgKi9cbiAgLy8gRklYTUU6IHYyLjAuMCByZW5hbWNlIG5vbi1jYW1lbENhc2UgcHJvcGVydGllcyB0byB1cHBlcmNhc2VcbiAgLypqc2hpbnQgY2FtZWxjYXNlOiBmYWxzZSAqL1xuXG4gIC8vIHNhdmUgY3VycmVudCBVUkkgdmFyaWFibGUsIGlmIGFueVxuICB2YXIgX1VSSSA9IHJvb3QgJiYgcm9vdC5VUkk7XG5cbiAgZnVuY3Rpb24gVVJJKHVybCwgYmFzZSkge1xuICAgIHZhciBfdXJsU3VwcGxpZWQgPSBhcmd1bWVudHMubGVuZ3RoID49IDE7XG4gICAgdmFyIF9iYXNlU3VwcGxpZWQgPSBhcmd1bWVudHMubGVuZ3RoID49IDI7XG5cbiAgICAvLyBBbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgdGhlICduZXcnIGtleXdvcmRcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgVVJJKSkge1xuICAgICAgaWYgKF91cmxTdXBwbGllZCkge1xuICAgICAgICBpZiAoX2Jhc2VTdXBwbGllZCkge1xuICAgICAgICAgIHJldHVybiBuZXcgVVJJKHVybCwgYmFzZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFVSSSh1cmwpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbmV3IFVSSSgpO1xuICAgIH1cblxuICAgIGlmICh1cmwgPT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKF91cmxTdXBwbGllZCkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCd1bmRlZmluZWQgaXMgbm90IGEgdmFsaWQgYXJndW1lbnQgZm9yIFVSSScpO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGxvY2F0aW9uICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB1cmwgPSBsb2NhdGlvbi5ocmVmICsgJyc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1cmwgPSAnJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodXJsID09PSBudWxsKSB7XG4gICAgICBpZiAoX3VybFN1cHBsaWVkKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ251bGwgaXMgbm90IGEgdmFsaWQgYXJndW1lbnQgZm9yIFVSSScpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuaHJlZih1cmwpO1xuXG4gICAgLy8gcmVzb2x2ZSB0byBiYXNlIGFjY29yZGluZyB0byBodHRwOi8vZHZjcy53My5vcmcvaGcvdXJsL3Jhdy1maWxlL3RpcC9PdmVydmlldy5odG1sI2NvbnN0cnVjdG9yXG4gICAgaWYgKGJhc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHRoaXMuYWJzb2x1dGVUbyhiYXNlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzSW50ZWdlcih2YWx1ZSkge1xuICAgIHJldHVybiAvXlswLTldKyQvLnRlc3QodmFsdWUpO1xuICB9XG5cbiAgVVJJLnZlcnNpb24gPSAnMS4xOS4xJztcblxuICB2YXIgcCA9IFVSSS5wcm90b3R5cGU7XG4gIHZhciBoYXNPd24gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXG4gIGZ1bmN0aW9uIGVzY2FwZVJlZ0V4KHN0cmluZykge1xuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9tZWRpYWxpemUvVVJJLmpzL2NvbW1pdC84NWFjMjE3ODNjMTFmOGNjYWIwNjEwNmRiYTk3MzVhMzFhODY5MjRkI2NvbW1pdGNvbW1lbnQtODIxOTYzXG4gICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC8oWy4qKz9ePSE6JHt9KCl8W1xcXVxcL1xcXFxdKS9nLCAnXFxcXCQxJyk7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRUeXBlKHZhbHVlKSB7XG4gICAgLy8gSUU4IGRvZXNuJ3QgcmV0dXJuIFtPYmplY3QgVW5kZWZpbmVkXSBidXQgW09iamVjdCBPYmplY3RdIGZvciB1bmRlZmluZWQgdmFsdWVcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuICdVbmRlZmluZWQnO1xuICAgIH1cblxuICAgIHJldHVybiBTdHJpbmcoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSkuc2xpY2UoOCwgLTEpO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNBcnJheShvYmopIHtcbiAgICByZXR1cm4gZ2V0VHlwZShvYmopID09PSAnQXJyYXknO1xuICB9XG5cbiAgZnVuY3Rpb24gZmlsdGVyQXJyYXlWYWx1ZXMoZGF0YSwgdmFsdWUpIHtcbiAgICB2YXIgbG9va3VwID0ge307XG4gICAgdmFyIGksIGxlbmd0aDtcblxuICAgIGlmIChnZXRUeXBlKHZhbHVlKSA9PT0gJ1JlZ0V4cCcpIHtcbiAgICAgIGxvb2t1cCA9IG51bGw7XG4gICAgfSBlbHNlIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgZm9yIChpID0gMCwgbGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbG9va3VwW3ZhbHVlW2ldXSA9IHRydWU7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvb2t1cFt2YWx1ZV0gPSB0cnVlO1xuICAgIH1cblxuICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IGRhdGEubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIC8qanNoaW50IGxheGJyZWFrOiB0cnVlICovXG4gICAgICB2YXIgX21hdGNoID0gbG9va3VwICYmIGxvb2t1cFtkYXRhW2ldXSAhPT0gdW5kZWZpbmVkXG4gICAgICAgIHx8ICFsb29rdXAgJiYgdmFsdWUudGVzdChkYXRhW2ldKTtcbiAgICAgIC8qanNoaW50IGxheGJyZWFrOiBmYWxzZSAqL1xuICAgICAgaWYgKF9tYXRjaCkge1xuICAgICAgICBkYXRhLnNwbGljZShpLCAxKTtcbiAgICAgICAgbGVuZ3RoLS07XG4gICAgICAgIGktLTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFycmF5Q29udGFpbnMobGlzdCwgdmFsdWUpIHtcbiAgICB2YXIgaSwgbGVuZ3RoO1xuXG4gICAgLy8gdmFsdWUgbWF5IGJlIHN0cmluZywgbnVtYmVyLCBhcnJheSwgcmVnZXhwXG4gICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAvLyBOb3RlOiB0aGlzIGNhbiBiZSBvcHRpbWl6ZWQgdG8gTyhuKSAoaW5zdGVhZCBvZiBjdXJyZW50IE8obSAqIG4pKVxuICAgICAgZm9yIChpID0gMCwgbGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKCFhcnJheUNvbnRhaW5zKGxpc3QsIHZhbHVlW2ldKSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YXIgX3R5cGUgPSBnZXRUeXBlKHZhbHVlKTtcbiAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBsaXN0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoX3R5cGUgPT09ICdSZWdFeHAnKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbGlzdFtpXSA9PT0gJ3N0cmluZycgJiYgbGlzdFtpXS5tYXRjaCh2YWx1ZSkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChsaXN0W2ldID09PSB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBmdW5jdGlvbiBhcnJheXNFcXVhbChvbmUsIHR3bykge1xuICAgIGlmICghaXNBcnJheShvbmUpIHx8ICFpc0FycmF5KHR3bykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBhcnJheXMgY2FuJ3QgYmUgZXF1YWwgaWYgdGhleSBoYXZlIGRpZmZlcmVudCBhbW91bnQgb2YgY29udGVudFxuICAgIGlmIChvbmUubGVuZ3RoICE9PSB0d28ubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgb25lLnNvcnQoKTtcbiAgICB0d28uc29ydCgpO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSBvbmUubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICBpZiAob25lW2ldICE9PSB0d29baV0pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gdHJpbVNsYXNoZXModGV4dCkge1xuICAgIHZhciB0cmltX2V4cHJlc3Npb24gPSAvXlxcLyt8XFwvKyQvZztcbiAgICByZXR1cm4gdGV4dC5yZXBsYWNlKHRyaW1fZXhwcmVzc2lvbiwgJycpO1xuICB9XG5cbiAgVVJJLl9wYXJ0cyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBwcm90b2NvbDogbnVsbCxcbiAgICAgIHVzZXJuYW1lOiBudWxsLFxuICAgICAgcGFzc3dvcmQ6IG51bGwsXG4gICAgICBob3N0bmFtZTogbnVsbCxcbiAgICAgIHVybjogbnVsbCxcbiAgICAgIHBvcnQ6IG51bGwsXG4gICAgICBwYXRoOiBudWxsLFxuICAgICAgcXVlcnk6IG51bGwsXG4gICAgICBmcmFnbWVudDogbnVsbCxcbiAgICAgIC8vIHN0YXRlXG4gICAgICBwcmV2ZW50SW52YWxpZEhvc3RuYW1lOiBVUkkucHJldmVudEludmFsaWRIb3N0bmFtZSxcbiAgICAgIGR1cGxpY2F0ZVF1ZXJ5UGFyYW1ldGVyczogVVJJLmR1cGxpY2F0ZVF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGVzY2FwZVF1ZXJ5U3BhY2U6IFVSSS5lc2NhcGVRdWVyeVNwYWNlXG4gICAgfTtcbiAgfTtcbiAgLy8gc3RhdGU6IHRocm93IG9uIGludmFsaWQgaG9zdG5hbWVcbiAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9tZWRpYWxpemUvVVJJLmpzL3B1bGwvMzQ1XG4gIC8vIGFuZCBodHRwczovL2dpdGh1Yi5jb20vbWVkaWFsaXplL1VSSS5qcy9pc3N1ZXMvMzU0XG4gIFVSSS5wcmV2ZW50SW52YWxpZEhvc3RuYW1lID0gZmFsc2U7XG4gIC8vIHN0YXRlOiBhbGxvdyBkdXBsaWNhdGUgcXVlcnkgcGFyYW1ldGVycyAoYT0xJmE9MSlcbiAgVVJJLmR1cGxpY2F0ZVF1ZXJ5UGFyYW1ldGVycyA9IGZhbHNlO1xuICAvLyBzdGF0ZTogcmVwbGFjZXMgKyB3aXRoICUyMCAoc3BhY2UgaW4gcXVlcnkgc3RyaW5ncylcbiAgVVJJLmVzY2FwZVF1ZXJ5U3BhY2UgPSB0cnVlO1xuICAvLyBzdGF0aWMgcHJvcGVydGllc1xuICBVUkkucHJvdG9jb2xfZXhwcmVzc2lvbiA9IC9eW2Etel1bYS16MC05ListXSokL2k7XG4gIFVSSS5pZG5fZXhwcmVzc2lvbiA9IC9bXmEtejAtOVxcLl8tXS9pO1xuICBVUkkucHVueWNvZGVfZXhwcmVzc2lvbiA9IC8oeG4tLSkvaTtcbiAgLy8gd2VsbCwgMzMzLjQ0NC41NTUuNjY2IG1hdGNoZXMsIGJ1dCBpdCBzdXJlIGFpbid0IG5vIElQdjQgLSBkbyB3ZSBjYXJlP1xuICBVUkkuaXA0X2V4cHJlc3Npb24gPSAvXlxcZHsxLDN9XFwuXFxkezEsM31cXC5cXGR7MSwzfVxcLlxcZHsxLDN9JC87XG4gIC8vIGNyZWRpdHMgdG8gUmljaCBCcm93blxuICAvLyBzb3VyY2U6IGh0dHA6Ly9mb3J1bXMuaW50ZXJtYXBwZXIuY29tL3ZpZXd0b3BpYy5waHA/cD0xMDk2IzEwOTZcbiAgLy8gc3BlY2lmaWNhdGlvbjogaHR0cDovL3d3dy5pZXRmLm9yZy9yZmMvcmZjNDI5MS50eHRcbiAgVVJJLmlwNl9leHByZXNzaW9uID0gL15cXHMqKCgoWzAtOUEtRmEtZl17MSw0fTopezd9KFswLTlBLUZhLWZdezEsNH18OikpfCgoWzAtOUEtRmEtZl17MSw0fTopezZ9KDpbMC05QS1GYS1mXXsxLDR9fCgoMjVbMC01XXwyWzAtNF1cXGR8MVxcZFxcZHxbMS05XT9cXGQpKFxcLigyNVswLTVdfDJbMC00XVxcZHwxXFxkXFxkfFsxLTldP1xcZCkpezN9KXw6KSl8KChbMC05QS1GYS1mXXsxLDR9Oil7NX0oKCg6WzAtOUEtRmEtZl17MSw0fSl7MSwyfSl8OigoMjVbMC01XXwyWzAtNF1cXGR8MVxcZFxcZHxbMS05XT9cXGQpKFxcLigyNVswLTVdfDJbMC00XVxcZHwxXFxkXFxkfFsxLTldP1xcZCkpezN9KXw6KSl8KChbMC05QS1GYS1mXXsxLDR9Oil7NH0oKCg6WzAtOUEtRmEtZl17MSw0fSl7MSwzfSl8KCg6WzAtOUEtRmEtZl17MSw0fSk/OigoMjVbMC01XXwyWzAtNF1cXGR8MVxcZFxcZHxbMS05XT9cXGQpKFxcLigyNVswLTVdfDJbMC00XVxcZHwxXFxkXFxkfFsxLTldP1xcZCkpezN9KSl8OikpfCgoWzAtOUEtRmEtZl17MSw0fTopezN9KCgoOlswLTlBLUZhLWZdezEsNH0pezEsNH0pfCgoOlswLTlBLUZhLWZdezEsNH0pezAsMn06KCgyNVswLTVdfDJbMC00XVxcZHwxXFxkXFxkfFsxLTldP1xcZCkoXFwuKDI1WzAtNV18MlswLTRdXFxkfDFcXGRcXGR8WzEtOV0/XFxkKSl7M30pKXw6KSl8KChbMC05QS1GYS1mXXsxLDR9Oil7Mn0oKCg6WzAtOUEtRmEtZl17MSw0fSl7MSw1fSl8KCg6WzAtOUEtRmEtZl17MSw0fSl7MCwzfTooKDI1WzAtNV18MlswLTRdXFxkfDFcXGRcXGR8WzEtOV0/XFxkKShcXC4oMjVbMC01XXwyWzAtNF1cXGR8MVxcZFxcZHxbMS05XT9cXGQpKXszfSkpfDopKXwoKFswLTlBLUZhLWZdezEsNH06KXsxfSgoKDpbMC05QS1GYS1mXXsxLDR9KXsxLDZ9KXwoKDpbMC05QS1GYS1mXXsxLDR9KXswLDR9OigoMjVbMC01XXwyWzAtNF1cXGR8MVxcZFxcZHxbMS05XT9cXGQpKFxcLigyNVswLTVdfDJbMC00XVxcZHwxXFxkXFxkfFsxLTldP1xcZCkpezN9KSl8OikpfCg6KCgoOlswLTlBLUZhLWZdezEsNH0pezEsN30pfCgoOlswLTlBLUZhLWZdezEsNH0pezAsNX06KCgyNVswLTVdfDJbMC00XVxcZHwxXFxkXFxkfFsxLTldP1xcZCkoXFwuKDI1WzAtNV18MlswLTRdXFxkfDFcXGRcXGR8WzEtOV0/XFxkKSl7M30pKXw6KSkpKCUuKyk/XFxzKiQvO1xuICAvLyBleHByZXNzaW9uIHVzZWQgaXMgXCJncnViZXIgcmV2aXNlZFwiIChAZ3J1YmVyIHYyKSBkZXRlcm1pbmVkIHRvIGJlIHRoZVxuICAvLyBiZXN0IHNvbHV0aW9uIGluIGEgcmVnZXgtZ29sZiB3ZSBkaWQgYSBjb3VwbGUgb2YgYWdlcyBhZ28gYXRcbiAgLy8gKiBodHRwOi8vbWF0aGlhc2J5bmVucy5iZS9kZW1vL3VybC1yZWdleFxuICAvLyAqIGh0dHA6Ly9yb2RuZXlyZWhtLmRlL3QvdXJsLXJlZ2V4Lmh0bWxcbiAgVVJJLmZpbmRfdXJpX2V4cHJlc3Npb24gPSAvXFxiKCg/OlthLXpdW1xcdy1dKzooPzpcXC97MSwzfXxbYS16MC05JV0pfHd3d1xcZHswLDN9Wy5dfFthLXowLTkuXFwtXStbLl1bYS16XXsyLDR9XFwvKSg/OlteXFxzKCk8Pl0rfFxcKChbXlxccygpPD5dK3woXFwoW15cXHMoKTw+XStcXCkpKSpcXCkpKyg/OlxcKChbXlxccygpPD5dK3woXFwoW15cXHMoKTw+XStcXCkpKSpcXCl8W15cXHNgISgpXFxbXFxde307OidcIi4sPD4/wqvCu+KAnOKAneKAmOKAmV0pKS9pZztcbiAgVVJJLmZpbmRVcmkgPSB7XG4gICAgLy8gdmFsaWQgXCJzY2hlbWU6Ly9cIiBvciBcInd3dy5cIlxuICAgIHN0YXJ0OiAvXFxiKD86KFthLXpdW2EtejAtOS4rLV0qOlxcL1xcLyl8d3d3XFwuKS9naSxcbiAgICAvLyBldmVyeXRoaW5nIHVwIHRvIHRoZSBuZXh0IHdoaXRlc3BhY2VcbiAgICBlbmQ6IC9bXFxzXFxyXFxuXXwkLyxcbiAgICAvLyB0cmltIHRyYWlsaW5nIHB1bmN0dWF0aW9uIGNhcHR1cmVkIGJ5IGVuZCBSZWdFeHBcbiAgICB0cmltOiAvW2AhKClcXFtcXF17fTs6J1wiLiw8Pj/Cq8K74oCc4oCd4oCe4oCY4oCZXSskLyxcbiAgICAvLyBiYWxhbmNlZCBwYXJlbnMgaW5jbHVzaW9uICgpLCBbXSwge30sIDw+XG4gICAgcGFyZW5zOiAvKFxcKFteXFwpXSpcXCl8XFxbW15cXF1dKlxcXXxcXHtbXn1dKlxcfXw8W14+XSo+KS9nLFxuICB9O1xuICAvLyBodHRwOi8vd3d3LmlhbmEub3JnL2Fzc2lnbm1lbnRzL3VyaS1zY2hlbWVzLmh0bWxcbiAgLy8gaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9MaXN0X29mX1RDUF9hbmRfVURQX3BvcnRfbnVtYmVycyNXZWxsLWtub3duX3BvcnRzXG4gIFVSSS5kZWZhdWx0UG9ydHMgPSB7XG4gICAgaHR0cDogJzgwJyxcbiAgICBodHRwczogJzQ0MycsXG4gICAgZnRwOiAnMjEnLFxuICAgIGdvcGhlcjogJzcwJyxcbiAgICB3czogJzgwJyxcbiAgICB3c3M6ICc0NDMnXG4gIH07XG4gIC8vIGxpc3Qgb2YgcHJvdG9jb2xzIHdoaWNoIGFsd2F5cyByZXF1aXJlIGEgaG9zdG5hbWVcbiAgVVJJLmhvc3RQcm90b2NvbHMgPSBbXG4gICAgJ2h0dHAnLFxuICAgICdodHRwcydcbiAgXTtcblxuICAvLyBhbGxvd2VkIGhvc3RuYW1lIGNoYXJhY3RlcnMgYWNjb3JkaW5nIHRvIFJGQyAzOTg2XG4gIC8vIEFMUEhBIERJR0lUIFwiLVwiIFwiLlwiIFwiX1wiIFwiflwiIFwiIVwiIFwiJFwiIFwiJlwiIFwiJ1wiIFwiKFwiIFwiKVwiIFwiKlwiIFwiK1wiIFwiLFwiIFwiO1wiIFwiPVwiICVlbmNvZGVkXG4gIC8vIEkndmUgbmV2ZXIgc2VlbiBhIChub24tSUROKSBob3N0bmFtZSBvdGhlciB0aGFuOiBBTFBIQSBESUdJVCAuIC0gX1xuICBVUkkuaW52YWxpZF9ob3N0bmFtZV9jaGFyYWN0ZXJzID0gL1teYS16QS1aMC05XFwuXFwtOl9dLztcbiAgLy8gbWFwIERPTSBFbGVtZW50cyB0byB0aGVpciBVUkkgYXR0cmlidXRlXG4gIFVSSS5kb21BdHRyaWJ1dGVzID0ge1xuICAgICdhJzogJ2hyZWYnLFxuICAgICdibG9ja3F1b3RlJzogJ2NpdGUnLFxuICAgICdsaW5rJzogJ2hyZWYnLFxuICAgICdiYXNlJzogJ2hyZWYnLFxuICAgICdzY3JpcHQnOiAnc3JjJyxcbiAgICAnZm9ybSc6ICdhY3Rpb24nLFxuICAgICdpbWcnOiAnc3JjJyxcbiAgICAnYXJlYSc6ICdocmVmJyxcbiAgICAnaWZyYW1lJzogJ3NyYycsXG4gICAgJ2VtYmVkJzogJ3NyYycsXG4gICAgJ3NvdXJjZSc6ICdzcmMnLFxuICAgICd0cmFjayc6ICdzcmMnLFxuICAgICdpbnB1dCc6ICdzcmMnLCAvLyBidXQgb25seSBpZiB0eXBlPVwiaW1hZ2VcIlxuICAgICdhdWRpbyc6ICdzcmMnLFxuICAgICd2aWRlbyc6ICdzcmMnXG4gIH07XG4gIFVSSS5nZXREb21BdHRyaWJ1dGUgPSBmdW5jdGlvbihub2RlKSB7XG4gICAgaWYgKCFub2RlIHx8ICFub2RlLm5vZGVOYW1lKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHZhciBub2RlTmFtZSA9IG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAvLyA8aW5wdXQ+IHNob3VsZCBvbmx5IGV4cG9zZSBzcmMgZm9yIHR5cGU9XCJpbWFnZVwiXG4gICAgaWYgKG5vZGVOYW1lID09PSAnaW5wdXQnICYmIG5vZGUudHlwZSAhPT0gJ2ltYWdlJykge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXR1cm4gVVJJLmRvbUF0dHJpYnV0ZXNbbm9kZU5hbWVdO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGVzY2FwZUZvckR1bWJGaXJlZm94MzYodmFsdWUpIHtcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vbWVkaWFsaXplL1VSSS5qcy9pc3N1ZXMvOTFcbiAgICByZXR1cm4gZXNjYXBlKHZhbHVlKTtcbiAgfVxuXG4gIC8vIGVuY29kaW5nIC8gZGVjb2RpbmcgYWNjb3JkaW5nIHRvIFJGQzM5ODZcbiAgZnVuY3Rpb24gc3RyaWN0RW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZykge1xuICAgIC8vIHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL2VuY29kZVVSSUNvbXBvbmVudFxuICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5nKVxuICAgICAgLnJlcGxhY2UoL1shJygpKl0vZywgZXNjYXBlRm9yRHVtYkZpcmVmb3gzNilcbiAgICAgIC5yZXBsYWNlKC9cXCovZywgJyUyQScpO1xuICB9XG4gIFVSSS5lbmNvZGUgPSBzdHJpY3RFbmNvZGVVUklDb21wb25lbnQ7XG4gIFVSSS5kZWNvZGUgPSBkZWNvZGVVUklDb21wb25lbnQ7XG4gIFVSSS5pc284ODU5ID0gZnVuY3Rpb24oKSB7XG4gICAgVVJJLmVuY29kZSA9IGVzY2FwZTtcbiAgICBVUkkuZGVjb2RlID0gdW5lc2NhcGU7XG4gIH07XG4gIFVSSS51bmljb2RlID0gZnVuY3Rpb24oKSB7XG4gICAgVVJJLmVuY29kZSA9IHN0cmljdEVuY29kZVVSSUNvbXBvbmVudDtcbiAgICBVUkkuZGVjb2RlID0gZGVjb2RlVVJJQ29tcG9uZW50O1xuICB9O1xuICBVUkkuY2hhcmFjdGVycyA9IHtcbiAgICBwYXRobmFtZToge1xuICAgICAgZW5jb2RlOiB7XG4gICAgICAgIC8vIFJGQzM5ODYgMi4xOiBGb3IgY29uc2lzdGVuY3ksIFVSSSBwcm9kdWNlcnMgYW5kIG5vcm1hbGl6ZXJzIHNob3VsZFxuICAgICAgICAvLyB1c2UgdXBwZXJjYXNlIGhleGFkZWNpbWFsIGRpZ2l0cyBmb3IgYWxsIHBlcmNlbnQtZW5jb2RpbmdzLlxuICAgICAgICBleHByZXNzaW9uOiAvJSgyNHwyNnwyQnwyQ3wzQnwzRHwzQXw0MCkvaWcsXG4gICAgICAgIG1hcDoge1xuICAgICAgICAgIC8vIC0uX34hJygpKlxuICAgICAgICAgICclMjQnOiAnJCcsXG4gICAgICAgICAgJyUyNic6ICcmJyxcbiAgICAgICAgICAnJTJCJzogJysnLFxuICAgICAgICAgICclMkMnOiAnLCcsXG4gICAgICAgICAgJyUzQic6ICc7JyxcbiAgICAgICAgICAnJTNEJzogJz0nLFxuICAgICAgICAgICclM0EnOiAnOicsXG4gICAgICAgICAgJyU0MCc6ICdAJ1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVjb2RlOiB7XG4gICAgICAgIGV4cHJlc3Npb246IC9bXFwvXFw/I10vZyxcbiAgICAgICAgbWFwOiB7XG4gICAgICAgICAgJy8nOiAnJTJGJyxcbiAgICAgICAgICAnPyc6ICclM0YnLFxuICAgICAgICAgICcjJzogJyUyMydcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgcmVzZXJ2ZWQ6IHtcbiAgICAgIGVuY29kZToge1xuICAgICAgICAvLyBSRkMzOTg2IDIuMTogRm9yIGNvbnNpc3RlbmN5LCBVUkkgcHJvZHVjZXJzIGFuZCBub3JtYWxpemVycyBzaG91bGRcbiAgICAgICAgLy8gdXNlIHVwcGVyY2FzZSBoZXhhZGVjaW1hbCBkaWdpdHMgZm9yIGFsbCBwZXJjZW50LWVuY29kaW5ncy5cbiAgICAgICAgZXhwcmVzc2lvbjogLyUoMjF8MjN8MjR8MjZ8Mjd8Mjh8Mjl8MkF8MkJ8MkN8MkZ8M0F8M0J8M0R8M0Z8NDB8NUJ8NUQpL2lnLFxuICAgICAgICBtYXA6IHtcbiAgICAgICAgICAvLyBnZW4tZGVsaW1zXG4gICAgICAgICAgJyUzQSc6ICc6JyxcbiAgICAgICAgICAnJTJGJzogJy8nLFxuICAgICAgICAgICclM0YnOiAnPycsXG4gICAgICAgICAgJyUyMyc6ICcjJyxcbiAgICAgICAgICAnJTVCJzogJ1snLFxuICAgICAgICAgICclNUQnOiAnXScsXG4gICAgICAgICAgJyU0MCc6ICdAJyxcbiAgICAgICAgICAvLyBzdWItZGVsaW1zXG4gICAgICAgICAgJyUyMSc6ICchJyxcbiAgICAgICAgICAnJTI0JzogJyQnLFxuICAgICAgICAgICclMjYnOiAnJicsXG4gICAgICAgICAgJyUyNyc6ICdcXCcnLFxuICAgICAgICAgICclMjgnOiAnKCcsXG4gICAgICAgICAgJyUyOSc6ICcpJyxcbiAgICAgICAgICAnJTJBJzogJyonLFxuICAgICAgICAgICclMkInOiAnKycsXG4gICAgICAgICAgJyUyQyc6ICcsJyxcbiAgICAgICAgICAnJTNCJzogJzsnLFxuICAgICAgICAgICclM0QnOiAnPSdcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgdXJucGF0aDoge1xuICAgICAgLy8gVGhlIGNoYXJhY3RlcnMgdW5kZXIgYGVuY29kZWAgYXJlIHRoZSBjaGFyYWN0ZXJzIGNhbGxlZCBvdXQgYnkgUkZDIDIxNDEgYXMgYmVpbmcgYWNjZXB0YWJsZVxuICAgICAgLy8gZm9yIHVzYWdlIGluIGEgVVJOLiBSRkMyMTQxIGFsc28gY2FsbHMgb3V0IFwiLVwiLCBcIi5cIiwgYW5kIFwiX1wiIGFzIGFjY2VwdGFibGUgY2hhcmFjdGVycywgYnV0XG4gICAgICAvLyB0aGVzZSBhcmVuJ3QgZW5jb2RlZCBieSBlbmNvZGVVUklDb21wb25lbnQsIHNvIHdlIGRvbid0IGhhdmUgdG8gY2FsbCB0aGVtIG91dCBoZXJlLiBBbHNvXG4gICAgICAvLyBub3RlIHRoYXQgdGhlIGNvbG9uIGNoYXJhY3RlciBpcyBub3QgZmVhdHVyZWQgaW4gdGhlIGVuY29kaW5nIG1hcDsgdGhpcyBpcyBiZWNhdXNlIFVSSS5qc1xuICAgICAgLy8gZ2l2ZXMgdGhlIGNvbG9ucyBpbiBVUk5zIHNlbWFudGljIG1lYW5pbmcgYXMgdGhlIGRlbGltaXRlcnMgb2YgcGF0aCBzZWdlbWVudHMsIGFuZCBzbyBpdFxuICAgICAgLy8gc2hvdWxkIG5vdCBhcHBlYXIgdW5lbmNvZGVkIGluIGEgc2VnbWVudCBpdHNlbGYuXG4gICAgICAvLyBTZWUgYWxzbyB0aGUgbm90ZSBhYm92ZSBhYm91dCBSRkMzOTg2IGFuZCBjYXBpdGFsYWxpemVkIGhleCBkaWdpdHMuXG4gICAgICBlbmNvZGU6IHtcbiAgICAgICAgZXhwcmVzc2lvbjogLyUoMjF8MjR8Mjd8Mjh8Mjl8MkF8MkJ8MkN8M0J8M0R8NDApL2lnLFxuICAgICAgICBtYXA6IHtcbiAgICAgICAgICAnJTIxJzogJyEnLFxuICAgICAgICAgICclMjQnOiAnJCcsXG4gICAgICAgICAgJyUyNyc6ICdcXCcnLFxuICAgICAgICAgICclMjgnOiAnKCcsXG4gICAgICAgICAgJyUyOSc6ICcpJyxcbiAgICAgICAgICAnJTJBJzogJyonLFxuICAgICAgICAgICclMkInOiAnKycsXG4gICAgICAgICAgJyUyQyc6ICcsJyxcbiAgICAgICAgICAnJTNCJzogJzsnLFxuICAgICAgICAgICclM0QnOiAnPScsXG4gICAgICAgICAgJyU0MCc6ICdAJ1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLy8gVGhlc2UgY2hhcmFjdGVycyBhcmUgdGhlIGNoYXJhY3RlcnMgY2FsbGVkIG91dCBieSBSRkMyMTQxIGFzIFwicmVzZXJ2ZWRcIiBjaGFyYWN0ZXJzIHRoYXRcbiAgICAgIC8vIHNob3VsZCBuZXZlciBhcHBlYXIgaW4gYSBVUk4sIHBsdXMgdGhlIGNvbG9uIGNoYXJhY3RlciAoc2VlIG5vdGUgYWJvdmUpLlxuICAgICAgZGVjb2RlOiB7XG4gICAgICAgIGV4cHJlc3Npb246IC9bXFwvXFw/IzpdL2csXG4gICAgICAgIG1hcDoge1xuICAgICAgICAgICcvJzogJyUyRicsXG4gICAgICAgICAgJz8nOiAnJTNGJyxcbiAgICAgICAgICAnIyc6ICclMjMnLFxuICAgICAgICAgICc6JzogJyUzQSdcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgVVJJLmVuY29kZVF1ZXJ5ID0gZnVuY3Rpb24oc3RyaW5nLCBlc2NhcGVRdWVyeVNwYWNlKSB7XG4gICAgdmFyIGVzY2FwZWQgPSBVUkkuZW5jb2RlKHN0cmluZyArICcnKTtcbiAgICBpZiAoZXNjYXBlUXVlcnlTcGFjZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBlc2NhcGVRdWVyeVNwYWNlID0gVVJJLmVzY2FwZVF1ZXJ5U3BhY2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVzY2FwZVF1ZXJ5U3BhY2UgPyBlc2NhcGVkLnJlcGxhY2UoLyUyMC9nLCAnKycpIDogZXNjYXBlZDtcbiAgfTtcbiAgVVJJLmRlY29kZVF1ZXJ5ID0gZnVuY3Rpb24oc3RyaW5nLCBlc2NhcGVRdWVyeVNwYWNlKSB7XG4gICAgc3RyaW5nICs9ICcnO1xuICAgIGlmIChlc2NhcGVRdWVyeVNwYWNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGVzY2FwZVF1ZXJ5U3BhY2UgPSBVUkkuZXNjYXBlUXVlcnlTcGFjZTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIFVSSS5kZWNvZGUoZXNjYXBlUXVlcnlTcGFjZSA/IHN0cmluZy5yZXBsYWNlKC9cXCsvZywgJyUyMCcpIDogc3RyaW5nKTtcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgIC8vIHdlJ3JlIG5vdCBnb2luZyB0byBtZXNzIHdpdGggd2VpcmQgZW5jb2RpbmdzLFxuICAgICAgLy8gZ2l2ZSB1cCBhbmQgcmV0dXJuIHRoZSB1bmRlY29kZWQgb3JpZ2luYWwgc3RyaW5nXG4gICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL21lZGlhbGl6ZS9VUkkuanMvaXNzdWVzLzg3XG4gICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL21lZGlhbGl6ZS9VUkkuanMvaXNzdWVzLzkyXG4gICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH1cbiAgfTtcbiAgLy8gZ2VuZXJhdGUgZW5jb2RlL2RlY29kZSBwYXRoIGZ1bmN0aW9uc1xuICB2YXIgX3BhcnRzID0geydlbmNvZGUnOidlbmNvZGUnLCAnZGVjb2RlJzonZGVjb2RlJ307XG4gIHZhciBfcGFydDtcbiAgdmFyIGdlbmVyYXRlQWNjZXNzb3IgPSBmdW5jdGlvbihfZ3JvdXAsIF9wYXJ0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHN0cmluZykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIFVSSVtfcGFydF0oc3RyaW5nICsgJycpLnJlcGxhY2UoVVJJLmNoYXJhY3RlcnNbX2dyb3VwXVtfcGFydF0uZXhwcmVzc2lvbiwgZnVuY3Rpb24oYykge1xuICAgICAgICAgIHJldHVybiBVUkkuY2hhcmFjdGVyc1tfZ3JvdXBdW19wYXJ0XS5tYXBbY107XG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyB3ZSdyZSBub3QgZ29pbmcgdG8gbWVzcyB3aXRoIHdlaXJkIGVuY29kaW5ncyxcbiAgICAgICAgLy8gZ2l2ZSB1cCBhbmQgcmV0dXJuIHRoZSB1bmRlY29kZWQgb3JpZ2luYWwgc3RyaW5nXG4gICAgICAgIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vbWVkaWFsaXplL1VSSS5qcy9pc3N1ZXMvODdcbiAgICAgICAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9tZWRpYWxpemUvVVJJLmpzL2lzc3Vlcy85MlxuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgZm9yIChfcGFydCBpbiBfcGFydHMpIHtcbiAgICBVUklbX3BhcnQgKyAnUGF0aFNlZ21lbnQnXSA9IGdlbmVyYXRlQWNjZXNzb3IoJ3BhdGhuYW1lJywgX3BhcnRzW19wYXJ0XSk7XG4gICAgVVJJW19wYXJ0ICsgJ1VyblBhdGhTZWdtZW50J10gPSBnZW5lcmF0ZUFjY2Vzc29yKCd1cm5wYXRoJywgX3BhcnRzW19wYXJ0XSk7XG4gIH1cblxuICB2YXIgZ2VuZXJhdGVTZWdtZW50ZWRQYXRoRnVuY3Rpb24gPSBmdW5jdGlvbihfc2VwLCBfY29kaW5nRnVuY05hbWUsIF9pbm5lckNvZGluZ0Z1bmNOYW1lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHN0cmluZykge1xuICAgICAgLy8gV2h5IHBhc3MgaW4gbmFtZXMgb2YgZnVuY3Rpb25zLCByYXRoZXIgdGhhbiB0aGUgZnVuY3Rpb24gb2JqZWN0cyB0aGVtc2VsdmVzPyBUaGVcbiAgICAgIC8vIGRlZmluaXRpb25zIG9mIHNvbWUgZnVuY3Rpb25zIChidXQgaW4gcGFydGljdWxhciwgVVJJLmRlY29kZSkgd2lsbCBvY2Nhc2lvbmFsbHkgY2hhbmdlIGR1ZVxuICAgICAgLy8gdG8gVVJJLmpzIGhhdmluZyBJU084ODU5IGFuZCBVbmljb2RlIG1vZGVzLiBQYXNzaW5nIGluIHRoZSBuYW1lIGFuZCBnZXR0aW5nIGl0IHdpbGwgZW5zdXJlXG4gICAgICAvLyB0aGF0IHRoZSBmdW5jdGlvbnMgd2UgdXNlIGhlcmUgYXJlIFwiZnJlc2hcIi5cbiAgICAgIHZhciBhY3R1YWxDb2RpbmdGdW5jO1xuICAgICAgaWYgKCFfaW5uZXJDb2RpbmdGdW5jTmFtZSkge1xuICAgICAgICBhY3R1YWxDb2RpbmdGdW5jID0gVVJJW19jb2RpbmdGdW5jTmFtZV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhY3R1YWxDb2RpbmdGdW5jID0gZnVuY3Rpb24oc3RyaW5nKSB7XG4gICAgICAgICAgcmV0dXJuIFVSSVtfY29kaW5nRnVuY05hbWVdKFVSSVtfaW5uZXJDb2RpbmdGdW5jTmFtZV0oc3RyaW5nKSk7XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHZhciBzZWdtZW50cyA9IChzdHJpbmcgKyAnJykuc3BsaXQoX3NlcCk7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBzZWdtZW50cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBzZWdtZW50c1tpXSA9IGFjdHVhbENvZGluZ0Z1bmMoc2VnbWVudHNbaV0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gc2VnbWVudHMuam9pbihfc2VwKTtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFRoaXMgdGFrZXMgcGxhY2Ugb3V0c2lkZSB0aGUgYWJvdmUgbG9vcCBiZWNhdXNlIHdlIGRvbid0IHdhbnQsIGUuZy4sIGVuY29kZVVyblBhdGggZnVuY3Rpb25zLlxuICBVUkkuZGVjb2RlUGF0aCA9IGdlbmVyYXRlU2VnbWVudGVkUGF0aEZ1bmN0aW9uKCcvJywgJ2RlY29kZVBhdGhTZWdtZW50Jyk7XG4gIFVSSS5kZWNvZGVVcm5QYXRoID0gZ2VuZXJhdGVTZWdtZW50ZWRQYXRoRnVuY3Rpb24oJzonLCAnZGVjb2RlVXJuUGF0aFNlZ21lbnQnKTtcbiAgVVJJLnJlY29kZVBhdGggPSBnZW5lcmF0ZVNlZ21lbnRlZFBhdGhGdW5jdGlvbignLycsICdlbmNvZGVQYXRoU2VnbWVudCcsICdkZWNvZGUnKTtcbiAgVVJJLnJlY29kZVVyblBhdGggPSBnZW5lcmF0ZVNlZ21lbnRlZFBhdGhGdW5jdGlvbignOicsICdlbmNvZGVVcm5QYXRoU2VnbWVudCcsICdkZWNvZGUnKTtcblxuICBVUkkuZW5jb2RlUmVzZXJ2ZWQgPSBnZW5lcmF0ZUFjY2Vzc29yKCdyZXNlcnZlZCcsICdlbmNvZGUnKTtcblxuICBVUkkucGFyc2UgPSBmdW5jdGlvbihzdHJpbmcsIHBhcnRzKSB7XG4gICAgdmFyIHBvcztcbiAgICBpZiAoIXBhcnRzKSB7XG4gICAgICBwYXJ0cyA9IHtcbiAgICAgICAgcHJldmVudEludmFsaWRIb3N0bmFtZTogVVJJLnByZXZlbnRJbnZhbGlkSG9zdG5hbWVcbiAgICAgIH07XG4gICAgfVxuICAgIC8vIFtwcm90b2NvbFwiOi8vXCJbdXNlcm5hbWVbXCI6XCJwYXNzd29yZF1cIkBcIl1ob3N0bmFtZVtcIjpcInBvcnRdXCIvXCI/XVtwYXRoXVtcIj9cInF1ZXJ5c3RyaW5nXVtcIiNcImZyYWdtZW50XVxuXG4gICAgLy8gZXh0cmFjdCBmcmFnbWVudFxuICAgIHBvcyA9IHN0cmluZy5pbmRleE9mKCcjJyk7XG4gICAgaWYgKHBvcyA+IC0xKSB7XG4gICAgICAvLyBlc2NhcGluZz9cbiAgICAgIHBhcnRzLmZyYWdtZW50ID0gc3RyaW5nLnN1YnN0cmluZyhwb3MgKyAxKSB8fCBudWxsO1xuICAgICAgc3RyaW5nID0gc3RyaW5nLnN1YnN0cmluZygwLCBwb3MpO1xuICAgIH1cblxuICAgIC8vIGV4dHJhY3QgcXVlcnlcbiAgICBwb3MgPSBzdHJpbmcuaW5kZXhPZignPycpO1xuICAgIGlmIChwb3MgPiAtMSkge1xuICAgICAgLy8gZXNjYXBpbmc/XG4gICAgICBwYXJ0cy5xdWVyeSA9IHN0cmluZy5zdWJzdHJpbmcocG9zICsgMSkgfHwgbnVsbDtcbiAgICAgIHN0cmluZyA9IHN0cmluZy5zdWJzdHJpbmcoMCwgcG9zKTtcbiAgICB9XG5cbiAgICAvLyBleHRyYWN0IHByb3RvY29sXG4gICAgaWYgKHN0cmluZy5zdWJzdHJpbmcoMCwgMikgPT09ICcvLycpIHtcbiAgICAgIC8vIHJlbGF0aXZlLXNjaGVtZVxuICAgICAgcGFydHMucHJvdG9jb2wgPSBudWxsO1xuICAgICAgc3RyaW5nID0gc3RyaW5nLnN1YnN0cmluZygyKTtcbiAgICAgIC8vIGV4dHJhY3QgXCJ1c2VyOnBhc3NAaG9zdDpwb3J0XCJcbiAgICAgIHN0cmluZyA9IFVSSS5wYXJzZUF1dGhvcml0eShzdHJpbmcsIHBhcnRzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcG9zID0gc3RyaW5nLmluZGV4T2YoJzonKTtcbiAgICAgIGlmIChwb3MgPiAtMSkge1xuICAgICAgICBwYXJ0cy5wcm90b2NvbCA9IHN0cmluZy5zdWJzdHJpbmcoMCwgcG9zKSB8fCBudWxsO1xuICAgICAgICBpZiAocGFydHMucHJvdG9jb2wgJiYgIXBhcnRzLnByb3RvY29sLm1hdGNoKFVSSS5wcm90b2NvbF9leHByZXNzaW9uKSkge1xuICAgICAgICAgIC8vIDogbWF5IGJlIHdpdGhpbiB0aGUgcGF0aFxuICAgICAgICAgIHBhcnRzLnByb3RvY29sID0gdW5kZWZpbmVkO1xuICAgICAgICB9IGVsc2UgaWYgKHN0cmluZy5zdWJzdHJpbmcocG9zICsgMSwgcG9zICsgMykgPT09ICcvLycpIHtcbiAgICAgICAgICBzdHJpbmcgPSBzdHJpbmcuc3Vic3RyaW5nKHBvcyArIDMpO1xuXG4gICAgICAgICAgLy8gZXh0cmFjdCBcInVzZXI6cGFzc0Bob3N0OnBvcnRcIlxuICAgICAgICAgIHN0cmluZyA9IFVSSS5wYXJzZUF1dGhvcml0eShzdHJpbmcsIHBhcnRzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdHJpbmcgPSBzdHJpbmcuc3Vic3RyaW5nKHBvcyArIDEpO1xuICAgICAgICAgIHBhcnRzLnVybiA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyB3aGF0J3MgbGVmdCBtdXN0IGJlIHRoZSBwYXRoXG4gICAgcGFydHMucGF0aCA9IHN0cmluZztcblxuICAgIC8vIGFuZCB3ZSdyZSBkb25lXG4gICAgcmV0dXJuIHBhcnRzO1xuICB9O1xuICBVUkkucGFyc2VIb3N0ID0gZnVuY3Rpb24oc3RyaW5nLCBwYXJ0cykge1xuICAgIGlmICghc3RyaW5nKSB7XG4gICAgICBzdHJpbmcgPSAnJztcbiAgICB9XG5cbiAgICAvLyBDb3B5IGNocm9tZSwgSUUsIG9wZXJhIGJhY2tzbGFzaC1oYW5kbGluZyBiZWhhdmlvci5cbiAgICAvLyBCYWNrIHNsYXNoZXMgYmVmb3JlIHRoZSBxdWVyeSBzdHJpbmcgZ2V0IGNvbnZlcnRlZCB0byBmb3J3YXJkIHNsYXNoZXNcbiAgICAvLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9qb3llbnQvbm9kZS9ibG9iLzM4NmZkMjRmNDliMGU5ZDFhOGEwNzY1OTJhNDA0MTY4ZmFlZWNjMzQvbGliL3VybC5qcyNMMTE1LUwxMjRcbiAgICAvLyBTZWU6IGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0yNTkxNlxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9tZWRpYWxpemUvVVJJLmpzL3B1bGwvMjMzXG4gICAgc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UoL1xcXFwvZywgJy8nKTtcblxuICAgIC8vIGV4dHJhY3QgaG9zdDpwb3J0XG4gICAgdmFyIHBvcyA9IHN0cmluZy5pbmRleE9mKCcvJyk7XG4gICAgdmFyIGJyYWNrZXRQb3M7XG4gICAgdmFyIHQ7XG5cbiAgICBpZiAocG9zID09PSAtMSkge1xuICAgICAgcG9zID0gc3RyaW5nLmxlbmd0aDtcbiAgICB9XG5cbiAgICBpZiAoc3RyaW5nLmNoYXJBdCgwKSA9PT0gJ1snKSB7XG4gICAgICAvLyBJUHY2IGhvc3QgLSBodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9kcmFmdC1pZXRmLTZtYW4tdGV4dC1hZGRyLXJlcHJlc2VudGF0aW9uLTA0I3NlY3Rpb24tNlxuICAgICAgLy8gSSBjbGFpbSBtb3N0IGNsaWVudCBzb2Z0d2FyZSBicmVha3Mgb24gSVB2NiBhbnl3YXlzLiBUbyBzaW1wbGlmeSB0aGluZ3MsIFVSSSBvbmx5IGFjY2VwdHNcbiAgICAgIC8vIElQdjYrcG9ydCBpbiB0aGUgZm9ybWF0IFsyMDAxOmRiODo6MV06ODAgKGZvciB0aGUgdGltZSBiZWluZylcbiAgICAgIGJyYWNrZXRQb3MgPSBzdHJpbmcuaW5kZXhPZignXScpO1xuICAgICAgcGFydHMuaG9zdG5hbWUgPSBzdHJpbmcuc3Vic3RyaW5nKDEsIGJyYWNrZXRQb3MpIHx8IG51bGw7XG4gICAgICBwYXJ0cy5wb3J0ID0gc3RyaW5nLnN1YnN0cmluZyhicmFja2V0UG9zICsgMiwgcG9zKSB8fCBudWxsO1xuICAgICAgaWYgKHBhcnRzLnBvcnQgPT09ICcvJykge1xuICAgICAgICBwYXJ0cy5wb3J0ID0gbnVsbDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGZpcnN0Q29sb24gPSBzdHJpbmcuaW5kZXhPZignOicpO1xuICAgICAgdmFyIGZpcnN0U2xhc2ggPSBzdHJpbmcuaW5kZXhPZignLycpO1xuICAgICAgdmFyIG5leHRDb2xvbiA9IHN0cmluZy5pbmRleE9mKCc6JywgZmlyc3RDb2xvbiArIDEpO1xuICAgICAgaWYgKG5leHRDb2xvbiAhPT0gLTEgJiYgKGZpcnN0U2xhc2ggPT09IC0xIHx8IG5leHRDb2xvbiA8IGZpcnN0U2xhc2gpKSB7XG4gICAgICAgIC8vIElQdjYgaG9zdCBjb250YWlucyBtdWx0aXBsZSBjb2xvbnMgLSBidXQgbm8gcG9ydFxuICAgICAgICAvLyB0aGlzIG5vdGF0aW9uIGlzIGFjdHVhbGx5IG5vdCBhbGxvd2VkIGJ5IFJGQyAzOTg2LCBidXQgd2UncmUgYSBsaWJlcmFsIHBhcnNlclxuICAgICAgICBwYXJ0cy5ob3N0bmFtZSA9IHN0cmluZy5zdWJzdHJpbmcoMCwgcG9zKSB8fCBudWxsO1xuICAgICAgICBwYXJ0cy5wb3J0ID0gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHQgPSBzdHJpbmcuc3Vic3RyaW5nKDAsIHBvcykuc3BsaXQoJzonKTtcbiAgICAgICAgcGFydHMuaG9zdG5hbWUgPSB0WzBdIHx8IG51bGw7XG4gICAgICAgIHBhcnRzLnBvcnQgPSB0WzFdIHx8IG51bGw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHBhcnRzLmhvc3RuYW1lICYmIHN0cmluZy5zdWJzdHJpbmcocG9zKS5jaGFyQXQoMCkgIT09ICcvJykge1xuICAgICAgcG9zKys7XG4gICAgICBzdHJpbmcgPSAnLycgKyBzdHJpbmc7XG4gICAgfVxuXG4gICAgaWYgKHBhcnRzLnByZXZlbnRJbnZhbGlkSG9zdG5hbWUpIHtcbiAgICAgIFVSSS5lbnN1cmVWYWxpZEhvc3RuYW1lKHBhcnRzLmhvc3RuYW1lLCBwYXJ0cy5wcm90b2NvbCk7XG4gICAgfVxuXG4gICAgaWYgKHBhcnRzLnBvcnQpIHtcbiAgICAgIFVSSS5lbnN1cmVWYWxpZFBvcnQocGFydHMucG9ydCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0cmluZy5zdWJzdHJpbmcocG9zKSB8fCAnLyc7XG4gIH07XG4gIFVSSS5wYXJzZUF1dGhvcml0eSA9IGZ1bmN0aW9uKHN0cmluZywgcGFydHMpIHtcbiAgICBzdHJpbmcgPSBVUkkucGFyc2VVc2VyaW5mbyhzdHJpbmcsIHBhcnRzKTtcbiAgICByZXR1cm4gVVJJLnBhcnNlSG9zdChzdHJpbmcsIHBhcnRzKTtcbiAgfTtcbiAgVVJJLnBhcnNlVXNlcmluZm8gPSBmdW5jdGlvbihzdHJpbmcsIHBhcnRzKSB7XG4gICAgLy8gZXh0cmFjdCB1c2VybmFtZTpwYXNzd29yZFxuICAgIHZhciBmaXJzdFNsYXNoID0gc3RyaW5nLmluZGV4T2YoJy8nKTtcbiAgICB2YXIgcG9zID0gc3RyaW5nLmxhc3RJbmRleE9mKCdAJywgZmlyc3RTbGFzaCA+IC0xID8gZmlyc3RTbGFzaCA6IHN0cmluZy5sZW5ndGggLSAxKTtcbiAgICB2YXIgdDtcblxuICAgIC8vIGF1dGhvcml0eUAgbXVzdCBjb21lIGJlZm9yZSAvcGF0aFxuICAgIGlmIChwb3MgPiAtMSAmJiAoZmlyc3RTbGFzaCA9PT0gLTEgfHwgcG9zIDwgZmlyc3RTbGFzaCkpIHtcbiAgICAgIHQgPSBzdHJpbmcuc3Vic3RyaW5nKDAsIHBvcykuc3BsaXQoJzonKTtcbiAgICAgIHBhcnRzLnVzZXJuYW1lID0gdFswXSA/IFVSSS5kZWNvZGUodFswXSkgOiBudWxsO1xuICAgICAgdC5zaGlmdCgpO1xuICAgICAgcGFydHMucGFzc3dvcmQgPSB0WzBdID8gVVJJLmRlY29kZSh0LmpvaW4oJzonKSkgOiBudWxsO1xuICAgICAgc3RyaW5nID0gc3RyaW5nLnN1YnN0cmluZyhwb3MgKyAxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGFydHMudXNlcm5hbWUgPSBudWxsO1xuICAgICAgcGFydHMucGFzc3dvcmQgPSBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBzdHJpbmc7XG4gIH07XG4gIFVSSS5wYXJzZVF1ZXJ5ID0gZnVuY3Rpb24oc3RyaW5nLCBlc2NhcGVRdWVyeVNwYWNlKSB7XG4gICAgaWYgKCFzdHJpbmcpIHtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG5cbiAgICAvLyB0aHJvdyBvdXQgdGhlIGZ1bmt5IGJ1c2luZXNzIC0gXCI/XCJbbmFtZVwiPVwidmFsdWVcIiZcIl0rXG4gICAgc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UoLyYrL2csICcmJykucmVwbGFjZSgvXlxcPyomKnwmKyQvZywgJycpO1xuXG4gICAgaWYgKCFzdHJpbmcpIHtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG5cbiAgICB2YXIgaXRlbXMgPSB7fTtcbiAgICB2YXIgc3BsaXRzID0gc3RyaW5nLnNwbGl0KCcmJyk7XG4gICAgdmFyIGxlbmd0aCA9IHNwbGl0cy5sZW5ndGg7XG4gICAgdmFyIHYsIG5hbWUsIHZhbHVlO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdiA9IHNwbGl0c1tpXS5zcGxpdCgnPScpO1xuICAgICAgbmFtZSA9IFVSSS5kZWNvZGVRdWVyeSh2LnNoaWZ0KCksIGVzY2FwZVF1ZXJ5U3BhY2UpO1xuICAgICAgLy8gbm8gXCI9XCIgaXMgbnVsbCBhY2NvcmRpbmcgdG8gaHR0cDovL2R2Y3MudzMub3JnL2hnL3VybC9yYXctZmlsZS90aXAvT3ZlcnZpZXcuaHRtbCNjb2xsZWN0LXVybC1wYXJhbWV0ZXJzXG4gICAgICB2YWx1ZSA9IHYubGVuZ3RoID8gVVJJLmRlY29kZVF1ZXJ5KHYuam9pbignPScpLCBlc2NhcGVRdWVyeVNwYWNlKSA6IG51bGw7XG5cbiAgICAgIGlmIChoYXNPd24uY2FsbChpdGVtcywgbmFtZSkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBpdGVtc1tuYW1lXSA9PT0gJ3N0cmluZycgfHwgaXRlbXNbbmFtZV0gPT09IG51bGwpIHtcbiAgICAgICAgICBpdGVtc1tuYW1lXSA9IFtpdGVtc1tuYW1lXV07XG4gICAgICAgIH1cblxuICAgICAgICBpdGVtc1tuYW1lXS5wdXNoKHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGl0ZW1zW25hbWVdID0gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGl0ZW1zO1xuICB9O1xuXG4gIFVSSS5idWlsZCA9IGZ1bmN0aW9uKHBhcnRzKSB7XG4gICAgdmFyIHQgPSAnJztcblxuICAgIGlmIChwYXJ0cy5wcm90b2NvbCkge1xuICAgICAgdCArPSBwYXJ0cy5wcm90b2NvbCArICc6JztcbiAgICB9XG5cbiAgICBpZiAoIXBhcnRzLnVybiAmJiAodCB8fCBwYXJ0cy5ob3N0bmFtZSkpIHtcbiAgICAgIHQgKz0gJy8vJztcbiAgICB9XG5cbiAgICB0ICs9IChVUkkuYnVpbGRBdXRob3JpdHkocGFydHMpIHx8ICcnKTtcblxuICAgIGlmICh0eXBlb2YgcGFydHMucGF0aCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGlmIChwYXJ0cy5wYXRoLmNoYXJBdCgwKSAhPT0gJy8nICYmIHR5cGVvZiBwYXJ0cy5ob3N0bmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdCArPSAnLyc7XG4gICAgICB9XG5cbiAgICAgIHQgKz0gcGFydHMucGF0aDtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHBhcnRzLnF1ZXJ5ID09PSAnc3RyaW5nJyAmJiBwYXJ0cy5xdWVyeSkge1xuICAgICAgdCArPSAnPycgKyBwYXJ0cy5xdWVyeTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHBhcnRzLmZyYWdtZW50ID09PSAnc3RyaW5nJyAmJiBwYXJ0cy5mcmFnbWVudCkge1xuICAgICAgdCArPSAnIycgKyBwYXJ0cy5mcmFnbWVudDtcbiAgICB9XG4gICAgcmV0dXJuIHQ7XG4gIH07XG4gIFVSSS5idWlsZEhvc3QgPSBmdW5jdGlvbihwYXJ0cykge1xuICAgIHZhciB0ID0gJyc7XG5cbiAgICBpZiAoIXBhcnRzLmhvc3RuYW1lKSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfSBlbHNlIGlmIChVUkkuaXA2X2V4cHJlc3Npb24udGVzdChwYXJ0cy5ob3N0bmFtZSkpIHtcbiAgICAgIHQgKz0gJ1snICsgcGFydHMuaG9zdG5hbWUgKyAnXSc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHQgKz0gcGFydHMuaG9zdG5hbWU7XG4gICAgfVxuXG4gICAgaWYgKHBhcnRzLnBvcnQpIHtcbiAgICAgIHQgKz0gJzonICsgcGFydHMucG9ydDtcbiAgICB9XG5cbiAgICByZXR1cm4gdDtcbiAgfTtcbiAgVVJJLmJ1aWxkQXV0aG9yaXR5ID0gZnVuY3Rpb24ocGFydHMpIHtcbiAgICByZXR1cm4gVVJJLmJ1aWxkVXNlcmluZm8ocGFydHMpICsgVVJJLmJ1aWxkSG9zdChwYXJ0cyk7XG4gIH07XG4gIFVSSS5idWlsZFVzZXJpbmZvID0gZnVuY3Rpb24ocGFydHMpIHtcbiAgICB2YXIgdCA9ICcnO1xuXG4gICAgaWYgKHBhcnRzLnVzZXJuYW1lKSB7XG4gICAgICB0ICs9IFVSSS5lbmNvZGUocGFydHMudXNlcm5hbWUpO1xuICAgIH1cblxuICAgIGlmIChwYXJ0cy5wYXNzd29yZCkge1xuICAgICAgdCArPSAnOicgKyBVUkkuZW5jb2RlKHBhcnRzLnBhc3N3b3JkKTtcbiAgICB9XG5cbiAgICBpZiAodCkge1xuICAgICAgdCArPSAnQCc7XG4gICAgfVxuXG4gICAgcmV0dXJuIHQ7XG4gIH07XG4gIFVSSS5idWlsZFF1ZXJ5ID0gZnVuY3Rpb24oZGF0YSwgZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzLCBlc2NhcGVRdWVyeVNwYWNlKSB7XG4gICAgLy8gYWNjb3JkaW5nIHRvIGh0dHA6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzM5ODYgb3IgaHR0cDovL2xhYnMuYXBhY2hlLm9yZy93ZWJhcmNoL3VyaS9yZmMvcmZjMzk4Ni5odG1sXG4gICAgLy8gYmVpbmcgwrstLl9+ISQmJygpKissOz06QC8/wqsgJUhFWCBhbmQgYWxudW0gYXJlIGFsbG93ZWRcbiAgICAvLyB0aGUgUkZDIGV4cGxpY2l0bHkgc3RhdGVzID8vZm9vIGJlaW5nIGEgdmFsaWQgdXNlIGNhc2UsIG5vIG1lbnRpb24gb2YgcGFyYW1ldGVyIHN5bnRheCFcbiAgICAvLyBVUkkuanMgdHJlYXRzIHRoZSBxdWVyeSBzdHJpbmcgYXMgYmVpbmcgYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXG4gICAgLy8gc2VlIGh0dHA6Ly93d3cudzMub3JnL1RSL1JFQy1odG1sNDAvaW50ZXJhY3QvZm9ybXMuaHRtbCNmb3JtLWNvbnRlbnQtdHlwZVxuXG4gICAgdmFyIHQgPSAnJztcbiAgICB2YXIgdW5pcXVlLCBrZXksIGksIGxlbmd0aDtcbiAgICBmb3IgKGtleSBpbiBkYXRhKSB7XG4gICAgICBpZiAoaGFzT3duLmNhbGwoZGF0YSwga2V5KSAmJiBrZXkpIHtcbiAgICAgICAgaWYgKGlzQXJyYXkoZGF0YVtrZXldKSkge1xuICAgICAgICAgIHVuaXF1ZSA9IHt9O1xuICAgICAgICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IGRhdGFba2V5XS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGRhdGFba2V5XVtpXSAhPT0gdW5kZWZpbmVkICYmIHVuaXF1ZVtkYXRhW2tleV1baV0gKyAnJ10gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICB0ICs9ICcmJyArIFVSSS5idWlsZFF1ZXJ5UGFyYW1ldGVyKGtleSwgZGF0YVtrZXldW2ldLCBlc2NhcGVRdWVyeVNwYWNlKTtcbiAgICAgICAgICAgICAgaWYgKGR1cGxpY2F0ZVF1ZXJ5UGFyYW1ldGVycyAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHVuaXF1ZVtkYXRhW2tleV1baV0gKyAnJ10gPSB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGRhdGFba2V5XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdCArPSAnJicgKyBVUkkuYnVpbGRRdWVyeVBhcmFtZXRlcihrZXksIGRhdGFba2V5XSwgZXNjYXBlUXVlcnlTcGFjZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdC5zdWJzdHJpbmcoMSk7XG4gIH07XG4gIFVSSS5idWlsZFF1ZXJ5UGFyYW1ldGVyID0gZnVuY3Rpb24obmFtZSwgdmFsdWUsIGVzY2FwZVF1ZXJ5U3BhY2UpIHtcbiAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9SRUMtaHRtbDQwL2ludGVyYWN0L2Zvcm1zLmh0bWwjZm9ybS1jb250ZW50LXR5cGUgLS0gYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXG4gICAgLy8gZG9uJ3QgYXBwZW5kIFwiPVwiIGZvciBudWxsIHZhbHVlcywgYWNjb3JkaW5nIHRvIGh0dHA6Ly9kdmNzLnczLm9yZy9oZy91cmwvcmF3LWZpbGUvdGlwL092ZXJ2aWV3Lmh0bWwjdXJsLXBhcmFtZXRlci1zZXJpYWxpemF0aW9uXG4gICAgcmV0dXJuIFVSSS5lbmNvZGVRdWVyeShuYW1lLCBlc2NhcGVRdWVyeVNwYWNlKSArICh2YWx1ZSAhPT0gbnVsbCA/ICc9JyArIFVSSS5lbmNvZGVRdWVyeSh2YWx1ZSwgZXNjYXBlUXVlcnlTcGFjZSkgOiAnJyk7XG4gIH07XG5cbiAgVVJJLmFkZFF1ZXJ5ID0gZnVuY3Rpb24oZGF0YSwgbmFtZSwgdmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIG5hbWUgPT09ICdvYmplY3QnKSB7XG4gICAgICBmb3IgKHZhciBrZXkgaW4gbmFtZSkge1xuICAgICAgICBpZiAoaGFzT3duLmNhbGwobmFtZSwga2V5KSkge1xuICAgICAgICAgIFVSSS5hZGRRdWVyeShkYXRhLCBrZXksIG5hbWVba2V5XSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgaWYgKGRhdGFbbmFtZV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBkYXRhW25hbWVdID0gdmFsdWU7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGRhdGFbbmFtZV0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGRhdGFbbmFtZV0gPSBbZGF0YVtuYW1lXV07XG4gICAgICB9XG5cbiAgICAgIGlmICghaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgdmFsdWUgPSBbdmFsdWVdO1xuICAgICAgfVxuXG4gICAgICBkYXRhW25hbWVdID0gKGRhdGFbbmFtZV0gfHwgW10pLmNvbmNhdCh2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1VSSS5hZGRRdWVyeSgpIGFjY2VwdHMgYW4gb2JqZWN0LCBzdHJpbmcgYXMgdGhlIG5hbWUgcGFyYW1ldGVyJyk7XG4gICAgfVxuICB9O1xuXG4gIFVSSS5zZXRRdWVyeSA9IGZ1bmN0aW9uKGRhdGEsIG5hbWUsIHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiBuYW1lID09PSAnb2JqZWN0Jykge1xuICAgICAgZm9yICh2YXIga2V5IGluIG5hbWUpIHtcbiAgICAgICAgaWYgKGhhc093bi5jYWxsKG5hbWUsIGtleSkpIHtcbiAgICAgICAgICBVUkkuc2V0UXVlcnkoZGF0YSwga2V5LCBuYW1lW2tleV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGRhdGFbbmFtZV0gPSB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IHZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdVUkkuc2V0UXVlcnkoKSBhY2NlcHRzIGFuIG9iamVjdCwgc3RyaW5nIGFzIHRoZSBuYW1lIHBhcmFtZXRlcicpO1xuICAgIH1cbiAgfTtcblxuICBVUkkucmVtb3ZlUXVlcnkgPSBmdW5jdGlvbihkYXRhLCBuYW1lLCB2YWx1ZSkge1xuICAgIHZhciBpLCBsZW5ndGgsIGtleTtcblxuICAgIGlmIChpc0FycmF5KG5hbWUpKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBuYW1lLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGRhdGFbbmFtZVtpXV0gPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChnZXRUeXBlKG5hbWUpID09PSAnUmVnRXhwJykge1xuICAgICAgZm9yIChrZXkgaW4gZGF0YSkge1xuICAgICAgICBpZiAobmFtZS50ZXN0KGtleSkpIHtcbiAgICAgICAgICBkYXRhW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBuYW1lID09PSAnb2JqZWN0Jykge1xuICAgICAgZm9yIChrZXkgaW4gbmFtZSkge1xuICAgICAgICBpZiAoaGFzT3duLmNhbGwobmFtZSwga2V5KSkge1xuICAgICAgICAgIFVSSS5yZW1vdmVRdWVyeShkYXRhLCBrZXksIG5hbWVba2V5XSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKGdldFR5cGUodmFsdWUpID09PSAnUmVnRXhwJykge1xuICAgICAgICAgIGlmICghaXNBcnJheShkYXRhW25hbWVdKSAmJiB2YWx1ZS50ZXN0KGRhdGFbbmFtZV0pKSB7XG4gICAgICAgICAgICBkYXRhW25hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkYXRhW25hbWVdID0gZmlsdGVyQXJyYXlWYWx1ZXMoZGF0YVtuYW1lXSwgdmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhW25hbWVdID09PSBTdHJpbmcodmFsdWUpICYmICghaXNBcnJheSh2YWx1ZSkgfHwgdmFsdWUubGVuZ3RoID09PSAxKSkge1xuICAgICAgICAgIGRhdGFbbmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNBcnJheShkYXRhW25hbWVdKSkge1xuICAgICAgICAgIGRhdGFbbmFtZV0gPSBmaWx0ZXJBcnJheVZhbHVlcyhkYXRhW25hbWVdLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRhdGFbbmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1VSSS5yZW1vdmVRdWVyeSgpIGFjY2VwdHMgYW4gb2JqZWN0LCBzdHJpbmcsIFJlZ0V4cCBhcyB0aGUgZmlyc3QgcGFyYW1ldGVyJyk7XG4gICAgfVxuICB9O1xuICBVUkkuaGFzUXVlcnkgPSBmdW5jdGlvbihkYXRhLCBuYW1lLCB2YWx1ZSwgd2l0aGluQXJyYXkpIHtcbiAgICBzd2l0Y2ggKGdldFR5cGUobmFtZSkpIHtcbiAgICAgIGNhc2UgJ1N0cmluZyc6XG4gICAgICAgIC8vIE5vdGhpbmcgdG8gZG8gaGVyZVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnUmVnRXhwJzpcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGRhdGEpIHtcbiAgICAgICAgICBpZiAoaGFzT3duLmNhbGwoZGF0YSwga2V5KSkge1xuICAgICAgICAgICAgaWYgKG5hbWUudGVzdChrZXkpICYmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IFVSSS5oYXNRdWVyeShkYXRhLCBrZXksIHZhbHVlKSkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICBjYXNlICdPYmplY3QnOlxuICAgICAgICBmb3IgKHZhciBfa2V5IGluIG5hbWUpIHtcbiAgICAgICAgICBpZiAoaGFzT3duLmNhbGwobmFtZSwgX2tleSkpIHtcbiAgICAgICAgICAgIGlmICghVVJJLmhhc1F1ZXJ5KGRhdGEsIF9rZXksIG5hbWVbX2tleV0pKSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVVJJLmhhc1F1ZXJ5KCkgYWNjZXB0cyBhIHN0cmluZywgcmVndWxhciBleHByZXNzaW9uIG9yIG9iamVjdCBhcyB0aGUgbmFtZSBwYXJhbWV0ZXInKTtcbiAgICB9XG5cbiAgICBzd2l0Y2ggKGdldFR5cGUodmFsdWUpKSB7XG4gICAgICBjYXNlICdVbmRlZmluZWQnOlxuICAgICAgICAvLyB0cnVlIGlmIGV4aXN0cyAoYnV0IG1heSBiZSBlbXB0eSlcbiAgICAgICAgcmV0dXJuIG5hbWUgaW4gZGF0YTsgLy8gZGF0YVtuYW1lXSAhPT0gdW5kZWZpbmVkO1xuXG4gICAgICBjYXNlICdCb29sZWFuJzpcbiAgICAgICAgLy8gdHJ1ZSBpZiBleGlzdHMgYW5kIG5vbi1lbXB0eVxuICAgICAgICB2YXIgX2Jvb2x5ID0gQm9vbGVhbihpc0FycmF5KGRhdGFbbmFtZV0pID8gZGF0YVtuYW1lXS5sZW5ndGggOiBkYXRhW25hbWVdKTtcbiAgICAgICAgcmV0dXJuIHZhbHVlID09PSBfYm9vbHk7XG5cbiAgICAgIGNhc2UgJ0Z1bmN0aW9uJzpcbiAgICAgICAgLy8gYWxsb3cgY29tcGxleCBjb21wYXJpc29uXG4gICAgICAgIHJldHVybiAhIXZhbHVlKGRhdGFbbmFtZV0sIG5hbWUsIGRhdGEpO1xuXG4gICAgICBjYXNlICdBcnJheSc6XG4gICAgICAgIGlmICghaXNBcnJheShkYXRhW25hbWVdKSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBvcCA9IHdpdGhpbkFycmF5ID8gYXJyYXlDb250YWlucyA6IGFycmF5c0VxdWFsO1xuICAgICAgICByZXR1cm4gb3AoZGF0YVtuYW1lXSwgdmFsdWUpO1xuXG4gICAgICBjYXNlICdSZWdFeHAnOlxuICAgICAgICBpZiAoIWlzQXJyYXkoZGF0YVtuYW1lXSkpIHtcbiAgICAgICAgICByZXR1cm4gQm9vbGVhbihkYXRhW25hbWVdICYmIGRhdGFbbmFtZV0ubWF0Y2godmFsdWUpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghd2l0aGluQXJyYXkpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYXJyYXlDb250YWlucyhkYXRhW25hbWVdLCB2YWx1ZSk7XG5cbiAgICAgIGNhc2UgJ051bWJlcic6XG4gICAgICAgIHZhbHVlID0gU3RyaW5nKHZhbHVlKTtcbiAgICAgICAgLyogZmFsbHMgdGhyb3VnaCAqL1xuICAgICAgY2FzZSAnU3RyaW5nJzpcbiAgICAgICAgaWYgKCFpc0FycmF5KGRhdGFbbmFtZV0pKSB7XG4gICAgICAgICAgcmV0dXJuIGRhdGFbbmFtZV0gPT09IHZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF3aXRoaW5BcnJheSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhcnJheUNvbnRhaW5zKGRhdGFbbmFtZV0sIHZhbHVlKTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVVJJLmhhc1F1ZXJ5KCkgYWNjZXB0cyB1bmRlZmluZWQsIGJvb2xlYW4sIHN0cmluZywgbnVtYmVyLCBSZWdFeHAsIEZ1bmN0aW9uIGFzIHRoZSB2YWx1ZSBwYXJhbWV0ZXInKTtcbiAgICB9XG4gIH07XG5cblxuICBVUkkuam9pblBhdGhzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGlucHV0ID0gW107XG4gICAgdmFyIHNlZ21lbnRzID0gW107XG4gICAgdmFyIG5vbkVtcHR5U2VnbWVudHMgPSAwO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciB1cmwgPSBuZXcgVVJJKGFyZ3VtZW50c1tpXSk7XG4gICAgICBpbnB1dC5wdXNoKHVybCk7XG4gICAgICB2YXIgX3NlZ21lbnRzID0gdXJsLnNlZ21lbnQoKTtcbiAgICAgIGZvciAodmFyIHMgPSAwOyBzIDwgX3NlZ21lbnRzLmxlbmd0aDsgcysrKSB7XG4gICAgICAgIGlmICh0eXBlb2YgX3NlZ21lbnRzW3NdID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHNlZ21lbnRzLnB1c2goX3NlZ21lbnRzW3NdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChfc2VnbWVudHNbc10pIHtcbiAgICAgICAgICBub25FbXB0eVNlZ21lbnRzKys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXNlZ21lbnRzLmxlbmd0aCB8fCAhbm9uRW1wdHlTZWdtZW50cykge1xuICAgICAgcmV0dXJuIG5ldyBVUkkoJycpO1xuICAgIH1cblxuICAgIHZhciB1cmkgPSBuZXcgVVJJKCcnKS5zZWdtZW50KHNlZ21lbnRzKTtcblxuICAgIGlmIChpbnB1dFswXS5wYXRoKCkgPT09ICcnIHx8IGlucHV0WzBdLnBhdGgoKS5zbGljZSgwLCAxKSA9PT0gJy8nKSB7XG4gICAgICB1cmkucGF0aCgnLycgKyB1cmkucGF0aCgpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdXJpLm5vcm1hbGl6ZSgpO1xuICB9O1xuXG4gIFVSSS5jb21tb25QYXRoID0gZnVuY3Rpb24ob25lLCB0d28pIHtcbiAgICB2YXIgbGVuZ3RoID0gTWF0aC5taW4ob25lLmxlbmd0aCwgdHdvLmxlbmd0aCk7XG4gICAgdmFyIHBvcztcblxuICAgIC8vIGZpbmQgZmlyc3Qgbm9uLW1hdGNoaW5nIGNoYXJhY3RlclxuICAgIGZvciAocG9zID0gMDsgcG9zIDwgbGVuZ3RoOyBwb3MrKykge1xuICAgICAgaWYgKG9uZS5jaGFyQXQocG9zKSAhPT0gdHdvLmNoYXJBdChwb3MpKSB7XG4gICAgICAgIHBvcy0tO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocG9zIDwgMSkge1xuICAgICAgcmV0dXJuIG9uZS5jaGFyQXQoMCkgPT09IHR3by5jaGFyQXQoMCkgJiYgb25lLmNoYXJBdCgwKSA9PT0gJy8nID8gJy8nIDogJyc7XG4gICAgfVxuXG4gICAgLy8gcmV2ZXJ0IHRvIGxhc3QgL1xuICAgIGlmIChvbmUuY2hhckF0KHBvcykgIT09ICcvJyB8fCB0d28uY2hhckF0KHBvcykgIT09ICcvJykge1xuICAgICAgcG9zID0gb25lLnN1YnN0cmluZygwLCBwb3MpLmxhc3RJbmRleE9mKCcvJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9uZS5zdWJzdHJpbmcoMCwgcG9zICsgMSk7XG4gIH07XG5cbiAgVVJJLndpdGhpblN0cmluZyA9IGZ1bmN0aW9uKHN0cmluZywgY2FsbGJhY2ssIG9wdGlvbnMpIHtcbiAgICBvcHRpb25zIHx8IChvcHRpb25zID0ge30pO1xuICAgIHZhciBfc3RhcnQgPSBvcHRpb25zLnN0YXJ0IHx8IFVSSS5maW5kVXJpLnN0YXJ0O1xuICAgIHZhciBfZW5kID0gb3B0aW9ucy5lbmQgfHwgVVJJLmZpbmRVcmkuZW5kO1xuICAgIHZhciBfdHJpbSA9IG9wdGlvbnMudHJpbSB8fCBVUkkuZmluZFVyaS50cmltO1xuICAgIHZhciBfcGFyZW5zID0gb3B0aW9ucy5wYXJlbnMgfHwgVVJJLmZpbmRVcmkucGFyZW5zO1xuICAgIHZhciBfYXR0cmlidXRlT3BlbiA9IC9bYS16MC05LV09W1wiJ10/JC9pO1xuXG4gICAgX3N0YXJ0Lmxhc3RJbmRleCA9IDA7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIHZhciBtYXRjaCA9IF9zdGFydC5leGVjKHN0cmluZyk7XG4gICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICB2YXIgc3RhcnQgPSBtYXRjaC5pbmRleDtcbiAgICAgIGlmIChvcHRpb25zLmlnbm9yZUh0bWwpIHtcbiAgICAgICAgLy8gYXR0cmlidXQoZT1bXCInXT8kKVxuICAgICAgICB2YXIgYXR0cmlidXRlT3BlbiA9IHN0cmluZy5zbGljZShNYXRoLm1heChzdGFydCAtIDMsIDApLCBzdGFydCk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVPcGVuICYmIF9hdHRyaWJ1dGVPcGVuLnRlc3QoYXR0cmlidXRlT3BlbikpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIgZW5kID0gc3RhcnQgKyBzdHJpbmcuc2xpY2Uoc3RhcnQpLnNlYXJjaChfZW5kKTtcbiAgICAgIHZhciBzbGljZSA9IHN0cmluZy5zbGljZShzdGFydCwgZW5kKTtcbiAgICAgIC8vIG1ha2Ugc3VyZSB3ZSBpbmNsdWRlIHdlbGwgYmFsYW5jZWQgcGFyZW5zXG4gICAgICB2YXIgcGFyZW5zRW5kID0gLTE7XG4gICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgcGFyZW5zTWF0Y2ggPSBfcGFyZW5zLmV4ZWMoc2xpY2UpO1xuICAgICAgICBpZiAoIXBhcmVuc01hdGNoKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcGFyZW5zTWF0Y2hFbmQgPSBwYXJlbnNNYXRjaC5pbmRleCArIHBhcmVuc01hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgcGFyZW5zRW5kID0gTWF0aC5tYXgocGFyZW5zRW5kLCBwYXJlbnNNYXRjaEVuZCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJlbnNFbmQgPiAtMSkge1xuICAgICAgICBzbGljZSA9IHNsaWNlLnNsaWNlKDAsIHBhcmVuc0VuZCkgKyBzbGljZS5zbGljZShwYXJlbnNFbmQpLnJlcGxhY2UoX3RyaW0sICcnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNsaWNlID0gc2xpY2UucmVwbGFjZShfdHJpbSwgJycpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2xpY2UubGVuZ3RoIDw9IG1hdGNoWzBdLmxlbmd0aCkge1xuICAgICAgICAvLyB0aGUgZXh0cmFjdCBvbmx5IGNvbnRhaW5zIHRoZSBzdGFydGluZyBtYXJrZXIgb2YgYSBVUkksXG4gICAgICAgIC8vIGUuZy4gXCJ3d3dcIiBvciBcImh0dHA6Ly9cIlxuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMuaWdub3JlICYmIG9wdGlvbnMuaWdub3JlLnRlc3Qoc2xpY2UpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBlbmQgPSBzdGFydCArIHNsaWNlLmxlbmd0aDtcbiAgICAgIHZhciByZXN1bHQgPSBjYWxsYmFjayhzbGljZSwgc3RhcnQsIGVuZCwgc3RyaW5nKTtcbiAgICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBfc3RhcnQubGFzdEluZGV4ID0gZW5kO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0ID0gU3RyaW5nKHJlc3VsdCk7XG4gICAgICBzdHJpbmcgPSBzdHJpbmcuc2xpY2UoMCwgc3RhcnQpICsgcmVzdWx0ICsgc3RyaW5nLnNsaWNlKGVuZCk7XG4gICAgICBfc3RhcnQubGFzdEluZGV4ID0gc3RhcnQgKyByZXN1bHQubGVuZ3RoO1xuICAgIH1cblxuICAgIF9zdGFydC5sYXN0SW5kZXggPSAwO1xuICAgIHJldHVybiBzdHJpbmc7XG4gIH07XG5cbiAgVVJJLmVuc3VyZVZhbGlkSG9zdG5hbWUgPSBmdW5jdGlvbih2LCBwcm90b2NvbCkge1xuICAgIC8vIFRoZW9yZXRpY2FsbHkgVVJJcyBhbGxvdyBwZXJjZW50LWVuY29kaW5nIGluIEhvc3RuYW1lcyAoYWNjb3JkaW5nIHRvIFJGQyAzOTg2KVxuICAgIC8vIHRoZXkgYXJlIG5vdCBwYXJ0IG9mIEROUyBhbmQgdGhlcmVmb3JlIGlnbm9yZWQgYnkgVVJJLmpzXG5cbiAgICB2YXIgaGFzSG9zdG5hbWUgPSAhIXY7IC8vIG5vdCBudWxsIGFuZCBub3QgYW4gZW1wdHkgc3RyaW5nXG4gICAgdmFyIGhhc1Byb3RvY29sID0gISFwcm90b2NvbDtcbiAgICB2YXIgcmVqZWN0RW1wdHlIb3N0bmFtZSA9IGZhbHNlO1xuXG4gICAgaWYgKGhhc1Byb3RvY29sKSB7XG4gICAgICByZWplY3RFbXB0eUhvc3RuYW1lID0gYXJyYXlDb250YWlucyhVUkkuaG9zdFByb3RvY29scywgcHJvdG9jb2wpO1xuICAgIH1cblxuICAgIGlmIChyZWplY3RFbXB0eUhvc3RuYW1lICYmICFoYXNIb3N0bmFtZSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSG9zdG5hbWUgY2Fubm90IGJlIGVtcHR5LCBpZiBwcm90b2NvbCBpcyAnICsgcHJvdG9jb2wpO1xuICAgIH0gZWxzZSBpZiAodiAmJiB2Lm1hdGNoKFVSSS5pbnZhbGlkX2hvc3RuYW1lX2NoYXJhY3RlcnMpKSB7XG4gICAgICAvLyB0ZXN0IHB1bnljb2RlXG4gICAgICBpZiAoIXB1bnljb2RlKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0hvc3RuYW1lIFwiJyArIHYgKyAnXCIgY29udGFpbnMgY2hhcmFjdGVycyBvdGhlciB0aGFuIFtBLVowLTkuLTpfXSBhbmQgUHVueWNvZGUuanMgaXMgbm90IGF2YWlsYWJsZScpO1xuICAgICAgfVxuICAgICAgaWYgKHB1bnljb2RlLnRvQVNDSUkodikubWF0Y2goVVJJLmludmFsaWRfaG9zdG5hbWVfY2hhcmFjdGVycykpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSG9zdG5hbWUgXCInICsgdiArICdcIiBjb250YWlucyBjaGFyYWN0ZXJzIG90aGVyIHRoYW4gW0EtWjAtOS4tOl9dJyk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIFVSSS5lbnN1cmVWYWxpZFBvcnQgPSBmdW5jdGlvbiAodikge1xuICAgIGlmICghdikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBwb3J0ID0gTnVtYmVyKHYpO1xuICAgIGlmIChpc0ludGVnZXIocG9ydCkgJiYgKHBvcnQgPiAwKSAmJiAocG9ydCA8IDY1NTM2KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1BvcnQgXCInICsgdiArICdcIiBpcyBub3QgYSB2YWxpZCBwb3J0Jyk7XG4gIH07XG5cbiAgLy8gbm9Db25mbGljdFxuICBVUkkubm9Db25mbGljdCA9IGZ1bmN0aW9uKHJlbW92ZUFsbCkge1xuICAgIGlmIChyZW1vdmVBbGwpIHtcbiAgICAgIHZhciB1bmNvbmZsaWN0ZWQgPSB7XG4gICAgICAgIFVSSTogdGhpcy5ub0NvbmZsaWN0KClcbiAgICAgIH07XG5cbiAgICAgIGlmIChyb290LlVSSVRlbXBsYXRlICYmIHR5cGVvZiByb290LlVSSVRlbXBsYXRlLm5vQ29uZmxpY3QgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdW5jb25mbGljdGVkLlVSSVRlbXBsYXRlID0gcm9vdC5VUklUZW1wbGF0ZS5ub0NvbmZsaWN0KCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChyb290LklQdjYgJiYgdHlwZW9mIHJvb3QuSVB2Ni5ub0NvbmZsaWN0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHVuY29uZmxpY3RlZC5JUHY2ID0gcm9vdC5JUHY2Lm5vQ29uZmxpY3QoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHJvb3QuU2Vjb25kTGV2ZWxEb21haW5zICYmIHR5cGVvZiByb290LlNlY29uZExldmVsRG9tYWlucy5ub0NvbmZsaWN0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHVuY29uZmxpY3RlZC5TZWNvbmRMZXZlbERvbWFpbnMgPSByb290LlNlY29uZExldmVsRG9tYWlucy5ub0NvbmZsaWN0KCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB1bmNvbmZsaWN0ZWQ7XG4gICAgfSBlbHNlIGlmIChyb290LlVSSSA9PT0gdGhpcykge1xuICAgICAgcm9vdC5VUkkgPSBfVVJJO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIHAuYnVpbGQgPSBmdW5jdGlvbihkZWZlckJ1aWxkKSB7XG4gICAgaWYgKGRlZmVyQnVpbGQgPT09IHRydWUpIHtcbiAgICAgIHRoaXMuX2RlZmVycmVkX2J1aWxkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGRlZmVyQnVpbGQgPT09IHVuZGVmaW5lZCB8fCB0aGlzLl9kZWZlcnJlZF9idWlsZCkge1xuICAgICAgdGhpcy5fc3RyaW5nID0gVVJJLmJ1aWxkKHRoaXMuX3BhcnRzKTtcbiAgICAgIHRoaXMuX2RlZmVycmVkX2J1aWxkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgcC5jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgVVJJKHRoaXMpO1xuICB9O1xuXG4gIHAudmFsdWVPZiA9IHAudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5idWlsZChmYWxzZSkuX3N0cmluZztcbiAgfTtcblxuXG4gIGZ1bmN0aW9uIGdlbmVyYXRlU2ltcGxlQWNjZXNzb3IoX3BhcnQpe1xuICAgIHJldHVybiBmdW5jdGlvbih2LCBidWlsZCkge1xuICAgICAgaWYgKHYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFydHNbX3BhcnRdIHx8ICcnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fcGFydHNbX3BhcnRdID0gdiB8fCBudWxsO1xuICAgICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBnZW5lcmF0ZVByZWZpeEFjY2Vzc29yKF9wYXJ0LCBfa2V5KXtcbiAgICByZXR1cm4gZnVuY3Rpb24odiwgYnVpbGQpIHtcbiAgICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhcnRzW19wYXJ0XSB8fCAnJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh2ICE9PSBudWxsKSB7XG4gICAgICAgICAgdiA9IHYgKyAnJztcbiAgICAgICAgICBpZiAodi5jaGFyQXQoMCkgPT09IF9rZXkpIHtcbiAgICAgICAgICAgIHYgPSB2LnN1YnN0cmluZygxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9wYXJ0c1tfcGFydF0gPSB2O1xuICAgICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBwLnByb3RvY29sID0gZ2VuZXJhdGVTaW1wbGVBY2Nlc3NvcigncHJvdG9jb2wnKTtcbiAgcC51c2VybmFtZSA9IGdlbmVyYXRlU2ltcGxlQWNjZXNzb3IoJ3VzZXJuYW1lJyk7XG4gIHAucGFzc3dvcmQgPSBnZW5lcmF0ZVNpbXBsZUFjY2Vzc29yKCdwYXNzd29yZCcpO1xuICBwLmhvc3RuYW1lID0gZ2VuZXJhdGVTaW1wbGVBY2Nlc3NvcignaG9zdG5hbWUnKTtcbiAgcC5wb3J0ID0gZ2VuZXJhdGVTaW1wbGVBY2Nlc3NvcigncG9ydCcpO1xuICBwLnF1ZXJ5ID0gZ2VuZXJhdGVQcmVmaXhBY2Nlc3NvcigncXVlcnknLCAnPycpO1xuICBwLmZyYWdtZW50ID0gZ2VuZXJhdGVQcmVmaXhBY2Nlc3NvcignZnJhZ21lbnQnLCAnIycpO1xuXG4gIHAuc2VhcmNoID0gZnVuY3Rpb24odiwgYnVpbGQpIHtcbiAgICB2YXIgdCA9IHRoaXMucXVlcnkodiwgYnVpbGQpO1xuICAgIHJldHVybiB0eXBlb2YgdCA9PT0gJ3N0cmluZycgJiYgdC5sZW5ndGggPyAoJz8nICsgdCkgOiB0O1xuICB9O1xuICBwLmhhc2ggPSBmdW5jdGlvbih2LCBidWlsZCkge1xuICAgIHZhciB0ID0gdGhpcy5mcmFnbWVudCh2LCBidWlsZCk7XG4gICAgcmV0dXJuIHR5cGVvZiB0ID09PSAnc3RyaW5nJyAmJiB0Lmxlbmd0aCA/ICgnIycgKyB0KSA6IHQ7XG4gIH07XG5cbiAgcC5wYXRobmFtZSA9IGZ1bmN0aW9uKHYsIGJ1aWxkKSB7XG4gICAgaWYgKHYgPT09IHVuZGVmaW5lZCB8fCB2ID09PSB0cnVlKSB7XG4gICAgICB2YXIgcmVzID0gdGhpcy5fcGFydHMucGF0aCB8fCAodGhpcy5fcGFydHMuaG9zdG5hbWUgPyAnLycgOiAnJyk7XG4gICAgICByZXR1cm4gdiA/ICh0aGlzLl9wYXJ0cy51cm4gPyBVUkkuZGVjb2RlVXJuUGF0aCA6IFVSSS5kZWNvZGVQYXRoKShyZXMpIDogcmVzO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7XG4gICAgICAgIHRoaXMuX3BhcnRzLnBhdGggPSB2ID8gVVJJLnJlY29kZVVyblBhdGgodikgOiAnJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3BhcnRzLnBhdGggPSB2ID8gVVJJLnJlY29kZVBhdGgodikgOiAnLyc7XG4gICAgICB9XG4gICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH07XG4gIHAucGF0aCA9IHAucGF0aG5hbWU7XG4gIHAuaHJlZiA9IGZ1bmN0aW9uKGhyZWYsIGJ1aWxkKSB7XG4gICAgdmFyIGtleTtcblxuICAgIGlmIChocmVmID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiB0aGlzLnRvU3RyaW5nKCk7XG4gICAgfVxuXG4gICAgdGhpcy5fc3RyaW5nID0gJyc7XG4gICAgdGhpcy5fcGFydHMgPSBVUkkuX3BhcnRzKCk7XG5cbiAgICB2YXIgX1VSSSA9IGhyZWYgaW5zdGFuY2VvZiBVUkk7XG4gICAgdmFyIF9vYmplY3QgPSB0eXBlb2YgaHJlZiA9PT0gJ29iamVjdCcgJiYgKGhyZWYuaG9zdG5hbWUgfHwgaHJlZi5wYXRoIHx8IGhyZWYucGF0aG5hbWUpO1xuICAgIGlmIChocmVmLm5vZGVOYW1lKSB7XG4gICAgICB2YXIgYXR0cmlidXRlID0gVVJJLmdldERvbUF0dHJpYnV0ZShocmVmKTtcbiAgICAgIGhyZWYgPSBocmVmW2F0dHJpYnV0ZV0gfHwgJyc7XG4gICAgICBfb2JqZWN0ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gd2luZG93LmxvY2F0aW9uIGlzIHJlcG9ydGVkIHRvIGJlIGFuIG9iamVjdCwgYnV0IGl0J3Mgbm90IHRoZSBzb3J0XG4gICAgLy8gb2Ygb2JqZWN0IHdlJ3JlIGxvb2tpbmcgZm9yOlxuICAgIC8vICogbG9jYXRpb24ucHJvdG9jb2wgZW5kcyB3aXRoIGEgY29sb25cbiAgICAvLyAqIGxvY2F0aW9uLnF1ZXJ5ICE9IG9iamVjdC5zZWFyY2hcbiAgICAvLyAqIGxvY2F0aW9uLmhhc2ggIT0gb2JqZWN0LmZyYWdtZW50XG4gICAgLy8gc2ltcGx5IHNlcmlhbGl6aW5nIHRoZSB1bmtub3duIG9iamVjdCBzaG91bGQgZG8gdGhlIHRyaWNrXG4gICAgLy8gKGZvciBsb2NhdGlvbiwgbm90IGZvciBldmVyeXRoaW5nLi4uKVxuICAgIGlmICghX1VSSSAmJiBfb2JqZWN0ICYmIGhyZWYucGF0aG5hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaHJlZiA9IGhyZWYudG9TdHJpbmcoKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGhyZWYgPT09ICdzdHJpbmcnIHx8IGhyZWYgaW5zdGFuY2VvZiBTdHJpbmcpIHtcbiAgICAgIHRoaXMuX3BhcnRzID0gVVJJLnBhcnNlKFN0cmluZyhocmVmKSwgdGhpcy5fcGFydHMpO1xuICAgIH0gZWxzZSBpZiAoX1VSSSB8fCBfb2JqZWN0KSB7XG4gICAgICB2YXIgc3JjID0gX1VSSSA/IGhyZWYuX3BhcnRzIDogaHJlZjtcbiAgICAgIGZvciAoa2V5IGluIHNyYykge1xuICAgICAgICBpZiAoa2V5ID09PSAncXVlcnknKSB7IGNvbnRpbnVlOyB9XG4gICAgICAgIGlmIChoYXNPd24uY2FsbCh0aGlzLl9wYXJ0cywga2V5KSkge1xuICAgICAgICAgIHRoaXMuX3BhcnRzW2tleV0gPSBzcmNba2V5XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHNyYy5xdWVyeSkge1xuICAgICAgICB0aGlzLnF1ZXJ5KHNyYy5xdWVyeSwgZmFsc2UpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnZhbGlkIGlucHV0Jyk7XG4gICAgfVxuXG4gICAgdGhpcy5idWlsZCghYnVpbGQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8vIGlkZW50aWZpY2F0aW9uIGFjY2Vzc29yc1xuICBwLmlzID0gZnVuY3Rpb24od2hhdCkge1xuICAgIHZhciBpcCA9IGZhbHNlO1xuICAgIHZhciBpcDQgPSBmYWxzZTtcbiAgICB2YXIgaXA2ID0gZmFsc2U7XG4gICAgdmFyIG5hbWUgPSBmYWxzZTtcbiAgICB2YXIgc2xkID0gZmFsc2U7XG4gICAgdmFyIGlkbiA9IGZhbHNlO1xuICAgIHZhciBwdW55Y29kZSA9IGZhbHNlO1xuICAgIHZhciByZWxhdGl2ZSA9ICF0aGlzLl9wYXJ0cy51cm47XG5cbiAgICBpZiAodGhpcy5fcGFydHMuaG9zdG5hbWUpIHtcbiAgICAgIHJlbGF0aXZlID0gZmFsc2U7XG4gICAgICBpcDQgPSBVUkkuaXA0X2V4cHJlc3Npb24udGVzdCh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7XG4gICAgICBpcDYgPSBVUkkuaXA2X2V4cHJlc3Npb24udGVzdCh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7XG4gICAgICBpcCA9IGlwNCB8fCBpcDY7XG4gICAgICBuYW1lID0gIWlwO1xuICAgICAgc2xkID0gbmFtZSAmJiBTTEQgJiYgU0xELmhhcyh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7XG4gICAgICBpZG4gPSBuYW1lICYmIFVSSS5pZG5fZXhwcmVzc2lvbi50ZXN0KHRoaXMuX3BhcnRzLmhvc3RuYW1lKTtcbiAgICAgIHB1bnljb2RlID0gbmFtZSAmJiBVUkkucHVueWNvZGVfZXhwcmVzc2lvbi50ZXN0KHRoaXMuX3BhcnRzLmhvc3RuYW1lKTtcbiAgICB9XG5cbiAgICBzd2l0Y2ggKHdoYXQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgY2FzZSAncmVsYXRpdmUnOlxuICAgICAgICByZXR1cm4gcmVsYXRpdmU7XG5cbiAgICAgIGNhc2UgJ2Fic29sdXRlJzpcbiAgICAgICAgcmV0dXJuICFyZWxhdGl2ZTtcblxuICAgICAgLy8gaG9zdG5hbWUgaWRlbnRpZmljYXRpb25cbiAgICAgIGNhc2UgJ2RvbWFpbic6XG4gICAgICBjYXNlICduYW1lJzpcbiAgICAgICAgcmV0dXJuIG5hbWU7XG5cbiAgICAgIGNhc2UgJ3NsZCc6XG4gICAgICAgIHJldHVybiBzbGQ7XG5cbiAgICAgIGNhc2UgJ2lwJzpcbiAgICAgICAgcmV0dXJuIGlwO1xuXG4gICAgICBjYXNlICdpcDQnOlxuICAgICAgY2FzZSAnaXB2NCc6XG4gICAgICBjYXNlICdpbmV0NCc6XG4gICAgICAgIHJldHVybiBpcDQ7XG5cbiAgICAgIGNhc2UgJ2lwNic6XG4gICAgICBjYXNlICdpcHY2JzpcbiAgICAgIGNhc2UgJ2luZXQ2JzpcbiAgICAgICAgcmV0dXJuIGlwNjtcblxuICAgICAgY2FzZSAnaWRuJzpcbiAgICAgICAgcmV0dXJuIGlkbjtcblxuICAgICAgY2FzZSAndXJsJzpcbiAgICAgICAgcmV0dXJuICF0aGlzLl9wYXJ0cy51cm47XG5cbiAgICAgIGNhc2UgJ3Vybic6XG4gICAgICAgIHJldHVybiAhIXRoaXMuX3BhcnRzLnVybjtcblxuICAgICAgY2FzZSAncHVueWNvZGUnOlxuICAgICAgICByZXR1cm4gcHVueWNvZGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgLy8gY29tcG9uZW50IHNwZWNpZmljIGlucHV0IHZhbGlkYXRpb25cbiAgdmFyIF9wcm90b2NvbCA9IHAucHJvdG9jb2w7XG4gIHZhciBfcG9ydCA9IHAucG9ydDtcbiAgdmFyIF9ob3N0bmFtZSA9IHAuaG9zdG5hbWU7XG5cbiAgcC5wcm90b2NvbCA9IGZ1bmN0aW9uKHYsIGJ1aWxkKSB7XG4gICAgaWYgKHYpIHtcbiAgICAgIC8vIGFjY2VwdCB0cmFpbGluZyA6Ly9cbiAgICAgIHYgPSB2LnJlcGxhY2UoLzooXFwvXFwvKT8kLywgJycpO1xuXG4gICAgICBpZiAoIXYubWF0Y2goVVJJLnByb3RvY29sX2V4cHJlc3Npb24pKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Byb3RvY29sIFwiJyArIHYgKyAnXCIgY29udGFpbnMgY2hhcmFjdGVycyBvdGhlciB0aGFuIFtBLVowLTkuKy1dIG9yIGRvZXNuXFwndCBzdGFydCB3aXRoIFtBLVpdJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIF9wcm90b2NvbC5jYWxsKHRoaXMsIHYsIGJ1aWxkKTtcbiAgfTtcbiAgcC5zY2hlbWUgPSBwLnByb3RvY29sO1xuICBwLnBvcnQgPSBmdW5jdGlvbih2LCBidWlsZCkge1xuICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHtcbiAgICAgIHJldHVybiB2ID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXM7XG4gICAgfVxuXG4gICAgaWYgKHYgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKHYgPT09IDApIHtcbiAgICAgICAgdiA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIGlmICh2KSB7XG4gICAgICAgIHYgKz0gJyc7XG4gICAgICAgIGlmICh2LmNoYXJBdCgwKSA9PT0gJzonKSB7XG4gICAgICAgICAgdiA9IHYuc3Vic3RyaW5nKDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgVVJJLmVuc3VyZVZhbGlkUG9ydCh2KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIF9wb3J0LmNhbGwodGhpcywgdiwgYnVpbGQpO1xuICB9O1xuICBwLmhvc3RuYW1lID0gZnVuY3Rpb24odiwgYnVpbGQpIHtcbiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7XG4gICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzO1xuICAgIH1cblxuICAgIGlmICh2ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHZhciB4ID0geyBwcmV2ZW50SW52YWxpZEhvc3RuYW1lOiB0aGlzLl9wYXJ0cy5wcmV2ZW50SW52YWxpZEhvc3RuYW1lIH07XG4gICAgICB2YXIgcmVzID0gVVJJLnBhcnNlSG9zdCh2LCB4KTtcbiAgICAgIGlmIChyZXMgIT09ICcvJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdIb3N0bmFtZSBcIicgKyB2ICsgJ1wiIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3RoZXIgdGhhbiBbQS1aMC05Li1dJyk7XG4gICAgICB9XG5cbiAgICAgIHYgPSB4Lmhvc3RuYW1lO1xuICAgICAgaWYgKHRoaXMuX3BhcnRzLnByZXZlbnRJbnZhbGlkSG9zdG5hbWUpIHtcbiAgICAgICAgVVJJLmVuc3VyZVZhbGlkSG9zdG5hbWUodiwgdGhpcy5fcGFydHMucHJvdG9jb2wpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBfaG9zdG5hbWUuY2FsbCh0aGlzLCB2LCBidWlsZCk7XG4gIH07XG5cbiAgLy8gY29tcG91bmQgYWNjZXNzb3JzXG4gIHAub3JpZ2luID0gZnVuY3Rpb24odiwgYnVpbGQpIHtcbiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7XG4gICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzO1xuICAgIH1cblxuICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHZhciBwcm90b2NvbCA9IHRoaXMucHJvdG9jb2woKTtcbiAgICAgIHZhciBhdXRob3JpdHkgPSB0aGlzLmF1dGhvcml0eSgpO1xuICAgICAgaWYgKCFhdXRob3JpdHkpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gKHByb3RvY29sID8gcHJvdG9jb2wgKyAnOi8vJyA6ICcnKSArIHRoaXMuYXV0aG9yaXR5KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBvcmlnaW4gPSBVUkkodik7XG4gICAgICB0aGlzXG4gICAgICAgIC5wcm90b2NvbChvcmlnaW4ucHJvdG9jb2woKSlcbiAgICAgICAgLmF1dGhvcml0eShvcmlnaW4uYXV0aG9yaXR5KCkpXG4gICAgICAgIC5idWlsZCghYnVpbGQpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9O1xuICBwLmhvc3QgPSBmdW5jdGlvbih2LCBidWlsZCkge1xuICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHtcbiAgICAgIHJldHVybiB2ID09PSB1bmRlZmluZWQgPyAnJyA6IHRoaXM7XG4gICAgfVxuXG4gICAgaWYgKHYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3BhcnRzLmhvc3RuYW1lID8gVVJJLmJ1aWxkSG9zdCh0aGlzLl9wYXJ0cykgOiAnJztcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHJlcyA9IFVSSS5wYXJzZUhvc3QodiwgdGhpcy5fcGFydHMpO1xuICAgICAgaWYgKHJlcyAhPT0gJy8nKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0hvc3RuYW1lIFwiJyArIHYgKyAnXCIgY29udGFpbnMgY2hhcmFjdGVycyBvdGhlciB0aGFuIFtBLVowLTkuLV0nKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5idWlsZCghYnVpbGQpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9O1xuICBwLmF1dGhvcml0eSA9IGZ1bmN0aW9uKHYsIGJ1aWxkKSB7XG4gICAgaWYgKHRoaXMuX3BhcnRzLnVybikge1xuICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpcztcbiAgICB9XG5cbiAgICBpZiAodiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcGFydHMuaG9zdG5hbWUgPyBVUkkuYnVpbGRBdXRob3JpdHkodGhpcy5fcGFydHMpIDogJyc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciByZXMgPSBVUkkucGFyc2VBdXRob3JpdHkodiwgdGhpcy5fcGFydHMpO1xuICAgICAgaWYgKHJlcyAhPT0gJy8nKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0hvc3RuYW1lIFwiJyArIHYgKyAnXCIgY29udGFpbnMgY2hhcmFjdGVycyBvdGhlciB0aGFuIFtBLVowLTkuLV0nKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5idWlsZCghYnVpbGQpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9O1xuICBwLnVzZXJpbmZvID0gZnVuY3Rpb24odiwgYnVpbGQpIHtcbiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7XG4gICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzO1xuICAgIH1cblxuICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHZhciB0ID0gVVJJLmJ1aWxkVXNlcmluZm8odGhpcy5fcGFydHMpO1xuICAgICAgcmV0dXJuIHQgPyB0LnN1YnN0cmluZygwLCB0Lmxlbmd0aCAtMSkgOiB0O1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodlt2Lmxlbmd0aC0xXSAhPT0gJ0AnKSB7XG4gICAgICAgIHYgKz0gJ0AnO1xuICAgICAgfVxuXG4gICAgICBVUkkucGFyc2VVc2VyaW5mbyh2LCB0aGlzLl9wYXJ0cyk7XG4gICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH07XG4gIHAucmVzb3VyY2UgPSBmdW5jdGlvbih2LCBidWlsZCkge1xuICAgIHZhciBwYXJ0cztcblxuICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiB0aGlzLnBhdGgoKSArIHRoaXMuc2VhcmNoKCkgKyB0aGlzLmhhc2goKTtcbiAgICB9XG5cbiAgICBwYXJ0cyA9IFVSSS5wYXJzZSh2KTtcbiAgICB0aGlzLl9wYXJ0cy5wYXRoID0gcGFydHMucGF0aDtcbiAgICB0aGlzLl9wYXJ0cy5xdWVyeSA9IHBhcnRzLnF1ZXJ5O1xuICAgIHRoaXMuX3BhcnRzLmZyYWdtZW50ID0gcGFydHMuZnJhZ21lbnQ7XG4gICAgdGhpcy5idWlsZCghYnVpbGQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8vIGZyYWN0aW9uIGFjY2Vzc29yc1xuICBwLnN1YmRvbWFpbiA9IGZ1bmN0aW9uKHYsIGJ1aWxkKSB7XG4gICAgaWYgKHRoaXMuX3BhcnRzLnVybikge1xuICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpcztcbiAgICB9XG5cbiAgICAvLyBjb252ZW5pZW5jZSwgcmV0dXJuIFwid3d3XCIgZnJvbSBcInd3dy5leGFtcGxlLm9yZ1wiXG4gICAgaWYgKHYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKCF0aGlzLl9wYXJ0cy5ob3N0bmFtZSB8fCB0aGlzLmlzKCdJUCcpKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cblxuICAgICAgLy8gZ3JhYiBkb21haW4gYW5kIGFkZCBhbm90aGVyIHNlZ21lbnRcbiAgICAgIHZhciBlbmQgPSB0aGlzLl9wYXJ0cy5ob3N0bmFtZS5sZW5ndGggLSB0aGlzLmRvbWFpbigpLmxlbmd0aCAtIDE7XG4gICAgICByZXR1cm4gdGhpcy5fcGFydHMuaG9zdG5hbWUuc3Vic3RyaW5nKDAsIGVuZCkgfHwgJyc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBlID0gdGhpcy5fcGFydHMuaG9zdG5hbWUubGVuZ3RoIC0gdGhpcy5kb21haW4oKS5sZW5ndGg7XG4gICAgICB2YXIgc3ViID0gdGhpcy5fcGFydHMuaG9zdG5hbWUuc3Vic3RyaW5nKDAsIGUpO1xuICAgICAgdmFyIHJlcGxhY2UgPSBuZXcgUmVnRXhwKCdeJyArIGVzY2FwZVJlZ0V4KHN1YikpO1xuXG4gICAgICBpZiAodiAmJiB2LmNoYXJBdCh2Lmxlbmd0aCAtIDEpICE9PSAnLicpIHtcbiAgICAgICAgdiArPSAnLic7XG4gICAgICB9XG5cbiAgICAgIGlmICh2LmluZGV4T2YoJzonKSAhPT0gLTEpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRG9tYWlucyBjYW5ub3QgY29udGFpbiBjb2xvbnMnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHYpIHtcbiAgICAgICAgVVJJLmVuc3VyZVZhbGlkSG9zdG5hbWUodiwgdGhpcy5fcGFydHMucHJvdG9jb2wpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9wYXJ0cy5ob3N0bmFtZSA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLnJlcGxhY2UocmVwbGFjZSwgdik7XG4gICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH07XG4gIHAuZG9tYWluID0gZnVuY3Rpb24odiwgYnVpbGQpIHtcbiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7XG4gICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgdiA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICBidWlsZCA9IHY7XG4gICAgICB2ID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8vIGNvbnZlbmllbmNlLCByZXR1cm4gXCJleGFtcGxlLm9yZ1wiIGZyb20gXCJ3d3cuZXhhbXBsZS5vcmdcIlxuICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmICghdGhpcy5fcGFydHMuaG9zdG5hbWUgfHwgdGhpcy5pcygnSVAnKSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIGhvc3RuYW1lIGNvbnNpc3RzIG9mIDEgb3IgMiBzZWdtZW50cywgaXQgbXVzdCBiZSB0aGUgZG9tYWluXG4gICAgICB2YXIgdCA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLm1hdGNoKC9cXC4vZyk7XG4gICAgICBpZiAodCAmJiB0Lmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhcnRzLmhvc3RuYW1lO1xuICAgICAgfVxuXG4gICAgICAvLyBncmFiIHRsZCBhbmQgYWRkIGFub3RoZXIgc2VnbWVudFxuICAgICAgdmFyIGVuZCA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLmxlbmd0aCAtIHRoaXMudGxkKGJ1aWxkKS5sZW5ndGggLSAxO1xuICAgICAgZW5kID0gdGhpcy5fcGFydHMuaG9zdG5hbWUubGFzdEluZGV4T2YoJy4nLCBlbmQgLTEpICsgMTtcbiAgICAgIHJldHVybiB0aGlzLl9wYXJ0cy5ob3N0bmFtZS5zdWJzdHJpbmcoZW5kKSB8fCAnJztcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCF2KSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2Nhbm5vdCBzZXQgZG9tYWluIGVtcHR5Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh2LmluZGV4T2YoJzonKSAhPT0gLTEpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRG9tYWlucyBjYW5ub3QgY29udGFpbiBjb2xvbnMnKTtcbiAgICAgIH1cblxuICAgICAgVVJJLmVuc3VyZVZhbGlkSG9zdG5hbWUodiwgdGhpcy5fcGFydHMucHJvdG9jb2wpO1xuXG4gICAgICBpZiAoIXRoaXMuX3BhcnRzLmhvc3RuYW1lIHx8IHRoaXMuaXMoJ0lQJykpIHtcbiAgICAgICAgdGhpcy5fcGFydHMuaG9zdG5hbWUgPSB2O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHJlcGxhY2UgPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4KHRoaXMuZG9tYWluKCkpICsgJyQnKTtcbiAgICAgICAgdGhpcy5fcGFydHMuaG9zdG5hbWUgPSB0aGlzLl9wYXJ0cy5ob3N0bmFtZS5yZXBsYWNlKHJlcGxhY2UsIHYpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH07XG4gIHAudGxkID0gZnVuY3Rpb24odiwgYnVpbGQpIHtcbiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7XG4gICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgdiA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICBidWlsZCA9IHY7XG4gICAgICB2ID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8vIHJldHVybiBcIm9yZ1wiIGZyb20gXCJ3d3cuZXhhbXBsZS5vcmdcIlxuICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmICghdGhpcy5fcGFydHMuaG9zdG5hbWUgfHwgdGhpcy5pcygnSVAnKSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG5cbiAgICAgIHZhciBwb3MgPSB0aGlzLl9wYXJ0cy5ob3N0bmFtZS5sYXN0SW5kZXhPZignLicpO1xuICAgICAgdmFyIHRsZCA9IHRoaXMuX3BhcnRzLmhvc3RuYW1lLnN1YnN0cmluZyhwb3MgKyAxKTtcblxuICAgICAgaWYgKGJ1aWxkICE9PSB0cnVlICYmIFNMRCAmJiBTTEQubGlzdFt0bGQudG9Mb3dlckNhc2UoKV0pIHtcbiAgICAgICAgcmV0dXJuIFNMRC5nZXQodGhpcy5fcGFydHMuaG9zdG5hbWUpIHx8IHRsZDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRsZDtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHJlcGxhY2U7XG5cbiAgICAgIGlmICghdikge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdjYW5ub3Qgc2V0IFRMRCBlbXB0eScpO1xuICAgICAgfSBlbHNlIGlmICh2Lm1hdGNoKC9bXmEtekEtWjAtOS1dLykpIHtcbiAgICAgICAgaWYgKFNMRCAmJiBTTEQuaXModikpIHtcbiAgICAgICAgICByZXBsYWNlID0gbmV3IFJlZ0V4cChlc2NhcGVSZWdFeCh0aGlzLnRsZCgpKSArICckJyk7XG4gICAgICAgICAgdGhpcy5fcGFydHMuaG9zdG5hbWUgPSB0aGlzLl9wYXJ0cy5ob3N0bmFtZS5yZXBsYWNlKHJlcGxhY2UsIHYpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RMRCBcIicgKyB2ICsgJ1wiIGNvbnRhaW5zIGNoYXJhY3RlcnMgb3RoZXIgdGhhbiBbQS1aMC05XScpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKCF0aGlzLl9wYXJ0cy5ob3N0bmFtZSB8fCB0aGlzLmlzKCdJUCcpKSB7XG4gICAgICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcignY2Fubm90IHNldCBUTEQgb24gbm9uLWRvbWFpbiBob3N0Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXBsYWNlID0gbmV3IFJlZ0V4cChlc2NhcGVSZWdFeCh0aGlzLnRsZCgpKSArICckJyk7XG4gICAgICAgIHRoaXMuX3BhcnRzLmhvc3RuYW1lID0gdGhpcy5fcGFydHMuaG9zdG5hbWUucmVwbGFjZShyZXBsYWNlLCB2KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5idWlsZCghYnVpbGQpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9O1xuICBwLmRpcmVjdG9yeSA9IGZ1bmN0aW9uKHYsIGJ1aWxkKSB7XG4gICAgaWYgKHRoaXMuX3BhcnRzLnVybikge1xuICAgICAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpcztcbiAgICB9XG5cbiAgICBpZiAodiA9PT0gdW5kZWZpbmVkIHx8IHYgPT09IHRydWUpIHtcbiAgICAgIGlmICghdGhpcy5fcGFydHMucGF0aCAmJiAhdGhpcy5fcGFydHMuaG9zdG5hbWUpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5fcGFydHMucGF0aCA9PT0gJy8nKSB7XG4gICAgICAgIHJldHVybiAnLyc7XG4gICAgICB9XG5cbiAgICAgIHZhciBlbmQgPSB0aGlzLl9wYXJ0cy5wYXRoLmxlbmd0aCAtIHRoaXMuZmlsZW5hbWUoKS5sZW5ndGggLSAxO1xuICAgICAgdmFyIHJlcyA9IHRoaXMuX3BhcnRzLnBhdGguc3Vic3RyaW5nKDAsIGVuZCkgfHwgKHRoaXMuX3BhcnRzLmhvc3RuYW1lID8gJy8nIDogJycpO1xuXG4gICAgICByZXR1cm4gdiA/IFVSSS5kZWNvZGVQYXRoKHJlcykgOiByZXM7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGUgPSB0aGlzLl9wYXJ0cy5wYXRoLmxlbmd0aCAtIHRoaXMuZmlsZW5hbWUoKS5sZW5ndGg7XG4gICAgICB2YXIgZGlyZWN0b3J5ID0gdGhpcy5fcGFydHMucGF0aC5zdWJzdHJpbmcoMCwgZSk7XG4gICAgICB2YXIgcmVwbGFjZSA9IG5ldyBSZWdFeHAoJ14nICsgZXNjYXBlUmVnRXgoZGlyZWN0b3J5KSk7XG5cbiAgICAgIC8vIGZ1bGx5IHF1YWxpZmllciBkaXJlY3RvcmllcyBiZWdpbiB3aXRoIGEgc2xhc2hcbiAgICAgIGlmICghdGhpcy5pcygncmVsYXRpdmUnKSkge1xuICAgICAgICBpZiAoIXYpIHtcbiAgICAgICAgICB2ID0gJy8nO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHYuY2hhckF0KDApICE9PSAnLycpIHtcbiAgICAgICAgICB2ID0gJy8nICsgdjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBkaXJlY3RvcmllcyBhbHdheXMgZW5kIHdpdGggYSBzbGFzaFxuICAgICAgaWYgKHYgJiYgdi5jaGFyQXQodi5sZW5ndGggLSAxKSAhPT0gJy8nKSB7XG4gICAgICAgIHYgKz0gJy8nO1xuICAgICAgfVxuXG4gICAgICB2ID0gVVJJLnJlY29kZVBhdGgodik7XG4gICAgICB0aGlzLl9wYXJ0cy5wYXRoID0gdGhpcy5fcGFydHMucGF0aC5yZXBsYWNlKHJlcGxhY2UsIHYpO1xuICAgICAgdGhpcy5idWlsZCghYnVpbGQpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9O1xuICBwLmZpbGVuYW1lID0gZnVuY3Rpb24odiwgYnVpbGQpIHtcbiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7XG4gICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgdiAhPT0gJ3N0cmluZycpIHtcbiAgICAgIGlmICghdGhpcy5fcGFydHMucGF0aCB8fCB0aGlzLl9wYXJ0cy5wYXRoID09PSAnLycpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuXG4gICAgICB2YXIgcG9zID0gdGhpcy5fcGFydHMucGF0aC5sYXN0SW5kZXhPZignLycpO1xuICAgICAgdmFyIHJlcyA9IHRoaXMuX3BhcnRzLnBhdGguc3Vic3RyaW5nKHBvcysxKTtcblxuICAgICAgcmV0dXJuIHYgPyBVUkkuZGVjb2RlUGF0aFNlZ21lbnQocmVzKSA6IHJlcztcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIG11dGF0ZWREaXJlY3RvcnkgPSBmYWxzZTtcblxuICAgICAgaWYgKHYuY2hhckF0KDApID09PSAnLycpIHtcbiAgICAgICAgdiA9IHYuc3Vic3RyaW5nKDEpO1xuICAgICAgfVxuXG4gICAgICBpZiAodi5tYXRjaCgvXFwuP1xcLy8pKSB7XG4gICAgICAgIG11dGF0ZWREaXJlY3RvcnkgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVwbGFjZSA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXgodGhpcy5maWxlbmFtZSgpKSArICckJyk7XG4gICAgICB2ID0gVVJJLnJlY29kZVBhdGgodik7XG4gICAgICB0aGlzLl9wYXJ0cy5wYXRoID0gdGhpcy5fcGFydHMucGF0aC5yZXBsYWNlKHJlcGxhY2UsIHYpO1xuXG4gICAgICBpZiAobXV0YXRlZERpcmVjdG9yeSkge1xuICAgICAgICB0aGlzLm5vcm1hbGl6ZVBhdGgoYnVpbGQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5idWlsZCghYnVpbGQpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH07XG4gIHAuc3VmZml4ID0gZnVuY3Rpb24odiwgYnVpbGQpIHtcbiAgICBpZiAodGhpcy5fcGFydHMudXJuKSB7XG4gICAgICByZXR1cm4gdiA9PT0gdW5kZWZpbmVkID8gJycgOiB0aGlzO1xuICAgIH1cblxuICAgIGlmICh2ID09PSB1bmRlZmluZWQgfHwgdiA9PT0gdHJ1ZSkge1xuICAgICAgaWYgKCF0aGlzLl9wYXJ0cy5wYXRoIHx8IHRoaXMuX3BhcnRzLnBhdGggPT09ICcvJykge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG5cbiAgICAgIHZhciBmaWxlbmFtZSA9IHRoaXMuZmlsZW5hbWUoKTtcbiAgICAgIHZhciBwb3MgPSBmaWxlbmFtZS5sYXN0SW5kZXhPZignLicpO1xuICAgICAgdmFyIHMsIHJlcztcblxuICAgICAgaWYgKHBvcyA9PT0gLTEpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuXG4gICAgICAvLyBzdWZmaXggbWF5IG9ubHkgY29udGFpbiBhbG51bSBjaGFyYWN0ZXJzICh5dXAsIEkgbWFkZSB0aGlzIHVwLilcbiAgICAgIHMgPSBmaWxlbmFtZS5zdWJzdHJpbmcocG9zKzEpO1xuICAgICAgcmVzID0gKC9eW2EtejAtOSVdKyQvaSkudGVzdChzKSA/IHMgOiAnJztcbiAgICAgIHJldHVybiB2ID8gVVJJLmRlY29kZVBhdGhTZWdtZW50KHJlcykgOiByZXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh2LmNoYXJBdCgwKSA9PT0gJy4nKSB7XG4gICAgICAgIHYgPSB2LnN1YnN0cmluZygxKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHN1ZmZpeCA9IHRoaXMuc3VmZml4KCk7XG4gICAgICB2YXIgcmVwbGFjZTtcblxuICAgICAgaWYgKCFzdWZmaXgpIHtcbiAgICAgICAgaWYgKCF2KSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9wYXJ0cy5wYXRoICs9ICcuJyArIFVSSS5yZWNvZGVQYXRoKHYpO1xuICAgICAgfSBlbHNlIGlmICghdikge1xuICAgICAgICByZXBsYWNlID0gbmV3IFJlZ0V4cChlc2NhcGVSZWdFeCgnLicgKyBzdWZmaXgpICsgJyQnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcGxhY2UgPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4KHN1ZmZpeCkgKyAnJCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVwbGFjZSkge1xuICAgICAgICB2ID0gVVJJLnJlY29kZVBhdGgodik7XG4gICAgICAgIHRoaXMuX3BhcnRzLnBhdGggPSB0aGlzLl9wYXJ0cy5wYXRoLnJlcGxhY2UocmVwbGFjZSwgdik7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfTtcbiAgcC5zZWdtZW50ID0gZnVuY3Rpb24oc2VnbWVudCwgdiwgYnVpbGQpIHtcbiAgICB2YXIgc2VwYXJhdG9yID0gdGhpcy5fcGFydHMudXJuID8gJzonIDogJy8nO1xuICAgIHZhciBwYXRoID0gdGhpcy5wYXRoKCk7XG4gICAgdmFyIGFic29sdXRlID0gcGF0aC5zdWJzdHJpbmcoMCwgMSkgPT09ICcvJztcbiAgICB2YXIgc2VnbWVudHMgPSBwYXRoLnNwbGl0KHNlcGFyYXRvcik7XG5cbiAgICBpZiAoc2VnbWVudCAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBzZWdtZW50ICE9PSAnbnVtYmVyJykge1xuICAgICAgYnVpbGQgPSB2O1xuICAgICAgdiA9IHNlZ21lbnQ7XG4gICAgICBzZWdtZW50ID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGlmIChzZWdtZW50ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHNlZ21lbnQgIT09ICdudW1iZXInKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0JhZCBzZWdtZW50IFwiJyArIHNlZ21lbnQgKyAnXCIsIG11c3QgYmUgMC1iYXNlZCBpbnRlZ2VyJyk7XG4gICAgfVxuXG4gICAgaWYgKGFic29sdXRlKSB7XG4gICAgICBzZWdtZW50cy5zaGlmdCgpO1xuICAgIH1cblxuICAgIGlmIChzZWdtZW50IDwgMCkge1xuICAgICAgLy8gYWxsb3cgbmVnYXRpdmUgaW5kZXhlcyB0byBhZGRyZXNzIGZyb20gdGhlIGVuZFxuICAgICAgc2VnbWVudCA9IE1hdGgubWF4KHNlZ21lbnRzLmxlbmd0aCArIHNlZ21lbnQsIDApO1xuICAgIH1cblxuICAgIGlmICh2ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIC8qanNoaW50IGxheGJyZWFrOiB0cnVlICovXG4gICAgICByZXR1cm4gc2VnbWVudCA9PT0gdW5kZWZpbmVkXG4gICAgICAgID8gc2VnbWVudHNcbiAgICAgICAgOiBzZWdtZW50c1tzZWdtZW50XTtcbiAgICAgIC8qanNoaW50IGxheGJyZWFrOiBmYWxzZSAqL1xuICAgIH0gZWxzZSBpZiAoc2VnbWVudCA9PT0gbnVsbCB8fCBzZWdtZW50c1tzZWdtZW50XSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAoaXNBcnJheSh2KSkge1xuICAgICAgICBzZWdtZW50cyA9IFtdO1xuICAgICAgICAvLyBjb2xsYXBzZSBlbXB0eSBlbGVtZW50cyB3aXRoaW4gYXJyYXlcbiAgICAgICAgZm9yICh2YXIgaT0wLCBsPXYubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgaWYgKCF2W2ldLmxlbmd0aCAmJiAoIXNlZ21lbnRzLmxlbmd0aCB8fCAhc2VnbWVudHNbc2VnbWVudHMubGVuZ3RoIC0xXS5sZW5ndGgpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoc2VnbWVudHMubGVuZ3RoICYmICFzZWdtZW50c1tzZWdtZW50cy5sZW5ndGggLTFdLmxlbmd0aCkge1xuICAgICAgICAgICAgc2VnbWVudHMucG9wKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc2VnbWVudHMucHVzaCh0cmltU2xhc2hlcyh2W2ldKSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodiB8fCB0eXBlb2YgdiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdiA9IHRyaW1TbGFzaGVzKHYpO1xuICAgICAgICBpZiAoc2VnbWVudHNbc2VnbWVudHMubGVuZ3RoIC0xXSA9PT0gJycpIHtcbiAgICAgICAgICAvLyBlbXB0eSB0cmFpbGluZyBlbGVtZW50cyBoYXZlIHRvIGJlIG92ZXJ3cml0dGVuXG4gICAgICAgICAgLy8gdG8gcHJldmVudCByZXN1bHRzIHN1Y2ggYXMgL2Zvby8vYmFyXG4gICAgICAgICAgc2VnbWVudHNbc2VnbWVudHMubGVuZ3RoIC0xXSA9IHY7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2VnbWVudHMucHVzaCh2KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodikge1xuICAgICAgICBzZWdtZW50c1tzZWdtZW50XSA9IHRyaW1TbGFzaGVzKHYpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VnbWVudHMuc3BsaWNlKHNlZ21lbnQsIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChhYnNvbHV0ZSkge1xuICAgICAgc2VnbWVudHMudW5zaGlmdCgnJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucGF0aChzZWdtZW50cy5qb2luKHNlcGFyYXRvciksIGJ1aWxkKTtcbiAgfTtcbiAgcC5zZWdtZW50Q29kZWQgPSBmdW5jdGlvbihzZWdtZW50LCB2LCBidWlsZCkge1xuICAgIHZhciBzZWdtZW50cywgaSwgbDtcblxuICAgIGlmICh0eXBlb2Ygc2VnbWVudCAhPT0gJ251bWJlcicpIHtcbiAgICAgIGJ1aWxkID0gdjtcbiAgICAgIHYgPSBzZWdtZW50O1xuICAgICAgc2VnbWVudCA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBpZiAodiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBzZWdtZW50cyA9IHRoaXMuc2VnbWVudChzZWdtZW50LCB2LCBidWlsZCk7XG4gICAgICBpZiAoIWlzQXJyYXkoc2VnbWVudHMpKSB7XG4gICAgICAgIHNlZ21lbnRzID0gc2VnbWVudHMgIT09IHVuZGVmaW5lZCA/IFVSSS5kZWNvZGUoc2VnbWVudHMpIDogdW5kZWZpbmVkO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9yIChpID0gMCwgbCA9IHNlZ21lbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgIHNlZ21lbnRzW2ldID0gVVJJLmRlY29kZShzZWdtZW50c1tpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHNlZ21lbnRzO1xuICAgIH1cblxuICAgIGlmICghaXNBcnJheSh2KSkge1xuICAgICAgdiA9ICh0eXBlb2YgdiA9PT0gJ3N0cmluZycgfHwgdiBpbnN0YW5jZW9mIFN0cmluZykgPyBVUkkuZW5jb2RlKHYpIDogdjtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChpID0gMCwgbCA9IHYubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIHZbaV0gPSBVUkkuZW5jb2RlKHZbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnNlZ21lbnQoc2VnbWVudCwgdiwgYnVpbGQpO1xuICB9O1xuXG4gIC8vIG11dGF0aW5nIHF1ZXJ5IHN0cmluZ1xuICB2YXIgcSA9IHAucXVlcnk7XG4gIHAucXVlcnkgPSBmdW5jdGlvbih2LCBidWlsZCkge1xuICAgIGlmICh2ID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gVVJJLnBhcnNlUXVlcnkodGhpcy5fcGFydHMucXVlcnksIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHYgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHZhciBkYXRhID0gVVJJLnBhcnNlUXVlcnkodGhpcy5fcGFydHMucXVlcnksIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpO1xuICAgICAgdmFyIHJlc3VsdCA9IHYuY2FsbCh0aGlzLCBkYXRhKTtcbiAgICAgIHRoaXMuX3BhcnRzLnF1ZXJ5ID0gVVJJLmJ1aWxkUXVlcnkocmVzdWx0IHx8IGRhdGEsIHRoaXMuX3BhcnRzLmR1cGxpY2F0ZVF1ZXJ5UGFyYW1ldGVycywgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSk7XG4gICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9IGVsc2UgaWYgKHYgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgdiAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMuX3BhcnRzLnF1ZXJ5ID0gVVJJLmJ1aWxkUXVlcnkodiwgdGhpcy5fcGFydHMuZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzLCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKTtcbiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcS5jYWxsKHRoaXMsIHYsIGJ1aWxkKTtcbiAgICB9XG4gIH07XG4gIHAuc2V0UXVlcnkgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSwgYnVpbGQpIHtcbiAgICB2YXIgZGF0YSA9IFVSSS5wYXJzZVF1ZXJ5KHRoaXMuX3BhcnRzLnF1ZXJ5LCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKTtcblxuICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycgfHwgbmFtZSBpbnN0YW5jZW9mIFN0cmluZykge1xuICAgICAgZGF0YVtuYW1lXSA9IHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6IG51bGw7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbmFtZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGZvciAodmFyIGtleSBpbiBuYW1lKSB7XG4gICAgICAgIGlmIChoYXNPd24uY2FsbChuYW1lLCBrZXkpKSB7XG4gICAgICAgICAgZGF0YVtrZXldID0gbmFtZVtrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1VSSS5hZGRRdWVyeSgpIGFjY2VwdHMgYW4gb2JqZWN0LCBzdHJpbmcgYXMgdGhlIG5hbWUgcGFyYW1ldGVyJyk7XG4gICAgfVxuXG4gICAgdGhpcy5fcGFydHMucXVlcnkgPSBVUkkuYnVpbGRRdWVyeShkYXRhLCB0aGlzLl9wYXJ0cy5kdXBsaWNhdGVRdWVyeVBhcmFtZXRlcnMsIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpO1xuICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIGJ1aWxkID0gdmFsdWU7XG4gICAgfVxuXG4gICAgdGhpcy5idWlsZCghYnVpbGQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICBwLmFkZFF1ZXJ5ID0gZnVuY3Rpb24obmFtZSwgdmFsdWUsIGJ1aWxkKSB7XG4gICAgdmFyIGRhdGEgPSBVUkkucGFyc2VRdWVyeSh0aGlzLl9wYXJ0cy5xdWVyeSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSk7XG4gICAgVVJJLmFkZFF1ZXJ5KGRhdGEsIG5hbWUsIHZhbHVlID09PSB1bmRlZmluZWQgPyBudWxsIDogdmFsdWUpO1xuICAgIHRoaXMuX3BhcnRzLnF1ZXJ5ID0gVVJJLmJ1aWxkUXVlcnkoZGF0YSwgdGhpcy5fcGFydHMuZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzLCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKTtcbiAgICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICBidWlsZCA9IHZhbHVlO1xuICAgIH1cblxuICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgcC5yZW1vdmVRdWVyeSA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlLCBidWlsZCkge1xuICAgIHZhciBkYXRhID0gVVJJLnBhcnNlUXVlcnkodGhpcy5fcGFydHMucXVlcnksIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpO1xuICAgIFVSSS5yZW1vdmVRdWVyeShkYXRhLCBuYW1lLCB2YWx1ZSk7XG4gICAgdGhpcy5fcGFydHMucXVlcnkgPSBVUkkuYnVpbGRRdWVyeShkYXRhLCB0aGlzLl9wYXJ0cy5kdXBsaWNhdGVRdWVyeVBhcmFtZXRlcnMsIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpO1xuICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIGJ1aWxkID0gdmFsdWU7XG4gICAgfVxuXG4gICAgdGhpcy5idWlsZCghYnVpbGQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICBwLmhhc1F1ZXJ5ID0gZnVuY3Rpb24obmFtZSwgdmFsdWUsIHdpdGhpbkFycmF5KSB7XG4gICAgdmFyIGRhdGEgPSBVUkkucGFyc2VRdWVyeSh0aGlzLl9wYXJ0cy5xdWVyeSwgdGhpcy5fcGFydHMuZXNjYXBlUXVlcnlTcGFjZSk7XG4gICAgcmV0dXJuIFVSSS5oYXNRdWVyeShkYXRhLCBuYW1lLCB2YWx1ZSwgd2l0aGluQXJyYXkpO1xuICB9O1xuICBwLnNldFNlYXJjaCA9IHAuc2V0UXVlcnk7XG4gIHAuYWRkU2VhcmNoID0gcC5hZGRRdWVyeTtcbiAgcC5yZW1vdmVTZWFyY2ggPSBwLnJlbW92ZVF1ZXJ5O1xuICBwLmhhc1NlYXJjaCA9IHAuaGFzUXVlcnk7XG5cbiAgLy8gc2FuaXRpemluZyBVUkxzXG4gIHAubm9ybWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX3BhcnRzLnVybikge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgLm5vcm1hbGl6ZVByb3RvY29sKGZhbHNlKVxuICAgICAgICAubm9ybWFsaXplUGF0aChmYWxzZSlcbiAgICAgICAgLm5vcm1hbGl6ZVF1ZXJ5KGZhbHNlKVxuICAgICAgICAubm9ybWFsaXplRnJhZ21lbnQoZmFsc2UpXG4gICAgICAgIC5idWlsZCgpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzXG4gICAgICAubm9ybWFsaXplUHJvdG9jb2woZmFsc2UpXG4gICAgICAubm9ybWFsaXplSG9zdG5hbWUoZmFsc2UpXG4gICAgICAubm9ybWFsaXplUG9ydChmYWxzZSlcbiAgICAgIC5ub3JtYWxpemVQYXRoKGZhbHNlKVxuICAgICAgLm5vcm1hbGl6ZVF1ZXJ5KGZhbHNlKVxuICAgICAgLm5vcm1hbGl6ZUZyYWdtZW50KGZhbHNlKVxuICAgICAgLmJ1aWxkKCk7XG4gIH07XG4gIHAubm9ybWFsaXplUHJvdG9jb2wgPSBmdW5jdGlvbihidWlsZCkge1xuICAgIGlmICh0eXBlb2YgdGhpcy5fcGFydHMucHJvdG9jb2wgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0aGlzLl9wYXJ0cy5wcm90b2NvbCA9IHRoaXMuX3BhcnRzLnByb3RvY29sLnRvTG93ZXJDYXNlKCk7XG4gICAgICB0aGlzLmJ1aWxkKCFidWlsZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIHAubm9ybWFsaXplSG9zdG5hbWUgPSBmdW5jdGlvbihidWlsZCkge1xuICAgIGlmICh0aGlzLl9wYXJ0cy5ob3N0bmFtZSkge1xuICAgICAgaWYgKHRoaXMuaXMoJ0lETicpICYmIHB1bnljb2RlKSB7XG4gICAgICAgIHRoaXMuX3BhcnRzLmhvc3RuYW1lID0gcHVueWNvZGUudG9BU0NJSSh0aGlzLl9wYXJ0cy5ob3N0bmFtZSk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuaXMoJ0lQdjYnKSAmJiBJUHY2KSB7XG4gICAgICAgIHRoaXMuX3BhcnRzLmhvc3RuYW1lID0gSVB2Ni5iZXN0KHRoaXMuX3BhcnRzLmhvc3RuYW1lKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fcGFydHMuaG9zdG5hbWUgPSB0aGlzLl9wYXJ0cy5ob3N0bmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgdGhpcy5idWlsZCghYnVpbGQpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICBwLm5vcm1hbGl6ZVBvcnQgPSBmdW5jdGlvbihidWlsZCkge1xuICAgIC8vIHJlbW92ZSBwb3J0IG9mIGl0J3MgdGhlIHByb3RvY29sJ3MgZGVmYXVsdFxuICAgIGlmICh0eXBlb2YgdGhpcy5fcGFydHMucHJvdG9jb2wgPT09ICdzdHJpbmcnICYmIHRoaXMuX3BhcnRzLnBvcnQgPT09IFVSSS5kZWZhdWx0UG9ydHNbdGhpcy5fcGFydHMucHJvdG9jb2xdKSB7XG4gICAgICB0aGlzLl9wYXJ0cy5wb3J0ID0gbnVsbDtcbiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgcC5ub3JtYWxpemVQYXRoID0gZnVuY3Rpb24oYnVpbGQpIHtcbiAgICB2YXIgX3BhdGggPSB0aGlzLl9wYXJ0cy5wYXRoO1xuICAgIGlmICghX3BhdGgpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHtcbiAgICAgIHRoaXMuX3BhcnRzLnBhdGggPSBVUkkucmVjb2RlVXJuUGF0aCh0aGlzLl9wYXJ0cy5wYXRoKTtcbiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9wYXJ0cy5wYXRoID09PSAnLycpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIF9wYXRoID0gVVJJLnJlY29kZVBhdGgoX3BhdGgpO1xuXG4gICAgdmFyIF93YXNfcmVsYXRpdmU7XG4gICAgdmFyIF9sZWFkaW5nUGFyZW50cyA9ICcnO1xuICAgIHZhciBfcGFyZW50LCBfcG9zO1xuXG4gICAgLy8gaGFuZGxlIHJlbGF0aXZlIHBhdGhzXG4gICAgaWYgKF9wYXRoLmNoYXJBdCgwKSAhPT0gJy8nKSB7XG4gICAgICBfd2FzX3JlbGF0aXZlID0gdHJ1ZTtcbiAgICAgIF9wYXRoID0gJy8nICsgX3BhdGg7XG4gICAgfVxuXG4gICAgLy8gaGFuZGxlIHJlbGF0aXZlIGZpbGVzIChhcyBvcHBvc2VkIHRvIGRpcmVjdG9yaWVzKVxuICAgIGlmIChfcGF0aC5zbGljZSgtMykgPT09ICcvLi4nIHx8IF9wYXRoLnNsaWNlKC0yKSA9PT0gJy8uJykge1xuICAgICAgX3BhdGggKz0gJy8nO1xuICAgIH1cblxuICAgIC8vIHJlc29sdmUgc2ltcGxlc1xuICAgIF9wYXRoID0gX3BhdGhcbiAgICAgIC5yZXBsYWNlKC8oXFwvKFxcLlxcLykrKXwoXFwvXFwuJCkvZywgJy8nKVxuICAgICAgLnJlcGxhY2UoL1xcL3syLH0vZywgJy8nKTtcblxuICAgIC8vIHJlbWVtYmVyIGxlYWRpbmcgcGFyZW50c1xuICAgIGlmIChfd2FzX3JlbGF0aXZlKSB7XG4gICAgICBfbGVhZGluZ1BhcmVudHMgPSBfcGF0aC5zdWJzdHJpbmcoMSkubWF0Y2goL14oXFwuXFwuXFwvKSsvKSB8fCAnJztcbiAgICAgIGlmIChfbGVhZGluZ1BhcmVudHMpIHtcbiAgICAgICAgX2xlYWRpbmdQYXJlbnRzID0gX2xlYWRpbmdQYXJlbnRzWzBdO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIHJlc29sdmUgcGFyZW50c1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBfcGFyZW50ID0gX3BhdGguc2VhcmNoKC9cXC9cXC5cXC4oXFwvfCQpLyk7XG4gICAgICBpZiAoX3BhcmVudCA9PT0gLTEpIHtcbiAgICAgICAgLy8gbm8gbW9yZSAuLi8gdG8gcmVzb2x2ZVxuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSBpZiAoX3BhcmVudCA9PT0gMCkge1xuICAgICAgICAvLyB0b3AgbGV2ZWwgY2Fubm90IGJlIHJlbGF0aXZlLCBza2lwIGl0XG4gICAgICAgIF9wYXRoID0gX3BhdGguc3Vic3RyaW5nKDMpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgX3BvcyA9IF9wYXRoLnN1YnN0cmluZygwLCBfcGFyZW50KS5sYXN0SW5kZXhPZignLycpO1xuICAgICAgaWYgKF9wb3MgPT09IC0xKSB7XG4gICAgICAgIF9wb3MgPSBfcGFyZW50O1xuICAgICAgfVxuICAgICAgX3BhdGggPSBfcGF0aC5zdWJzdHJpbmcoMCwgX3BvcykgKyBfcGF0aC5zdWJzdHJpbmcoX3BhcmVudCArIDMpO1xuICAgIH1cblxuICAgIC8vIHJldmVydCB0byByZWxhdGl2ZVxuICAgIGlmIChfd2FzX3JlbGF0aXZlICYmIHRoaXMuaXMoJ3JlbGF0aXZlJykpIHtcbiAgICAgIF9wYXRoID0gX2xlYWRpbmdQYXJlbnRzICsgX3BhdGguc3Vic3RyaW5nKDEpO1xuICAgIH1cblxuICAgIHRoaXMuX3BhcnRzLnBhdGggPSBfcGF0aDtcbiAgICB0aGlzLmJ1aWxkKCFidWlsZCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIHAubm9ybWFsaXplUGF0aG5hbWUgPSBwLm5vcm1hbGl6ZVBhdGg7XG4gIHAubm9ybWFsaXplUXVlcnkgPSBmdW5jdGlvbihidWlsZCkge1xuICAgIGlmICh0eXBlb2YgdGhpcy5fcGFydHMucXVlcnkgPT09ICdzdHJpbmcnKSB7XG4gICAgICBpZiAoIXRoaXMuX3BhcnRzLnF1ZXJ5Lmxlbmd0aCkge1xuICAgICAgICB0aGlzLl9wYXJ0cy5xdWVyeSA9IG51bGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnF1ZXJ5KFVSSS5wYXJzZVF1ZXJ5KHRoaXMuX3BhcnRzLnF1ZXJ5LCB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlKSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYnVpbGQoIWJ1aWxkKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgcC5ub3JtYWxpemVGcmFnbWVudCA9IGZ1bmN0aW9uKGJ1aWxkKSB7XG4gICAgaWYgKCF0aGlzLl9wYXJ0cy5mcmFnbWVudCkge1xuICAgICAgdGhpcy5fcGFydHMuZnJhZ21lbnQgPSBudWxsO1xuICAgICAgdGhpcy5idWlsZCghYnVpbGQpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICBwLm5vcm1hbGl6ZVNlYXJjaCA9IHAubm9ybWFsaXplUXVlcnk7XG4gIHAubm9ybWFsaXplSGFzaCA9IHAubm9ybWFsaXplRnJhZ21lbnQ7XG5cbiAgcC5pc284ODU5ID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gZXhwZWN0IHVuaWNvZGUgaW5wdXQsIGlzbzg4NTkgb3V0cHV0XG4gICAgdmFyIGUgPSBVUkkuZW5jb2RlO1xuICAgIHZhciBkID0gVVJJLmRlY29kZTtcblxuICAgIFVSSS5lbmNvZGUgPSBlc2NhcGU7XG4gICAgVVJJLmRlY29kZSA9IGRlY29kZVVSSUNvbXBvbmVudDtcbiAgICB0cnkge1xuICAgICAgdGhpcy5ub3JtYWxpemUoKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgVVJJLmVuY29kZSA9IGU7XG4gICAgICBVUkkuZGVjb2RlID0gZDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgcC51bmljb2RlID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gZXhwZWN0IGlzbzg4NTkgaW5wdXQsIHVuaWNvZGUgb3V0cHV0XG4gICAgdmFyIGUgPSBVUkkuZW5jb2RlO1xuICAgIHZhciBkID0gVVJJLmRlY29kZTtcblxuICAgIFVSSS5lbmNvZGUgPSBzdHJpY3RFbmNvZGVVUklDb21wb25lbnQ7XG4gICAgVVJJLmRlY29kZSA9IHVuZXNjYXBlO1xuICAgIHRyeSB7XG4gICAgICB0aGlzLm5vcm1hbGl6ZSgpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBVUkkuZW5jb2RlID0gZTtcbiAgICAgIFVSSS5kZWNvZGUgPSBkO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBwLnJlYWRhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHVyaSA9IHRoaXMuY2xvbmUoKTtcbiAgICAvLyByZW1vdmluZyB1c2VybmFtZSwgcGFzc3dvcmQsIGJlY2F1c2UgdGhleSBzaG91bGRuJ3QgYmUgZGlzcGxheWVkIGFjY29yZGluZyB0byBSRkMgMzk4NlxuICAgIHVyaS51c2VybmFtZSgnJykucGFzc3dvcmQoJycpLm5vcm1hbGl6ZSgpO1xuICAgIHZhciB0ID0gJyc7XG4gICAgaWYgKHVyaS5fcGFydHMucHJvdG9jb2wpIHtcbiAgICAgIHQgKz0gdXJpLl9wYXJ0cy5wcm90b2NvbCArICc6Ly8nO1xuICAgIH1cblxuICAgIGlmICh1cmkuX3BhcnRzLmhvc3RuYW1lKSB7XG4gICAgICBpZiAodXJpLmlzKCdwdW55Y29kZScpICYmIHB1bnljb2RlKSB7XG4gICAgICAgIHQgKz0gcHVueWNvZGUudG9Vbmljb2RlKHVyaS5fcGFydHMuaG9zdG5hbWUpO1xuICAgICAgICBpZiAodXJpLl9wYXJ0cy5wb3J0KSB7XG4gICAgICAgICAgdCArPSAnOicgKyB1cmkuX3BhcnRzLnBvcnQ7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHQgKz0gdXJpLmhvc3QoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodXJpLl9wYXJ0cy5ob3N0bmFtZSAmJiB1cmkuX3BhcnRzLnBhdGggJiYgdXJpLl9wYXJ0cy5wYXRoLmNoYXJBdCgwKSAhPT0gJy8nKSB7XG4gICAgICB0ICs9ICcvJztcbiAgICB9XG5cbiAgICB0ICs9IHVyaS5wYXRoKHRydWUpO1xuICAgIGlmICh1cmkuX3BhcnRzLnF1ZXJ5KSB7XG4gICAgICB2YXIgcSA9ICcnO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIHFwID0gdXJpLl9wYXJ0cy5xdWVyeS5zcGxpdCgnJicpLCBsID0gcXAubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIHZhciBrdiA9IChxcFtpXSB8fCAnJykuc3BsaXQoJz0nKTtcbiAgICAgICAgcSArPSAnJicgKyBVUkkuZGVjb2RlUXVlcnkoa3ZbMF0sIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpXG4gICAgICAgICAgLnJlcGxhY2UoLyYvZywgJyUyNicpO1xuXG4gICAgICAgIGlmIChrdlsxXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgcSArPSAnPScgKyBVUkkuZGVjb2RlUXVlcnkoa3ZbMV0sIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpXG4gICAgICAgICAgICAucmVwbGFjZSgvJi9nLCAnJTI2Jyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHQgKz0gJz8nICsgcS5zdWJzdHJpbmcoMSk7XG4gICAgfVxuXG4gICAgdCArPSBVUkkuZGVjb2RlUXVlcnkodXJpLmhhc2goKSwgdHJ1ZSk7XG4gICAgcmV0dXJuIHQ7XG4gIH07XG5cbiAgLy8gcmVzb2x2aW5nIHJlbGF0aXZlIGFuZCBhYnNvbHV0ZSBVUkxzXG4gIHAuYWJzb2x1dGVUbyA9IGZ1bmN0aW9uKGJhc2UpIHtcbiAgICB2YXIgcmVzb2x2ZWQgPSB0aGlzLmNsb25lKCk7XG4gICAgdmFyIHByb3BlcnRpZXMgPSBbJ3Byb3RvY29sJywgJ3VzZXJuYW1lJywgJ3Bhc3N3b3JkJywgJ2hvc3RuYW1lJywgJ3BvcnQnXTtcbiAgICB2YXIgYmFzZWRpciwgaSwgcDtcblxuICAgIGlmICh0aGlzLl9wYXJ0cy51cm4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVVJOcyBkbyBub3QgaGF2ZSBhbnkgZ2VuZXJhbGx5IGRlZmluZWQgaGllcmFyY2hpY2FsIGNvbXBvbmVudHMnKTtcbiAgICB9XG5cbiAgICBpZiAoIShiYXNlIGluc3RhbmNlb2YgVVJJKSkge1xuICAgICAgYmFzZSA9IG5ldyBVUkkoYmFzZSk7XG4gICAgfVxuXG4gICAgaWYgKHJlc29sdmVkLl9wYXJ0cy5wcm90b2NvbCkge1xuICAgICAgLy8gRGlyZWN0bHkgcmV0dXJucyBldmVuIGlmIHRoaXMuX3BhcnRzLmhvc3RuYW1lIGlzIGVtcHR5LlxuICAgICAgcmV0dXJuIHJlc29sdmVkO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXNvbHZlZC5fcGFydHMucHJvdG9jb2wgPSBiYXNlLl9wYXJ0cy5wcm90b2NvbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fcGFydHMuaG9zdG5hbWUpIHtcbiAgICAgIHJldHVybiByZXNvbHZlZDtcbiAgICB9XG5cbiAgICBmb3IgKGkgPSAwOyAocCA9IHByb3BlcnRpZXNbaV0pOyBpKyspIHtcbiAgICAgIHJlc29sdmVkLl9wYXJ0c1twXSA9IGJhc2UuX3BhcnRzW3BdO1xuICAgIH1cblxuICAgIGlmICghcmVzb2x2ZWQuX3BhcnRzLnBhdGgpIHtcbiAgICAgIHJlc29sdmVkLl9wYXJ0cy5wYXRoID0gYmFzZS5fcGFydHMucGF0aDtcbiAgICAgIGlmICghcmVzb2x2ZWQuX3BhcnRzLnF1ZXJ5KSB7XG4gICAgICAgIHJlc29sdmVkLl9wYXJ0cy5xdWVyeSA9IGJhc2UuX3BhcnRzLnF1ZXJ5O1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAocmVzb2x2ZWQuX3BhcnRzLnBhdGguc3Vic3RyaW5nKC0yKSA9PT0gJy4uJykge1xuICAgICAgICByZXNvbHZlZC5fcGFydHMucGF0aCArPSAnLyc7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZXNvbHZlZC5wYXRoKCkuY2hhckF0KDApICE9PSAnLycpIHtcbiAgICAgICAgYmFzZWRpciA9IGJhc2UuZGlyZWN0b3J5KCk7XG4gICAgICAgIGJhc2VkaXIgPSBiYXNlZGlyID8gYmFzZWRpciA6IGJhc2UucGF0aCgpLmluZGV4T2YoJy8nKSA9PT0gMCA/ICcvJyA6ICcnO1xuICAgICAgICByZXNvbHZlZC5fcGFydHMucGF0aCA9IChiYXNlZGlyID8gKGJhc2VkaXIgKyAnLycpIDogJycpICsgcmVzb2x2ZWQuX3BhcnRzLnBhdGg7XG4gICAgICAgIHJlc29sdmVkLm5vcm1hbGl6ZVBhdGgoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXNvbHZlZC5idWlsZCgpO1xuICAgIHJldHVybiByZXNvbHZlZDtcbiAgfTtcbiAgcC5yZWxhdGl2ZVRvID0gZnVuY3Rpb24oYmFzZSkge1xuICAgIHZhciByZWxhdGl2ZSA9IHRoaXMuY2xvbmUoKS5ub3JtYWxpemUoKTtcbiAgICB2YXIgcmVsYXRpdmVQYXJ0cywgYmFzZVBhcnRzLCBjb21tb24sIHJlbGF0aXZlUGF0aCwgYmFzZVBhdGg7XG5cbiAgICBpZiAocmVsYXRpdmUuX3BhcnRzLnVybikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVUk5zIGRvIG5vdCBoYXZlIGFueSBnZW5lcmFsbHkgZGVmaW5lZCBoaWVyYXJjaGljYWwgY29tcG9uZW50cycpO1xuICAgIH1cblxuICAgIGJhc2UgPSBuZXcgVVJJKGJhc2UpLm5vcm1hbGl6ZSgpO1xuICAgIHJlbGF0aXZlUGFydHMgPSByZWxhdGl2ZS5fcGFydHM7XG4gICAgYmFzZVBhcnRzID0gYmFzZS5fcGFydHM7XG4gICAgcmVsYXRpdmVQYXRoID0gcmVsYXRpdmUucGF0aCgpO1xuICAgIGJhc2VQYXRoID0gYmFzZS5wYXRoKCk7XG5cbiAgICBpZiAocmVsYXRpdmVQYXRoLmNoYXJBdCgwKSAhPT0gJy8nKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VSSSBpcyBhbHJlYWR5IHJlbGF0aXZlJyk7XG4gICAgfVxuXG4gICAgaWYgKGJhc2VQYXRoLmNoYXJBdCgwKSAhPT0gJy8nKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBjYWxjdWxhdGUgYSBVUkkgcmVsYXRpdmUgdG8gYW5vdGhlciByZWxhdGl2ZSBVUkknKTtcbiAgICB9XG5cbiAgICBpZiAocmVsYXRpdmVQYXJ0cy5wcm90b2NvbCA9PT0gYmFzZVBhcnRzLnByb3RvY29sKSB7XG4gICAgICByZWxhdGl2ZVBhcnRzLnByb3RvY29sID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAocmVsYXRpdmVQYXJ0cy51c2VybmFtZSAhPT0gYmFzZVBhcnRzLnVzZXJuYW1lIHx8IHJlbGF0aXZlUGFydHMucGFzc3dvcmQgIT09IGJhc2VQYXJ0cy5wYXNzd29yZCkge1xuICAgICAgcmV0dXJuIHJlbGF0aXZlLmJ1aWxkKCk7XG4gICAgfVxuXG4gICAgaWYgKHJlbGF0aXZlUGFydHMucHJvdG9jb2wgIT09IG51bGwgfHwgcmVsYXRpdmVQYXJ0cy51c2VybmFtZSAhPT0gbnVsbCB8fCByZWxhdGl2ZVBhcnRzLnBhc3N3b3JkICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gcmVsYXRpdmUuYnVpbGQoKTtcbiAgICB9XG5cbiAgICBpZiAocmVsYXRpdmVQYXJ0cy5ob3N0bmFtZSA9PT0gYmFzZVBhcnRzLmhvc3RuYW1lICYmIHJlbGF0aXZlUGFydHMucG9ydCA9PT0gYmFzZVBhcnRzLnBvcnQpIHtcbiAgICAgIHJlbGF0aXZlUGFydHMuaG9zdG5hbWUgPSBudWxsO1xuICAgICAgcmVsYXRpdmVQYXJ0cy5wb3J0ID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHJlbGF0aXZlLmJ1aWxkKCk7XG4gICAgfVxuXG4gICAgaWYgKHJlbGF0aXZlUGF0aCA9PT0gYmFzZVBhdGgpIHtcbiAgICAgIHJlbGF0aXZlUGFydHMucGF0aCA9ICcnO1xuICAgICAgcmV0dXJuIHJlbGF0aXZlLmJ1aWxkKCk7XG4gICAgfVxuXG4gICAgLy8gZGV0ZXJtaW5lIGNvbW1vbiBzdWIgcGF0aFxuICAgIGNvbW1vbiA9IFVSSS5jb21tb25QYXRoKHJlbGF0aXZlUGF0aCwgYmFzZVBhdGgpO1xuXG4gICAgLy8gSWYgdGhlIHBhdGhzIGhhdmUgbm90aGluZyBpbiBjb21tb24sIHJldHVybiBhIHJlbGF0aXZlIFVSTCB3aXRoIHRoZSBhYnNvbHV0ZSBwYXRoLlxuICAgIGlmICghY29tbW9uKSB7XG4gICAgICByZXR1cm4gcmVsYXRpdmUuYnVpbGQoKTtcbiAgICB9XG5cbiAgICB2YXIgcGFyZW50cyA9IGJhc2VQYXJ0cy5wYXRoXG4gICAgICAuc3Vic3RyaW5nKGNvbW1vbi5sZW5ndGgpXG4gICAgICAucmVwbGFjZSgvW15cXC9dKiQvLCAnJylcbiAgICAgIC5yZXBsYWNlKC8uKj9cXC8vZywgJy4uLycpO1xuXG4gICAgcmVsYXRpdmVQYXJ0cy5wYXRoID0gKHBhcmVudHMgKyByZWxhdGl2ZVBhcnRzLnBhdGguc3Vic3RyaW5nKGNvbW1vbi5sZW5ndGgpKSB8fCAnLi8nO1xuXG4gICAgcmV0dXJuIHJlbGF0aXZlLmJ1aWxkKCk7XG4gIH07XG5cbiAgLy8gY29tcGFyaW5nIFVSSXNcbiAgcC5lcXVhbHMgPSBmdW5jdGlvbih1cmkpIHtcbiAgICB2YXIgb25lID0gdGhpcy5jbG9uZSgpO1xuICAgIHZhciB0d28gPSBuZXcgVVJJKHVyaSk7XG4gICAgdmFyIG9uZV9tYXAgPSB7fTtcbiAgICB2YXIgdHdvX21hcCA9IHt9O1xuICAgIHZhciBjaGVja2VkID0ge307XG4gICAgdmFyIG9uZV9xdWVyeSwgdHdvX3F1ZXJ5LCBrZXk7XG5cbiAgICBvbmUubm9ybWFsaXplKCk7XG4gICAgdHdvLm5vcm1hbGl6ZSgpO1xuXG4gICAgLy8gZXhhY3QgbWF0Y2hcbiAgICBpZiAob25lLnRvU3RyaW5nKCkgPT09IHR3by50b1N0cmluZygpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBleHRyYWN0IHF1ZXJ5IHN0cmluZ1xuICAgIG9uZV9xdWVyeSA9IG9uZS5xdWVyeSgpO1xuICAgIHR3b19xdWVyeSA9IHR3by5xdWVyeSgpO1xuICAgIG9uZS5xdWVyeSgnJyk7XG4gICAgdHdvLnF1ZXJ5KCcnKTtcblxuICAgIC8vIGRlZmluaXRlbHkgbm90IGVxdWFsIGlmIG5vdCBldmVuIG5vbi1xdWVyeSBwYXJ0cyBtYXRjaFxuICAgIGlmIChvbmUudG9TdHJpbmcoKSAhPT0gdHdvLnRvU3RyaW5nKCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBxdWVyeSBwYXJhbWV0ZXJzIGhhdmUgdGhlIHNhbWUgbGVuZ3RoLCBldmVuIGlmIHRoZXkncmUgcGVybXV0ZWRcbiAgICBpZiAob25lX3F1ZXJ5Lmxlbmd0aCAhPT0gdHdvX3F1ZXJ5Lmxlbmd0aCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIG9uZV9tYXAgPSBVUkkucGFyc2VRdWVyeShvbmVfcXVlcnksIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpO1xuICAgIHR3b19tYXAgPSBVUkkucGFyc2VRdWVyeSh0d29fcXVlcnksIHRoaXMuX3BhcnRzLmVzY2FwZVF1ZXJ5U3BhY2UpO1xuXG4gICAgZm9yIChrZXkgaW4gb25lX21hcCkge1xuICAgICAgaWYgKGhhc093bi5jYWxsKG9uZV9tYXAsIGtleSkpIHtcbiAgICAgICAgaWYgKCFpc0FycmF5KG9uZV9tYXBba2V5XSkpIHtcbiAgICAgICAgICBpZiAob25lX21hcFtrZXldICE9PSB0d29fbWFwW2tleV0pIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoIWFycmF5c0VxdWFsKG9uZV9tYXBba2V5XSwgdHdvX21hcFtrZXldKSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNoZWNrZWRba2V5XSA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChrZXkgaW4gdHdvX21hcCkge1xuICAgICAgaWYgKGhhc093bi5jYWxsKHR3b19tYXAsIGtleSkpIHtcbiAgICAgICAgaWYgKCFjaGVja2VkW2tleV0pIHtcbiAgICAgICAgICAvLyB0d28gY29udGFpbnMgYSBwYXJhbWV0ZXIgbm90IHByZXNlbnQgaW4gb25lXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cbiAgLy8gc3RhdGVcbiAgcC5wcmV2ZW50SW52YWxpZEhvc3RuYW1lID0gZnVuY3Rpb24odikge1xuICAgIHRoaXMuX3BhcnRzLnByZXZlbnRJbnZhbGlkSG9zdG5hbWUgPSAhIXY7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgcC5kdXBsaWNhdGVRdWVyeVBhcmFtZXRlcnMgPSBmdW5jdGlvbih2KSB7XG4gICAgdGhpcy5fcGFydHMuZHVwbGljYXRlUXVlcnlQYXJhbWV0ZXJzID0gISF2O1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIHAuZXNjYXBlUXVlcnlTcGFjZSA9IGZ1bmN0aW9uKHYpIHtcbiAgICB0aGlzLl9wYXJ0cy5lc2NhcGVRdWVyeVNwYWNlID0gISF2O1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIHJldHVybiBVUkk7XG59KSk7XG4iLCIvKiEgaHR0cHM6Ly9tdGhzLmJlL3B1bnljb2RlIHYxLjQuMCBieSBAbWF0aGlhcyAqL1xuOyhmdW5jdGlvbihyb290KSB7XG5cblx0LyoqIERldGVjdCBmcmVlIHZhcmlhYmxlcyAqL1xuXHR2YXIgZnJlZUV4cG9ydHMgPSB0eXBlb2YgZXhwb3J0cyA9PSAnb2JqZWN0JyAmJiBleHBvcnRzICYmXG5cdFx0IWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0cztcblx0dmFyIGZyZWVNb2R1bGUgPSB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZSAmJlxuXHRcdCFtb2R1bGUubm9kZVR5cGUgJiYgbW9kdWxlO1xuXHR2YXIgZnJlZUdsb2JhbCA9IHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgZ2xvYmFsO1xuXHRpZiAoXG5cdFx0ZnJlZUdsb2JhbC5nbG9iYWwgPT09IGZyZWVHbG9iYWwgfHxcblx0XHRmcmVlR2xvYmFsLndpbmRvdyA9PT0gZnJlZUdsb2JhbCB8fFxuXHRcdGZyZWVHbG9iYWwuc2VsZiA9PT0gZnJlZUdsb2JhbFxuXHQpIHtcblx0XHRyb290ID0gZnJlZUdsb2JhbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBUaGUgYHB1bnljb2RlYCBvYmplY3QuXG5cdCAqIEBuYW1lIHB1bnljb2RlXG5cdCAqIEB0eXBlIE9iamVjdFxuXHQgKi9cblx0dmFyIHB1bnljb2RlLFxuXG5cdC8qKiBIaWdoZXN0IHBvc2l0aXZlIHNpZ25lZCAzMi1iaXQgZmxvYXQgdmFsdWUgKi9cblx0bWF4SW50ID0gMjE0NzQ4MzY0NywgLy8gYWthLiAweDdGRkZGRkZGIG9yIDJeMzEtMVxuXG5cdC8qKiBCb290c3RyaW5nIHBhcmFtZXRlcnMgKi9cblx0YmFzZSA9IDM2LFxuXHR0TWluID0gMSxcblx0dE1heCA9IDI2LFxuXHRza2V3ID0gMzgsXG5cdGRhbXAgPSA3MDAsXG5cdGluaXRpYWxCaWFzID0gNzIsXG5cdGluaXRpYWxOID0gMTI4LCAvLyAweDgwXG5cdGRlbGltaXRlciA9ICctJywgLy8gJ1xceDJEJ1xuXG5cdC8qKiBSZWd1bGFyIGV4cHJlc3Npb25zICovXG5cdHJlZ2V4UHVueWNvZGUgPSAvXnhuLS0vLFxuXHRyZWdleE5vbkFTQ0lJID0gL1teXFx4MjAtXFx4N0VdLywgLy8gdW5wcmludGFibGUgQVNDSUkgY2hhcnMgKyBub24tQVNDSUkgY2hhcnNcblx0cmVnZXhTZXBhcmF0b3JzID0gL1tcXHgyRVxcdTMwMDJcXHVGRjBFXFx1RkY2MV0vZywgLy8gUkZDIDM0OTAgc2VwYXJhdG9yc1xuXG5cdC8qKiBFcnJvciBtZXNzYWdlcyAqL1xuXHRlcnJvcnMgPSB7XG5cdFx0J292ZXJmbG93JzogJ092ZXJmbG93OiBpbnB1dCBuZWVkcyB3aWRlciBpbnRlZ2VycyB0byBwcm9jZXNzJyxcblx0XHQnbm90LWJhc2ljJzogJ0lsbGVnYWwgaW5wdXQgPj0gMHg4MCAobm90IGEgYmFzaWMgY29kZSBwb2ludCknLFxuXHRcdCdpbnZhbGlkLWlucHV0JzogJ0ludmFsaWQgaW5wdXQnXG5cdH0sXG5cblx0LyoqIENvbnZlbmllbmNlIHNob3J0Y3V0cyAqL1xuXHRiYXNlTWludXNUTWluID0gYmFzZSAtIHRNaW4sXG5cdGZsb29yID0gTWF0aC5mbG9vcixcblx0c3RyaW5nRnJvbUNoYXJDb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZSxcblxuXHQvKiogVGVtcG9yYXJ5IHZhcmlhYmxlICovXG5cdGtleTtcblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQvKipcblx0ICogQSBnZW5lcmljIGVycm9yIHV0aWxpdHkgZnVuY3Rpb24uXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIFRoZSBlcnJvciB0eXBlLlxuXHQgKiBAcmV0dXJucyB7RXJyb3J9IFRocm93cyBhIGBSYW5nZUVycm9yYCB3aXRoIHRoZSBhcHBsaWNhYmxlIGVycm9yIG1lc3NhZ2UuXG5cdCAqL1xuXHRmdW5jdGlvbiBlcnJvcih0eXBlKSB7XG5cdFx0dGhyb3cgbmV3IFJhbmdlRXJyb3IoZXJyb3JzW3R5cGVdKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBBIGdlbmVyaWMgYEFycmF5I21hcGAgdXRpbGl0eSBmdW5jdGlvbi5cblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cblx0ICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRoYXQgZ2V0cyBjYWxsZWQgZm9yIGV2ZXJ5IGFycmF5XG5cdCAqIGl0ZW0uXG5cdCAqIEByZXR1cm5zIHtBcnJheX0gQSBuZXcgYXJyYXkgb2YgdmFsdWVzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFjayBmdW5jdGlvbi5cblx0ICovXG5cdGZ1bmN0aW9uIG1hcChhcnJheSwgZm4pIHtcblx0XHR2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuXHRcdHZhciByZXN1bHQgPSBbXTtcblx0XHR3aGlsZSAobGVuZ3RoLS0pIHtcblx0XHRcdHJlc3VsdFtsZW5ndGhdID0gZm4oYXJyYXlbbGVuZ3RoXSk7XG5cdFx0fVxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cblxuXHQvKipcblx0ICogQSBzaW1wbGUgYEFycmF5I21hcGAtbGlrZSB3cmFwcGVyIHRvIHdvcmsgd2l0aCBkb21haW4gbmFtZSBzdHJpbmdzIG9yIGVtYWlsXG5cdCAqIGFkZHJlc3Nlcy5cblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcy5cblx0ICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRoYXQgZ2V0cyBjYWxsZWQgZm9yIGV2ZXJ5XG5cdCAqIGNoYXJhY3Rlci5cblx0ICogQHJldHVybnMge0FycmF5fSBBIG5ldyBzdHJpbmcgb2YgY2hhcmFjdGVycyByZXR1cm5lZCBieSB0aGUgY2FsbGJhY2tcblx0ICogZnVuY3Rpb24uXG5cdCAqL1xuXHRmdW5jdGlvbiBtYXBEb21haW4oc3RyaW5nLCBmbikge1xuXHRcdHZhciBwYXJ0cyA9IHN0cmluZy5zcGxpdCgnQCcpO1xuXHRcdHZhciByZXN1bHQgPSAnJztcblx0XHRpZiAocGFydHMubGVuZ3RoID4gMSkge1xuXHRcdFx0Ly8gSW4gZW1haWwgYWRkcmVzc2VzLCBvbmx5IHRoZSBkb21haW4gbmFtZSBzaG91bGQgYmUgcHVueWNvZGVkLiBMZWF2ZVxuXHRcdFx0Ly8gdGhlIGxvY2FsIHBhcnQgKGkuZS4gZXZlcnl0aGluZyB1cCB0byBgQGApIGludGFjdC5cblx0XHRcdHJlc3VsdCA9IHBhcnRzWzBdICsgJ0AnO1xuXHRcdFx0c3RyaW5nID0gcGFydHNbMV07XG5cdFx0fVxuXHRcdC8vIEF2b2lkIGBzcGxpdChyZWdleClgIGZvciBJRTggY29tcGF0aWJpbGl0eS4gU2VlICMxNy5cblx0XHRzdHJpbmcgPSBzdHJpbmcucmVwbGFjZShyZWdleFNlcGFyYXRvcnMsICdcXHgyRScpO1xuXHRcdHZhciBsYWJlbHMgPSBzdHJpbmcuc3BsaXQoJy4nKTtcblx0XHR2YXIgZW5jb2RlZCA9IG1hcChsYWJlbHMsIGZuKS5qb2luKCcuJyk7XG5cdFx0cmV0dXJuIHJlc3VsdCArIGVuY29kZWQ7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhbiBhcnJheSBjb250YWluaW5nIHRoZSBudW1lcmljIGNvZGUgcG9pbnRzIG9mIGVhY2ggVW5pY29kZVxuXHQgKiBjaGFyYWN0ZXIgaW4gdGhlIHN0cmluZy4gV2hpbGUgSmF2YVNjcmlwdCB1c2VzIFVDUy0yIGludGVybmFsbHksXG5cdCAqIHRoaXMgZnVuY3Rpb24gd2lsbCBjb252ZXJ0IGEgcGFpciBvZiBzdXJyb2dhdGUgaGFsdmVzIChlYWNoIG9mIHdoaWNoXG5cdCAqIFVDUy0yIGV4cG9zZXMgYXMgc2VwYXJhdGUgY2hhcmFjdGVycykgaW50byBhIHNpbmdsZSBjb2RlIHBvaW50LFxuXHQgKiBtYXRjaGluZyBVVEYtMTYuXG5cdCAqIEBzZWUgYHB1bnljb2RlLnVjczIuZW5jb2RlYFxuXHQgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz5cblx0ICogQG1lbWJlck9mIHB1bnljb2RlLnVjczJcblx0ICogQG5hbWUgZGVjb2RlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBzdHJpbmcgVGhlIFVuaWNvZGUgaW5wdXQgc3RyaW5nIChVQ1MtMikuXG5cdCAqIEByZXR1cm5zIHtBcnJheX0gVGhlIG5ldyBhcnJheSBvZiBjb2RlIHBvaW50cy5cblx0ICovXG5cdGZ1bmN0aW9uIHVjczJkZWNvZGUoc3RyaW5nKSB7XG5cdFx0dmFyIG91dHB1dCA9IFtdLFxuXHRcdCAgICBjb3VudGVyID0gMCxcblx0XHQgICAgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aCxcblx0XHQgICAgdmFsdWUsXG5cdFx0ICAgIGV4dHJhO1xuXHRcdHdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7XG5cdFx0XHR2YWx1ZSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7XG5cdFx0XHRpZiAodmFsdWUgPj0gMHhEODAwICYmIHZhbHVlIDw9IDB4REJGRiAmJiBjb3VudGVyIDwgbGVuZ3RoKSB7XG5cdFx0XHRcdC8vIGhpZ2ggc3Vycm9nYXRlLCBhbmQgdGhlcmUgaXMgYSBuZXh0IGNoYXJhY3RlclxuXHRcdFx0XHRleHRyYSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7XG5cdFx0XHRcdGlmICgoZXh0cmEgJiAweEZDMDApID09IDB4REMwMCkgeyAvLyBsb3cgc3Vycm9nYXRlXG5cdFx0XHRcdFx0b3V0cHV0LnB1c2goKCh2YWx1ZSAmIDB4M0ZGKSA8PCAxMCkgKyAoZXh0cmEgJiAweDNGRikgKyAweDEwMDAwKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyB1bm1hdGNoZWQgc3Vycm9nYXRlOyBvbmx5IGFwcGVuZCB0aGlzIGNvZGUgdW5pdCwgaW4gY2FzZSB0aGUgbmV4dFxuXHRcdFx0XHRcdC8vIGNvZGUgdW5pdCBpcyB0aGUgaGlnaCBzdXJyb2dhdGUgb2YgYSBzdXJyb2dhdGUgcGFpclxuXHRcdFx0XHRcdG91dHB1dC5wdXNoKHZhbHVlKTtcblx0XHRcdFx0XHRjb3VudGVyLS07XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG91dHB1dC5wdXNoKHZhbHVlKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgc3RyaW5nIGJhc2VkIG9uIGFuIGFycmF5IG9mIG51bWVyaWMgY29kZSBwb2ludHMuXG5cdCAqIEBzZWUgYHB1bnljb2RlLnVjczIuZGVjb2RlYFxuXHQgKiBAbWVtYmVyT2YgcHVueWNvZGUudWNzMlxuXHQgKiBAbmFtZSBlbmNvZGVcblx0ICogQHBhcmFtIHtBcnJheX0gY29kZVBvaW50cyBUaGUgYXJyYXkgb2YgbnVtZXJpYyBjb2RlIHBvaW50cy5cblx0ICogQHJldHVybnMge1N0cmluZ30gVGhlIG5ldyBVbmljb2RlIHN0cmluZyAoVUNTLTIpLlxuXHQgKi9cblx0ZnVuY3Rpb24gdWNzMmVuY29kZShhcnJheSkge1xuXHRcdHJldHVybiBtYXAoYXJyYXksIGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHR2YXIgb3V0cHV0ID0gJyc7XG5cdFx0XHRpZiAodmFsdWUgPiAweEZGRkYpIHtcblx0XHRcdFx0dmFsdWUgLT0gMHgxMDAwMDtcblx0XHRcdFx0b3V0cHV0ICs9IHN0cmluZ0Zyb21DaGFyQ29kZSh2YWx1ZSA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMCk7XG5cdFx0XHRcdHZhbHVlID0gMHhEQzAwIHwgdmFsdWUgJiAweDNGRjtcblx0XHRcdH1cblx0XHRcdG91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUpO1xuXHRcdFx0cmV0dXJuIG91dHB1dDtcblx0XHR9KS5qb2luKCcnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIGJhc2ljIGNvZGUgcG9pbnQgaW50byBhIGRpZ2l0L2ludGVnZXIuXG5cdCAqIEBzZWUgYGRpZ2l0VG9CYXNpYygpYFxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0ge051bWJlcn0gY29kZVBvaW50IFRoZSBiYXNpYyBudW1lcmljIGNvZGUgcG9pbnQgdmFsdWUuXG5cdCAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBudW1lcmljIHZhbHVlIG9mIGEgYmFzaWMgY29kZSBwb2ludCAoZm9yIHVzZSBpblxuXHQgKiByZXByZXNlbnRpbmcgaW50ZWdlcnMpIGluIHRoZSByYW5nZSBgMGAgdG8gYGJhc2UgLSAxYCwgb3IgYGJhc2VgIGlmXG5cdCAqIHRoZSBjb2RlIHBvaW50IGRvZXMgbm90IHJlcHJlc2VudCBhIHZhbHVlLlxuXHQgKi9cblx0ZnVuY3Rpb24gYmFzaWNUb0RpZ2l0KGNvZGVQb2ludCkge1xuXHRcdGlmIChjb2RlUG9pbnQgLSA0OCA8IDEwKSB7XG5cdFx0XHRyZXR1cm4gY29kZVBvaW50IC0gMjI7XG5cdFx0fVxuXHRcdGlmIChjb2RlUG9pbnQgLSA2NSA8IDI2KSB7XG5cdFx0XHRyZXR1cm4gY29kZVBvaW50IC0gNjU7XG5cdFx0fVxuXHRcdGlmIChjb2RlUG9pbnQgLSA5NyA8IDI2KSB7XG5cdFx0XHRyZXR1cm4gY29kZVBvaW50IC0gOTc7XG5cdFx0fVxuXHRcdHJldHVybiBiYXNlO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgZGlnaXQvaW50ZWdlciBpbnRvIGEgYmFzaWMgY29kZSBwb2ludC5cblx0ICogQHNlZSBgYmFzaWNUb0RpZ2l0KClgXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSB7TnVtYmVyfSBkaWdpdCBUaGUgbnVtZXJpYyB2YWx1ZSBvZiBhIGJhc2ljIGNvZGUgcG9pbnQuXG5cdCAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBiYXNpYyBjb2RlIHBvaW50IHdob3NlIHZhbHVlICh3aGVuIHVzZWQgZm9yXG5cdCAqIHJlcHJlc2VudGluZyBpbnRlZ2VycykgaXMgYGRpZ2l0YCwgd2hpY2ggbmVlZHMgdG8gYmUgaW4gdGhlIHJhbmdlXG5cdCAqIGAwYCB0byBgYmFzZSAtIDFgLiBJZiBgZmxhZ2AgaXMgbm9uLXplcm8sIHRoZSB1cHBlcmNhc2UgZm9ybSBpc1xuXHQgKiB1c2VkOyBlbHNlLCB0aGUgbG93ZXJjYXNlIGZvcm0gaXMgdXNlZC4gVGhlIGJlaGF2aW9yIGlzIHVuZGVmaW5lZFxuXHQgKiBpZiBgZmxhZ2AgaXMgbm9uLXplcm8gYW5kIGBkaWdpdGAgaGFzIG5vIHVwcGVyY2FzZSBmb3JtLlxuXHQgKi9cblx0ZnVuY3Rpb24gZGlnaXRUb0Jhc2ljKGRpZ2l0LCBmbGFnKSB7XG5cdFx0Ly8gIDAuLjI1IG1hcCB0byBBU0NJSSBhLi56IG9yIEEuLlpcblx0XHQvLyAyNi4uMzUgbWFwIHRvIEFTQ0lJIDAuLjlcblx0XHRyZXR1cm4gZGlnaXQgKyAyMiArIDc1ICogKGRpZ2l0IDwgMjYpIC0gKChmbGFnICE9IDApIDw8IDUpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEJpYXMgYWRhcHRhdGlvbiBmdW5jdGlvbiBhcyBwZXIgc2VjdGlvbiAzLjQgb2YgUkZDIDM0OTIuXG5cdCAqIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzNDkyI3NlY3Rpb24tMy40XG5cdCAqIEBwcml2YXRlXG5cdCAqL1xuXHRmdW5jdGlvbiBhZGFwdChkZWx0YSwgbnVtUG9pbnRzLCBmaXJzdFRpbWUpIHtcblx0XHR2YXIgayA9IDA7XG5cdFx0ZGVsdGEgPSBmaXJzdFRpbWUgPyBmbG9vcihkZWx0YSAvIGRhbXApIDogZGVsdGEgPj4gMTtcblx0XHRkZWx0YSArPSBmbG9vcihkZWx0YSAvIG51bVBvaW50cyk7XG5cdFx0Zm9yICgvKiBubyBpbml0aWFsaXphdGlvbiAqLzsgZGVsdGEgPiBiYXNlTWludXNUTWluICogdE1heCA+PiAxOyBrICs9IGJhc2UpIHtcblx0XHRcdGRlbHRhID0gZmxvb3IoZGVsdGEgLyBiYXNlTWludXNUTWluKTtcblx0XHR9XG5cdFx0cmV0dXJuIGZsb29yKGsgKyAoYmFzZU1pbnVzVE1pbiArIDEpICogZGVsdGEgLyAoZGVsdGEgKyBza2V3KSk7XG5cdH1cblxuXHQvKipcblx0ICogQ29udmVydHMgYSBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzIHRvIGEgc3RyaW5nIG9mIFVuaWNvZGVcblx0ICogc3ltYm9scy5cblx0ICogQG1lbWJlck9mIHB1bnljb2RlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy5cblx0ICogQHJldHVybnMge1N0cmluZ30gVGhlIHJlc3VsdGluZyBzdHJpbmcgb2YgVW5pY29kZSBzeW1ib2xzLlxuXHQgKi9cblx0ZnVuY3Rpb24gZGVjb2RlKGlucHV0KSB7XG5cdFx0Ly8gRG9uJ3QgdXNlIFVDUy0yXG5cdFx0dmFyIG91dHB1dCA9IFtdLFxuXHRcdCAgICBpbnB1dExlbmd0aCA9IGlucHV0Lmxlbmd0aCxcblx0XHQgICAgb3V0LFxuXHRcdCAgICBpID0gMCxcblx0XHQgICAgbiA9IGluaXRpYWxOLFxuXHRcdCAgICBiaWFzID0gaW5pdGlhbEJpYXMsXG5cdFx0ICAgIGJhc2ljLFxuXHRcdCAgICBqLFxuXHRcdCAgICBpbmRleCxcblx0XHQgICAgb2xkaSxcblx0XHQgICAgdyxcblx0XHQgICAgayxcblx0XHQgICAgZGlnaXQsXG5cdFx0ICAgIHQsXG5cdFx0ICAgIC8qKiBDYWNoZWQgY2FsY3VsYXRpb24gcmVzdWx0cyAqL1xuXHRcdCAgICBiYXNlTWludXNUO1xuXG5cdFx0Ly8gSGFuZGxlIHRoZSBiYXNpYyBjb2RlIHBvaW50czogbGV0IGBiYXNpY2AgYmUgdGhlIG51bWJlciBvZiBpbnB1dCBjb2RlXG5cdFx0Ly8gcG9pbnRzIGJlZm9yZSB0aGUgbGFzdCBkZWxpbWl0ZXIsIG9yIGAwYCBpZiB0aGVyZSBpcyBub25lLCB0aGVuIGNvcHlcblx0XHQvLyB0aGUgZmlyc3QgYmFzaWMgY29kZSBwb2ludHMgdG8gdGhlIG91dHB1dC5cblxuXHRcdGJhc2ljID0gaW5wdXQubGFzdEluZGV4T2YoZGVsaW1pdGVyKTtcblx0XHRpZiAoYmFzaWMgPCAwKSB7XG5cdFx0XHRiYXNpYyA9IDA7XG5cdFx0fVxuXG5cdFx0Zm9yIChqID0gMDsgaiA8IGJhc2ljOyArK2opIHtcblx0XHRcdC8vIGlmIGl0J3Mgbm90IGEgYmFzaWMgY29kZSBwb2ludFxuXHRcdFx0aWYgKGlucHV0LmNoYXJDb2RlQXQoaikgPj0gMHg4MCkge1xuXHRcdFx0XHRlcnJvcignbm90LWJhc2ljJyk7XG5cdFx0XHR9XG5cdFx0XHRvdXRwdXQucHVzaChpbnB1dC5jaGFyQ29kZUF0KGopKTtcblx0XHR9XG5cblx0XHQvLyBNYWluIGRlY29kaW5nIGxvb3A6IHN0YXJ0IGp1c3QgYWZ0ZXIgdGhlIGxhc3QgZGVsaW1pdGVyIGlmIGFueSBiYXNpYyBjb2RlXG5cdFx0Ly8gcG9pbnRzIHdlcmUgY29waWVkOyBzdGFydCBhdCB0aGUgYmVnaW5uaW5nIG90aGVyd2lzZS5cblxuXHRcdGZvciAoaW5kZXggPSBiYXNpYyA+IDAgPyBiYXNpYyArIDEgOiAwOyBpbmRleCA8IGlucHV0TGVuZ3RoOyAvKiBubyBmaW5hbCBleHByZXNzaW9uICovKSB7XG5cblx0XHRcdC8vIGBpbmRleGAgaXMgdGhlIGluZGV4IG9mIHRoZSBuZXh0IGNoYXJhY3RlciB0byBiZSBjb25zdW1lZC5cblx0XHRcdC8vIERlY29kZSBhIGdlbmVyYWxpemVkIHZhcmlhYmxlLWxlbmd0aCBpbnRlZ2VyIGludG8gYGRlbHRhYCxcblx0XHRcdC8vIHdoaWNoIGdldHMgYWRkZWQgdG8gYGlgLiBUaGUgb3ZlcmZsb3cgY2hlY2tpbmcgaXMgZWFzaWVyXG5cdFx0XHQvLyBpZiB3ZSBpbmNyZWFzZSBgaWAgYXMgd2UgZ28sIHRoZW4gc3VidHJhY3Qgb2ZmIGl0cyBzdGFydGluZ1xuXHRcdFx0Ly8gdmFsdWUgYXQgdGhlIGVuZCB0byBvYnRhaW4gYGRlbHRhYC5cblx0XHRcdGZvciAob2xkaSA9IGksIHcgPSAxLCBrID0gYmFzZTsgLyogbm8gY29uZGl0aW9uICovOyBrICs9IGJhc2UpIHtcblxuXHRcdFx0XHRpZiAoaW5kZXggPj0gaW5wdXRMZW5ndGgpIHtcblx0XHRcdFx0XHRlcnJvcignaW52YWxpZC1pbnB1dCcpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZGlnaXQgPSBiYXNpY1RvRGlnaXQoaW5wdXQuY2hhckNvZGVBdChpbmRleCsrKSk7XG5cblx0XHRcdFx0aWYgKGRpZ2l0ID49IGJhc2UgfHwgZGlnaXQgPiBmbG9vcigobWF4SW50IC0gaSkgLyB3KSkge1xuXHRcdFx0XHRcdGVycm9yKCdvdmVyZmxvdycpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aSArPSBkaWdpdCAqIHc7XG5cdFx0XHRcdHQgPSBrIDw9IGJpYXMgPyB0TWluIDogKGsgPj0gYmlhcyArIHRNYXggPyB0TWF4IDogayAtIGJpYXMpO1xuXG5cdFx0XHRcdGlmIChkaWdpdCA8IHQpIHtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGJhc2VNaW51c1QgPSBiYXNlIC0gdDtcblx0XHRcdFx0aWYgKHcgPiBmbG9vcihtYXhJbnQgLyBiYXNlTWludXNUKSkge1xuXHRcdFx0XHRcdGVycm9yKCdvdmVyZmxvdycpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dyAqPSBiYXNlTWludXNUO1xuXG5cdFx0XHR9XG5cblx0XHRcdG91dCA9IG91dHB1dC5sZW5ndGggKyAxO1xuXHRcdFx0YmlhcyA9IGFkYXB0KGkgLSBvbGRpLCBvdXQsIG9sZGkgPT0gMCk7XG5cblx0XHRcdC8vIGBpYCB3YXMgc3VwcG9zZWQgdG8gd3JhcCBhcm91bmQgZnJvbSBgb3V0YCB0byBgMGAsXG5cdFx0XHQvLyBpbmNyZW1lbnRpbmcgYG5gIGVhY2ggdGltZSwgc28gd2UnbGwgZml4IHRoYXQgbm93OlxuXHRcdFx0aWYgKGZsb29yKGkgLyBvdXQpID4gbWF4SW50IC0gbikge1xuXHRcdFx0XHRlcnJvcignb3ZlcmZsb3cnKTtcblx0XHRcdH1cblxuXHRcdFx0biArPSBmbG9vcihpIC8gb3V0KTtcblx0XHRcdGkgJT0gb3V0O1xuXG5cdFx0XHQvLyBJbnNlcnQgYG5gIGF0IHBvc2l0aW9uIGBpYCBvZiB0aGUgb3V0cHV0XG5cdFx0XHRvdXRwdXQuc3BsaWNlKGkrKywgMCwgbik7XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gdWNzMmVuY29kZShvdXRwdXQpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scyAoZS5nLiBhIGRvbWFpbiBuYW1lIGxhYmVsKSB0byBhXG5cdCAqIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMuXG5cdCAqIEBtZW1iZXJPZiBwdW55Y29kZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMuXG5cdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSByZXN1bHRpbmcgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy5cblx0ICovXG5cdGZ1bmN0aW9uIGVuY29kZShpbnB1dCkge1xuXHRcdHZhciBuLFxuXHRcdCAgICBkZWx0YSxcblx0XHQgICAgaGFuZGxlZENQQ291bnQsXG5cdFx0ICAgIGJhc2ljTGVuZ3RoLFxuXHRcdCAgICBiaWFzLFxuXHRcdCAgICBqLFxuXHRcdCAgICBtLFxuXHRcdCAgICBxLFxuXHRcdCAgICBrLFxuXHRcdCAgICB0LFxuXHRcdCAgICBjdXJyZW50VmFsdWUsXG5cdFx0ICAgIG91dHB1dCA9IFtdLFxuXHRcdCAgICAvKiogYGlucHV0TGVuZ3RoYCB3aWxsIGhvbGQgdGhlIG51bWJlciBvZiBjb2RlIHBvaW50cyBpbiBgaW5wdXRgLiAqL1xuXHRcdCAgICBpbnB1dExlbmd0aCxcblx0XHQgICAgLyoqIENhY2hlZCBjYWxjdWxhdGlvbiByZXN1bHRzICovXG5cdFx0ICAgIGhhbmRsZWRDUENvdW50UGx1c09uZSxcblx0XHQgICAgYmFzZU1pbnVzVCxcblx0XHQgICAgcU1pbnVzVDtcblxuXHRcdC8vIENvbnZlcnQgdGhlIGlucHV0IGluIFVDUy0yIHRvIFVuaWNvZGVcblx0XHRpbnB1dCA9IHVjczJkZWNvZGUoaW5wdXQpO1xuXG5cdFx0Ly8gQ2FjaGUgdGhlIGxlbmd0aFxuXHRcdGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoO1xuXG5cdFx0Ly8gSW5pdGlhbGl6ZSB0aGUgc3RhdGVcblx0XHRuID0gaW5pdGlhbE47XG5cdFx0ZGVsdGEgPSAwO1xuXHRcdGJpYXMgPSBpbml0aWFsQmlhcztcblxuXHRcdC8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHNcblx0XHRmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikge1xuXHRcdFx0Y3VycmVudFZhbHVlID0gaW5wdXRbal07XG5cdFx0XHRpZiAoY3VycmVudFZhbHVlIDwgMHg4MCkge1xuXHRcdFx0XHRvdXRwdXQucHVzaChzdHJpbmdGcm9tQ2hhckNvZGUoY3VycmVudFZhbHVlKSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aGFuZGxlZENQQ291bnQgPSBiYXNpY0xlbmd0aCA9IG91dHB1dC5sZW5ndGg7XG5cblx0XHQvLyBgaGFuZGxlZENQQ291bnRgIGlzIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgdGhhdCBoYXZlIGJlZW4gaGFuZGxlZDtcblx0XHQvLyBgYmFzaWNMZW5ndGhgIGlzIHRoZSBudW1iZXIgb2YgYmFzaWMgY29kZSBwb2ludHMuXG5cblx0XHQvLyBGaW5pc2ggdGhlIGJhc2ljIHN0cmluZyAtIGlmIGl0IGlzIG5vdCBlbXB0eSAtIHdpdGggYSBkZWxpbWl0ZXJcblx0XHRpZiAoYmFzaWNMZW5ndGgpIHtcblx0XHRcdG91dHB1dC5wdXNoKGRlbGltaXRlcik7XG5cdFx0fVxuXG5cdFx0Ly8gTWFpbiBlbmNvZGluZyBsb29wOlxuXHRcdHdoaWxlIChoYW5kbGVkQ1BDb3VudCA8IGlucHV0TGVuZ3RoKSB7XG5cblx0XHRcdC8vIEFsbCBub24tYmFzaWMgY29kZSBwb2ludHMgPCBuIGhhdmUgYmVlbiBoYW5kbGVkIGFscmVhZHkuIEZpbmQgdGhlIG5leHRcblx0XHRcdC8vIGxhcmdlciBvbmU6XG5cdFx0XHRmb3IgKG0gPSBtYXhJbnQsIGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikge1xuXHRcdFx0XHRjdXJyZW50VmFsdWUgPSBpbnB1dFtqXTtcblx0XHRcdFx0aWYgKGN1cnJlbnRWYWx1ZSA+PSBuICYmIGN1cnJlbnRWYWx1ZSA8IG0pIHtcblx0XHRcdFx0XHRtID0gY3VycmVudFZhbHVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIEluY3JlYXNlIGBkZWx0YWAgZW5vdWdoIHRvIGFkdmFuY2UgdGhlIGRlY29kZXIncyA8bixpPiBzdGF0ZSB0byA8bSwwPixcblx0XHRcdC8vIGJ1dCBndWFyZCBhZ2FpbnN0IG92ZXJmbG93XG5cdFx0XHRoYW5kbGVkQ1BDb3VudFBsdXNPbmUgPSBoYW5kbGVkQ1BDb3VudCArIDE7XG5cdFx0XHRpZiAobSAtIG4gPiBmbG9vcigobWF4SW50IC0gZGVsdGEpIC8gaGFuZGxlZENQQ291bnRQbHVzT25lKSkge1xuXHRcdFx0XHRlcnJvcignb3ZlcmZsb3cnKTtcblx0XHRcdH1cblxuXHRcdFx0ZGVsdGEgKz0gKG0gLSBuKSAqIGhhbmRsZWRDUENvdW50UGx1c09uZTtcblx0XHRcdG4gPSBtO1xuXG5cdFx0XHRmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikge1xuXHRcdFx0XHRjdXJyZW50VmFsdWUgPSBpbnB1dFtqXTtcblxuXHRcdFx0XHRpZiAoY3VycmVudFZhbHVlIDwgbiAmJiArK2RlbHRhID4gbWF4SW50KSB7XG5cdFx0XHRcdFx0ZXJyb3IoJ292ZXJmbG93Jyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoY3VycmVudFZhbHVlID09IG4pIHtcblx0XHRcdFx0XHQvLyBSZXByZXNlbnQgZGVsdGEgYXMgYSBnZW5lcmFsaXplZCB2YXJpYWJsZS1sZW5ndGggaW50ZWdlclxuXHRcdFx0XHRcdGZvciAocSA9IGRlbHRhLCBrID0gYmFzZTsgLyogbm8gY29uZGl0aW9uICovOyBrICs9IGJhc2UpIHtcblx0XHRcdFx0XHRcdHQgPSBrIDw9IGJpYXMgPyB0TWluIDogKGsgPj0gYmlhcyArIHRNYXggPyB0TWF4IDogayAtIGJpYXMpO1xuXHRcdFx0XHRcdFx0aWYgKHEgPCB0KSB7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cU1pbnVzVCA9IHEgLSB0O1xuXHRcdFx0XHRcdFx0YmFzZU1pbnVzVCA9IGJhc2UgLSB0O1xuXHRcdFx0XHRcdFx0b3V0cHV0LnB1c2goXG5cdFx0XHRcdFx0XHRcdHN0cmluZ0Zyb21DaGFyQ29kZShkaWdpdFRvQmFzaWModCArIHFNaW51c1QgJSBiYXNlTWludXNULCAwKSlcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRxID0gZmxvb3IocU1pbnVzVCAvIGJhc2VNaW51c1QpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdG91dHB1dC5wdXNoKHN0cmluZ0Zyb21DaGFyQ29kZShkaWdpdFRvQmFzaWMocSwgMCkpKTtcblx0XHRcdFx0XHRiaWFzID0gYWRhcHQoZGVsdGEsIGhhbmRsZWRDUENvdW50UGx1c09uZSwgaGFuZGxlZENQQ291bnQgPT0gYmFzaWNMZW5ndGgpO1xuXHRcdFx0XHRcdGRlbHRhID0gMDtcblx0XHRcdFx0XHQrK2hhbmRsZWRDUENvdW50O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdCsrZGVsdGE7XG5cdFx0XHQrK247XG5cblx0XHR9XG5cdFx0cmV0dXJuIG91dHB1dC5qb2luKCcnKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSBvciBhbiBlbWFpbCBhZGRyZXNzXG5cdCAqIHRvIFVuaWNvZGUuIE9ubHkgdGhlIFB1bnljb2RlZCBwYXJ0cyBvZiB0aGUgaW5wdXQgd2lsbCBiZSBjb252ZXJ0ZWQsIGkuZS5cblx0ICogaXQgZG9lc24ndCBtYXR0ZXIgaWYgeW91IGNhbGwgaXQgb24gYSBzdHJpbmcgdGhhdCBoYXMgYWxyZWFkeSBiZWVuXG5cdCAqIGNvbnZlcnRlZCB0byBVbmljb2RlLlxuXHQgKiBAbWVtYmVyT2YgcHVueWNvZGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBQdW55Y29kZWQgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcyB0b1xuXHQgKiBjb252ZXJ0IHRvIFVuaWNvZGUuXG5cdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBVbmljb2RlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBQdW55Y29kZVxuXHQgKiBzdHJpbmcuXG5cdCAqL1xuXHRmdW5jdGlvbiB0b1VuaWNvZGUoaW5wdXQpIHtcblx0XHRyZXR1cm4gbWFwRG9tYWluKGlucHV0LCBmdW5jdGlvbihzdHJpbmcpIHtcblx0XHRcdHJldHVybiByZWdleFB1bnljb2RlLnRlc3Qoc3RyaW5nKVxuXHRcdFx0XHQ/IGRlY29kZShzdHJpbmcuc2xpY2UoNCkudG9Mb3dlckNhc2UoKSlcblx0XHRcdFx0OiBzdHJpbmc7XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogQ29udmVydHMgYSBVbmljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSBvciBhbiBlbWFpbCBhZGRyZXNzIHRvXG5cdCAqIFB1bnljb2RlLiBPbmx5IHRoZSBub24tQVNDSUkgcGFydHMgb2YgdGhlIGRvbWFpbiBuYW1lIHdpbGwgYmUgY29udmVydGVkLFxuXHQgKiBpLmUuIGl0IGRvZXNuJ3QgbWF0dGVyIGlmIHlvdSBjYWxsIGl0IHdpdGggYSBkb21haW4gdGhhdCdzIGFscmVhZHkgaW5cblx0ICogQVNDSUkuXG5cdCAqIEBtZW1iZXJPZiBwdW55Y29kZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIGRvbWFpbiBuYW1lIG9yIGVtYWlsIGFkZHJlc3MgdG8gY29udmVydCwgYXMgYVxuXHQgKiBVbmljb2RlIHN0cmluZy5cblx0ICogQHJldHVybnMge1N0cmluZ30gVGhlIFB1bnljb2RlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBkb21haW4gbmFtZSBvclxuXHQgKiBlbWFpbCBhZGRyZXNzLlxuXHQgKi9cblx0ZnVuY3Rpb24gdG9BU0NJSShpbnB1dCkge1xuXHRcdHJldHVybiBtYXBEb21haW4oaW5wdXQsIGZ1bmN0aW9uKHN0cmluZykge1xuXHRcdFx0cmV0dXJuIHJlZ2V4Tm9uQVNDSUkudGVzdChzdHJpbmcpXG5cdFx0XHRcdD8gJ3huLS0nICsgZW5jb2RlKHN0cmluZylcblx0XHRcdFx0OiBzdHJpbmc7XG5cdFx0fSk7XG5cdH1cblxuXHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHQvKiogRGVmaW5lIHRoZSBwdWJsaWMgQVBJICovXG5cdHB1bnljb2RlID0ge1xuXHRcdC8qKlxuXHRcdCAqIEEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBQdW55Y29kZS5qcyB2ZXJzaW9uIG51bWJlci5cblx0XHQgKiBAbWVtYmVyT2YgcHVueWNvZGVcblx0XHQgKiBAdHlwZSBTdHJpbmdcblx0XHQgKi9cblx0XHQndmVyc2lvbic6ICcxLjMuMicsXG5cdFx0LyoqXG5cdFx0ICogQW4gb2JqZWN0IG9mIG1ldGhvZHMgdG8gY29udmVydCBmcm9tIEphdmFTY3JpcHQncyBpbnRlcm5hbCBjaGFyYWN0ZXJcblx0XHQgKiByZXByZXNlbnRhdGlvbiAoVUNTLTIpIHRvIFVuaWNvZGUgY29kZSBwb2ludHMsIGFuZCBiYWNrLlxuXHRcdCAqIEBzZWUgPGh0dHBzOi8vbWF0aGlhc2J5bmVucy5iZS9ub3Rlcy9qYXZhc2NyaXB0LWVuY29kaW5nPlxuXHRcdCAqIEBtZW1iZXJPZiBwdW55Y29kZVxuXHRcdCAqIEB0eXBlIE9iamVjdFxuXHRcdCAqL1xuXHRcdCd1Y3MyJzoge1xuXHRcdFx0J2RlY29kZSc6IHVjczJkZWNvZGUsXG5cdFx0XHQnZW5jb2RlJzogdWNzMmVuY29kZVxuXHRcdH0sXG5cdFx0J2RlY29kZSc6IGRlY29kZSxcblx0XHQnZW5jb2RlJzogZW5jb2RlLFxuXHRcdCd0b0FTQ0lJJzogdG9BU0NJSSxcblx0XHQndG9Vbmljb2RlJzogdG9Vbmljb2RlXG5cdH07XG5cblx0LyoqIEV4cG9zZSBgcHVueWNvZGVgICovXG5cdC8vIFNvbWUgQU1EIGJ1aWxkIG9wdGltaXplcnMsIGxpa2Ugci5qcywgY2hlY2sgZm9yIHNwZWNpZmljIGNvbmRpdGlvbiBwYXR0ZXJuc1xuXHQvLyBsaWtlIHRoZSBmb2xsb3dpbmc6XG5cdGlmIChcblx0XHR0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiZcblx0XHR0eXBlb2YgZGVmaW5lLmFtZCA9PSAnb2JqZWN0JyAmJlxuXHRcdGRlZmluZS5hbWRcblx0KSB7XG5cdFx0ZGVmaW5lKCdwdW55Y29kZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHB1bnljb2RlO1xuXHRcdH0pO1xuXHR9IGVsc2UgaWYgKGZyZWVFeHBvcnRzICYmIGZyZWVNb2R1bGUpIHtcblx0XHRpZiAobW9kdWxlLmV4cG9ydHMgPT0gZnJlZUV4cG9ydHMpIHtcblx0XHRcdC8vIGluIE5vZGUuanMsIGlvLmpzLCBvciBSaW5nb0pTIHYwLjguMCtcblx0XHRcdGZyZWVNb2R1bGUuZXhwb3J0cyA9IHB1bnljb2RlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBpbiBOYXJ3aGFsIG9yIFJpbmdvSlMgdjAuNy4wLVxuXHRcdFx0Zm9yIChrZXkgaW4gcHVueWNvZGUpIHtcblx0XHRcdFx0cHVueWNvZGUuaGFzT3duUHJvcGVydHkoa2V5KSAmJiAoZnJlZUV4cG9ydHNba2V5XSA9IHB1bnljb2RlW2tleV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSBlbHNlIHtcblx0XHQvLyBpbiBSaGlubyBvciBhIHdlYiBicm93c2VyXG5cdFx0cm9vdC5wdW55Y29kZSA9IHB1bnljb2RlO1xuXHR9XG5cbn0odGhpcykpO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0FcbiAqIENvcHlyaWdodCAyMDE2IElORVNDLUlEXG4gKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcbiAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WXG4gKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcbiAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcbiAqIENvcHlyaWdodCAyMDE2IEFwaXplZVxuICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICoqL1xuY29uc3QgbWV0aG9kcyA9IHtHRVQ6ICdnZXQnLCBQT1NUOiAncG9zdCd9XG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFJlcXVlc3RcbiAqIEBkZXNjIEJyaWRnZSB0byBtYWtlIEhUVFAgcmVxdWVzdHNcbiAqIEBwcm9wZXJ0eSB7ZnVuY3Rpb24odXJsOnN0cmluZywgb3B0aW9uczpPYmplY3QpOnN0cmluZ30gZ2V0XG4gKiBAcHJvcGVydHkge2Z1bmN0aW9uKHVybDpzdHJpbmcsIG9wdGlvbnM6T2JqZWN0KTpzdHJpbmd9IHBvc3RcbiAqL1xuXG4vKipcbiAqIEJyaWRnZSB0byBtYWtlIEhUVFAgcmVxdWVzdHNcbiAqL1xuY2xhc3MgUmVxdWVzdCB7XG5cblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0bGV0IF90aGlzID0gdGhpc1xuXG5cdFx0T2JqZWN0LmtleXMobWV0aG9kcykuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHtcblx0XHRcdF90aGlzW21ldGhvZHNbbWV0aG9kXV0gPSBmdW5jdGlvbih1cmwsIG9wdGlvbnMpIHtcblx0XHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0XHRcdF90aGlzLl9tYWtlTG9jYWxSZXF1ZXN0KG1ldGhvZHNbbWV0aG9kXS50b1VwcGVyQ2FzZSgpLCB1cmwsIG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKHJlc3VsdClcblx0XHRcdFx0XHR9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pIHtcblx0XHRcdFx0XHRcdHJlamVjdChyZWFzb24pXG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9KVxuXHR9XG5cblx0X21ha2VMb2NhbFJlcXVlc3QobWV0aG9kLCB1cmwsIG9wdGlvbnMpIHtcblx0XHRsZXQgX3RoaXMgPSB0aGlzXG5cblx0XHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHR1cmwgPSBfdGhpcy5fbWFwUHJvdG9jb2wodXJsKVxuXHRcdFx0bGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpXG5cblx0XHRcdHhoci5vcGVuKG1ldGhvZCwgdXJsLCB0cnVlKVxuXG5cdFx0XHR4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdFx0bGV0IHhociA9IGV2ZW50LmN1cnJlbnRUYXJnZXRcblx0XHRcdFx0aWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7XG5cdFx0XHRcdFx0aWYgKHhoci5zdGF0dXMgPj0gMjAwIHx8IHhoci5zdGF0dXMgPD0gMjk5KSB7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKHhoci5yZXNwb25zZVRleHQpXG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHJlamVjdCh4aHIucmVzcG9uc2VUZXh0KVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZihvcHRpb25zICYmIG9wdGlvbnMuaGVhZGVycykge1xuXHRcdFx0XHRmb3IobGV0IHByb3AgaW4gb3B0aW9ucy5oZWFkZXJzKSB7XG5cdFx0XHRcdFx0eGhyLnNldFJlcXVlc3RIZWFkZXIocHJvcCwgb3B0aW9ucy5oZWFkZXJzW3Byb3BdKVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHhoci5zZW5kKG9wdGlvbnM/b3B0aW9ucy5ib2R5Om51bGwpXG5cdFx0fSlcblxuXHR9XG5cblx0X21hcFByb3RvY29sKHVybCkge1xuXHRcdGxldCBwcm90b2NvbG1hcCA9IHtcblx0XHRcdCdsb2NhbGhvc3Q6Ly8nOiAnaHR0cHM6Ly8nLFxuXHRcdFx0J3VuZGVmaW5lZDovLyc6ICdodHRwczovLycsXG5cdFx0XHQnaHlwZXJ0eS1jYXRhbG9ndWU6Ly8nOiAnaHR0cHM6Ly8nLFxuXHRcdFx0J2h0dHBzOi8vJzogJ2h0dHBzOi8vJyxcblx0XHRcdCdodHRwOi8vJzogJ2h0dHA6Ly8nXG5cdFx0fVxuXG5cdFx0bGV0IGZvdW5kUHJvdG9jb2wgPSBmYWxzZVxuXHRcdGZvciAobGV0IHByb3RvY29sIGluIHByb3RvY29sbWFwKSB7XG5cdFx0XHRpZiAodXJsLnNsaWNlKDAsIHByb3RvY29sLmxlbmd0aCkgPT09IHByb3RvY29sKSB7XG5cdFx0XHRcdHVybCA9IHByb3RvY29sbWFwW3Byb3RvY29sXSArIHVybC5zbGljZShwcm90b2NvbC5sZW5ndGgsIHVybC5sZW5ndGgpXG5cdFx0XHRcdGZvdW5kUHJvdG9jb2wgPSB0cnVlXG5cdFx0XHRcdGJyZWFrXG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCFmb3VuZFByb3RvY29sKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcHJvdG9jb2wgb2YgdXJsOiAnICsgdXJsKVxuXHRcdH1cblxuXHRcdHJldHVybiB1cmxcblx0fVxufVxuXG5leHBvcnQgZGVmYXVsdCBSZXF1ZXN0XG4iLCIvLyBUT0RPOiBpbXBvcnQgYW5kIGV4dGVuZCB0aGUgY2xhc3Mgb2YgdGhlIHNlcnZpY2UtZnJhbWV3b3JrXG4vLyBzZXJ2aWNlLWZyYW1ld29yay9kaXN0L1J1bnRpbWVDYXBhYmlsaXRpZXM7XG5cbmNsYXNzIFJ1bnRpbWVDYXBhYmlsaXRpZXMge1xuXG4gIGNvbnN0cnVjdG9yKHN0b3JhZ2VNYW5hZ2VyKSB7XG4gICAgaWYgKCFzdG9yYWdlTWFuYWdlcikgdGhyb3cgbmV3IEVycm9yKCdUaGUgUnVudGltZSBDYXBhYmlsaXRpZXMgbmVlZCB0aGUgc3RvcmFnZU1hbmFnZXInKTtcblxuICAgIHRoaXMuc3RvcmFnZU1hbmFnZXIgPSBzdG9yYWdlTWFuYWdlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFzIGEgcHJvbWlzZSBSdW50aW1lQ2FwYWJpbGl0aWVzIGpzb24gb2JqZWN0IHdpdGggYWxsIGF2YWlsYWJsZSBjYXBhYmlsaXRpZXMgb2YgdGhlIHJ1bnRpbWUuXG4gICAqIElmIGl0IHdhcyBub3QgeWV0IHBlcnNpc3RlZCBpbiB0aGUgU3RvcmFnZSBNYW5hZ2VyIGl0IGNvbGxlY3RzIGFsbCByZXF1aXJlZCBpbmZvIGZyb20gdGhlIHBsYXRmb3JtIGFuZCBzYXZlcyBpbiB0aGUgc3RvcmFnZSBtYW5hZ2VyLlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxvYmplY3Q+fVxuICAgKi9cbiAgZ2V0UnVudGltZUNhcGFiaWxpdGllcygpIHtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgIFByb21pc2UuYWxsKFt0aGlzLl9nZXRFbnZpcm9ubWVudCgpLCB0aGlzLl9nZXRNZWRpYURldmljZXMoKV0pLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICBsZXQgY2FwYWJpbGl0aWVzID0ge307XG4gICAgICAgIHJlc3VsdC5mb3JFYWNoKChjYXBhYmlsaXR5KSA9PiB7XG4gICAgICAgICAgT2JqZWN0LmFzc2lnbihjYXBhYmlsaXRpZXMsIGNhcGFiaWxpdHkpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnN0b3JhZ2VNYW5hZ2VyLnNldCgnY2FwYWJpbGl0aWVzJywgJzEnLCBjYXBhYmlsaXRpZXMpO1xuXG4gICAgICAgIHJlc29sdmUoY2FwYWJpbGl0aWVzKTtcbiAgICAgIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgfSk7XG5cbiAgICB9KTtcblxuICB9XG5cbiAgLyoqXG4gICAqIHJldHVybnMgYXMgYSBwcm9taXNlIGEgYm9vbGVhbiBhY2NvcmRpbmcgdG8gYXZhaWxhYmxlIGNhcGFiaWxpdGllcy5cbiAgICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59XG4gICAqL1xuICBpc0F2YWlsYWJsZShjYXBhYmlsaXR5KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG5cbiAgICAgIHRoaXMuc3RvcmFnZU1hbmFnZXIuZ2V0KCdjYXBhYmlsaXRpZXMnKS50aGVuKChjYXBhYmlsaXRpZXMpID0+IHtcblxuICAgICAgICBjb25zb2xlLmxvZygnQ2FwYWJpbGl0eSAnICsgY2FwYWJpbGl0eSArICcgaXMgYXZhaWxhYmxlPyAnLCBjYXBhYmlsaXRpZXMuaGFzT3duUHJvcGVydHkoY2FwYWJpbGl0eSkgJiYgY2FwYWJpbGl0aWVzW2NhcGFiaWxpdHldKTtcbiAgICAgICAgaWYgKGNhcGFiaWxpdGllcy5oYXNPd25Qcm9wZXJ0eShjYXBhYmlsaXR5KSAmJiBjYXBhYmlsaXRpZXNbY2FwYWJpbGl0eV0pIHtcbiAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIGl0IHJlZnJlc2hlcyBwcmV2aW91c2x5IGNvbGxlY3RlZCBjYXBhYmlsaXRpZXMgYW5kIHVwZGF0ZXMgdGhlIHN0b3JhZ2UgbWFuYWdlclxuICAgKi9cbiAgdXBkYXRlKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0aGlzLmdldFJ1bnRpbWVDYXBhYmlsaXRpZXMoKS50aGVuKHJlc29sdmUpLmNhdGNoKHJlamVjdCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBUT0RPOiBvcmdhbml6ZSB0aGUgY29kZSBpbiBzZXBhcmF0ZWQgZmlsZXNcbiAgX2dldEVudmlyb25tZW50KCkge1xuXG4gICAgLy8gVE9ETzogdGhpcyBzaG91bGQgYmUgbW9yZSBlZmZlY3RpdmUgYW5kIGNoZWNrIHRoZSBlbnZpcm9ubWVudFxuICAgIHJldHVybiB7XG4gICAgICBicm93c2VyOiAhISh3aW5kb3cgJiYgbmF2aWdhdG9yKSxcbiAgICAgIG5vZGU6ICEhISh3aW5kb3cgJiYgbmF2aWdhdG9yKVxuICAgIH07XG4gIH1cblxuICAvLyBUT0RPOiBvcmdhbml6ZSB0aGUgY29kZSBpbiBzZXBhcmF0ZWQgZmlsZXNcbiAgX2dldE1lZGlhRGV2aWNlcygpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblxuICAgICAgbGV0IGNhcGFiaWxpdHkgPSB7fTtcblxuICAgICAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzIHx8ICFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VudW1lcmF0ZURldmljZXMoKSBub3Qgc3VwcG9ydGVkLicpO1xuICAgICAgICByZXNvbHZlKGNhcGFiaWxpdHkpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIExpc3QgY2FtZXJhcyBhbmQgbWljcm9waG9uZXMuXG4gICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMoKVxuICAgICAgLnRoZW4oKGRldmljZXMpID0+IHtcbiAgICAgICAgZGV2aWNlcy5mb3JFYWNoKChkZXZpY2UpID0+IHtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZygnRGV2aWNlczonLCBkZXZpY2Uua2luZCwgZGV2aWNlLmxhYmVsLCBkZXZpY2UuZGV2aWNlSWQpO1xuICAgICAgICAgIGlmIChkZXZpY2Uua2luZCA9PT0gJ2F1ZGlvaW5wdXQnKSB7XG4gICAgICAgICAgICBjYXBhYmlsaXR5Lm1pYyA9IHRydWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGRldmljZS5raW5kID09PSAndmlkZW9pbnB1dCcpIHtcbiAgICAgICAgICAgIGNhcGFiaWxpdHkuY2FtZXJhID0gdHJ1ZTtcblx0ICAgIGNhcGFiaWxpdHkud2luZG93U2FuZGJveCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmVzb2x2ZShjYXBhYmlsaXR5KTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICByZXNvbHZlKGNhcGFiaWxpdHkpO1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIubmFtZSArICc6ICcgKyBlcnIubWVzc2FnZSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IFJ1bnRpbWVDYXBhYmlsaXRpZXM7XG4iLCIvKipcbiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBXG4qIENvcHlyaWdodCAyMDE2IElORVNDLUlEXG4qIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTFxuKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVlxuKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0FcbiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBR1xuKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWVcbiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU5cbipcbiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbipcbiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbipcbiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4qIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4qIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKiovXG5pbXBvcnQgUGVyc2lzdGVuY2VNYW5hZ2VyIGZyb20gJ3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvUGVyc2lzdGVuY2VNYW5hZ2VyJztcbmltcG9ydCB7IGNyZWF0ZVNhbmRib3ggfSBmcm9tICcuL1NhbmRib3hlcyc7XG5pbXBvcnQgU2FuZGJveEFwcCBmcm9tICcuL1NhbmRib3hBcHAnO1xuaW1wb3J0IFJlcXVlc3QgZnJvbSAnLi9SZXF1ZXN0JztcbmltcG9ydCBSdW50aW1lQ2FwYWJpbGl0aWVzIGZyb20gJy4vUnVudGltZUNhcGFiaWxpdGllcyc7XG5pbXBvcnQgU3RvcmFnZU1hbmFnZXIgZnJvbSAnc2VydmljZS1mcmFtZXdvcmsvZGlzdC9TdG9yYWdlTWFuYWdlcic7XG5pbXBvcnQgRGV4aWUgZnJvbSAnZGV4aWUnO1xuaW1wb3J0IHsgUnVudGltZUNhdGFsb2d1ZSB9IGZyb20gJ3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvUnVudGltZUNhdGFsb2d1ZSc7XG5cbi8qKlxuICogSXMgYSBicmlkZ2UgdG8gaXNvbGF0ZSB0aGUgcnVudGltZSBmcm9tIHRoZSBzcGVjaWZpYyBwbGF0Zm9ybVxuICogQHR5cGVkZWYge09iamVjdH0gUnVudGltZUZhY3RvcnlcbiAqIEBwcm9wZXJ0eSB7ZnVuY3Rpb24oKTpTYW5kYm94fSBjcmVhdGVTYW5kYm94IENyZWF0ZXMgYSBuZXcgU2FuZGJveFxuICogQHByb3BlcnR5IHtmdW5jdGlvbigpOlNhbmRib3hBcHB9IGNyZWF0ZUFwcFNhbmRib3ggQ3JlYXRlcyBhIG5ldyBTYW5kYm94QXBwXG4gKiBAcHJvcGVydHkge2Z1bmN0aW9uKCk6UmVxdWVzdH0gY3JlYXRlSHR0cFJlcXVlc3QgQ3JlYXRlcyBhIG5ldyBSZXF1ZXN0IG9iamVjdFxuICogQHByb3BlcnR5IHtmdW5jdGlvbigpOlJ1bnRpbWVDYXRhbG9ndWV9IGNyZWF0ZVJ1bnRpbWVDYXRhbG9ndWUgQ3JlYXRlcyBhIG5ldyBSdW50aW1lQ2F0YWxvZ3VlXG4gKiBAcHJvcGVydHkge2Z1bmN0aW9uKEVuY29kZWQgZGF0YTogc3RyaW5nKTpzdHJpbmd9IGF0b2IgUmV0dXJucyB0aGUgc3RyaW5nIGRlY29kZWRcbiAqIEBwcm9wZXJ0eSB7ZnVuY3Rpb24oKTpQZXJzaXN0ZW5jZU1hbmFnZXJ9IHBlcnNpc3RlbmNlTWFuYWdlciBSZXR1cm5zIGEgbmV3IFBlcnNpc3RlbmNlTWFuYWdlclxuICogQHByb3BlcnR5IHtmdW5jdGlvbigpOlN0b3JhZ2VNYW5hZ2VyfSBzdG9yYWdlTWFuYWdlciBSZXR1cm5zIGEgbmV3IFN0b3JhZ2VNYW5hZ2VyXG4gKiBAcHJvcGVydHkge2Z1bmN0aW9uKCk6UnVudGltZUNhcGFiaWxpdGllc30gcnVudGltZUNhcGFiaWxpdGllcyBSZXR1cm5zIGEgbmV3IFJ1bnRpbWVDYXBhYmlsaXRpZXNcbiAqL1xuZXhwb3J0IGRlZmF1bHQge1xuICBjcmVhdGVTYW5kYm94KGNvbnN0cmFpbnRzKSB7XG4gICAgcmV0dXJuIGNyZWF0ZVNhbmRib3goY29uc3RyYWludHMpO1xuICB9LFxuXG4gIGNyZWF0ZUFwcFNhbmRib3goKSB7XG4gICAgcmV0dXJuIG5ldyBTYW5kYm94QXBwKCk7XG4gIH0sXG5cbiAgY3JlYXRlSHR0cFJlcXVlc3QoKSB7XG4gICAgbGV0IHJlcXVlc3QgPSBuZXcgUmVxdWVzdCgpO1xuICAgIHJldHVybiByZXF1ZXN0O1xuICB9LFxuXG4gIGNyZWF0ZVJ1bnRpbWVDYXRhbG9ndWUoKSB7XG4gICAgaWYgKCF0aGlzLmNhdGFsb2d1ZSkgeyB0aGlzLmNhdGFsb2d1ZSA9IG5ldyBSdW50aW1lQ2F0YWxvZ3VlKHRoaXMpOyB9XG5cbiAgICByZXR1cm4gdGhpcy5jYXRhbG9ndWU7XG4gIH0sXG5cbiAgYXRvYihiNjQpIHtcbiAgICByZXR1cm4gYXRvYihiNjQpO1xuICB9LFxuXG4gIHBlcnNpc3RlbmNlTWFuYWdlcigpIHtcbiAgICBsZXQgbG9jYWxTdG9yYWdlID0gd2luZG93LmxvY2FsU3RvcmFnZTtcbiAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlTWFuYWdlcihsb2NhbFN0b3JhZ2UpO1xuICB9LFxuICBzdG9yYWdlTWFuYWdlcihuYW1lLCBzY2hlbWFzKSB7XG5cbiAgICBpZiAoIXRoaXMuZGF0YWJhc2VzKSB7IHRoaXMuZGF0YWJhc2VzID0ge307IH1cbiAgICBpZiAoIXRoaXMuc3RvcmVNYW5hZ2VyKSB7IHRoaXMuc3RvcmVNYW5hZ2VyID0ge307IH1cblxuICAgIC8vIFRvIG1ha2UgdGhlIHN0b3JhZ2UgcGVyc2l0ZW50IGFuZCBub3cgYWxsb3cgdGhlIHN5c3RlbSBjbGVhciB0aGUgc3RvcmFnZSB3aGVuIGlzIHVuZGVyIHByZXNzdXJlO1xuICAgIGlmIChuYXZpZ2F0b3IgJiYgbmF2aWdhdG9yLnN0b3JhZ2UgJiYgbmF2aWdhdG9yLnN0b3JhZ2UucGVyc2lzdCkge1xuICAgICAgbmF2aWdhdG9yLnN0b3JhZ2UucGVyc2lzdCgpLnRoZW4oZnVuY3Rpb24ocGVyc2lzdGVudCkge1xuICAgICAgICBpZiAocGVyc2lzdGVudCkgeyBjb25zb2xlLmxvZygnU3RvcmFnZSB3aWxsIG5vdCBiZSBjbGVhcmVkIGV4Y2VwdCBieSBleHBsaWNpdCB1c2VyIGFjdGlvbicpOyB9IGVsc2UgeyBjb25zb2xlLmxvZygnU3RvcmFnZSBtYXkgYmUgY2xlYXJlZCBieSB0aGUgVUEgdW5kZXIgc3RvcmFnZSBwcmVzc3VyZS4nKTsgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gVXNpbmcgdGhlIGltcGxlbWVudGF0aW9uIG9mIFNlcnZpY2UgRnJhbWV3b3JrXG4gICAgLy8gRGV4aWUgaXMgdGhlIEluZGV4REIgV3JhcHBlclxuICAgIGlmICghdGhpcy5kYXRhYmFzZXMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgIHRoaXMuZGF0YWJhc2VzW25hbWVdID0gbmV3IERleGllKG5hbWUpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5zdG9yZU1hbmFnZXIuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgIHRoaXMuc3RvcmVNYW5hZ2VyW25hbWVdID0gbmV3IFN0b3JhZ2VNYW5hZ2VyKHRoaXMuZGF0YWJhc2VzW25hbWVdLCBuYW1lLCBzY2hlbWFzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5zdG9yZU1hbmFnZXJbbmFtZV07XG4gIH0sXG5cbiAgcnVudGltZUNhcGFiaWxpdGllcygpIHtcblxuICAgIGlmICghdGhpcy5jYXBhYmlsaXRpZXNNYW5hZ2VyKSB7XG4gICAgICBsZXQgc3RvcmFnZU1hbmFnZXIgPSB0aGlzLnN0b3JhZ2VNYW5hZ2VyKCdjYXBhYmlsaXRpZXMnKTtcbiAgICAgIHRoaXMuY2FwYWJpbGl0aWVzTWFuYWdlciA9IG5ldyBSdW50aW1lQ2FwYWJpbGl0aWVzKHN0b3JhZ2VNYW5hZ2VyKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5jYXBhYmlsaXRpZXNNYW5hZ2VyO1xuICB9XG59O1xuIiwiLyoqXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXG4qXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4qXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4qXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbioqL1xuaW1wb3J0IHsgU2FuZGJveCwgU2FuZGJveFR5cGUgfSBmcm9tICdydW50aW1lLWNvcmUvZGlzdC9zYW5kYm94JztcbmltcG9ydCBNaW5pQnVzIGZyb20gJ3J1bnRpbWUtY29yZS9kaXN0L21pbmlidXMnO1xuXG4vKipcbiAqIFByb3h5IGZvciB0aGUgQXBwbGljYXRpb24gY29udGV4dFxuICogKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNhbmRib3hBcHAgZXh0ZW5kcyBTYW5kYm94IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIC8qKlxuXHRcdCAqIEB0eXBlIHtydW50aW1lLWNvcmUvZGlzdC9zYW5kYm94L1NhbmRib3hUeXBlfVxuXHRcdCAqL1xuICAgIHRoaXMudHlwZSA9IFNhbmRib3hUeXBlLk5PUk1BTDtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGlmICghdGhpcy5vcmlnaW4pIHtcbiAgICAgICAgLyoqXG5cdFx0XHRcdCAqIEB0eXBlIHtXaW5kb3d9XG5cdFx0XHRcdCAqL1xuICAgICAgICB0aGlzLm9yaWdpbiA9IGUuc291cmNlO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGUuZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoZS5kYXRhLmhhc093blByb3BlcnR5KCd0bycpICYmIGUuZGF0YS50by5zdGFydHNXaXRoKCdjb3JlOicpKSB7IHJldHVybjsgfVxuXG4gICAgICAvLyB0aGlzLl9vbk1lc3NhZ2UoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShlLmRhdGEpKSk7XG4gICAgICB0aGlzLl9vbk1lc3NhZ2UoZS5kYXRhKTtcbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTQU5EQk9YIEFQUF0gLSBFcnJvcicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgfVxuXG4gIF9vblBvc3RNZXNzYWdlKG1zZykge1xuICAgIHRoaXMub3JpZ2luLnBvc3RNZXNzYWdlKG1zZywgJyonKTtcbiAgfVxufVxuIiwiLyoqXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXG4qXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4qXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4qXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbioqL1xuaW1wb3J0IHsgU2FuZGJveCwgU2FuZGJveFR5cGUgfSBmcm9tICdydW50aW1lLWNvcmUvZGlzdC9zYW5kYm94JztcbmltcG9ydCBNaW5pQnVzIGZyb20gJ3J1bnRpbWUtY29yZS9kaXN0L21pbmlidXMnO1xuaW1wb3J0IFJ1bnRpbWVGYWN0b3J5IGZyb20gJy4vUnVudGltZUZhY3RvcnknO1xuXG4vKipcbiAqIFByb3h5IGZvciBhIFdlYldvcmtlclxuICogKi9cbmV4cG9ydCBjbGFzcyBTYW5kYm94V29ya2VyIGV4dGVuZHMgU2FuZGJveCB7XG4gIHN0YXRpYyBjYXBhYmlsaXRpZXMoKSB7XG4gICAgcmV0dXJuIFJ1bnRpbWVGYWN0b3J5LnJ1bnRpbWVDYXBhYmlsaXRpZXMoKS5nZXRSdW50aW1lQ2FwYWJpbGl0aWVzKClcbiAgICAgIC50aGVuKGNhcGFiaWxpdGllcyA9Pk9iamVjdC5hc3NpZ24oY2FwYWJpbGl0aWVzLCB7IG1pYzogZmFsc2UsIGNhbWVyYTogZmFsc2UsIHdpbmRvd1NhbmRib3g6IGZhbHNlIH0pKTtcbiAgfVxuXG4gIHN0YXRpYyBuZXcoY2FwYWJpbGl0aWVzKSB7XG4gICAgcmV0dXJuIG5ldyBTYW5kYm94V29ya2VyKGNhcGFiaWxpdGllcywgJy4vY29udGV4dC1zZXJ2aWNlLmpzJyk7XG4gIH1cblxuICAvKipcblx0ICogQHBhcmFtIHtzdHJpbmd9IHNjcmlwdCAtIFNjcmlwdCB0aGF0IHdpbGwgYmUgbG9hZGVkIGluIHRoZSB3ZWIgd29ya2VyXG5cdCAqL1xuICBjb25zdHJ1Y3RvcihjYXBhYmlsaXRpZXMsIHNjcmlwdCkge1xuICAgIHN1cGVyKGNhcGFiaWxpdGllcyk7XG5cbiAgICAvKipcblx0XHQgKiBAdHlwZSB7cnVudGltZS1jb3JlL2Rpc3Qvc2FuZGJveC9TYW5kYm94VHlwZX1cblx0XHQgKi9cbiAgICB0aGlzLnR5cGUgPSBTYW5kYm94VHlwZS5OT1JNQUw7XG4gICAgaWYgKFdvcmtlcikge1xuICAgICAgdGhpcy5fd29ya2VyID0gbmV3IFdvcmtlcihzY3JpcHQpO1xuICAgICAgdGhpcy5fd29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIHRoaXMuX29uTWVzc2FnZShlLmRhdGEpO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgdGhpcy5fd29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tTYW5kYm94IFdvcmtlcl0gLSBFcnJvcjogJywgZXJyb3IpO1xuICAgICAgICB0aHJvdyBKU09OLnN0cmluZ2lmeShlcnJvcik7XG4gICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICB0aGlzLl93b3JrZXIucG9zdE1lc3NhZ2UoJycpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdXIgZW52aXJvbm1lbnQgZG9lcyBub3Qgc3VwcG9ydCB3b3JrZXIgXFxuJyk7XG4gICAgfVxuICB9XG5cbiAgX29uUG9zdE1lc3NhZ2UobXNnKSB7XG4gICAgdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKG1zZyk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFNhbmRib3hXaW5kb3cgZXh0ZW5kcyBTYW5kYm94IHtcbiAgc3RhdGljIGNhcGFiaWxpdGllcygpIHtcbiAgICByZXR1cm4gUnVudGltZUZhY3RvcnkucnVudGltZUNhcGFiaWxpdGllcygpLmdldFJ1bnRpbWVDYXBhYmlsaXRpZXMoKTtcbiAgfVxuXG4gIHN0YXRpYyBuZXcoY2FwYWJpbGl0aWVzKSB7XG4gICAgcmV0dXJuIG5ldyBTYW5kYm94V2luZG93KGNhcGFiaWxpdGllcyk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihjYXBhYmlsaXRpZXMpIHtcbiAgICBzdXBlcihjYXBhYmlsaXRpZXMpO1xuXG4gICAgdGhpcy50eXBlID0gU2FuZGJveFR5cGUuV0lORE9XO1xuICAgIHRoaXMuY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpO1xuXG4gICAgdGhpcy5jaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHRoaXMuX29uTWVzc2FnZShlLmRhdGEpO1xuICAgIH0uYmluZCh0aGlzKTtcblxuICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IHRvOiAncnVudGltZTpjcmVhdGVTYW5kYm94V2luZG93JyB9LCAnKicsIFt0aGlzLmNoYW5uZWwucG9ydDJdKTtcbiAgfVxuXG4gIF9vblBvc3RNZXNzYWdlKG1zZykge1xuICAgIHRoaXMuY2hhbm5lbC5wb3J0MS5wb3N0TWVzc2FnZShtc2cpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTYW5kYm94KGNvbnN0cmFpbnRzKSB7XG4gIGNvbnN0IHNhbmRib3hlcyA9IFtTYW5kYm94V29ya2VyLCBTYW5kYm94V2luZG93XTtcbiAgbGV0IGRpZmYgPSAoYSwgYikgPT4gT2JqZWN0LmtleXMoYSkuZmlsdGVyKHggPT4gYVt4XSAhPT0gYlt4XSk7XG5cbiAgcmV0dXJuIFByb21pc2UuYWxsKHNhbmRib3hlcy5tYXAocyA9PiBzLmNhcGFiaWxpdGllcygpLnRoZW4oYz0+eyByZXR1cm4ge2NhcGFiaWxpdGllczogYywgc2FuZGJveDogc307IH0pKSlcbiAgICAudGhlbihzYnMgPT4ge1xuICAgICAgbGV0IGkgPSAwO1xuICAgICAgd2hpbGUgKGkgPCBzYnMubGVuZ3RoKSB7XG4gICAgICAgIGlmIChkaWZmKGNvbnN0cmFpbnRzLCBzYnNbaV0uY2FwYWJpbGl0aWVzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICBsZXQgY2FwYWJpbGl0aWVzID0gc2JzW2ldLmNhcGFiaWxpdGllcztcbiAgICAgICAgICBsZXQgc2FuZGJveCA9IHNic1tpXS5zYW5kYm94Lm5ldyhjYXBhYmlsaXRpZXMpO1xuICAgICAgICAgIHJldHVybiBzYW5kYm94O1xuICAgICAgICB9XG5cbiAgICAgICAgaSsrO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdOb25lIG9mIHN1cHBvcnRlZCBzYW5kYm94ZXMgbWF0Y2ggeW91ciBjb25zdHJhaW50cycpO1xuICAgIH0pO1xufVxuIiwiLy8ganNoaW50IGJyb3dzZXI6dHJ1ZSwganF1ZXJ5OiB0cnVlXG5cbmNsYXNzIElkZW50aXRpZXNHVUkge1xuXG4gIGNvbnN0cnVjdG9yKGd1aVVSTCwgaWRtVVJMLCBtZXNzYWdlQnVzKSB7XG4gICAgY29uc29sZS5sb2coJ0lkZW50aXRpZXNHVUknLCB0aGlzKTtcbiAgICAvL2lmICghaWRlbnRpdHlNb2R1bGUpIHRocm93IEVycm9yKCdJZGVudGl0eSBNb2R1bGUgbm90IHNldCEnKTtcbiAgICBpZiAoIW1lc3NhZ2VCdXMpIHRocm93IEVycm9yKCdNZXNzYWdlIEJ1cyBub3Qgc2V0IScpO1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgX3RoaXMuX2d1aVVSTCA9IGd1aVVSTDtcbiAgICBfdGhpcy5faWRtVVJMID0gaWRtVVJMO1xuICAgIF90aGlzLl9tZXNzYWdlQnVzID0gbWVzc2FnZUJ1cztcbiAgICBfdGhpcy5fYWxyZWFkeVJlTG9naW4gPSBmYWxzZTtcbiAgICBfdGhpcy5fYWxyZWFkeUxvZ2luID0gZmFsc2U7XG5cbiAgICB0aGlzLmNhbGxJZGVudGl0eU1vZHVsZUZ1bmMoJ2RlcGxveUdVSScsIHt9KS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLl9idWlsZERyYXdlcigpO1xuICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ1JFQURZOicsIHJlc3VsdCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmlzTG9nZ2VkID0gZmFsc2U7XG5cbiAgICBjb25zdCBkcmF3ZXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZGMtdGVtcG9yYXJ5LWRyYXdlcicpO1xuICAgIGNvbnN0IE1EQ1RlbXBvcmFyeURyYXdlciA9IG1kYy5kcmF3ZXIuTURDVGVtcG9yYXJ5RHJhd2VyO1xuICAgIGNvbnN0IGRyYXdlciA9IG5ldyBNRENUZW1wb3JhcnlEcmF3ZXIoZHJhd2VyRWwpO1xuXG4gICAgdGhpcy5fZHJhd2VyRWwgPSBkcmF3ZXJFbDtcbiAgICB0aGlzLl9kcmF3ZXIgPSBkcmF3ZXI7XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZ3MtYnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgIGRyYXdlci5vcGVuID0gdHJ1ZTtcbiAgICB9KTtcblxuICAgIGRyYXdlckVsLmFkZEV2ZW50TGlzdGVuZXIoJ01EQ1RlbXBvcmFyeURyYXdlcjpvcGVuJywgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ1JlY2VpdmVkIE1EQ1RlbXBvcmFyeURyYXdlcjpvcGVuJyk7XG4gICAgICB0aGlzLl9pc0RyYXdlck9wZW4gPSB0cnVlO1xuICAgICAgcGFyZW50LnBvc3RNZXNzYWdlKHsgYm9keTogeyBtZXRob2Q6ICdzaG93QWRtaW5QYWdlJyB9LCB0bzogJ3J1bnRpbWU6Z3VpLW1hbmFnZXInIH0sICcqJyk7XG4gICAgfSk7XG5cbiAgICBkcmF3ZXJFbC5hZGRFdmVudExpc3RlbmVyKCdNRENUZW1wb3JhcnlEcmF3ZXI6Y2xvc2UnLCAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnUmVjZWl2ZWQgTURDVGVtcG9yYXJ5RHJhd2VyOmNsb3NlJyk7XG4gICAgICB0aGlzLl9pc0RyYXdlck9wZW4gPSBmYWxzZTtcbiAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IGJvZHk6IHsgbWV0aG9kOiAnaGlkZUFkbWluUGFnZScgfSwgdG86ICdydW50aW1lOmd1aS1tYW5hZ2VyJyB9LCAnKicpO1xuICAgIH0pO1xuXG4gIH1cblxuICBsb2dPdXQoKSB7XG4gICAgbGV0IF90aGlzID0gdGhpcztcbiAgICBjb25zb2xlLmxvZygnSWRlbnRpdGllc0dVSTogbG9nZ2luZyBvdXQnKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXG4gICAgICBjb25zb2xlLmxvZygnQnVpbGRpbmcgZHJhd2VyJyk7XG4gICAgICBfdGhpcy5fYnVpbGREcmF3ZXIoKTtcblxuICAgICAgcmVzb2x2ZSgnR3VpIHJlc2V0Jyk7XG5cblxuICAgIH0pO1xuICB9XG5cbiAgX2J1aWxkRHJhd2VyKCkge1xuXG4gICAgY29uc3QgZ3VpVVJMID0gdGhpcy5fZ3VpVVJMO1xuXG4gICAgdGhpcy5fbWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihndWlVUkwsIG1zZyA9PiB7XG5cbiAgICAgIGNvbnN0IGZ1bmNOYW1lID0gbXNnLmJvZHkubWV0aG9kO1xuXG4gICAgICBpZiAobXNnLnR5cGUgIT09ICdyZXNwb25zZScpIHtcblxuXG4gICAgICAgIGlmICghdGhpcy5pc0xvZ2dlZCkge1xuXG4gICAgICAgICAgY29uc3QgY2xpY2tDbG9zZSA9IG5ldyBNb3VzZUV2ZW50KCdjbGljaycpO1xuICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZXR0aW5ncy1idG4nKS5kaXNwYXRjaEV2ZW50KGNsaWNrQ2xvc2UpO1xuXG4gICAgICAgIH1cblxuICAgICAgfVxuXG4gICAgICBpZiAoZnVuY05hbWUgPT09ICdvcGVuUG9wdXAnKSB7XG5cbiAgICAgICAgdGhpcy5vcGVuUG9wdXAoKS50aGVuKCgpID0+IHtcblxuICAgICAgICAgIGxldCB1cmxyZWNlaXZlZCA9IG1zZy5ib2R5LnBhcmFtcy51cmxyZWNlaXZlZDtcbiAgICAgICAgICB0aGlzLm9wZW5Qb3B1cCh1cmxyZWNlaXZlZCkudGhlbigocmV0dXJuZWRWYWx1ZSkgPT4ge1xuICAgICAgICAgICAgbGV0IHZhbHVlID0ge3R5cGU6ICdleGVjdXRlJywgdmFsdWU6IHJldHVybmVkVmFsdWUsIGNvZGU6IDIwMH07XG4gICAgICAgICAgICBsZXQgcmVwbHlNc2cgPSB7aWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgdG86IG1zZy5mcm9tLCBmcm9tOiBtc2cudG8sIGJvZHk6IHZhbHVlfTtcbiAgICAgICAgICAgIHRoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UocmVwbHlNc2cpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybjtcblxuICAgICAgfVxuXG4gICAgICBjb25zdCBjYWxsYmFjayA9IChpZGVudGl0eUluZm8pID0+IHtcblxuICAgICAgICB0aGlzLmlzTG9nZ2VkID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLl9idWlsZE1lc3NhZ2UobXNnLCBpZGVudGl0eUluZm8pO1xuXG4gICAgICB9O1xuXG4gICAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG5cbiAgICAgIHRoaXMuX2dldElkZW50aXRpZXMoY2FsbGJhY2ssIHRydWUpO1xuXG4gICAgfSk7XG5cbiAgICB0aGlzLl9nZXRJZGVudGl0aWVzKCk7XG5cbiAgfVxuXG4gIF9idWlsZE1lc3NhZ2UobXNnLCBpZGVudGl0eUluZm8pIHtcbiAgICBsZXQgcmVwbHlNc2c7XG4gICAgbGV0IHZhbHVlO1xuXG4gICAgY29uc3QgZnJvbSA9IG1zZyA/IG1zZy5mcm9tIDogdGhpcy5fZ3VpVVJMO1xuICAgIGNvbnN0IHRvID0gbXNnID8gbXNnLnRvIDogdGhpcy5faWRtVVJMO1xuXG4gICAgY29uc29sZS5sb2coJ2Nob3NlbiBpZGVudGl0eTogJywgaWRlbnRpdHlJbmZvKTtcblxuICAgIHN3aXRjaCAoaWRlbnRpdHlJbmZvLnR5cGUpIHtcbiAgICAgIGNhc2UgJ2lkcCc6XG4gICAgICAgIHZhbHVlID0geyB0eXBlOiAnaWRwJywgdmFsdWU6IGlkZW50aXR5SW5mby52YWx1ZSwgY29kZTogMjAwIH07XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdpZGVudGl0eSc6XG4gICAgICAgIHZhbHVlID0geyB0eXBlOiAnaWRlbnRpdHknLCB2YWx1ZTogaWRlbnRpdHlJbmZvLnZhbHVlLCBjb2RlOiAyMDAgfTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHZhbHVlID0geyB0eXBlOiAnZXJyb3InLCB2YWx1ZTogJ0Vycm9yIG9uIGlkZW50aXR5IEdVSScsIGNvZGU6IDQwMCB9O1xuICAgIH1cblxuICAgIHJlcGx5TXNnID0ge2lkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIHRvOiBmcm9tLCBmcm9tOiB0bywgYm9keTogdmFsdWUgfTtcblxuICAgIHRoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UocmVwbHlNc2cpO1xuICB9XG5cbiAgX2dldElkZW50aXRpZXMoY2FsbGJhY2ssIG9QZW5EcmF3ZXIpIHtcblxuICAgIHJldHVybiB0aGlzLmNhbGxJZGVudGl0eU1vZHVsZUZ1bmMoJ2dldElkZW50aXRpZXNUb0Nob29zZScsIHt9KS50aGVuKChyZXN1bHRPYmplY3QpID0+IHtcbiAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuc2hvd0lkcHMocmVzdWx0T2JqZWN0LmlkcHMsIGNhbGxiYWNrKSwgdGhpcy5zaG93RGVmYXVsdElkZW50aXR5KHJlc3VsdE9iamVjdC5kZWZhdWx0SWRlbnRpdHkpLCB0aGlzLnNob3dJZGVudGl0aWVzKHJlc3VsdE9iamVjdCwgY2FsbGJhY2ssIG9QZW5EcmF3ZXIpXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuc2hvd0lkcHMocmVzdWx0T2JqZWN0LmlkcHMpLCB0aGlzLnNob3dEZWZhdWx0SWRlbnRpdHkocmVzdWx0T2JqZWN0LmRlZmF1bHRJZGVudGl0eSksIHRoaXMuc2hvd0lkZW50aXRpZXMocmVzdWx0T2JqZWN0KV0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gIH1cblxuICAvLyBfb3BlbkRyYXdlcigpIHtcblxuICAvLyAgIGxldCBfdGhpcyA9IHRoaXM7XG4gIC8vICAgY29uc3QgZ3VpVVJMID0gX3RoaXMuX2d1aVVSTDtcblxuICAvLyAgIF90aGlzLnJlc3VsdFVSTCAgPSB1bmRlZmluZWQ7XG5cbiAgLy8gICBfdGhpcy5fbWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihndWlVUkwsIG1zZyA9PiB7XG4gIC8vICAgICBsZXQgaWRlbnRpdHlJbmZvID0gbXNnLmJvZHkudmFsdWU7XG4gIC8vICAgICBsZXQgZnVuY05hbWUgPSBtc2cuYm9keS5tZXRob2Q7XG4gIC8vICAgICBsZXQgdmFsdWU7XG4gIC8vICAgICBjb25zb2xlLmxvZygnW0lkZW50aXRpZXNHVUldIHJlY2VpdmVkIG1zZzogJywgbXNnKTtcblxuICAvLyAgICAgX3RoaXMuc2hvd0lkZW50aXRpZXNHVUkobXNnLmJvZHkudmFsdWUpLnRoZW4oKGlkZW50aXR5SW5mbykgPT4ge1xuXG4gIC8vICAgICAgIGxldCByZXBseU1zZztcbiAgLy8gICAgICAgY29uc29sZS5sb2coJ1tJZGVudGl0aWVzR1VJXSBpZGVudGl0eUluZm8gZnJvbSBHVUk6ICcsIGlkZW50aXR5SW5mbyk7XG5cbiAgLy8gICAgICAgLy9oaWRlIGNvbmZpZyBwYWdlIHdpdGggdGhlIGlkZW50aXR5IEdVSVxuICAvLyAgICAgICBwYXJlbnQucG9zdE1lc3NhZ2UoeyBib2R5OiB7IG1ldGhvZDogJ2hpZGVBZG1pblBhZ2UnIH0sIHRvOiAncnVudGltZTpndWktbWFuYWdlcicgfSwgJyonKTtcbiAgLy8gICAgICAgJCgnLmFkbWluLXBhZ2UnKS5hZGRDbGFzcygnaGlkZScpO1xuXG4gIC8vICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF0uc3R5bGUgPSAnYmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudCc7XG4gIC8vICAgICAgICQoJy5pZGVudGl0aWVzLXNlY3Rpb24nKS5hZGRDbGFzcygnaGlkZScpO1xuICAvLyAgICAgICAkKCcucG9saWNpZXMtc2VjdGlvbicpLmFkZENsYXNzKCdoaWRlJyk7XG5cbiAgLy8gICAgICAgc3dpdGNoIChpZGVudGl0eUluZm8udHlwZSkge1xuICAvLyAgICAgICAgIGNhc2UgJ2lkcCc6XG4gIC8vICAgICAgICAgICB2YWx1ZSA9IHsgdHlwZTogJ2lkcCcsIHZhbHVlOiBpZGVudGl0eUluZm8udmFsdWUsIGNvZGU6IDIwMCB9O1xuICAvLyAgICAgICAgICAgcmVwbHlNc2cgPSB7IGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIHRvOiBtc2cuZnJvbSwgZnJvbTogbXNnLnRvLCBib2R5OiB2YWx1ZSB9O1xuICAvLyAgICAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UocmVwbHlNc2cpO1xuICAvLyAgICAgICAgICAgYnJlYWs7XG5cbiAgLy8gICAgICAgICBjYXNlICdpZGVudGl0eSc6XG4gIC8vICAgICAgICAgICB2YWx1ZSA9IHsgdHlwZTogJ2lkZW50aXR5JywgdmFsdWU6IGlkZW50aXR5SW5mby52YWx1ZSwgY29kZTogMjAwIH07XG4gIC8vICAgICAgICAgICByZXBseU1zZyA9IHsgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgdG86IG1zZy5mcm9tLCBmcm9tOiBtc2cudG8sIGJvZHk6IHZhbHVlIH07XG4gIC8vICAgICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShyZXBseU1zZyk7XG4gIC8vICAgICAgICAgICBicmVhaztcblxuICAvLyAgICAgICAgIGRlZmF1bHQ6XG4gIC8vICAgICAgICAgICB2YWx1ZSA9IHsgdHlwZTogJ2Vycm9yJywgdmFsdWU6ICdFcnJvciBvbiBpZGVudGl0eSBHVUknLCBjb2RlOiA0MDAgfTtcbiAgLy8gICAgICAgICAgIHJlcGx5TXNnID0geyBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCB0bzogbXNnLmZyb20sIGZyb206IG1zZy50bywgYm9keTogdmFsdWUgfTtcbiAgLy8gICAgICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHJlcGx5TXNnKTtcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfSk7XG5cbiAgLy8gICAgIGlmIChmdW5jTmFtZSA9PT0gJ29wZW5Qb3B1cCcpIHtcbiAgLy8gICAgICAgbGV0IHVybHJlY2VpdmVkID0gbXNnLmJvZHkucGFyYW1zLnVybHJlY2VpdmVkO1xuICAvLyAgICAgICBfdGhpcy5vcGVuUG9wdXAodXJscmVjZWl2ZWQpLnRoZW4oKHJldHVybmVkVmFsdWUpID0+IHtcbiAgLy8gICAgICAgICBsZXQgdmFsdWUgPSB7dHlwZTogJ2V4ZWN1dGUnLCB2YWx1ZTogcmV0dXJuZWRWYWx1ZSwgY29kZTogMjAwfTtcbiAgLy8gICAgICAgICBsZXQgcmVwbHlNc2cgPSB7aWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgdG86IG1zZy5mcm9tLCBmcm9tOiBtc2cudG8sIGJvZHk6IHZhbHVlfTtcbiAgLy8gICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShyZXBseU1zZyk7XG4gIC8vICAgICAgIH0pO1xuICAvLyAgICAgICByZXR1cm47IC8vIHRoaXMgYXZvaWRzIGdldHRpbmcgc3R1Y2sgaW4gdGhlIGlkZW50aXRpZXMgcGFnZVxuICAvLyAgICAgfVxuXG4gIC8vICAgICAvLyB1bmhpZGUgdGhlIGNvbmZpZyBwYWdlIHdpdGggdGhlIGlkZW50aXR5IEdVSVxuICAvLyAgICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXS5zdHlsZSA9ICdiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyc7XG4gIC8vICAgICBwYXJlbnQucG9zdE1lc3NhZ2UoeyBib2R5OiB7IG1ldGhvZDogJ3Nob3dBZG1pblBhZ2UnIH0sIHRvOiAncnVudGltZTpndWktbWFuYWdlcicgfSwgJyonKTtcblxuICAvLyAgICAgY29uc3QgY2xpY2tPcGVuID0gbmV3IE1vdXNlRXZlbnQoJ2NsaWNrJyk7XG4gIC8vICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZ3MtYnRuJykuZGlzcGF0Y2hFdmVudChjbGlja09wZW4pO1xuXG4gIC8vICAgICAkKCcuYWRtaW4tcGFnZScpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG5cbiAgLy8gICB9KTtcbiAgLy8gfVxuXG4gIGNhbGxJZGVudGl0eU1vZHVsZUZ1bmMobWV0aG9kTmFtZSwgcGFyYW1ldGVycykge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IHsgdHlwZTogJ2V4ZWN1dGUnLCB0bzogX3RoaXMuX2lkbVVSTCwgZnJvbTogX3RoaXMuX2d1aVVSTCxcbiAgICAgICAgYm9keTogeyByZXNvdXJjZTogJ2lkZW50aXR5JywgbWV0aG9kOiBtZXRob2ROYW1lLCBwYXJhbXM6IHBhcmFtZXRlcnMgfX07XG5cbiAgICAgIHRoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgKHJlcykgPT4ge1xuICAgICAgICBsZXQgcmVzdWx0ID0gcmVzLmJvZHkudmFsdWU7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH0pO1xuXG4gICAgfSk7XG4gIH1cblxuICBvcGVuUG9wdXAodXJscmVjZWl2ZWQpIHtcblxuICAgIFxuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuICAgICAgZnVuY3Rpb24gd2FpdChtcykge1xuICAgICAgICB2YXIgc3RhcnQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgdmFyIGVuZCA9IHN0YXJ0O1xuICAgICAgICB3aGlsZSAoZW5kIDwgc3RhcnQgKyBtcykge1xuICAgICAgICAgIGVuZCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGxldCB3aW47XG4gICAgICBpZiAoIXVybHJlY2VpdmVkKSB7XG4gICAgICAgIHdpbiA9IHdpbmRvdy5vcGVuKCcnLCAnb3BlbklEcmVxdWVzdCcsICdsb2NhdGlvbj0xLHN0YXR1cz0xJyk7XG4gICAgICAgIHRoaXMud2luID0gd2luO1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3YWl0KDEwMDApOyAgXG4gICAgICAgIHdpbiA9IHRoaXMud2luO1xuICAgICAgICB3aW4ubG9jYXRpb24uaHJlZiA9IHVybHJlY2VpdmVkO1xuICAgICAgfVxuXG4gICAgICAvLyBsZXQgd2luID0gd2luZG93Lm9wZW4odXJscmVjZWl2ZWQsICdvcGVuSURyZXF1ZXN0JywgJ2xvY2F0aW9uPTEsc3RhdHVzPTEsc2Nyb2xsYmFycz0xJyk7XG4gICAgICBpZiAod2luZG93LmNvcmRvdmEpIHtcbiAgICAgICAgd2luLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRzdGFydCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICBsZXQgdXJsID0gZS51cmw7XG4gICAgICAgICAgbGV0IGNvZGUgPSAvXFwmY29kZT0oLispJC8uZXhlYyh1cmwpO1xuICAgICAgICAgIGxldCBlcnJvciA9IC9cXCZlcnJvcj0oLispJC8uZXhlYyh1cmwpO1xuXG4gICAgICAgICAgaWYgKGNvZGUgfHwgZXJyb3IpIHtcbiAgICAgICAgICAgIHdpbi5jbG9zZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUodXJsKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHJlamVjdCgnb3BlblBvcHVwIGVycm9yIDEgLSBzaG91bGQgbm90IGhhcHBlbicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuXG4gICAgICAgIGxldCBwb2xsVGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHdpbi5jbG9zZWQpIHtcbiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwb2xsVGltZXIpO1xuXG4gICAgICAgICAgICAgIC8vIHJldHVybiByZWplY3QoJ1NvbWUgZXJyb3Igb2NjdXJlZCB3aGVuIHRyeWluZyB0byBnZXQgaWRlbnRpdHkuJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICgod2luLmRvY3VtZW50LlVSTC5pbmRleE9mKCdhY2Nlc3NfdG9rZW4nKSAhPT0gLTEgfHwgd2luLmRvY3VtZW50LlVSTC5pbmRleE9mKCdjb2RlJykgIT09IC0xKSAmJiB3aW4uZG9jdW1lbnQuVVJMLmluZGV4T2YobG9jYXRpb24ub3JpZ2luKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwocG9sbFRpbWVyKTtcbiAgICAgICAgICAgICAgbGV0IHVybCA9ICAgd2luLmRvY3VtZW50LlVSTDtcblxuICAgICAgICAgICAgICByZXNvbHZlKHVybCk7XG4gICAgICAgICAgICAgIHJldHVybiB3aW4uY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvL3JldHVybiByZWplY3QoJ29wZW5Qb3B1cCBlcnJvciAyIC0gc2hvdWxkIG5vdCBoYXBwZW4nKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGUpO1xuICAgICAgICAgIH1cblxuICAgICAgICB9LCA1MDApO1xuICAgICAgfVxuXG4gICAgfSk7XG4gIH1cblxuICAvLyBzaG93SWRlbnRpdGllc0dVSShyZWNlaXZlZEluZm8pIHtcbiAgLy8gICBsZXQgX3RoaXMgPSB0aGlzO1xuXG4gIC8vICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgLy8gICAgIGNvbnNvbGUubG9nKCdbSWRlbnRpdGllc0dVSS5zaG93SWRlbnRpdGllc0dVSV0gcmVjZWl2ZWRJbmZvOiAnLCByZWNlaXZlZEluZm8pO1xuXG4gIC8vICAgICBsZXQgaWRlbnRpdHlJbmZvO1xuICAvLyAgICAgbGV0IHRvUmVtb3ZlSUQ7XG5cbiAgLy8gICAgIGxldCBjYWxsYmFjayA9ICh2YWx1ZSkgPT4ge1xuICAvLyAgICAgICBjb25zb2xlLmxvZygnY2hvc2VuIGlkZW50aXR5OiAnLCB2YWx1ZSk7XG5cbiAgLy8gICAgICAgY29uc3QgY2xpY2tDbG9zZSA9IG5ldyBNb3VzZUV2ZW50KCdjbGljaycpO1xuICAvLyAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZ3MtYnRuJykuZGlzcGF0Y2hFdmVudChjbGlja0Nsb3NlKTtcblxuICAvLyAgICAgICByZXNvbHZlKHt0eXBlOiAnaWRlbnRpdHknLCB2YWx1ZTogdmFsdWV9KTtcbiAgLy8gICAgIH07XG5cbiAgLy8gICAgIF90aGlzLl9jaGVja1JlY2VpdmVkSW5mbyhyZWNlaXZlZEluZm8pLnRoZW4oKHJlc3VsdE9iamVjdCkgPT4ge1xuICAvLyAgICAgICBpZGVudGl0eUluZm8gPSByZXN1bHRPYmplY3QuaWRlbnRpdHlJbmZvO1xuICAvLyAgICAgICB0b1JlbW92ZUlEID0gcmVzdWx0T2JqZWN0LnRvUmVtb3ZlSUQ7XG5cbiAgLy8gICAgICAgJCgnLnBvbGljaWVzLXNlY3Rpb24nKS5hZGRDbGFzcygnaGlkZScpO1xuICAvLyAgICAgICAkKCcuaWRlbnRpdGllcy1zZWN0aW9uJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcblxuICAvLyAgICAgICBfdGhpcy5zaG93SWRwcyhyZWNlaXZlZEluZm8uaWRwcywgY2FsbGJhY2spO1xuXG4gIC8vICAgICAgIF90aGlzLnNob3dJZGVudGl0aWVzKGlkZW50aXR5SW5mby5pZGVudGl0aWVzLCB0b1JlbW92ZUlEKS50aGVuKChpZGVudGl0eSkgPT4ge1xuICAvLyAgICAgICAgIGNvbnNvbGUubG9nKCdjaG9zZW4gaWRlbnRpdHk6ICcsIGlkZW50aXR5KTtcbiAgLy8gICAgICAgICByZXNvbHZlKHt0eXBlOiAnaWRlbnRpdHknLCB2YWx1ZTogaWRlbnRpdHl9KTtcbiAgLy8gICAgICAgfSk7XG5cbiAgLy8gICAgICAgbGV0IGlkcHMgPSBbXTtcbiAgLy8gICAgICAgbGV0IGlkcHNPYmplY3RzID0gaWRlbnRpdHlJbmZvLmlkcHM7XG5cbiAgLy8gICAgICAgaWRwc09iamVjdHMuZm9yRWFjaChmdW5jdGlvbihlbnRyeSkge1xuICAvLyAgICAgICAgIGlmKGVudHJ5LnR5cGUgJiYgZW50cnkudHlwZSA9PSAnaWRUb2tlbicpIHtcbiAgLy8gICAgICAgICAgIGlkcHMucHVzaChlbnRyeS5kb21haW4pO1xuICAvLyAgICAgICAgIH1cbiAgLy8gICAgICAgfSk7XG5cbiAgLy8gICAgICAgJCgnI2lkcHJvdmlkZXJzJykuaHRtbChfdGhpcy5fZ2V0TGlzdChpZHBzKSk7XG4gIC8vICAgICAgICQoJyNpZHByb3ZpZGVycycpLm9mZigpO1xuICAvLyAgICAgICAvLyAkKCcjaWRwcm92aWRlcnMnKS5vbignY2xpY2snLCAoZXZlbnQpID0+IF90aGlzLm9idGFpbk5ld0lkZW50aXR5KGV2ZW50LCBjYWxsYmFjaywgdG9SZW1vdmVJRCkpO1xuICAvLyAgICAgICAvLyQoJy5iYWNrJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiBfdGhpcy5nb0hvbWUoKSk7XG4gIC8vICAgICAgICQoJy5pZGVudGl0aWVzLXJlc2V0Jykub2ZmKCk7XG4gIC8vICAgICAgIC8vICQoJy5pZGVudGl0aWVzLXJlc2V0Jykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiBfdGhpcy5fcmVzZXRJZGVudGl0aWVzKGNhbGxiYWNrKSk7XG4gIC8vICAgICB9KTtcbiAgLy8gICB9KTtcbiAgLy8gfVxuXG4gIF9jaGVja1JlY2VpdmVkSW5mbyhyZWNlaXZlZEluZm8pIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgIGxldCBpZGVudGl0eUluZm87XG4gICAgICBsZXQgdG9SZW1vdmVJRDtcblxuICAgICAgaWYgKHJlY2VpdmVkSW5mbykge1xuICAgICAgICBpZGVudGl0eUluZm8gPSByZWNlaXZlZEluZm87XG4gICAgICAgIHRvUmVtb3ZlSUQgPSBmYWxzZTtcbiAgICAgICAgcmVzb2x2ZSh7aWRlbnRpdHlJbmZvOiBpZGVudGl0eUluZm8sIHRvUmVtb3ZlSUQ6IHRvUmVtb3ZlSUR9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRvUmVtb3ZlSUQgPSB0cnVlO1xuICAgICAgICBfdGhpcy5jYWxsSWRlbnRpdHlNb2R1bGVGdW5jKCdnZXRJZGVudGl0aWVzVG9DaG9vc2UnLCB7fSkudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgcmVzb2x2ZSh7aWRlbnRpdHlJbmZvOiByZXN1bHQsIHRvUmVtb3ZlSUQ6IHRvUmVtb3ZlSUR9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBzaG93SWRwcyhpZHBzKSB7XG5cbiAgICBjb25zb2xlLmxvZygnW0lkZW50aXRpZXNHVUkuc2hvd0lkcHNdIDogJywgaWRwcyk7XG5cbiAgICBsZXQgaWRwc0xpc3RFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZHBzLWxpc3QnKTtcblxuICAgIGNvbnN0IGNsaWNrRXZlbnQgPSAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IGVsID0gZXZlbnQuY3VycmVudFRhcmdldDtcbiAgICAgIGNvbnN0IGlkcCA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1pZHAnKTtcblxuICAgICAgdGhpcy5sb2dpbldpdGhJRFAoaWRwKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3ZhbHVlIGhlcmU6ICcsIHJlc3VsdC52YWx1ZSk7XG4gICAgICAgIC8vIHJlc3VsdC52YWx1ZSA9IHJlc3VsdC52YWx1ZS51c2VyVVJMXG5cbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2spIHtcbiAgICAgICAgICB0aGlzLmNhbGxiYWNrKHJlc3VsdCk7XG4gICAgICAgIH1cblxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIGlkcHMuZm9yRWFjaCgoa2V5KSA9PiB7XG5cbiAgICAgIGxldCBsaW5rRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluay0nICsga2V5LmRvbWFpbik7XG5cbiAgICAgIGlmICghbGlua0VsKSB7XG4gICAgICAgIGxpbmtFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgICAgbGlua0VsLnNldEF0dHJpYnV0ZSgnaWQnLCAnbGluay0nICsga2V5LmRvbWFpbik7XG4gICAgICAgIGxpbmtFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWRwJywga2V5LmRvbWFpbik7XG4gICAgICAgIGxpbmtFbC5jbGFzc0xpc3QgPSAnbWRjLWxpc3QtaXRlbSBsaW5rLScgKyBrZXkuZG9tYWluO1xuICAgICAgICBsaW5rRWwuaHJlZiA9ICcjJztcblxuICAgICAgICBjb25zdCBsaW5rRWxUZXh0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoa2V5LmRvbWFpbik7XG5cbiAgICAgICAgbGV0IG5hbWUgPSBrZXkuZG9tYWluO1xuICAgICAgICBpZiAobmFtZS5pbmRleE9mKCcuJykgIT09IC0xKSB7XG4gICAgICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDAsIG5hbWUuaW5kZXhPZignLicpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuYW1lID0gJ3F1ZXN0aW9uJztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGltZ0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgICAgIGltZ0VsLmNsYXNzTGlzdCA9ICdtZGMtbGlzdC1pdGVtX19zdGFydC1kZXRhaWwnO1xuICAgICAgICBpbWdFbC5zcmMgPSAnLi9hc3NldHMvJyArIG5hbWUgKyAnLnN2Zyc7XG4gICAgICAgIGltZ0VsLndpZHRoID0gMzA7XG4gICAgICAgIGltZ0VsLmhlaWdodCA9IDMwO1xuXG4gICAgICAgIGltZ0VsLm9uZXJyb3IgPSAoZSkgPT4geyBlLnNyY0VsZW1lbnQuc3JjID0gJy4vYXNzZXRzL3F1ZXN0aW9uLnN2Zyc7IH07XG5cbiAgICAgICAgbGlua0VsLmFwcGVuZENoaWxkKGltZ0VsKTtcbiAgICAgICAgbGlua0VsLmFwcGVuZENoaWxkKGxpbmtFbFRleHQpO1xuXG4gICAgICAgIGlkcHNMaXN0RWwuYXBwZW5kQ2hpbGQobGlua0VsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxpbmtFbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrRXZlbnQpO1xuICAgICAgfVxuXG4gICAgICBsaW5rRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbGlja0V2ZW50KTtcblxuICAgIH0pO1xuXG4gIH1cblxuICBzaG93RGVmYXVsdElkZW50aXR5KGlkZW50aXR5KSB7XG5cbiAgICBpZiAoaWRlbnRpdHkpIHtcblxuICAgICAgdGhpcy5pc0xvZ2dlZCA9IHRydWU7XG5cbiAgICAgIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZGMtbGlzdC0tYXZhdGFyLWxpc3QnKTtcblxuICAgICAgbGV0IGl0ZW1FbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpdGVtLScgKyBpZGVudGl0eS51c2VyUHJvZmlsZS51c2VyVVJMKTtcblxuICAgICAgaWYgKCFpdGVtRWwpIHtcblxuICAgICAgICBpdGVtRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgICAgICBpdGVtRWwuaWQgPSAnaXRlbS0nICsgaWRlbnRpdHkudXNlclByb2ZpbGUudXNlclVSTDtcbiAgICAgICAgaXRlbUVsLmNsYXNzTGlzdCA9ICdtZGMtbGlzdC1pdGVtIGl0ZW0tJyArIGlkZW50aXR5LnVzZXJQcm9maWxlLnVzZXJVUkw7XG4gICAgICAgIGl0ZW1FbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdXNlclVSTCcsIGlkZW50aXR5LnVzZXJQcm9maWxlLnVzZXJVUkwpO1xuXG4gICAgICAgIGNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgICAgICBwcm9maWxlSW1hZ2UuY2xhc3NMaXN0ID0gJ21kYy1saXN0LWl0ZW1fX3N0YXJ0LWRldGFpbCc7XG4gICAgICAgIHByb2ZpbGVJbWFnZS53aWR0aCA9IDU2O1xuICAgICAgICBwcm9maWxlSW1hZ2UuaGVpZ2h0ID0gNTY7XG4gICAgICAgIHByb2ZpbGVJbWFnZS5hbHQgPSBpZGVudGl0eS51c2VyUHJvZmlsZS5uYW1lO1xuICAgICAgICBwcm9maWxlSW1hZ2Uuc3JjID0gaWRlbnRpdHkudXNlclByb2ZpbGUucGljdHVyZTtcbiAgICAgICAgaXRlbUVsLmFwcGVuZENoaWxkKHByb2ZpbGVJbWFnZSk7XG5cbiAgICAgICAgY29uc3QgdGV4dDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIHRleHQxLmNsYXNzTGlzdCA9ICduYW1lIG1kYy1saXN0LWl0ZW1fX3RleHQnO1xuICAgICAgICB0ZXh0MS50ZXh0Q29udGVudCA9IGlkZW50aXR5LnVzZXJQcm9maWxlLm5hbWU7XG5cbiAgICAgICAgY29uc3QgdGV4dDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIHRleHQyLmNsYXNzTGlzdCA9ICdlbWFpbCBtZGMtbGlzdC1pdGVtX19zZWNvbmRhcnktdGV4dCc7XG4gICAgICAgIHRleHQyLnRleHRDb250ZW50ID0gaWRlbnRpdHkudXNlclByb2ZpbGUuZW1haWw7XG5cbiAgICAgICAgdGV4dDEuYXBwZW5kQ2hpbGQodGV4dDIpO1xuICAgICAgICBpdGVtRWwuYXBwZW5kQ2hpbGQodGV4dDEpO1xuICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQoaXRlbUVsKTtcblxuICAgICAgfVxuXG4gICAgfVxuXG4gIH1cblxuICBzaG93SWRlbnRpdGllcyhpRHMsIGNhbGxiYWNrLCBvUGVuRHJhd2VyID0gZmFsc2UpIHtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgIGNvbnNvbGUubG9nKCdbSWRlbnRpdGllc0dVSS5zaG93TXlJZGVudGl0aWVzXSA6ICcsIGlEcy5pZGVudGl0aWVzLCBpRHMuZGVmYXVsdElkZW50aXR5KTtcblxuICAgICAgY29uc3QgaWRlbnRpdGllcyA9IGlEcy5pZGVudGl0aWVzO1xuICAgICAgY29uc3QgY3VycmVudCA9IGlEcy5kZWZhdWx0SWRlbnRpdHkgPyBpRHMuZGVmYXVsdElkZW50aXR5LnVzZXJVUkwgOiAnJztcblxuICAgICAgbGV0IGFjdGl2ZUlkZW50aXRpZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWN0aXZlLWlkZW50aXRpZXMnKTtcblxuICAgICAgT2JqZWN0LmtleXMoaWRlbnRpdGllcykuZm9yRWFjaCgoa2V5KSA9PiB7XG5cbiAgICAgICAgY29uc3QgZXhpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluay0nICsga2V5KTtcbiAgICAgICAgaWYgKGV4aXN0KSB7IHJldHVybjsgfVxuXG4gICAgICAgIGNvbnN0IGxpbmtFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgICAgbGlua0VsLmhyZWYgPSAnIyc7XG4gICAgICAgIGxpbmtFbC5pZCA9ICdsaW5rLScgKyBrZXk7XG4gICAgICAgIGxpbmtFbC5jbGFzc0xpc3QgPSAnbWRjLWxpc3QtaXRlbSc7XG4gICAgICAgIGxpbmtFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdXNlclVSTCcsIGtleSk7XG5cbiAgICAgICAgaWYgKGtleSA9PT0gY3VycmVudCkge1xuICAgICAgICAgIGxpbmtFbC5jbGFzc0xpc3QgKz0gJyBtZGMtdGVtcG9yYXJ5LWRyYXdlci0tc2VsZWN0ZWQnO1xuICAgICAgICB9XG5cbiAgICAgICAgbGlua0VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG5cbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgY29uc3QgZWwgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgICAgIGNvbnN0IHVzZXJVUkwgPSBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdXNlclVSTCcpO1xuXG4gICAgICAgICAgY29uc29sZS5sb2coJ3VzZXJVUkw6JywgdXNlclVSTCwgY2FsbGJhY2ssIGVsKTtcblxuICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgY2FsbGJhY2sodXNlclVSTCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgICAgICBwcm9maWxlSW1hZ2UuY2xhc3NMaXN0ID0gJ21kYy1saXN0LWl0ZW1fX3N0YXJ0LWRldGFpbCc7XG4gICAgICAgIHByb2ZpbGVJbWFnZS53aWR0aCA9IDQwO1xuICAgICAgICBwcm9maWxlSW1hZ2UuaGVpZ2h0ID0gNDA7XG4gICAgICAgIHByb2ZpbGVJbWFnZS5hbHQgPSBpZGVudGl0aWVzW2tleV0udXNlclByb2ZpbGUubmFtZTtcbiAgICAgICAgcHJvZmlsZUltYWdlLnNyYyA9IGlkZW50aXRpZXNba2V5XS51c2VyUHJvZmlsZS5waWN0dXJlO1xuICAgICAgICBwcm9maWxlSW1hZ2Uub25lcnJvciA9IChlKSA9PiB7IGUuc3JjRWxlbWVudC5zcmMgPSAnLi9hc3NldHMvcXVlc3Rpb24uc3ZnJzsgfTtcblxuICAgICAgICBjb25zdCB0ZXh0MSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgdGV4dDEuY2xhc3NMaXN0ID0gJ25hbWUgbWRjLWxpc3QtaXRlbV9fdGV4dCc7XG4gICAgICAgIHRleHQxLnRleHRDb250ZW50ID0gaWRlbnRpdGllc1trZXldLnVzZXJQcm9maWxlLm5hbWU7XG5cbiAgICAgICAgY29uc3QgdGV4dDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIHRleHQyLmNsYXNzTGlzdCA9ICdlbWFpbCBtZGMtbGlzdC1pdGVtX19zZWNvbmRhcnktdGV4dCc7XG4gICAgICAgIHRleHQyLnRleHRDb250ZW50ID0gaWRlbnRpdGllc1trZXldLnVzZXJQcm9maWxlLmVtYWlsO1xuXG4gICAgICAgIHRleHQxLmFwcGVuZENoaWxkKHRleHQyKTtcblxuICAgICAgICBsaW5rRWwuYXBwZW5kQ2hpbGQocHJvZmlsZUltYWdlKTtcbiAgICAgICAgbGlua0VsLmFwcGVuZENoaWxkKHRleHQxKTtcblxuICAgICAgICBhY3RpdmVJZGVudGl0aWVzLmFwcGVuZENoaWxkKGxpbmtFbCk7XG5cbiAgICAgIH0pO1xuXG4gICAgICBpZiAob1BlbkRyYXdlciAmJiAoIXRoaXMuX2FscmVhZHlSZUxvZ2luKSkge1xuICAgICAgICB0aGlzLl9kcmF3ZXIub3BlbiA9IHRydWVcbiAgICAgIH1cblxuICAgICAgaWYgKG9QZW5EcmF3ZXIgJiYgKCF0aGlzLl9hbHJlYWR5UmVMb2dpbikgJiYgKCF0aGlzLl9hbHJlYWR5TG9naW4pKSB7XG4gICAgICAgIHRoaXMuX2FscmVhZHlSZUxvZ2luID0gdHJ1ZTtcbiAgICAgICAgcGFyZW50LnBvc3RNZXNzYWdlKHsgYm9keTogeyBtZXRob2Q6ICd0b2tlbkV4cGlyZWQnIH0sIHRvOiAncnVudGltZTpndWktbWFuYWdlcicgfSwgJyonKTtcbiAgICAgIH1cblxuXG5cblxuLypcbiAgICAgIGlmIChPYmplY3Qua2V5cyhpZGVudGl0aWVzKS5sZW5ndGggPT09IDEpIHtcblxuICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICBjYWxsYmFjayh7dHlwZTogJ2lkZW50aXR5JywgdmFsdWU6IGN1cnJlbnR9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXNvbHZlKHt0eXBlOiAnaWRlbnRpdHknLCB2YWx1ZTogY3VycmVudH0pO1xuICAgICAgfSovXG5cblxuICAgICAgLy8gbGV0IGNhbGxiYWNrID0gKGlkZW50aXR5KSA9PiB7XG4gICAgICAvLyAgIHJlc29sdmUoaWRlbnRpdHkpO1xuICAgICAgLy8gfTtcblxuICAgICAgLy8gaWYgKCF0b1JlbW92ZUlEKSB7XG4gICAgICAvLyAgICQoJy5jbGlja2FibGUtY2VsbCcpLm9uKCdjbGljaycsIChldmVudCkgPT4gX3RoaXMuY2hhbmdlSUQoZXZlbnQsIGNhbGxiYWNrKSk7XG4gICAgICAvLyB9XG5cbiAgICAgIC8vICQoJy5yZW1vdmUtaWQnKS5vbignY2xpY2snLCAoZXZlbnQpID0+IF90aGlzLnJlbW92ZUlEKGlEcykpO1xuXG4gICAgfSk7XG4gIH1cblxuICByZW1vdmVJRChldmVudCwgZW1haWxzKSB7XG4gICAgbGV0IF90aGlzID0gdGhpcztcbiAgICBsZXQgcm93ID0gZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgICBsZXQgaWRUb1JlbW92ZSA9IHJvdy5jaGlsZHJlblswXS50ZXh0Q29udGVudDtcbiAgICBsZXQgZG9tYWluID0gcm93LmNoaWxkcmVuWzFdLnRleHRDb250ZW50O1xuXG4gICAgX3RoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygndW5yZWdpc3RlcklkZW50aXR5JywgeyBlbWFpbDogaWRUb1JlbW92ZSB9KS50aGVuKCgpID0+IHtcbiAgICAgIGxldCBudW1FbWFpbHMgPSBlbWFpbHMubGVuZ3RoO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1FbWFpbHM7IGkrKykge1xuICAgICAgICBpZiAoZW1haWxzW2ldLmVtYWlsID09PSBpZFRvUmVtb3ZlKSB7XG4gICAgICAgICAgZW1haWxzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLy9cbiAgICAgIF90aGlzLnNob3dJZGVudGl0aWVzKGVtYWlscywgdHJ1ZSk7XG4gICAgfSk7XG5cbiAgICAvL190aGlzLmlkZW50aXR5TW9kdWxlLnVucmVnaXN0ZXJJZGVudGl0eShpZFRvUmVtb3ZlKTtcblxuICB9XG5cbiAgYXV0aG9yaXNlKGlkcCwgcmVzb3VyY2UpIHtcblxuXG4gICAgcmV0dXJuIHRoaXMub3BlblBvcHVwKClcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHsgc2NvcGU6IHJlc291cmNlLCBpZHBEb21haW46IGlkcCB9O1xuICAgICAgICByZXR1cm4gdGhpcy5jYWxsSWRlbnRpdHlNb2R1bGVGdW5jKCdnZXRBY2Nlc3NUb2tlbkF1dGhvcmlzYXRpb25FbmRwb2ludCcsIGRhdGEpO1xuICAgICAgfSlcbiAgICAgIC50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnW0lkZW50aXRpZXNHVUkuYXV0aG9yaXNlXSByZWNlaXZlZFVSTCBmcm9tIGlkcCBQcm94eTogJyArIHZhbHVlKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5vcGVuUG9wdXAodmFsdWUpO1xuICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1tJZGVudGl0aWVzR1VJLmF1dGhvcmlzZS5vcGVuUG9wdXAucmVzdWx0XScsIHJlc3VsdCk7XG5cbiAgICAgICAgLy8gcmVzb3VyY2UgYXMgYXJyYXlcblxuXG4gICAgICAgIGNvbnN0IGRhdGEgPSB7IHJlc291cmNlczogW3Jlc291cmNlXSwgaWRwRG9tYWluOiBpZHAsIGxvZ2luOiByZXN1bHQgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygnZ2V0QWNjZXNzVG9rZW4nLCBkYXRhKTtcbiAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4ge1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdbSWRlbnRpdGllc0dVSS5hdXRob3Jpc2UuZ2V0QWNjZXNzVG9rZW4ucmVzdWx0XScsIHJlc3VsdCk7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbGxJZGVudGl0eU1vZHVsZUZ1bmMoJ2FkZEFjY2Vzc1Rva2VuJywgcmVzdWx0KTtcbiAgICAgIH0pLnRoZW4oKHZhbHVlKSA9PiB7XG4gICAgICAgIHRoaXMuX2RyYXdlci5vcGVuID0gZmFsc2U7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH0pO1xuXG4gIH1cblxuICBsb2dpbldpdGhJRFAoaWRwKSB7XG5cblxuICAgIGxldCBfcHVibGljS2V5O1xuXG4gICAgcmV0dXJuIHRoaXMub3BlblBvcHVwKClcbiAgICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygnZ2V0TXlQdWJsaWNLZXknLCB7fSk7XG4gICAgICB9KS50aGVuKChwdWJsaWNLZXkpID0+IHtcbiAgICAgICAgX3B1YmxpY0tleSA9IHB1YmxpY0tleTtcbiAgICAgICAgY29uc3QgZGF0YSA9IHsgY29udGVudHM6IHB1YmxpY0tleSwgb3JpZ2luOiAnb3JpZ2luJywgdXNlcm5hbWVIaW50OiB1bmRlZmluZWQsIGlkcERvbWFpbjogaWRwIH07XG4gICAgICAgIHJldHVybiB0aGlzLmNhbGxJZGVudGl0eU1vZHVsZUZ1bmMoJ3NlbmRHZW5lcmF0ZU1lc3NhZ2UnLCBkYXRhKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigodmFsdWUpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tJZGVudGl0aWVzR1VJLm9idGFpbk5ld0lkZW50aXR5XSByZWNlaXZlZFVSTCBmcm9tIGlkcCBQcm94eTogJyArIHZhbHVlLmxvZ2luVXJsLnN1YnN0cmluZygwLCAyMCkgKyAnLi4uJyk7XG5cbiAgICAgICAgbGV0IHVybCA9IHZhbHVlLmxvZ2luVXJsO1xuICAgICAgICBsZXQgZmluYWxVUkw7XG5cbiAgICAgICAgLy9jaGVjayBpZiB0aGUgcmVjZWl2ZWRVUkwgY29udGFpbnMgdGhlIHJlZGlyZWN0IGZpZWxkIGFuZCByZXBsYWNlIGl0XG4gICAgICAgIGlmICh1cmwuaW5kZXhPZigncmVkaXJlY3RfdXJpJykgIT09IC0xKSB7XG4gICAgICAgICAgbGV0IGZpcnN0UGFydCA9IHVybC5zdWJzdHJpbmcoMCwgdXJsLmluZGV4T2YoJ3JlZGlyZWN0X3VyaScpKTtcbiAgICAgICAgICBsZXQgc2Vjb25kQXV4UGFydCA9IHVybC5zdWJzdHJpbmcodXJsLmluZGV4T2YoJ3JlZGlyZWN0X3VyaScpLCB1cmwubGVuZ3RoKTtcblxuICAgICAgICAgIGxldCBzZWNvbmRQYXJ0ID0gc2Vjb25kQXV4UGFydC5zdWJzdHJpbmcoc2Vjb25kQXV4UGFydC5pbmRleE9mKCcmJyksIHVybC5sZW5ndGgpO1xuXG4gICAgICAgICAgLy9jaGVjayBpZiB0aGUgcmVkZGlyZWN0IGZpZWxkIGlzIHRoZSBsYXN0IGZpZWxkIG9mIHRoZSBVUkxcbiAgICAgICAgICBpZiAoc2Vjb25kUGFydC5pbmRleE9mKCcmJykgIT09IC0xKSB7XG4gICAgICAgICAgICBmaW5hbFVSTCA9IGZpcnN0UGFydCArICdyZWRpcmVjdF91cmk9JyArIGxvY2F0aW9uLm9yaWdpbiArIHNlY29uZFBhcnQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZpbmFsVVJMID0gZmlyc3RQYXJ0ICsgJ3JlZGlyZWN0X3VyaT0nICsgbG9jYXRpb24ub3JpZ2luO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVzdWx0VVJMID0gZmluYWxVUkwgfHwgdXJsO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdbSWRlbnRpdGllc0dVSS5vcGVuUG9wdXBdJywgdGhpcy5yZXN1bHRVUkwpO1xuICAgICAgICByZXR1cm4gdGhpcy5vcGVuUG9wdXAodGhpcy5yZXN1bHRVUkwpO1xuICAgICAgfSkudGhlbigoaWRlbnRpdHkpID0+IHtcblxuICAgICAgICBjb25zb2xlLmxvZygnW0lkZW50aXRpZXNHVUkub3BlblBvcHVwLnJlc3VsdF0nLCBpZGVudGl0eSk7XG5cbiAgICAgICAgY29uc3QgZGF0YSA9IHsgY29udGVudHM6IF9wdWJsaWNLZXksIG9yaWdpbjogJ29yaWdpbicsIHVzZXJuYW1lSGludDogaWRlbnRpdHksIGlkcERvbWFpbjogaWRwIH07XG4gICAgICAgIHJldHVybiB0aGlzLmNhbGxJZGVudGl0eU1vZHVsZUZ1bmMoJ3NlbmRHZW5lcmF0ZU1lc3NhZ2UnLCBkYXRhKTtcbiAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4ge1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdbSWRlbnRpdGllc0dVSS5zZW5kR2VuZXJhdGVNZXNzYWdlLnJlc3VsdF0nLCByZXN1bHQpO1xuICAgICAgICByZXR1cm4gdGhpcy5jYWxsSWRlbnRpdHlNb2R1bGVGdW5jKCdhZGRBc3NlcnRpb24nLCByZXN1bHQpO1xuICAgICAgfSkudGhlbigodmFsdWUpID0+IHtcblxuICAgICAgICB0aGlzLl9kcmF3ZXIub3BlbiA9IGZhbHNlO1xuICAgICAgICBjb25zdCB1c2VyVVJMID0ge3R5cGU6ICdpZGVudGl0eScsIHZhbHVlOiB2YWx1ZS51c2VyUHJvZmlsZS51c2VyVVJMfTtcbiAgICAgICAgLy8gY29uc3QgdXNlcklkZW50aXR5ID0ge3R5cGU6ICdpZGVudGl0eScsIHZhbHVlOiB2YWx1ZS51c2VyUHJvZmlsZX07XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1tJZGVudGl0aWVzR1VJLmxvZ2luV2l0aElEUCBmaW5hbF0nLCB2YWx1ZSk7XG4gICAgICAgIHRoaXMuX2FscmVhZHlMb2dpbiA9IHRydWU7XG4gICAgICAgIHJldHVybiB1c2VyVVJMO1xuICAgICAgICAvLyByZXR1cm4gdXNlcklkZW50aXR5O1xuICAgICAgfSk7XG5cbiAgfVxuXG4gIC8vIG9idGFpbk5ld0lkZW50aXR5KGV2ZW50LCBjYWxsYmFjaywgdG9SZW1vdmVJRCkge1xuICAvLyAgIGxldCBfdGhpcyA9IHRoaXM7XG4gIC8vICAgbGV0IGlkUHJvdmlkZXIgPSBldmVudC50YXJnZXQudGV4dENvbnRlbnQ7XG4gIC8vICAgbGV0IGlkUHJvdmlkZXIyID0gZXZlbnQudGFyZ2V0LnRleHQ7XG5cbiAgLy8gICBfdGhpcy5jYWxsSWRlbnRpdHlNb2R1bGVGdW5jKCdnZXRNeVB1YmxpY0tleScsIHt9KS50aGVuKChwdWJsaWNLZXkpID0+IHtcbiAgLy8gICAgIC8vIGxldCBwdWJsaWNLZXkgPSBidG9hKGtleVBhaXIucHVibGljKTtcblxuICAvLyAgICAgX3RoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygnc2VuZEdlbmVyYXRlTWVzc2FnZScsXG4gIC8vICAgICAgIHsgY29udGVudHM6IHB1YmxpY0tleSwgb3JpZ2luOiAnb3JpZ2luJywgdXNlcm5hbWVIaW50OiB1bmRlZmluZWQsIGlkcERvbWFpbjogaWRQcm92aWRlciwgfSkudGhlbigodmFsdWUpID0+IHtcbiAgLy8gICAgICAgY29uc29sZS5sb2coJ1tJZGVudGl0aWVzR1VJLm9idGFpbk5ld0lkZW50aXR5XSByZWNlaXZlZFVSTCBmcm9tIGlkcCBQcm94eTogJyArIHZhbHVlLmxvZ2luVXJsLnN1YnN0cmluZygwLCAyMCkgKyAnLi4uJyk7XG5cbiAgLy8gICAgICAgbGV0IHVybCA9IHZhbHVlLmxvZ2luVXJsO1xuICAvLyAgICAgICBsZXQgZmluYWxVUkw7XG5cbiAgLy8gICAgICAgLy9jaGVjayBpZiB0aGUgcmVjZWl2ZWRVUkwgY29udGFpbnMgdGhlIHJlZGlyZWN0IGZpZWxkIGFuZCByZXBsYWNlIGl0XG4gIC8vICAgICAgIGlmICh1cmwuaW5kZXhPZigncmVkaXJlY3RfdXJpJykgIT09IC0xKSB7XG4gIC8vICAgICAgICAgbGV0IGZpcnN0UGFydCA9IHVybC5zdWJzdHJpbmcoMCwgdXJsLmluZGV4T2YoJ3JlZGlyZWN0X3VyaScpKTtcbiAgLy8gICAgICAgICBsZXQgc2Vjb25kQXV4UGFydCA9IHVybC5zdWJzdHJpbmcodXJsLmluZGV4T2YoJ3JlZGlyZWN0X3VyaScpLCB1cmwubGVuZ3RoKTtcblxuICAvLyAgICAgICAgIGxldCBzZWNvbmRQYXJ0ID0gc2Vjb25kQXV4UGFydC5zdWJzdHJpbmcoc2Vjb25kQXV4UGFydC5pbmRleE9mKCcmJyksIHVybC5sZW5ndGgpO1xuXG4gIC8vICAgICAgICAgLy9jaGVjayBpZiB0aGUgcmVkZGlyZWN0IGZpZWxkIGlzIHRoZSBsYXN0IGZpZWxkIG9mIHRoZSBVUkxcbiAgLy8gICAgICAgICBpZiAoc2Vjb25kUGFydC5pbmRleE9mKCcmJykgIT09IC0xKSB7XG4gIC8vICAgICAgICAgICBmaW5hbFVSTCA9IGZpcnN0UGFydCArICdyZWRpcmVjdF91cmk9JyArIGxvY2F0aW9uLm9yaWdpbiArIHNlY29uZFBhcnQ7XG4gIC8vICAgICAgICAgfSBlbHNlIHtcbiAgLy8gICAgICAgICAgIGZpbmFsVVJMID0gZmlyc3RQYXJ0ICsgJ3JlZGlyZWN0X3VyaT0nICsgbG9jYXRpb24ub3JpZ2luO1xuICAvLyAgICAgICAgIH1cbiAgLy8gICAgICAgfVxuXG4gIC8vICAgICAgIF90aGlzLnJlc3VsdFVSTCA9IGZpbmFsVVJMIHx8IHVybDtcblxuICAvLyAgICAgICAkKCcubG9naW4taWRwJykuaHRtbCgnPHA+Q2hvc2VuIElEUDogJyArIGlkUHJvdmlkZXIgKyAnPC9wPicpO1xuICAvLyAgICAgICAkKCcubG9naW4nKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAvLyAgICAgICAkKCcubG9naW4tYnRuJykub2ZmKCk7XG4gIC8vICAgICAgICQoJy5sb2dpbi1idG4nKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgLy8gICAgICAgICAkKCcubG9naW4nKS5hZGRDbGFzcygnaGlkZScpO1xuICAvLyAgICAgICAgIC8vIF90aGlzLl9hdXRoZW50aWNhdGVVc2VyKHB1YmxpY0tleSwgdmFsdWUsICdvcmlnaW4nLCBpZFByb3ZpZGVyKS50aGVuKChlbWFpbCkgPT4ge1xuICAvLyAgICAgICAgIC8vICAgY2FsbGJhY2soZW1haWwpO1xuICAvLyAgICAgICAgIC8vICAgX3RoaXMuc2hvd0lkZW50aXRpZXNHVUkoKTtcbiAgLy8gICAgICAgICAvLyB9KTtcbiAgLy8gICAgICAgfSk7XG4gIC8vICAgICB9KTtcbiAgLy8gICB9KS5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coJ29idGFuaW4gbmV3IGlkZW50aXR5JywgZXJyKSk7XG5cbiAgLy8gfVxuXG4gIF9nZXRMaXN0KGl0ZW1zKSB7XG4gICAgbGV0IGxpc3QgPSAnJztcbiAgICBsZXQgbnVtSXRlbXMgPSBpdGVtcy5sZW5ndGg7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUl0ZW1zOyBpKyspIHtcbiAgICAgIGxpc3QgKz0gJzxsaSBjbGFzcz1cImRpdmlkZXJcIj48L2xpPic7XG4gICAgICBsaXN0ICs9ICc8bGk+PGEgY2xhc3M9XCJjZW50ZXItYWxpZ25cIj4nICsgaXRlbXNbaV0gKyAnPC9hPjwvbGk+JztcbiAgICB9XG5cbiAgICByZXR1cm4gbGlzdDtcbiAgfVxuXG4gIF9hdXRoZW50aWNhdGVVc2VyKHB1YmxpY0tleSwgdmFsdWUsIG9yaWdpbiwgaWRQcm92aWRlcikge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgbGV0IHVybCA9IF90aGlzLnJlc3VsdFVSTDtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgIF90aGlzLm9wZW5Qb3B1cCh1cmwpLnRoZW4oKGlkZW50aXR5KSA9PiB7XG5cbiAgICAgICAgX3RoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygnc2VuZEdlbmVyYXRlTWVzc2FnZScsXG4gICAgICAgICAgeyBjb250ZW50czogcHVibGljS2V5LCBvcmlnaW46IG9yaWdpbiwgdXNlcm5hbWVIaW50OiBpZGVudGl0eSwgaWRwRG9tYWluOiBpZFByb3ZpZGVyIH0pLnRoZW4oKHJlc3VsdCkgPT4ge1xuXG4gICAgICAgICAgaWYgKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAvL190aGlzLmlkZW50aXR5TW9kdWxlLnN0b3JlSWRlbnRpdHkocmVzdWx0LCBrZXlQYWlyKS50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgX3RoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygnYWRkQXNzZXJ0aW9uJywgcmVzdWx0KS50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICByZXNvbHZlKHZhbHVlLnVzZXJQcm9maWxlLnVzZXJVUkwpO1xuICAgICAgICAgICAgfSwgKGVycikgPT4ge1xuICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdCgnZXJyb3Igb24gb2J0YWluaW5nIGlkZW50aXR5IGluZm9ybWF0aW9uJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuICAgICAgfSwgKGVycikgPT4ge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgX3Jlc2V0SWRlbnRpdGllcygpIHtcbiAgICBjb25zb2xlLmxvZygnX3Jlc2V0SWRlbnRpdGllcycpO1xuICB9XG5cblxufVxuXG5leHBvcnQgZGVmYXVsdCBJZGVudGl0aWVzR1VJO1xuIiwiaW1wb3J0IFBvbGljaWVzTWFuYWdlciBmcm9tICcuL1BvbGljaWVzTWFuYWdlcic7XG5cbmNsYXNzIFBvbGljaWVzR1VJIHtcblxuICBjb25zdHJ1Y3RvcihwZXBHdWlVUkwsIHBlcFVSTCwgbWVzc2FnZUJ1cykge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgX3RoaXMucG9saWNpZXNNYW5hZ2VyID0gbmV3IFBvbGljaWVzTWFuYWdlcihwZXBHdWlVUkwsIHBlcFVSTCwgbWVzc2FnZUJ1cyk7XG4gICAgLy8gYXNzdW1lIHByZXBhcmVBdHRyaWJ1dGVzIGlzIGNhbGxlZCBhZnRlciB0aGlzXG4gIH1cblxuICBwcmVwYXJlQXR0cmlidXRlcygpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBfdGhpcy5wb2xpY2llc01hbmFnZXIucHJlcGFyZUF0dHJpYnV0ZXMoKS50aGVuKCgpID0+IHtcbiAgICAgICAgX3RoaXMuZWxlbWVudHMgPSBfdGhpcy5fc2V0RWxlbWVudHMoKTtcbiAgICAgICAgX3RoaXMuX3NldExpc3RlbmVycygpO1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIF9hZGRNZW1iZXIoKSB7XG4gICAgbGV0IF90aGlzID0gdGhpcztcbiAgICBsZXQgZ3JvdXAgPSBldmVudC50YXJnZXQuaWQ7XG4gICAgJCgnLm1lbWJlci1uZXctaW50cm8nKS5odG1sKCc8aDU+QWRkIGEgbWVtYmVyIHRvIGEgZ3JvdXA8L2g1PjxwPkluc2VydCBhIHVzZXIgZW1haWwgYmVsb3cgdG8gYWRkIHRvIHRoZSBcIicgKyBncm91cCArICdcIiBncm91cC48L3A+Jyk7XG4gICAgJCgnLm1lbWJlci1uZXctbW9kYWwnKS5vcGVuTW9kYWwoKTtcbiAgICAkKCcubWVtYmVyLW5ldy1vaycpLm9mZigpO1xuICAgICQoJy5tZW1iZXItbmV3LW9rJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICBsZXQgbWVtYmVyID0gJCgnI21lbWJlci1uZXcnKS52YWwoKTtcbiAgICAgICQoJyNtZW1iZXItbmV3JykudmFsKCcnKTtcbiAgICAgIF90aGlzLnBvbGljaWVzTWFuYWdlci5hZGRUb0dyb3VwKGdyb3VwLCBtZW1iZXIpLnRoZW4oKCkgPT4ge1xuICAgICAgICAkKCcubWVtYmVyLW5ldy1tb2RhbCcpLmNsb3NlTW9kYWwoKTtcbiAgICAgICAgX3RoaXMuX21hbmFnZUdyb3VwcygpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBfY3JlYXRlR3JvdXAoKSB7XG4gICAgbGV0IF90aGlzID0gdGhpcztcbiAgICAkKCcjZ3JvdXAtbmV3LW5hbWUnKS52YWwoJycpO1xuICAgICQoJy5ncm91cC1uZXctbW9kYWwnKS5vcGVuTW9kYWwoKTtcbiAgICAkKCcuZ3JvdXAtbmV3LW9rJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICBsZXQgZ3JvdXBOYW1lID0gJCgnI2dyb3VwLW5ldy1uYW1lJykudmFsKCk7XG4gICAgICBfdGhpcy5wb2xpY2llc01hbmFnZXIuY3JlYXRlR3JvdXAoZ3JvdXBOYW1lKS50aGVuKCgpID0+IHtcbiAgICAgICAgX3RoaXMuX21hbmFnZUdyb3VwcygpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBfYWRkUG9saWN5KCkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgJCgnI3BvbGljeS1uZXctdGl0bGUnKS52YWwoJycpO1xuICAgICQoJy5jb21iaW5pbmcnKS5odG1sKCcnKTtcbiAgICBsZXQgYWxnb3JpdGhtcyA9IFsnQmxvY2sgb3ZlcnJpZGVzJywgJ0FsbG93IG92ZXJyaWRlcycsICdGaXJzdCBhcHBsaWNhYmxlJ107XG4gICAgJCgnLmNvbWJpbmluZycpLmFwcGVuZCh0aGlzLl9nZXRPcHRpb25zKCdjb21iLWFsZ29yaXRobScsICdDaG9vc2UgYSBjb21iaW5pbmcgYWxnb3JpdGhtJywgYWxnb3JpdGhtcykpO1xuICAgICQoJy5wb2xpY3ktbmV3Jykub3Blbk1vZGFsKCk7XG5cbiAgICAkKCcucG9saWN5LW5ldy1vaycpLm9mZigpO1xuICAgICQoJy5wb2xpY3ktbmV3LW9rJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICBsZXQgcG9saWN5VGl0bGUgPSAkKCcjcG9saWN5LW5ldy10aXRsZScpLnZhbCgpO1xuICAgICAgaWYgKCFwb2xpY3lUaXRsZSkge1xuICAgICAgICBNYXRlcmlhbGl6ZS50b2FzdCgnSW52YWxpZCBwb2xpY3kgdGl0bGUnLCA0MDAwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCBjb21iaW5pbmdBbGdvcml0aG0gPSAkKCcjY29tYi1hbGdvcml0aG0nKS52YWwoKTtcbiAgICAgICAgX3RoaXMucG9saWNpZXNNYW5hZ2VyLmFkZFBvbGljeShwb2xpY3lUaXRsZSwgY29tYmluaW5nQWxnb3JpdGhtKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAkKCcuaGVscC1tZW51JykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAkKCcucG9saWN5LW5ldycpLmNsb3NlTW9kYWwoKTtcbiAgICAgICAgICBfdGhpcy5fZ29Ib21lKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgICQoJy5oZWxwLWJ0bicpLm9mZigpO1xuICAgICQoJy5oZWxwLWJ0bicpLm9uKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgJCgnLmhlbHAtbWVudScpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfSk7XG4gIH1cblxuICBfZGVjcmVhc2VSdWxlUHJpb3JpdHkoKSB7XG4gICAgbGV0IF90aGlzID0gdGhpcztcbiAgICBsZXQgaWQgPSBldmVudC50YXJnZXQuY2xvc2VzdCgndHInKS5pZDtcbiAgICBsZXQgc3BsaXRJZCA9IGlkLnNwbGl0KCc6Jyk7XG4gICAgbGV0IHRoaXNQcmlvcml0eSA9IHBhcnNlSW50KHNwbGl0SWRbc3BsaXRJZC5sZW5ndGggLSAxXSk7XG4gICAgc3BsaXRJZC5wb3AoKTtcbiAgICBsZXQgcG9saWN5VGl0bGUgPSBzcGxpdElkLmpvaW4oJzonKTtcbiAgICBfdGhpcy5wb2xpY2llc01hbmFnZXIuZ2V0UG9saWN5KHBvbGljeVRpdGxlKS50aGVuKChwb2xpY3kpID0+IHtcbiAgICAgIGxldCBsYXN0UHJpb3JpdHkgPSBwb2xpY3kuZ2V0TGFzdFByaW9yaXR5KCk7XG4gICAgICBpZiAobGFzdFByaW9yaXR5ICE9IHRoaXNQcmlvcml0eSkge1xuICAgICAgICBsZXQgbmV3UHJpb3JpdHkgPSBwYXJzZUludCh0aGlzUHJpb3JpdHkgKyAxKTtcbiAgICAgICAgX3RoaXMucG9saWNpZXNNYW5hZ2VyLmRlY3JlYXNlUnVsZVByaW9yaXR5KHBvbGljeVRpdGxlLCB0aGlzUHJpb3JpdHksIG5ld1ByaW9yaXR5KS50aGVuKCgpID0+IHtcbiAgICAgICAgICBfdGhpcy5fZ29Ib21lKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgX2RlbGV0ZU1lbWJlcigpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIGxldCBpZCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0cicpLmlkO1xuICAgIGxldCBzcGxpdElkID0gaWQuc3BsaXQoJzo6Jyk7XG4gICAgbGV0IG1lbWJlciA9IHNwbGl0SWRbc3BsaXRJZC5sZW5ndGggLSAxXTtcbiAgICBzcGxpdElkLnBvcCgpO1xuICAgIGxldCBncm91cCA9IHNwbGl0SWQuam9pbignOjonKTtcbiAgICBfdGhpcy5wb2xpY2llc01hbmFnZXIucmVtb3ZlRnJvbUdyb3VwKGdyb3VwLCBtZW1iZXIpLnRoZW4oKCkgPT4ge1xuICAgICAgX3RoaXMuX21hbmFnZUdyb3VwcygpO1xuICAgIH0pO1xuICB9XG5cbiAgX2RlbGV0ZUdyb3VwKCkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgbGV0IGdyb3VwTmFtZSA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0cicpLmNoaWxkcmVuWzBdLmlkO1xuICAgIF90aGlzLnBvbGljaWVzTWFuYWdlci5kZWxldGVHcm91cChncm91cE5hbWUpLnRoZW4oKCkgPT4ge1xuICAgICAgX3RoaXMuX21hbmFnZUdyb3VwcygpO1xuICAgIH0pO1xuICB9XG5cbiAgX2RlbGV0ZVBvbGljeSgpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIGxldCBwb2xpY3lUaXRsZSA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0cicpLmlkO1xuICAgIF90aGlzLnBvbGljaWVzTWFuYWdlci5kZWxldGVQb2xpY3kocG9saWN5VGl0bGUpLnRoZW4oKCkgPT4ge1xuICAgICAgX3RoaXMuX2dvSG9tZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgX2RlbGV0ZVJ1bGUoKSB7XG4gICAgbGV0IF90aGlzID0gdGhpcztcbiAgICBsZXQgaWQgPSBldmVudC50YXJnZXQuY2xvc2VzdCgndHInKS5pZDtcbiAgICBsZXQgc3BsaXRJZCA9IGlkLnNwbGl0KCc6Jyk7XG4gICAgbGV0IHByaW9yaXR5ID0gc3BsaXRJZFtzcGxpdElkLmxlbmd0aCAtIDFdO1xuICAgIHNwbGl0SWQucG9wKCk7XG4gICAgbGV0IHBvbGljeVRpdGxlID0gc3BsaXRJZC5qb2luKCc6Jyk7XG4gICAgbGV0IHJ1bGUgPSBfdGhpcy5wb2xpY2llc01hbmFnZXIuZ2V0UnVsZU9mUG9saWN5KHBvbGljeVRpdGxlLCBwcmlvcml0eSk7XG5cbiAgICBfdGhpcy5wb2xpY2llc01hbmFnZXIuZGVsZXRlUnVsZShwb2xpY3lUaXRsZSwgcnVsZSkudGhlbigoKSA9PiB7XG4gICAgICBfdGhpcy5fZ29Ib21lKCk7XG4gICAgfSk7XG4gIH1cblxuICBfZ2V0QWN0aXZlUG9saWN5KCkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgX3RoaXMucG9saWNpZXNNYW5hZ2VyLmdldEFjdGl2ZVBvbGljeSgpLnRoZW4oKGFjdGl2ZVVzZXJQb2xpY3kpID0+IHtcbiAgICAgICQoJy5wb2xpY3ktYWN0aXZlJykuaHRtbCgnJyk7XG4gICAgICBfdGhpcy5wb2xpY2llc01hbmFnZXIuZ2V0UG9saWNpZXNUaXRsZXMoKS50aGVuKChwb2xpY2llcykgPT4ge1xuICAgICAgICBwb2xpY2llcy5wdXNoKCdEZWFjdGl2YXRlIGFsbCBwb2xpY2llcycpO1xuXG4gICAgICAgICQoJy5wb2xpY3ktYWN0aXZlJykuYXBwZW5kKF90aGlzLl9nZXRPcHRpb25zKCdwb2xpY2llcy1saXN0JywgJ0NsaWNrIHRvIGFjdGl2YXRlIGEgcG9saWN5JywgcG9saWNpZXMsIGFjdGl2ZVVzZXJQb2xpY3kpKTtcblxuICAgICAgICAkKCcjcG9saWNpZXMtbGlzdCcpLm9uKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICAgIGxldCBwb2xpY3lUaXRsZSA9ICQoJyNwb2xpY2llcy1saXN0JykuZmluZChcIjpzZWxlY3RlZFwiKVswXS50ZXh0Q29udGVudDtcbiAgICAgICAgICBpZiAocG9saWN5VGl0bGUgPT09ICdEZWFjdGl2YXRlIGFsbCBwb2xpY2llcycpIHtcbiAgICAgICAgICAgIHBvbGljeVRpdGxlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfdGhpcy5wb2xpY2llc01hbmFnZXIudXBkYXRlQWN0aXZlUG9saWN5KHBvbGljeVRpdGxlKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIF9nZXRHcm91cE9wdGlvbnModGl0bGUsIGtleXMsIHNjb3BlcywgbGlzdHMpIHtcbiAgICBsZXQgbGlzdCA9ICc8b3B0aW9uIGRpc2FibGVkIHNlbGVjdGVkPicgKyB0aXRsZSArICc8L29wdGlvbj4nO1xuXG4gICAgZm9yIChsZXQgaSBpbiBrZXlzKSB7XG4gICAgICBsaXN0ICs9ICc8b3B0Z3JvdXAgbGFiZWw9JyArIGtleXNbaV0gKyAnPic7XG4gICAgICBmb3IgKGxldCBqIGluIGxpc3RzW2ldKSB7XG4gICAgICAgIGxpc3QgKz0gJzxvcHRpb24gaWQ9XCInICsgc2NvcGVzW2ldICsgJ1wiPicgKyBsaXN0c1tpXVtqXSArICc8L29wdGlvbj4nO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBsaXN0O1xuICB9XG5cbiAgX2dldEluZm8odmFyaWFibGUpIHtcbiAgICBsZXQgaW5mbztcblxuICAgIHN3aXRjaCh2YXJpYWJsZSkge1xuICAgICAgY2FzZSAnRGF0ZSc6XG4gICAgICAgIGluZm8gPSAkKCcuY29uZmlnJykuZmluZCgnaW5wdXQnKS52YWwoKTtcbiAgICAgICAgaWYgKGluZm8uaW5kZXhPZignLCcpICE9PSAtMSkgeyAvLzIwIEp1bHksIDIwMTZcbiAgICAgICAgICBsZXQgc3BsaXRJbmZvID0gaW5mby5zcGxpdCgnICcpOyAvL1snMjAnLCAnSnVseSwnLCcgJzIwMTYnXVxuICAgICAgICAgIHNwbGl0SW5mb1sxXSA9IHNwbGl0SW5mb1sxXS5zdWJzdHJpbmcoMCwgc3BsaXRJbmZvWzFdLmxlbmd0aCAtIDEpOyAvLydKdWx5J1xuICAgICAgICAgIGxldCBtb250aHMgPSBbJ0phbnVhcnknLCAnRmVicnVhcnknLCAnTWFyY2gnLCAnQXByaWwnLCAnTWF5JywgJ0p1bmUnLCAnSnVseScsICdBdWd1c3QnLCAnU2VwdGVtYmVyJywgJ09jdG9iZXInLCAnTm92ZW1iZXInLCAnRGVjZW1iZXInXTtcbiAgICAgICAgICBpbmZvID0gc3BsaXRJbmZvWzBdICsgJy8nICsgKG1vbnRocy5pbmRleE9mKHNwbGl0SW5mb1sxXSkgKyAxKSArICcvJyArIHNwbGl0SW5mb1syXTtcbiAgICAgICAgfSBlbHNlIHsgLy8gMjAxNi0wNy0yMFxuICAgICAgICAgIGxldCBzcGxpdEluZm8gPSBpbmZvLnNwbGl0KCctJyk7XG4gICAgICAgICAgaW5mbyA9IHNwbGl0SW5mb1syXSArICcvJyArIHNwbGl0SW5mb1sxXSArICcvJyArIHNwbGl0SW5mb1swXTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ0dyb3VwIG9mIHVzZXJzJzpcbiAgICAgICAgaW5mbyA9ICQoJyNncm91cCcpLmZpbmQoXCI6c2VsZWN0ZWRcIikudGV4dCgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ1N1YnNjcmlwdGlvbiBwcmVmZXJlbmNlcyc6XG4gICAgICAgIGlmIChpbmZvID0gJChcImlucHV0W25hbWU9J3J1bGUtbmV3LXN1YnNjcmlwdGlvbiddOmNoZWNrZWRcIilbMF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGluZm8gPSAkKFwiaW5wdXRbbmFtZT0ncnVsZS1uZXctc3Vic2NyaXB0aW9uJ106Y2hlY2tlZFwiKVswXS5pZDtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ1dlZWtkYXknOlxuICAgICAgICBpbmZvID0gJCgnI3dlZWtkYXknKS5maW5kKFwiOnNlbGVjdGVkXCIpLnRleHQoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpbmZvID0gJCgnLmNvbmZpZycpLmZpbmQoJ2lucHV0JykudmFsKCk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHJldHVybiBpbmZvO1xuICB9XG5cbiAgX2dldExpc3QoaXRlbXMpIHtcbiAgICAgIGxldCBsaXN0ID0gJyc7XG4gICAgICBsZXQgbnVtSXRlbXMgPSBpdGVtcy5sZW5ndGg7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtSXRlbXM7IGkrKykge1xuICAgICAgICBsaXN0ICs9ICc8bGkgY2xhc3M9XCJkaXZpZGVyXCI+PC9saT4nO1xuICAgICAgICBsaXN0ICs9ICc8bGk+PGEgY2xhc3M9XCJjZW50ZXItYWxpZ25cIj4nICsgaXRlbXNbaV0gKyAnPC9hPjwvbGk+JztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGxpc3Q7XG4gICAgfVxuXG4gIF9nZXRPcHRpb25zKGlkLCB0aXRsZSwgbGlzdCwgc2VsZWN0ZWQpIHtcbiAgICBsZXQgb3B0aW9ucyA9ICc8c2VsZWN0IGlkPVwiJyArIGlkICsgJ1wiIGNsYXNzPVwiYnJvd3Nlci1kZWZhdWx0XCI+PG9wdGlvbiBkaXNhYmxlZCBzZWxlY3RlZD4nICsgdGl0bGUgKyAnPC9vcHRpb24+JztcbiAgICBmb3IgKGxldCBpIGluIGxpc3QpIHtcbiAgICAgIGlmIChzZWxlY3RlZCAhPT0gdW5kZWZpbmVkICYgc2VsZWN0ZWQgPT09IGxpc3RbaV0pIHtcbiAgICAgICAgb3B0aW9ucyArPSAnPG9wdGlvbiBzZWxlY3RlZCBpZD1cIicgKyBpZCArICdcIj4nICsgbGlzdFtpXSArICc8L29wdGlvbj4nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3B0aW9ucyArPSAnPG9wdGlvbiBpZD1cIicgKyBpZCArICdcIj4nICsgbGlzdFtpXSArICc8L29wdGlvbj4nO1xuICAgICAgfVxuICAgIH1cbiAgICBvcHRpb25zICs9ICc8L3NlbGVjdD4nO1xuXG4gICAgcmV0dXJuIG9wdGlvbnM7XG4gIH1cblxuICBfZ2V0UG9saWNpZXNUYWJsZSgpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuXG4gICAgX3RoaXMucG9saWNpZXNNYW5hZ2VyLmdldEZvcm1hdHRlZFBvbGljaWVzKCkudGhlbigocG9saWNpZXMpID0+IHtcbiAgICAgICQoJy5wb2xpY2llcy1ubycpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAkKCcucG9saWNpZXMtY3VycmVudCcpLmh0bWwoJycpO1xuXG4gICAgICBsZXQgcG9saWNpZXNUaXRsZXMgPSBbXTtcbiAgICAgIGxldCBydWxlc1RpdGxlcyA9IFtdO1xuICAgICAgbGV0IGlkcyA9IFtdO1xuXG4gICAgICBmb3IgKGxldCBpIGluIHBvbGljaWVzKSB7XG4gICAgICAgIHBvbGljaWVzVGl0bGVzLnB1c2gocG9saWNpZXNbaV0udGl0bGUpO1xuICAgICAgICBydWxlc1RpdGxlcy5wdXNoKHBvbGljaWVzW2ldLnJ1bGVzVGl0bGVzKTtcbiAgICAgICAgaWRzLnB1c2gocG9saWNpZXNbaV0uaWRzKTtcbiAgICAgIH1cblxuICAgICAgbGV0IHRhYmxlID0gJzx0YWJsZT4nO1xuICAgICAgbGV0IGlzRW1wdHkgPSBwb2xpY2llc1RpdGxlcy5sZW5ndGggPT09IDA7XG5cbiAgICAgIGZvciAobGV0IGkgaW4gcG9saWNpZXNUaXRsZXMpIHtcbiAgICAgICAgdGFibGUgKz0gJzx0aGVhZD48dHIgaWQ9XCInICsgcG9saWNpZXNUaXRsZXNbaV0gKyAnXCI+PHRkPjwvdGQ+PHRkPjwvdGQ+PHRoIGNsYXNzPVwiY2VudGVyLWFsaWduXCI+JyArIHBvbGljaWVzVGl0bGVzW2ldICsgJzwvdGg+PHRkPjxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnMgY2xpY2thYmxlLWNlbGwgcG9saWN5LWRlbGV0ZVwiIHN0eWxlPVwiY3Vyc29yOiBwb2ludGVyOyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlXCI+ZGVsZXRlX2ZvcmV2ZXI8L2k+PC90ZD48L3RyPjwvdGhlYWQ+PHRib2R5Pic7XG5cbiAgICAgICAgZm9yIChsZXQgaiBpbiBydWxlc1RpdGxlc1tpXSkge1xuICAgICAgICAgIHRhYmxlICs9ICc8dHIgaWQ9XCInICsgaWRzW2ldW2pdICsgJ1wiID48dGQ+PGkgY2xhc3M9XCJtYXRlcmlhbC1pY29ucyBjbGlja2FibGUtY2VsbCBydWxlLXByaW9yaXR5LWluY3JlYXNlXCIgc3R5bGU9XCJjdXJzb3I6IHBvaW50ZXI7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGVcIj5hcnJvd191cHdhcmQ8L2k+PC90ZD48dGQ+PGkgY2xhc3M9XCJtYXRlcmlhbC1pY29ucyBjbGlja2FibGUtY2VsbCBydWxlLXByaW9yaXR5LWRlY3JlYXNlXCIgc3R5bGU9XCJjdXJzb3I6IHBvaW50ZXI7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGVcIj5hcnJvd19kb3dud2FyZDwvaT48L3RkPjx0ZCBjbGFzcz1cInJ1bGUtc2hvdyBjbGlja2FibGUtY2VsbFwiIHN0eWxlPVwiY3Vyc29yOiBwb2ludGVyXCI+JyArIHJ1bGVzVGl0bGVzW2ldW2pdICsgJzwvdGQ+PHRkPjxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnMgY2xpY2thYmxlLWNlbGwgcnVsZS1kZWxldGVcIiBzdHlsZT1cImN1cnNvcjogcG9pbnRlcjsgdmVydGljYWwtYWxpZ246IG1pZGRsZVwiPmNsZWFyPC9pPjwvdGQ+PC90cj4nO1xuICAgICAgICB9XG4gICAgICAgIHRhYmxlICs9ICc8dHIgaWQ9XCInICsgcG9saWNpZXNUaXRsZXNbaV0gKyAnXCI+PC90ZD48dGQ+PC90ZD48dGQ+PC90ZD48dGQgc3R5bGU9XCJ0ZXh0LWFsaWduOmNlbnRlclwiPjxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnMgY2xpY2thYmxlLWNlbGwgY2VudGVyLWFsaWduIHJ1bGUtYWRkXCIgc3R5bGU9XCJjdXJzb3I6IHBvaW50ZXJcIj5hZGRfY2lyY2xlPC9pPjwvdGQ+PC90cj4nO1xuICAgICAgfVxuICAgICAgaWYgKCFpc0VtcHR5KSB7XG4gICAgICAgIHRhYmxlICs9ICc8L3Rib2R5PjwvdGFibGU+JztcbiAgICAgICAgJCgnLnBvbGljaWVzLWN1cnJlbnQnKS5hcHBlbmQodGFibGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJCgnLnBvbGljaWVzLW5vJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICAgICQoJy5ydWxlLWFkZCcpLm9uKCdjbGljaycsIChldmVudCkgPT4geyBfdGhpcy5fc2hvd1ZhcmlhYmxlc1R5cGVzKCk7IH0pO1xuICAgICAgJCgnLnJ1bGUtZGVsZXRlJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7IF90aGlzLl9kZWxldGVSdWxlKCk7IH0pO1xuICAgICAgJCgnLnJ1bGUtc2hvdycpLm9uKCdjbGljaycsIChldmVudCkgPT4geyBfdGhpcy5fc2hvd1J1bGUoKTsgfSk7XG4gICAgICAkKCcucnVsZS1wcmlvcml0eS1pbmNyZWFzZScpLm9uKCdjbGljaycsIChldmVudCkgPT4geyBfdGhpcy5faW5jcmVhc2VSdWxlUHJpb3JpdHkoKTsgfSk7XG4gICAgICAkKCcucnVsZS1wcmlvcml0eS1kZWNyZWFzZScpLm9uKCdjbGljaycsIChldmVudCkgPT4geyBfdGhpcy5fZGVjcmVhc2VSdWxlUHJpb3JpdHkoKTsgfSk7XG4gICAgICAkKCcucG9saWN5LWFkZCcpLm9mZigpO1xuICAgICAgJCgnLnBvbGljeS1hZGQnKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHsgX3RoaXMuX2FkZFBvbGljeSgpOyB9KTtcbiAgICAgICQoJy5wb2xpY3ktZGVsZXRlJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7IF90aGlzLl9kZWxldGVQb2xpY3koKTsgfSk7XG4gICAgfSk7XG4gIH1cblxuICBfZ29Ib21lKCkge1xuICAgIHRoaXMuX2dldEFjdGl2ZVBvbGljeSgpO1xuICAgIHRoaXMuX2dldFBvbGljaWVzVGFibGUoKTtcbiAgfVxuXG4gIF9pbmNyZWFzZVJ1bGVQcmlvcml0eSgpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIGxldCBpZCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0cicpLmlkO1xuICAgIGxldCBzcGxpdElkID0gaWQuc3BsaXQoJzonKTtcbiAgICBsZXQgdGhpc1ByaW9yaXR5ID0gcGFyc2VJbnQoc3BsaXRJZFtzcGxpdElkLmxlbmd0aCAtIDFdKTtcbiAgICBpZiAodGhpc1ByaW9yaXR5ICE9PSAwKSB7XG4gICAgICBzcGxpdElkLnBvcCgpO1xuICAgICAgbGV0IHBvbGljeVRpdGxlID0gc3BsaXRJZC5qb2luKCc6Jyk7XG4gICAgICBsZXQgbmV3UHJpb3JpdHkgPSB0aGlzUHJpb3JpdHkgLSAxO1xuXG4gICAgICBfdGhpcy5wb2xpY2llc01hbmFnZXIuaW5jcmVhc2VSdWxlUHJpb3JpdHkocG9saWN5VGl0bGUsIHRoaXNQcmlvcml0eSwgbmV3UHJpb3JpdHkpLnRoZW4oKCkgPT4ge1xuICAgICAgICBfdGhpcy5fZ29Ib21lKCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBfbWFuYWdlR3JvdXBzKCkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgX3RoaXMucG9saWNpZXNNYW5hZ2VyLmdldEdyb3VwcygpLnRoZW4oKGdyb3Vwc1BFKSA9PiB7XG4gICAgICAkKCcuZ3JvdXBzLWN1cnJlbnQnKS5odG1sKCcnKTtcbiAgICAgIGxldCBncm91cHMgPSBncm91cHNQRS5ncm91cHNOYW1lcztcbiAgICAgIGxldCBtZW1iZXJzID0gZ3JvdXBzUEUubWVtYmVycztcbiAgICAgIGxldCBpZHMgPSBncm91cHNQRS5pZHM7XG5cbiAgICAgIGxldCB0YWJsZSA9ICc8dGFibGU+JztcbiAgICAgIGxldCBpc0VtcHR5ID0gZ3JvdXBzLmxlbmd0aCA9PT0gMDtcblxuICAgICAgZm9yIChsZXQgaSBpbiBncm91cHMpIHtcbiAgICAgICAgdGFibGUgKz0gJzx0aGVhZD48dHI+PHRoIGlkPVwiJyArIGdyb3Vwc1tpXSArICdcIj4nICsgZ3JvdXBzW2ldICsgJzwvdGg+PHRkIHN0eWxlPVwidGV4dC1hbGlnbjpyaWdodFwiPjxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnMgY2xpY2thYmxlLWNlbGwgZ3JvdXAtZGVsZXRlXCIgc3R5bGU9XCJjdXJzb3I6IHBvaW50ZXI7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGVcIj5kZWxldGVfZm9yZXZlcjwvaT48L3RkPjwvdHI+PC90aGVhZD48dGJvZHk+JztcbiAgICAgICAgZm9yIChsZXQgaiBpbiBtZW1iZXJzW2ldKSB7XG4gICAgICAgICAgdGFibGUgKz0gJzx0ciBpZD1cIicgKyBpZHNbaV1bal0gKyAnXCIgPjx0ZCBzdHlsZT1cImN1cnNvcjogcG9pbnRlclwiPicgKyBtZW1iZXJzW2ldW2pdICsgJzwvdGQ+PHRkIHN0eWxlPVwidGV4dC1hbGlnbjpyaWdodFwiPjxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnMgY2xpY2thYmxlLWNlbGwgbWVtYmVyLWRlbGV0ZVwiIHN0eWxlPVwiY3Vyc29yOiBwb2ludGVyOyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlXCI+Y2xlYXI8L2k+PC90ZD48L3RyPic7XG4gICAgICAgIH1cblxuICAgICAgICB0YWJsZSArPSAnPHRyIGlkPVwiJyArIGdyb3Vwc1tpXSArICdcIj48dGQ+PGkgY2xhc3M9XCJtYXRlcmlhbC1pY29ucyBjbGlja2FibGUtY2VsbCBtZW1iZXItYWRkXCIgaWQ9XCInICsgZ3JvdXBzW2ldICsgJ1wiIHN0eWxlPVwiY3Vyc29yOiBwb2ludGVyXCI+YWRkX2NpcmNsZTwvaT48L3RkPjwvdHI+JztcbiAgICAgIH1cblxuICAgICAgaWYgKCFpc0VtcHR5KSB7XG4gICAgICAgIHRhYmxlICs9ICc8L3Rib2R5PjwvdGFibGU+JztcbiAgICAgICAgJCgnLmdyb3Vwcy1jdXJyZW50JykuYXBwZW5kKHRhYmxlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICQoJy5ncm91cHMtY3VycmVudCcpLmFwcGVuZCgnPHA+VGhlcmUgYXJlIG5vIGdyb3VwcyBzZXQuPC9wPicpO1xuICAgICAgfVxuXG4gICAgICAkKCcubWVtYmVyLWFkZCcpLm9mZigpO1xuICAgICAgJCgnLm1lbWJlci1hZGQnKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHsgX3RoaXMuX2FkZE1lbWJlcigpOyB9KTtcbiAgICAgICQoJy5tZW1iZXItZGVsZXRlJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7IF90aGlzLl9kZWxldGVNZW1iZXIoKTsgfSk7XG4gICAgICAkKCcuZ3JvdXAtYWRkJykub2ZmKCk7XG4gICAgICAkKCcuZ3JvdXAtYWRkJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7IF90aGlzLl9jcmVhdGVHcm91cCgpOyB9KTtcbiAgICAgICQoJy5ncm91cC1kZWxldGUnKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHsgX3RoaXMuX2RlbGV0ZUdyb3VwKCk7IH0pO1xuICAgIH0pO1xuICB9XG5cbiAgX3BhcnNlRmlsZUNvbnRlbnQoY29udGVudCkge1xuICAgIGxldCBwYXJzZWRDb250ZW50ID0gSlNPTi5wYXJzZShjb250ZW50KTtcbiAgICBmb3IgKGxldCBpIGluIHBhcnNlZENvbnRlbnQpIHtcbiAgICAgIHRoaXMucG9saWNpZXNNYW5hZ2VyLmFkZFBvbGljeShpLCB1bmRlZmluZWQsIHBhcnNlZENvbnRlbnRbaV0pO1xuICAgIH1cbiAgICAkKCcucG9saWN5LW5ldycpLmNsb3NlTW9kYWwoKTtcbiAgfVxuXG4gIF9zZXRFbGVtZW50cygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZGF0ZTogKHBhcmFtcykgPT4geyByZXR1cm4gJzxpbnB1dCB0eXBlPVwiZGF0ZVwiIGNsYXNzPVwiZGF0ZXBpY2tlclwiPic7IH0sXG4gICAgICBzZWxlY3Q6IChwYXJhbXMpID0+IHsgcmV0dXJuIHRoaXMuX2dldE9wdGlvbnMocGFyYW1zWzBdLCBwYXJhbXNbMV0sIHBhcmFtc1syXSk7IH0sXG4gICAgICBmb3JtOiAocGFyYW1zKSA9PiB7IHJldHVybiAnPGZvcm0+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgcGxhY2Vob2xkZXI9XCInICsgcGFyYW1zICsgJ1wiPjwvaW5wdXQ+PC9mb3JtPic7IH1cbiAgICB9O1xuICB9XG5cbiAgX3Nob3dOZXdDb25maWd1cmF0aW9uUGFuZWwocG9saWN5VGl0bGUpIHtcbiAgICBsZXQgdmFyaWFibGUgPSBldmVudC50YXJnZXQudGV4dDtcbiAgICAkKCcudmFyaWFibGUnKS5odG1sKHRoaXMuX2dldE5ld0NvbmZpZ3VyYXRpb24ocG9saWN5VGl0bGUsIHZhcmlhYmxlKSk7XG4gICAgJCgnLnNjb3BlcycpLmVtcHR5KCkuaHRtbCgnJyk7XG5cbiAgICBsZXQga2V5cyA9IFsnRW1haWwnLCAnSHlwZXJ0eScsICdBbGwnXTtcbiAgICBsZXQgc2NvcGVzID0gWydpZGVudGl0eScsICdoeXBlcnR5JywgJ2dsb2JhbCddO1xuICAgIGxldCBsaXN0cyA9IFtdO1xuXG4gICAgdGhpcy5wb2xpY2llc01hbmFnZXIuZ2V0TXlFbWFpbHMoKS50aGVuKChlbWFpbHMpID0+IHtcbiAgICAgIGxpc3RzLnB1c2goZW1haWxzKTtcbiAgICAgIHRoaXMucG9saWNpZXNNYW5hZ2VyLmdldE15SHlwZXJ0aWVzKCkudGhlbigoaHlwZXJ0aWVzKSA9PiB7XG4gICAgICAgIGxpc3RzLnB1c2goaHlwZXJ0aWVzKTtcbiAgICAgICAgbGlzdHMucHVzaChbJ0FsbCBpZGVudGl0aWVzIGFuZCBoeXBlcnRpZXMnXSk7XG4gICAgICAgICQoJy5zY29wZXMnKS5hcHBlbmQodGhpcy5fZ2V0R3JvdXBPcHRpb25zKCdBcHBseSB0aGlzIGNvbmZpZ3VyYXRpb24gdG86Jywga2V5cywgc2NvcGVzLCBsaXN0cykpO1xuICAgICAgICAkKCcudmFyaWFibGUnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBfc2hvd1ZhcmlhYmxlc1R5cGVzKGV2ZW50KSB7XG4gICAgbGV0IHBvbGljeVRpdGxlID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ3RyJykuaWQ7XG5cbiAgICAkKCcjdmFyaWFibGVzLXR5cGVzJykuZW1wdHkoKS5odG1sKCcnKTtcbiAgICBsZXQgdmFyaWFibGVzID0gdGhpcy5wb2xpY2llc01hbmFnZXIuZ2V0VmFyaWFibGVzKCk7XG4gICAgJCgnI3ZhcmlhYmxlcy10eXBlcycpLmFwcGVuZCh0aGlzLl9nZXRMaXN0KHZhcmlhYmxlcykpO1xuICAgICQoJy52YXJpYWJsZScpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgJCgnLnJ1bGUtbmV3Jykub3Blbk1vZGFsKCk7XG4gICAgJCgnI3ZhcmlhYmxlcy10eXBlcycpLm9mZigpO1xuICAgICQoJyN2YXJpYWJsZXMtdHlwZXMnKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHsgdGhpcy5fc2hvd05ld0NvbmZpZ3VyYXRpb25QYW5lbChwb2xpY3lUaXRsZSk7IH0pO1xuICB9XG5cbiAgX2dldE5ld0NvbmZpZ3VyYXRpb24ocG9saWN5VGl0bGUsIHZhcmlhYmxlKSB7XG4gICAgbGV0IF90aGlzID0gdGhpcztcbiAgICBsZXQgaW5mbyA9IF90aGlzLnBvbGljaWVzTWFuYWdlci5nZXRWYXJpYWJsZUluZm8odmFyaWFibGUpO1xuICAgICQoJy5ydWxlLW5ldy10aXRsZScpLmh0bWwoaW5mby50aXRsZSk7XG4gICAgJCgnLmRlc2NyaXB0aW9uJykuaHRtbChpbmZvLmRlc2NyaXB0aW9uKTtcbiAgICAkKCcuY29uZmlnJykuaHRtbCgnJyk7XG5cbiAgICBpZiAodmFyaWFibGUgPT09ICdTdWJzY3JpcHRpb24gcHJlZmVyZW5jZXMnKSB7XG4gICAgICAkKCcuc3Vic2NyaXB0aW9uLXR5cGUnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKCcuc3Vic2NyaXB0aW9uLXR5cGUnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgbGV0IHRhZ3MgPSBpbmZvLmlucHV0O1xuICAgICAgZm9yIChsZXQgaSBpbiB0YWdzKSB7XG4gICAgICAgIF90aGlzLnBvbGljaWVzTWFuYWdlci5nZXRHcm91cHNOYW1lcygpLnRoZW4oKGdyb3Vwc05hbWVzKSA9PiB7XG4gICAgICAgICAgaWYgKHZhcmlhYmxlID09PSAnR3JvdXAgb2YgdXNlcnMnKSB7XG4gICAgICAgICAgICB0YWdzW2ldWzFdLnB1c2goZ3JvdXBzTmFtZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAkKCcuY29uZmlnJykuYXBwZW5kKF90aGlzLmVsZW1lbnRzW3RhZ3NbaV1bMF1dKHRhZ3NbaV1bMV0pKTtcbiAgICAgICAgICBpZiAodmFyaWFibGUgPT09ICdHcm91cCBvZiB1c2VycycpIHtcbiAgICAgICAgICAgIHRhZ3NbaV1bMV0ucG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh2YXJpYWJsZSA9PT0nZGF0ZScpIHtcbiAgICAgICAgJCgnLmRhdGVwaWNrZXInKS5waWNrYWRhdGUoe1xuICAgICAgICAgIHNlbGVjdE1vbnRoczogdHJ1ZSxcbiAgICAgICAgICBzZWxlY3RZZWFyczogMTVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbGxvdycpLmNoZWNrZWQgPSBmYWxzZTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmxvY2snKS5jaGVja2VkID0gZmFsc2U7XG4gICAgJCgnLm9rLWJ0bicpLm9mZigpO1xuICAgICQoJy5vay1idG4nKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmICgkKFwiaW5wdXRbbmFtZT0ncnVsZS1uZXctZGVjaXNpb24nXTpjaGVja2VkXCIpWzBdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbGV0IGluZm8gPSBfdGhpcy5fZ2V0SW5mbyh2YXJpYWJsZSk7XG4gICAgICAgIGxldCBkZWNpc2lvbiA9ICQoXCJpbnB1dFtuYW1lPSdydWxlLW5ldy1kZWNpc2lvbiddOmNoZWNrZWRcIilbMF0uaWQ7XG4gICAgICAgIGRlY2lzaW9uID0gZGVjaXNpb24gPT09ICdhbGxvdyc7XG4gICAgICAgIGxldCBzY29wZSA9ICQoJy5zY29wZXMnKS5maW5kKFwiOnNlbGVjdGVkXCIpWzBdLmlkO1xuICAgICAgICBsZXQgdGFyZ2V0ID0gJCgnLnNjb3BlcycpLmZpbmQoXCI6c2VsZWN0ZWRcIilbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgIHRhcmdldCA9ICh0YXJnZXQgPT09ICdBbGwgaWRlbnRpdGllcyBhbmQgaHlwZXJ0aWVzJykgPyAnZ2xvYmFsJyA6IHRhcmdldDtcbiAgICAgICAgX3RoaXMucG9saWNpZXNNYW5hZ2VyLnNldEluZm8odmFyaWFibGUsIHBvbGljeVRpdGxlLCBpbmZvLCBkZWNpc2lvbiwgc2NvcGUsIHRhcmdldCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgJCgnLnJ1bGUtbmV3JykuY2xvc2VNb2RhbCgpO1xuICAgICAgICAgIF90aGlzLl9nb0hvbWUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBFcnJvcignSU5GT1JNQVRJT04gTUlTU0lORzogcGxlYXNlIHNwZWNpZnkgYW4gYXV0aG9yaXNhdGlvbiBkZWNpc2lvbi4nKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIF9kZWxldGVJbmZvKHJlc291cmNlVHlwZSkge1xuICAgIGxldCBpZCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0cicpLmlkO1xuICAgIGxldCBzcGxpdElkID0gaWQuc3BsaXQoJzonKTtcbiAgICBsZXQgc2NvcGUgPSBzcGxpdElkWzBdO1xuICAgIHNwbGl0SWQuc2hpZnQoKTtcbiAgICBsZXQgdGFyZ2V0ID0gc3BsaXRJZC5qb2luKCcnKTtcbiAgICBsZXQgY29uZGl0aW9uID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ3RyJykuY2hpbGRyZW5bMF0uaWQ7XG4gICAgdGhpcy5wb2xpY2llc01hbmFnZXIuZGVsZXRlSW5mbyhyZXNvdXJjZVR5cGUsIHNjb3BlLCB0YXJnZXQsIGNvbmRpdGlvbik7XG4gICAgdGhpcy5fZ29Ib21lKCk7XG4gIH1cblxuICBfc2V0TGlzdGVuZXJzKCkge1xuICAgICQoJy5zZXR0aW5ncy1idG4nKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IGJvZHk6IHsgbWV0aG9kOiAnc2hvd0FkbWluUGFnZScgfSwgdG86ICdydW50aW1lOmd1aS1tYW5hZ2VyJyB9LCAnKicpO1xuICAgICAgJCgnLmFkbWluLXBhZ2UnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXS5zdHlsZSA9ICdiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyc7XG4gICAgfSk7XG5cbiAgICAkKCcucG9saWNpZXMtcGFnZS1zaG93Jykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAkKCcucG9saWNpZXMtc2VjdGlvbicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAkKCcuaWRlbnRpdGllcy1zZWN0aW9uJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIHRoaXMuX2dvSG9tZSgpO1xuICAgICAgdGhpcy5fbWFuYWdlR3JvdXBzKCk7XG4gICAgfSk7XG5cbiAgICAkKCcuYWRtaW4tcGFnZS1leGl0Jykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICBwYXJlbnQucG9zdE1lc3NhZ2UoeyBib2R5OiB7IG1ldGhvZDogJ2hpZGVBZG1pblBhZ2UnIH0sIHRvOiAncnVudGltZTpndWktbWFuYWdlcicgfSwgJyonKTtcbiAgICAgICQoJy5hZG1pbi1wYWdlJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF0uc3R5bGUgPSAnYmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudDsnO1xuICAgIH0pO1xuXG4gICAgJCgnLmV4aXQtYnRuJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAkKCcuc3Vic2NyaXB0aW9uLXR5cGUnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgJCgnLmhlbHAtbWVudScpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgfSk7XG5cbiAgICAkKCcjcG9saWN5LWZpbGUnKS5vbignY2hhbmdlJywgKGV2ZW50KSA9PiB7XG4gICAgICBsZXQgZmlsZSA9IGV2ZW50LnRhcmdldC5maWxlc1swXTtcbiAgICAgIGxldCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZmlsZSwgXCJVVEYtOFwiKTtcbiAgICAgIHJlYWRlci5vbmxvYWQgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgdGhpcy5fcGFyc2VGaWxlQ29udGVudChldmVudC50YXJnZXQucmVzdWx0KTtcbiAgICAgICAgdGhpcy5fZ29Ib21lKCk7XG4gICAgICB9XG4gICAgICByZWFkZXIub25lcnJvciA9IChldmVudCkgPT4ge1xuICAgICAgICB0aHJvdyBFcnJvcihcIkVycm9yIHJlYWRpbmcgdGhlIGZpbGVcIik7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBfc2hvd1J1bGUoZXZlbnQpIHtcbiAgICBsZXQgcnVsZVRpdGxlID0gZXZlbnQudGFyZ2V0LnRleHRDb250ZW50O1xuICAgIGxldCBpZCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0cicpLmlkO1xuICAgIGxldCBzcGxpdElkID0gaWQuc3BsaXQoJzonKTtcbiAgICBsZXQgcHJpb3JpdHkgPSBzcGxpdElkW3NwbGl0SWQubGVuZ3RoIC0gMV07XG4gICAgc3BsaXRJZC5wb3AoKTtcbiAgICBsZXQgcG9saWN5VGl0bGUgPSBzcGxpdElkLmpvaW4oJzonKTtcbiAgICB0aGlzLnBvbGljaWVzTWFuYWdlci5nZXRSdWxlT2ZQb2xpY3kocG9saWN5VGl0bGUsIHByaW9yaXR5KS50aGVuKChydWxlKSA9PiB7XG4gICAgICBpZiAocnVsZS5jb25kaXRpb24uYXR0cmlidXRlID09PSAnc3Vic2NyaXB0aW9uJyAmJiBydWxlLmNvbmRpdGlvbi5wYXJhbXMgPT09ICdwcmVhdXRob3Jpc2VkJykge1xuICAgICAgICAkKCcuYXV0aG9yaXNlLWJ0bnMnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV0IGVsZW1lbnQ7XG4gICAgICAgIGlmIChydWxlLmRlY2lzaW9uKSB7XG4gICAgICAgICAgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tYWxsb3cnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bi1ibG9jaycpO1xuICAgICAgICB9XG4gICAgICAgIGVsZW1lbnQuY2hlY2tlZCA9IHRydWU7XG4gICAgICAgICQoJy5hdXRob3Jpc2UtYnRucycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICB9XG4gICAgICAkKCcubWVtYmVyLWFkZCcpLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAkKCcubWVtYmVyLW5ldy1idG4nKS5hZGRDbGFzcygnaGlkZScpO1xuXG4gICAgICAkKCcucnVsZS1kZXRhaWxzJykub3Blbk1vZGFsKCk7XG4gICAgICAkKCcucnVsZS10aXRsZScpLmh0bWwoJzxoNT48Yj4nICsgcnVsZVRpdGxlICsgJzwvYj48L2g1PicpO1xuICAgICAgaWYgKHJ1bGUuY29uZGl0aW9uLmF0dHJpYnV0ZSA9PT0gJ3N1YnNjcmlwdGlvbicpIHtcbiAgICAgICAgJCgnLnN1YnNjcmlwdGlvbi10eXBlJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgIH1cbiAgICAgICQoJy5zdWJzY3JpcHRpb24tZGVjaXNpb24nKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHsgdGhpcy5fdXBkYXRlUnVsZSgnc3Vic2NyaXB0aW9uJywgcG9saWN5VGl0bGUsIHJ1bGUpOyB9KTtcbiAgICAgICQoJy5kZWNpc2lvbicpLm9mZigpO1xuICAgICAgJCgnLmRlY2lzaW9uJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7IHRoaXMuX3VwZGF0ZVJ1bGUoJ2F1dGhvcmlzYXRpb24nLCBwb2xpY3lUaXRsZSwgcnVsZSk7fSk7XG4gICAgfSk7XG4gIH1cblxuICBfdXBkYXRlUnVsZSh0eXBlLCBwb2xpY3lUaXRsZSwgcnVsZSkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgbGV0IHRpdGxlID0gJCgnLnJ1bGUtdGl0bGUnKS50ZXh0KCk7XG4gICAgbGV0IHNwbGl0VGl0bGUgPSB0aXRsZS5zcGxpdCgnICcpO1xuICAgIGxldCBpbmRleCA9IHNwbGl0VGl0bGUuaW5kZXhPZignaXMnKTtcbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICBpbmRleCA9IHNwbGl0VGl0bGUuaW5kZXhPZignYXJlJyk7XG4gICAgfVxuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSAnYXV0aG9yaXNhdGlvbic6XG4gICAgICAgIGxldCBuZXdEZWNpc2lvbiA9ICQoXCJpbnB1dFtuYW1lPSdydWxlLXVwZGF0ZS1kZWNpc2lvbiddOmNoZWNrZWRcIilbMF0uaWQ7XG5cbiAgICAgICAgaWYgKG5ld0RlY2lzaW9uID09PSAnYnRuLWFsbG93Jykge1xuICAgICAgICAgIHNwbGl0VGl0bGVbaW5kZXggKyAxXSA9ICdhbGxvd2VkJztcbiAgICAgICAgICBuZXdEZWNpc2lvbiA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc3BsaXRUaXRsZVtpbmRleCArIDFdID0gJ2Jsb2NrZWQnO1xuICAgICAgICAgIG5ld0RlY2lzaW9uID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGl0bGUgPSBzcGxpdFRpdGxlLmpvaW4oJyAnKTtcbiAgICAgICAgJCgnLnJ1bGUtdGl0bGUnKS5odG1sKCc8aDU+PGI+JyArIHRpdGxlICsgJzwvYj48L2g1PicpO1xuICAgICAgICBfdGhpcy5wb2xpY2llc01hbmFnZXIudXBkYXRlUG9saWN5KHBvbGljeVRpdGxlLCBydWxlLCBuZXdEZWNpc2lvbikudGhlbigoKSA9PiB7XG4gICAgICAgICAgX3RoaXMuX2dvSG9tZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdzdWJzY3JpcHRpb24nOlxuICAgICAgICBsZXQgbmV3U3Vic2NyaXB0aW9uVHlwZSA9IGV2ZW50LnRhcmdldC5sYWJlbHNbMF0udGV4dENvbnRlbnQ7XG5cbiAgICAgICAgbGV0IGRlY2lzaW9uID0gc3BsaXRUaXRsZVtpbmRleCArIDFdO1xuICAgICAgICBzcGxpdFRpdGxlID0gdGl0bGUuc3BsaXQoJ2h5cGVydGllcyBhcmUnKTtcbiAgICAgICAgaWYgKG5ld1N1YnNjcmlwdGlvblR5cGUgPT09ICdBbGwgc3Vic2NyaWJlcnMnKSB7XG4gICAgICAgICAgJCgnLmF1dGhvcmlzZS1idG5zJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICBuZXdEZWNpc2lvbiA9IHJ1bGUuZGVjaXNpb247XG4gICAgICAgICAgbmV3U3Vic2NyaXB0aW9uVHlwZSA9ICcqJztcbiAgICAgICAgICB0aXRsZSA9ICdTdWJzY3JpcHRpb25zIGZyb20gYWxsIGh5cGVydGllcyBhcmUnICsgc3BsaXRUaXRsZVsxXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkKCcuYXV0aG9yaXNlLWJ0bnMnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAgIG5ld0RlY2lzaW9uID0gdHJ1ZTtcbiAgICAgICAgICBuZXdTdWJzY3JpcHRpb25UeXBlID0gJ3ByZWF1dGhvcmlzZWQnO1xuICAgICAgICAgIHRpdGxlID0gJ1N1YnNjcmlwdGlvbnMgZnJvbSBwcmV2aW91c2x5IGF1dGhvcmlzZWQgaHlwZXJ0aWVzIGFyZScgKyBzcGxpdFRpdGxlWzFdO1xuICAgICAgICB9XG5cbiAgICAgICAgJCgnLnJ1bGUtdGl0bGUnKS5odG1sKCc8aDU+PGI+JyArIHRpdGxlICsgJzwvYj48L2g1PicpO1xuICAgICAgICBfdGhpcy5wb2xpY2llc01hbmFnZXIudXBkYXRlUG9saWN5KHBvbGljeVRpdGxlLCBydWxlLCBuZXdEZWNpc2lvbiwgbmV3U3Vic2NyaXB0aW9uVHlwZSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgX3RoaXMuX2dvSG9tZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvbGljaWVzR1VJO1xuIiwiY2xhc3MgUG9saWNpZXNNYW5hZ2VyIHtcblxuICBjb25zdHJ1Y3RvcihwZXBHdWlVUkwsIHBlcFVSTCwgbWVzc2FnZUJ1cykge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgX3RoaXMuX2d1aVVSTCA9IHBlcEd1aVVSTDtcbiAgICBfdGhpcy5fcGVwVVJMID0gcGVwVVJMO1xuICAgIF90aGlzLl9tZXNzYWdlQnVzID0gbWVzc2FnZUJ1cztcblxuICAgIC8vIGFzc3VtZSBwcmVwYXJlIGF0dHJpYnV0ZXMgaXMgY2FsbGVkIGFmdGVyIHRoaXNcbiAgfVxuXG4gIGNhbGxQb2xpY3lFbmdpbmVGdW5jKG1ldGhvZE5hbWUsIHBhcmFtZXRlcnMpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIGxldCBtZXNzYWdlO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIG1lc3NhZ2UgPSB7IHR5cGU6ICdleGVjdXRlJywgdG86IF90aGlzLl9wZXBVUkwsIGZyb206IF90aGlzLl9ndWlVUkwsXG4gICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6ICdwb2xpY3knLCBtZXRob2Q6IG1ldGhvZE5hbWUsIHBhcmFtczogcGFyYW1ldGVycyB9LCB9O1xuICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgKHJlcykgPT4ge1xuICAgICAgICBsZXQgcmVzdWx0ID0gcmVzLmJvZHkudmFsdWU7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcHJlcGFyZUF0dHJpYnV0ZXMoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgICBfdGhpcy5jYWxsUG9saWN5RW5naW5lRnVuYygndXNlclBvbGljaWVzJywge30pLnRoZW4oKHVzZXJQb2xpY2llcykgPT4ge1xuICAgICAgICBfdGhpcy5wb2xpY2llcyA9IHVzZXJQb2xpY2llcztcbiAgICAgICAgX3RoaXMudmFyaWFibGVzID0gX3RoaXMuc2V0VmFyaWFibGVzKCk7XG4gICAgICAgIF90aGlzLmFkZGl0aW9uID0gX3RoaXMuc2V0QWRkaXRpb25NZXRob2RzKCk7XG4gICAgICAgIF90aGlzLnZhbGlkYXRpb24gPSBfdGhpcy5zZXRWYWxpZGF0aW9uTWV0aG9kcygpO1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZFRvR3JvdXAoZ3JvdXBOYW1lLCB1c2VyKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FsbFBvbGljeUVuZ2luZUZ1bmMoJ2FkZFRvR3JvdXAnLCB7Z3JvdXBOYW1lOiBncm91cE5hbWUsIHVzZXJFbWFpbDogdXNlcn0pO1xuICB9XG5cbiAgY3JlYXRlR3JvdXAoZ3JvdXBOYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FsbFBvbGljeUVuZ2luZUZ1bmMoJ2NyZWF0ZUdyb3VwJywge2dyb3VwTmFtZTogZ3JvdXBOYW1lfSk7XG4gIH1cblxuICBhZGRQb2xpY3kodGl0bGUsIGNvbWJpbmluZ0FsZ29yaXRobSwgcG9saWN5KSB7XG4gICAgaWYgKHBvbGljeSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBzd2l0Y2ggKGNvbWJpbmluZ0FsZ29yaXRobSkge1xuICAgICAgICBjYXNlICdCbG9jayBvdmVycmlkZXMnOlxuICAgICAgICAgIGNvbWJpbmluZ0FsZ29yaXRobSA9ICdibG9ja092ZXJyaWRlcyc7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0FsbG93IG92ZXJyaWRlcyc6XG4gICAgICAgICAgY29tYmluaW5nQWxnb3JpdGhtID0gJ2FsbG93T3ZlcnJpZGVzJztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRmlyc3QgYXBwbGljYWJsZSc6XG4gICAgICAgICAgY29tYmluaW5nQWxnb3JpdGhtID0gJ2ZpcnN0QXBwbGljYWJsZSc7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgY29tYmluaW5nQWxnb3JpdGhtID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdhZGRQb2xpY3knLFxuICAgICAge3NvdXJjZTogJ1VTRVInLCBrZXk6IHRpdGxlLCBwb2xpY3k6IHBvbGljeSwgY29tYmluaW5nQWxnb3JpdGhtOiBjb21iaW5pbmdBbGdvcml0aG19KTtcbiAgfVxuXG4gIGRlY3JlYXNlUnVsZVByaW9yaXR5KHBvbGljeVRpdGxlLCB0aGlzUHJpb3JpdHksIG5ld1ByaW9yaXR5KSB7XG4gICAgdGhpcy5nZXRSdWxlT2ZQb2xpY3kocG9saWN5VGl0bGUsIG5ld1ByaW9yaXR5KS5wcmlvcml0eSA9IHRoaXNQcmlvcml0eTtcbiAgICB0aGlzLmdldFJ1bGVPZlBvbGljeShwb2xpY3lUaXRsZSwgdGhpc1ByaW9yaXR5KS5wcmlvcml0eSA9IG5ld1ByaW9yaXR5O1xuICAgIHJldHVybiB0aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdzYXZlUG9saWNpZXMnLCB7c291cmNlOiAnVVNFUid9KTtcbiAgfVxuXG4gIGRlbGV0ZUdyb3VwKGdyb3VwTmFtZSkge1xuICAgIHJldHVybiB0aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdkZWxldGVHcm91cCcsIHtncm91cE5hbWU6IGdyb3VwTmFtZX0pO1xuICB9XG5cbiAgZGVsZXRlUG9saWN5KHRpdGxlKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FsbFBvbGljeUVuZ2luZUZ1bmMoJ3JlbW92ZVBvbGljeScsIHtzb3VyY2U6ICdVU0VSJywga2V5OiB0aXRsZX0pO1xuICB9XG5cbiAgZGVsZXRlUnVsZShwb2xpY3lUaXRsZSwgcnVsZSkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgX3RoaXMuY2FsbFBvbGljeUVuZ2luZUZ1bmMoJ3VzZXJQb2xpY2llcycsIHt9KS50aGVuKCh1c2VyUG9saWNpZXMpID0+IHtcbiAgICAgICAgdXNlclBvbGljaWVzW3BvbGljeVRpdGxlXS5kZWxldGVSdWxlKHJ1bGUpO1xuICAgICAgICBfdGhpcy5jYWxsUG9saWN5RW5naW5lRnVuYygnc2F2ZVBvbGljaWVzJywge3NvdXJjZTogJ1VTRVInfSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0QWN0aXZlUG9saWN5KCkge1xuICAgIHJldHVybiB0aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdhY3RpdmVVc2VyUG9saWN5Jywge30pO1xuICB9XG5cbiAgZ2V0UG9saWN5KGtleSkge1xuICAgIHJldHVybiB0aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCd1c2VyUG9saWN5Jywge2tleToga2V5fSk7XG4gIH1cblxuICBnZXRQb2xpY2llc1RpdGxlcygpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBfdGhpcy5jYWxsUG9saWN5RW5naW5lRnVuYygndXNlclBvbGljaWVzJywge30pLnRoZW4oKHBvbGljaWVzKSA9PiB7XG4gICAgICAgIGxldCB0aXRsZXMgPSBbXTtcblxuICAgICAgICBmb3IgKGxldCBpIGluIHBvbGljaWVzKSB7XG4gICAgICAgICAgdGl0bGVzLnB1c2goaSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXNvbHZlKHRpdGxlcyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFRhcmdldHMoc2NvcGUpIHtcbiAgICBsZXQgdGFyZ2V0cyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSBpbiB0aGlzLnBvbGljaWVzW3Njb3BlXSkge1xuICAgICAgaWYgKHRhcmdldHMuaW5kZXhPZihpKSA9PT0gLTEpIHtcbiAgICAgICAgdGFyZ2V0cy5wdXNoKGkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0YXJnZXRzO1xuICB9XG5cbiAgaW5jcmVhc2VSdWxlUHJpb3JpdHkocG9saWN5VGl0bGUsIHRoaXNQcmlvcml0eSwgbmV3UHJpb3JpdHkpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIF90aGlzLmdldFJ1bGVPZlBvbGljeShwb2xpY3lUaXRsZSwgdGhpc1ByaW9yaXR5KS5wcmlvcml0eSA9IG5ld1ByaW9yaXR5O1xuICAgIF90aGlzLmdldFJ1bGVPZlBvbGljeShwb2xpY3lUaXRsZSwgbmV3UHJpb3JpdHkpLnByaW9yaXR5ID0gdGhpc1ByaW9yaXR5O1xuICAgIHJldHVybiBfdGhpcy5jYWxsUG9saWN5RW5naW5lRnVuYygnc2F2ZVBvbGljaWVzJywge3NvdXJjZTogJ1VTRVInfSk7XG4gIH1cblxuICBzZXRWYXJpYWJsZXMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICdEYXRlJzoge1xuICAgICAgICB0aXRsZTogJzxicj48aDU+VXBkYXRpbmcgZGF0ZSByZWxhdGVkIGNvbmZpZ3VyYXRpb25zPC9oNT48cD5JbmNvbWluZyBjb21tdW5pY2F0aW9ucyBpbiB0aGUgaW50cm9kdWNlZCBkYXRlIHdpbGwgYmUgYWxsb3dlZCBvciBibG9ja2VkIGFjY29yZGluZyB0byB5b3VyIGNvbmZpZ3VyYXRpb25zLCB3aGljaCBjYW4gYmUgY2hhbmdlZCBpbiB0aGUgcHJlZmVyZW5jZXMgcGFnZS48L3A+PGJyPicsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnPHA+RGF0ZTo8L3A+JyxcbiAgICAgICAgaW5wdXQ6IFtcbiAgICAgICAgICBbJ2RhdGUnLCBbXV1cbiAgICAgICAgXVxuICAgICAgfSxcbiAgICAgICdEb21haW4nOiB7XG4gICAgICAgIHRpdGxlOiAnPGJyPjxoNT5VcGRhdGluZyBkb21haW4gY29uZmlndXJhdGlvbnM8L2g1PjxwPkluY29taW5nIGNvbW11bmljYXRpb25zIGZyb20gYSB1c2VyIHdob3NlIGlkZW50aXR5IGlzIGZyb20gdGhlIGludHJvZHVjZWQgZG9tYWluIGFsbG93ZWQgb3IgYmxvY2tlZCBhY2NvcmRpbmcgdG8geW91ciBjb25maWd1cmF0aW9ucywgd2hpY2ggY2FuIGJlIGNoYW5nZWQgaW4gdGhlIHByZWZlcmVuY2VzIHBhZ2UuPC9wPjxicj4nLFxuICAgICAgICBkZXNjcmlwdGlvbjogJzxwPkRvbWFpbjo8L3A+JyxcbiAgICAgICAgaW5wdXQ6IFtcbiAgICAgICAgICBbJ2Zvcm0nLCBbXV1cbiAgICAgICAgXVxuICAgICAgfSxcbiAgICAgICdHcm91cCBvZiB1c2Vycyc6IHtcbiAgICAgICAgdGl0bGU6ICc8YnI+PGg1PlVwZGF0aW5nIGdyb3VwcyBjb25maWd1cmF0aW9uczwvaDU+PHA+SW5jb21pbmcgY29tbXVuaWNhdGlvbnMgZnJvbSBhIHVzZXIgd2hvc2UgaWRlbnRpdHkgaXMgaW4gdGhlIGludHJvZHVjZWQgZ3JvdXAgd2lsbCBiZSBhbGxvd2VkIG9yIGJsb2NrZWQgYWNjb3JkaW5nIHRvIHlvdXIgY29uZmlndXJhdGlvbnMsIHdoaWNoIGNhbiBiZSBjaGFuZ2VkIGluIHRoZSBwcmVmZXJlbmNlcyBwYWdlLjwvcD48YnI+JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICc8cD5Hcm91cCBuYW1lOjwvcD4nLFxuICAgICAgICBpbnB1dDogW1xuICAgICAgICAgIFsnc2VsZWN0JywgWydncm91cCcsICdTZWxlY3QgYSBncm91cDonXV1cbiAgICAgICAgXVxuICAgICAgfSxcbiAgICAgICdTdWJzY3JpcHRpb24gcHJlZmVyZW5jZXMnOiB7XG4gICAgICAgIHRpdGxlOiAnPGJyPjxoNT5VcGRhdGluZyBzdWJzY3JpcHRpb25zIGNvbmZpZ3VyYXRpb25zPC9oNT48cD5UaGUgYWNjZXB0YW5jZSBvZiBzdWJzY3JpcHRpb25zIHRvIHlvdXIgaHlwZXJ0aWVzIHdpbGwgYmUgYWxsb3dlZCBvciBibG9ja2VkIGFjY29yZGluZyB0byB5b3VyIGNvbmZpZ3VyYXRpb25zLCB3aGljaCBjYW4gYmUgY2hhbmdlZCBpbiB0aGUgcHJlZmVyZW5jZXMgcGFnZS48L3A+PGJyPicsXG4gICAgICAgIGlucHV0OiBbXVxuICAgICAgfSxcbiAgICAgICdUaW1lIG9mIHRoZSBkYXknOiB7XG4gICAgICAgIHRpdGxlOiAnPGJyPjxoNT5VcGRhdGluZyB0aW1lIGNvbmZpZ3VyYXRpb25zPC9oNT48cD5JbmNvbWluZyBjb21tdW5pY2F0aW9ucyBpbiB0aGUgaW50cm9kdWNlZCB0aW1lc2xvdCB3aWxsIGJlIGJsb2NrZWQsIGJ1dCB0aGlzIGNhbiBiZSBjaGFuZ2VkIGluIHRoZSBwcmVmZXJlbmNlcyBwYWdlLjwvcD48cD5QbGVhc2UgaW50cm9kdWNlIGEgbmV3IHRpbWVzbG90IGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OjwvcD48cCBjbGFzcz1cImNlbnRlci1hbGlnblwiPiZsdDtTVEFSVC1IT1VSJmd0OzombHQ7U1RBUlQtTUlOVVRFUyZndDsgdG8gJmx0O0VORC1IT1VSJmd0OzombHQ7RU5ELU1JTlVURVMmZ3Q7PC9wPjxicj4nLFxuICAgICAgICBkZXNjcmlwdGlvbjogJzxwPlRpbWVzbG90OjwvcD4nLFxuICAgICAgICBpbnB1dDogW1xuICAgICAgICAgIFsnZm9ybScsIFtdXVxuICAgICAgICBdXG4gICAgICB9LFxuICAgICAgV2Vla2RheToge1xuICAgICAgICB0aXRsZTogJzxicj48aDU+VXBkYXRpbmcgd2Vla2RheSBjb25maWd1cmF0aW9uczwvaDU+PHA+SW5jb21pbmcgY29tbXVuaWNhdGlvbnMgaW4gdGhlIGludHJvZHVjZWQgd2Vla2RheSB3aWxsIGJlIGFsbG93ZWQgb3IgYmxvY2tlZCBhY2NvcmRpbmcgdG8geW91ciBjb25maWd1cmF0aW9ucywgd2hpY2ggY2FuIGJlIGNoYW5nZWQgaW4gdGhlIHByZWZlcmVuY2VzIHBhZ2UuPC9wPjxicj4nLFxuICAgICAgICBkZXNjcmlwdGlvbjogJzxwPldlZWtkYXk6PC9wPicsXG4gICAgICAgIGlucHV0OiBbXG4gICAgICAgICAgWydzZWxlY3QnLCBbJ3dlZWtkYXknLCAnU2VsZWN0IGEgd2Vla2RheTonLCBbJ1NhdHVyZGF5JywgJ1N1bmRheScsICdNb25kYXknLCAnVHVlc2RheScsICdXZWRuZXNkYXknLCAnVGh1cnNkYXknLCAnRnJpZGF5J11dXVxuICAgICAgICBdXG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIHNldEFkZGl0aW9uTWV0aG9kcygpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiB7XG4gICAgICBEYXRlOiAocGFyYW1zKSA9PiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgbGV0IHBvbGljeVRpdGxlID0gcGFyYW1zWzBdO1xuICAgICAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCd1c2VyUG9saWNpZXMnLCB7fSkudGhlbigodXNlclBvbGljaWVzKSA9PiB7XG4gICAgICAgICAgICB1c2VyUG9saWNpZXNbcG9saWN5VGl0bGVdLmNyZWF0ZVJ1bGUocGFyYW1zWzRdLCB7IGF0dHJpYnV0ZTogJ2RhdGUnLCBvcGVyYXRvcjogJ2VxdWFscycsIHBhcmFtczogcGFyYW1zWzNdIH0sIHBhcmFtc1sxXSwgcGFyYW1zWzJdKTtcbiAgICAgICAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdzYXZlUG9saWNpZXMnLCB7c291cmNlOiAnVVNFUid9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIERvbWFpbjogKHBhcmFtcykgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgIGxldCBwb2xpY3lUaXRsZSA9IHBhcmFtc1swXTtcbiAgICAgICAgICBfdGhpcy5jYWxsUG9saWN5RW5naW5lRnVuYygndXNlclBvbGljaWVzJywge30pLnRoZW4oKHVzZXJQb2xpY2llcykgPT4ge1xuICAgICAgICAgICAgdXNlclBvbGljaWVzW3BvbGljeVRpdGxlXS5jcmVhdGVSdWxlKHBhcmFtc1s0XSwgeyBhdHRyaWJ1dGU6ICdkb21haW4nLCBvcGVyYXRvcjogJ2VxdWFscycsIHBhcmFtczogcGFyYW1zWzNdIH0sIHBhcmFtc1sxXSwgcGFyYW1zWzJdKTtcbiAgICAgICAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdzYXZlUG9saWNpZXMnLCB7c291cmNlOiAnVVNFUid9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgICdHcm91cCBvZiB1c2Vycyc6IChwYXJhbXMpID0+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICBsZXQgcG9saWN5VGl0bGUgPSBwYXJhbXNbMF07XG4gICAgICAgICAgX3RoaXMuY2FsbFBvbGljeUVuZ2luZUZ1bmMoJ3VzZXJQb2xpY2llcycsIHt9KS50aGVuKCh1c2VyUG9saWNpZXMpID0+IHtcbiAgICAgICAgICAgIHVzZXJQb2xpY2llc1twb2xpY3lUaXRsZV0uY3JlYXRlUnVsZShwYXJhbXNbNF0sIHsgYXR0cmlidXRlOiAnc291cmNlJywgb3BlcmF0b3I6ICdpbicsIHBhcmFtczogcGFyYW1zWzNdIH0sIHBhcmFtc1sxXSwgcGFyYW1zWzJdKTtcbiAgICAgICAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdzYXZlUG9saWNpZXMnLCB7c291cmNlOiAnVVNFUid9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgICdTdWJzY3JpcHRpb24gcHJlZmVyZW5jZXMnOiAocGFyYW1zKSA9PiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgbGV0IHBvbGljeVRpdGxlID0gcGFyYW1zWzBdO1xuICAgICAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCd1c2VyUG9saWNpZXMnLCB7fSkudGhlbigodXNlclBvbGljaWVzKSA9PiB7XG4gICAgICAgICAgICBsZXQgb3BlcmF0b3IgPSAnZXF1YWxzJztcbiAgICAgICAgICAgIGlmIChwYXJhbXNbM10gPT09ICdwcmVhdXRob3Jpc2VkJykge1xuICAgICAgICAgICAgICBvcGVyYXRvciA9ICdpbic7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRJQUdPOiB0aGlzIGlzIGdpdmluZyBtZSBhbiBlcnJvci4uLlxuICAgICAgICAgICAgdXNlclBvbGljaWVzW3BvbGljeVRpdGxlXS5jcmVhdGVSdWxlKHBhcmFtc1s0XSwgeyBhdHRyaWJ1dGU6ICdzdWJzY3JpcHRpb24nLCBvcGVyYXRvcjogb3BlcmF0b3IsIHBhcmFtczogcGFyYW1zWzNdIH0sIHBhcmFtc1sxXSwgcGFyYW1zWzJdKTtcbiAgICAgICAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdzYXZlUG9saWNpZXMnLCB7c291cmNlOiAnVVNFUid9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgICdUaW1lIG9mIHRoZSBkYXknOiAocGFyYW1zKSA9PiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgbGV0IHBvbGljeVRpdGxlID0gcGFyYW1zWzBdO1xuICAgICAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCd1c2VyUG9saWNpZXMnLCB7fSkudGhlbigodXNlclBvbGljaWVzKSA9PiB7XG4gICAgICAgICAgICBwYXJhbXNbM10gPSBwYXJhbXNbM10uc3BsaXQoJyB0byAnKTtcbiAgICAgICAgICAgIGxldCBzdGFydCA9IHBhcmFtc1szXVswXS5zcGxpdCgnOicpO1xuICAgICAgICAgICAgc3RhcnQgPSBzdGFydC5qb2luKCcnKTtcbiAgICAgICAgICAgIGxldCBlbmQgPSBwYXJhbXNbM11bMV0uc3BsaXQoJzonKTtcbiAgICAgICAgICAgIGVuZCA9IGVuZC5qb2luKCcnKTtcbiAgICAgICAgICAgIHVzZXJQb2xpY2llc1twb2xpY3lUaXRsZV0uY3JlYXRlUnVsZShwYXJhbXNbNF0sIHsgYXR0cmlidXRlOiAndGltZScsIG9wZXJhdG9yOiAnYmV0d2VlbicsIHBhcmFtczogW3N0YXJ0LCBlbmRdIH0sIHBhcmFtc1sxXSwgcGFyYW1zWzJdKTtcbiAgICAgICAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdzYXZlUG9saWNpZXMnLCB7c291cmNlOiAnVVNFUid9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcblxuICAgICAgV2Vla2RheTogKHBhcmFtcykgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgIGxldCB3ZWVrZGF5cyA9IFsnU3VuZGF5JywgJ01vbmRheScsICdUdWVzZGF5JywgJ1dlZG5lc2RheScsICdUaHVyc2RheScsICdGcmlkYXknLCAnU2F0dXJkYXknXTtcbiAgICAgICAgICBwYXJhbXNbM10gPSB3ZWVrZGF5cy5pbmRleE9mKHBhcmFtc1szXSk7XG4gICAgICAgICAgbGV0IHBvbGljeVRpdGxlID0gcGFyYW1zWzBdO1xuICAgICAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCd1c2VyUG9saWNpZXMnLCB7fSkudGhlbigodXNlclBvbGljaWVzKSA9PiB7XG4gICAgICAgICAgICB1c2VyUG9saWNpZXNbcG9saWN5VGl0bGVdLmNyZWF0ZVJ1bGUocGFyYW1zWzRdLCB7IGF0dHJpYnV0ZTogJ3dlZWtkYXknLCBvcGVyYXRvcjogJ2VxdWFscycsIHBhcmFtczogcGFyYW1zWzNdIH0sIHBhcmFtc1sxXSwgcGFyYW1zWzJdKTtcbiAgICAgICAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdzYXZlUG9saWNpZXMnLCB7c291cmNlOiAnVVNFUid9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBzZXRWYWxpZGF0aW9uTWV0aG9kcygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgRGF0ZTogKHNjb3BlLCBpbmZvKSA9PiB7IHJldHVybiB0aGlzLmlzVmFsaWREYXRlKGluZm8pICYgdGhpcy5pc1ZhbGlkU2NvcGUoc2NvcGUpOyB9LFxuICAgICAgJ0dyb3VwIG9mIHVzZXJzJzogKHNjb3BlLCBpbmZvKSA9PiB7IHJldHVybiB0aGlzLmlzVmFsaWRTdHJpbmcoaW5mbykgJiB0aGlzLmlzVmFsaWRTY29wZShzY29wZSk7IH0sXG4gICAgICBEb21haW46IChzY29wZSwgaW5mbykgPT4geyByZXR1cm4gdGhpcy5pc1ZhbGlkRG9tYWluKGluZm8pICYgdGhpcy5pc1ZhbGlkU2NvcGUoc2NvcGUpOyB9LFxuICAgICAgV2Vla2RheTogKHNjb3BlLCBpbmZvKSA9PiB7IHJldHVybiB0cnVlICYgdGhpcy5pc1ZhbGlkU2NvcGUoc2NvcGUpOyB9LFxuICAgICAgJ1N1YnNjcmlwdGlvbiBwcmVmZXJlbmNlcyc6IChzY29wZSwgaW5mbykgPT4geyByZXR1cm4gdGhpcy5pc1ZhbGlkU3Vic2NyaXB0aW9uVHlwZShpbmZvKSAmIHRoaXMuaXNWYWxpZFNjb3BlKHNjb3BlKTsgfSxcbiAgICAgICdUaW1lIG9mIHRoZSBkYXknOiAoc2NvcGUsIGluZm8pID0+IHsgcmV0dXJuIHRoaXMuaXNWYWxpZFRpbWVzbG90KGluZm8pICYgdGhpcy5pc1ZhbGlkU2NvcGUoc2NvcGUpOyB9XG4gICAgfTtcbiAgfVxuXG4gIHVwZGF0ZUFjdGl2ZVBvbGljeSh0aXRsZSkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdhY3RpdmVVc2VyUG9saWN5Jywge3VzZXJQb2xpY3k6IHRpdGxlfSkudGhlbigoKSA9PiB7XG4gICAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdzYXZlQWN0aXZlUG9saWN5Jywge30pLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGlzVmFsaWRFbWFpbChpbmZvKSB7XG4gICAgbGV0IHBhdHRlcm4gPSAvW2EtejAtOS5fJSstXStAW2EtejAtOS4tXStcXC5bYS16XXsyLDN9JC87XG4gICAgcmV0dXJuIHBhdHRlcm4udGVzdChpbmZvKTtcbiAgfVxuXG4gIGlzVmFsaWREb21haW4oaW5mbykge1xuICAgIGxldCBwYXR0ZXJuID0gL1thLXowLTkuLV0rXFwuW2Etel17MiwzfSQvO1xuICAgIHJldHVybiBwYXR0ZXJuLnRlc3QoaW5mbyk7XG4gIH1cblxuICBpc1ZhbGlkU3RyaW5nKGluZm8pIHtcbiAgICBsZXQgcGF0dGVybiA9IC9bYS16MC05Li1dJC87XG4gICAgcmV0dXJuIHBhdHRlcm4udGVzdChpbmZvKTtcbiAgfVxuXG4gIGlzVmFsaWRTdWJzY3JpcHRpb25UeXBlKGluZm8pIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGlzVmFsaWREYXRlKGluZm8pIHtcbiAgICBsZXQgaW5mb1NwbGl0ID0gaW5mby5zcGxpdCgnLycpO1xuICAgIGxldCBkYXkgPSBwYXJzZUludChpbmZvU3BsaXRbMF0pO1xuICAgIGxldCBtb250aCA9IHBhcnNlSW50KGluZm9TcGxpdFsxXSk7XG4gICAgbGV0IHllYXIgPSBwYXJzZUludChpbmZvU3BsaXRbMl0pO1xuXG4gICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aC0xLCBkYXkpO1xuICAgIGxldCBpc1ZhbGlkRm9ybWF0ID0gZGF0ZS5nZXRGdWxsWWVhcigpID09PSB5ZWFyICYmIGRhdGUuZ2V0TW9udGgoKSArIDEgPT09IG1vbnRoICYmIGRhdGUuZ2V0RGF0ZSgpID09PSBkYXk7XG4gICAgbGV0IGZvcm1hdHRlZERhdGUgPSBkYXRlLmdldERhdGUoKSArICcvJyArIChkYXRlLmdldE1vbnRoKCkgKyAxKSArICcvJyArIGRhdGUuZ2V0RnVsbFllYXIoKVxuICAgIGxldCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGxldCB0b2RheSA9IG5vdy5nZXREYXRlKCkgKyAnLycgKyAobm93LmdldE1vbnRoKCkgKyAxKSArICcvJyArIG5vdy5nZXRGdWxsWWVhcigpO1xuXG4gICAgbGV0IGlzRnV0dXJlID0gZmFsc2U7XG4gICAgaWYgKGRhdGUuZ2V0RnVsbFllYXIoKSA+IG5vdy5nZXRGdWxsWWVhcigpKSB7XG4gICAgICBpc0Z1dHVyZSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChkYXRlLmdldEZ1bGxZZWFyKCkgPT0gbm93LmdldEZ1bGxZZWFyKCkpIHtcbiAgICAgICAgaWYgKChkYXRlLmdldE1vbnRoKCkgKyAxKSA+IChub3cuZ2V0TW9udGgoKSArIDEpKSB7XG4gICAgICAgICAgaXNGdXR1cmUgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICgoZGF0ZS5nZXRNb250aCgpICsgMSkgPT0gKG5vdy5nZXRNb250aCgpICsgMSkpIHtcbiAgICAgICAgICAgIGlmIChkYXRlLmdldERhdGUoKSA+PSAobm93LmdldERhdGUoKSkpIHtcbiAgICAgICAgICAgICAgaXNGdXR1cmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAoaXNWYWxpZEZvcm1hdCAmJiBpc0Z1dHVyZSk7XG4gIH1cblxuICBpc1ZhbGlkU2NvcGUoc2NvcGUpIHtcbiAgICByZXR1cm4gc2NvcGUgIT09ICcnO1xuICB9XG5cbiAgaXNWYWxpZFRpbWVzbG90KGluZm8pIHtcbiAgICBpZiAoIWluZm8pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGV0IHNwbGl0SW5mbyA9IGluZm8uc3BsaXQoJyB0byAnKTsgLy8gWzEyOjAwLCAxMzowMF1cbiAgICBsZXQgdHdvVGltZXMgPSBzcGxpdEluZm8ubGVuZ3RoID09PSAyO1xuICAgIGlmICghdHdvVGltZXMpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGV0IHNwbGl0U3RhcnQgPSBzcGxpdEluZm9bMF0uc3BsaXQoJzonKTsgLy8gWzEyLCAwMF1cbiAgICBsZXQgc3BsaXRFbmQgPSBzcGxpdEluZm9bMV0uc3BsaXQoJzonKTsgLy8gWzEzLCAwMF1cbiAgICBpZiAoc3BsaXRTdGFydC5sZW5ndGggIT09IDIgfHwgc3BsaXRFbmQubGVuZ3RoICE9PSAyKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGxldCBva1NpemUgPSAoc3BsaXRTdGFydFswXS5sZW5ndGggPT09IDIpICYmIChzcGxpdFN0YXJ0WzFdLmxlbmd0aCA9PT0gMikgJiYgKHNwbGl0RW5kWzBdLmxlbmd0aCA9PT0gMikgJiYgKHNwbGl0RW5kWzFdLmxlbmd0aCA9PT0gMik7XG4gICAgbGV0IGFyZUludGVnZXJzID0gKHNwbGl0U3RhcnRbMF0gPT0gcGFyc2VJbnQoc3BsaXRTdGFydFswXSwgMTApKSAmJiAoc3BsaXRTdGFydFsxXSA9PSBwYXJzZUludChzcGxpdFN0YXJ0WzFdLCAxMCkpICYmIChzcGxpdEVuZFswXSA9PSBwYXJzZUludChzcGxpdEVuZFswXSwgMTApKSAmJiAoc3BsaXRFbmRbMV0gPT0gcGFyc2VJbnQoc3BsaXRFbmRbMV0sIDEwKSk7XG4gICAgcmV0dXJuIHR3b1RpbWVzICYmIG9rU2l6ZSAmJiBhcmVJbnRlZ2VycztcbiAgfVxuXG4gIGdldEZvcm1hdHRlZFBvbGljaWVzKCkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCd1c2VyUG9saWNpZXMnLCB7fSkudGhlbigocG9saWNpZXNQRSkgPT4ge1xuICAgICAgICBsZXQgcG9saWNpZXNHVUkgPSBbXTtcblxuICAgICAgICBmb3IgKGxldCBpIGluIHBvbGljaWVzUEUpIHtcbiAgICAgICAgICBsZXQgcG9saWN5ID0ge1xuICAgICAgICAgICAgdGl0bGU6IHBvbGljaWVzUEVbaV0ua2V5LFxuICAgICAgICAgICAgcnVsZXNUaXRsZXM6IFtdLFxuICAgICAgICAgICAgaWRzOiBbXVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChwb2xpY2llc1BFW2ldLnJ1bGVzLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgcG9saWNpZXNQRVtpXS5ydWxlcyA9IHBvbGljaWVzUEVbaV0uc29ydFJ1bGVzKCk7XG4gICAgICAgICAgICBmb3IgKGxldCBqIGluIHBvbGljaWVzUEVbaV0ucnVsZXMpIHtcbiAgICAgICAgICAgICAgbGV0IHRpdGxlID0gX3RoaXMuX2dldFRpdGxlKHBvbGljaWVzUEVbaV0ucnVsZXNbal0pO1xuICAgICAgICAgICAgICBwb2xpY3kucnVsZXNUaXRsZXMucHVzaCh0aXRsZSk7XG4gICAgICAgICAgICAgIHBvbGljeS5pZHMucHVzaChwb2xpY3kudGl0bGUgKyAnOicgKyBwb2xpY2llc1BFW2ldLnJ1bGVzW2pdLnByaW9yaXR5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBwb2xpY2llc0dVSS5wdXNoKHBvbGljeSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXNvbHZlKHBvbGljaWVzR1VJKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0UnVsZU9mUG9saWN5KHRpdGxlLCBwcmlvcml0eSkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCd1c2VyUG9saWNpZXMnLCB7fSkudGhlbigocG9saWNpZXMpID0+IHtcbiAgICAgICAgbGV0IHBvbGljeSA9IHBvbGljaWVzW3RpdGxlXTtcbiAgICAgICAgcmVzb2x2ZShwb2xpY3kuZ2V0UnVsZUJ5UHJpb3JpdHkocHJpb3JpdHkpKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgX2dldFRpdGxlKHJ1bGUpIHtcbiAgICBsZXQgY29uZGl0aW9uID0gcnVsZS5jb25kaXRpb247XG4gICAgbGV0IGF1dGhvcmlzZSA9IChydWxlLmRlY2lzaW9uKSA/ICdhbGxvd2VkJyA6ICdibG9ja2VkJztcbiAgICBsZXQgdGFyZ2V0ID0gcnVsZS50YXJnZXQgPT09ICdnbG9iYWwnID8gJ0FsbCBpZGVudGl0aWVzIGFuZCBoeXBlcnRpZXMnIDogcnVsZS50YXJnZXQ7XG4gICAgbGV0IGF0dHJpYnV0ZSA9IGNvbmRpdGlvbi5hdHRyaWJ1dGU7XG4gICAgc3dpdGNoKGF0dHJpYnV0ZSkge1xuICAgICAgY2FzZSAnZGF0ZSc6XG4gICAgICAgIHJldHVybiAnRGF0ZSAnICsgY29uZGl0aW9uLnBhcmFtcyArICcgaXMgJyArIGF1dGhvcmlzZSArICcgKCcgKyB0YXJnZXQgKyAnKSc7XG4gICAgICBjYXNlICdkb21haW4nOlxuICAgICAgICByZXR1cm4gJ0RvbWFpbiBcXFwiJyArIGNvbmRpdGlvbi5wYXJhbXMgKyAnXFxcIiBpcyAnICsgYXV0aG9yaXNlICsgJyAoJyArIHRhcmdldCArICcpJztcbiAgICAgIGNhc2UgJ3NvdXJjZSc6XG4gICAgICAgIGlmIChjb25kaXRpb24ub3BlcmF0b3IgPT09ICdpbicpIHtcbiAgICAgICAgICByZXR1cm4gJ0dyb3VwIFxcXCInICsgY29uZGl0aW9uLnBhcmFtcyArICdcXFwiIGlzICcgKyBhdXRob3Jpc2UgKyAnICgnICsgdGFyZ2V0ICsgJyknO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChjb25kaXRpb24ub3BlcmF0b3IgPT09ICdlcXVhbHMnKSB7XG4gICAgICAgICAgICByZXR1cm4gJ1VzZXIgJyArIGNvbmRpdGlvbi5wYXJhbXMgKyAnIGlzICcgKyBhdXRob3Jpc2UgKyAnICgnICsgdGFyZ2V0ICsgJyknO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgY2FzZSAnc3Vic2NyaXB0aW9uJzpcbiAgICAgICAgaWYgKGNvbmRpdGlvbi5wYXJhbXMgPT09ICcqJykge1xuICAgICAgICAgIHJldHVybiAnU3Vic2NyaXB0aW9ucyBmcm9tIGFsbCBoeXBlcnRpZXMgYXJlICcgKyBhdXRob3Jpc2UgKyAnICgnICsgdGFyZ2V0ICsgJyknO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChjb25kaXRpb24ucGFyYW1zID09PSAncHJlYXV0aG9yaXNlZCcpIHtcbiAgICAgICAgICAgIHJldHVybiAnU3Vic2NyaXB0aW9ucyBmcm9tIHByZXZpb3VzbHkgYXV0aG9yaXNlZCBoeXBlcnRpZXMgYXJlIGFsbG93ZWQgKCcgKyB0YXJnZXQgKyAnKSc7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBjYXNlICd0aW1lJzpcbiAgICAgICAgbGV0IHN0YXJ0ID0gY29uZGl0aW9uLnBhcmFtc1swXVswXSArIGNvbmRpdGlvbi5wYXJhbXNbMF1bMV0gKyAnOicgKyBjb25kaXRpb24ucGFyYW1zWzBdWzJdICsgY29uZGl0aW9uLnBhcmFtc1swXVszXTtcbiAgICAgICAgbGV0IGVuZCA9IGNvbmRpdGlvbi5wYXJhbXNbMV1bMF0gKyBjb25kaXRpb24ucGFyYW1zWzFdWzFdICsgJzonICsgY29uZGl0aW9uLnBhcmFtc1sxXVsyXSArIGNvbmRpdGlvbi5wYXJhbXNbMV1bM107XG4gICAgICAgIHJldHVybiAnVGltZXNsb3QgZnJvbSAnICsgc3RhcnQgKyAnIHRvICcgKyBlbmQgKyAnIGlzICcgKyBhdXRob3Jpc2UgKyAnICgnICsgdGFyZ2V0ICsgJyknO1xuICAgICAgY2FzZSAnd2Vla2RheSc6XG4gICAgICAgIGxldCB3ZWVrZGF5cyA9IFsnU3VuZGF5JywgJ01vbmRheScsICdUdWVzZGF5JywgJ1dlZG5lc2RheScsICdUaHVyc2RheScsICdGcmlkYXknLCAnU2F0dXJkYXknXTtcbiAgICAgICAgbGV0IHdlZWtkYXlJRCA9IGNvbmRpdGlvbi5wYXJhbXM7XG4gICAgICAgIHJldHVybiAnV2Vla2RheSBcXFwiJyArIHdlZWtkYXlzW3dlZWtkYXlJRF0gKyAnXFxcIiBpcyAnICsgYXV0aG9yaXNlICsgJyAoJyArIHRhcmdldCArICcpJztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAnUnVsZSAnICsgcnVsZS5wcmlvcml0eSArICcgaXMgJyArIGF1dGhvcmlzZSArICcgKCcgKyB0YXJnZXQgKyAnKSc7XG4gICAgfVxuICB9XG5cbiAgZ2V0VmFyaWFibGVzKCkge1xuICAgIGxldCB2YXJpYWJsZXNUaXRsZXMgPSBbXTtcbiAgICBmb3IgKGxldCBpIGluIHRoaXMudmFyaWFibGVzKSB7XG4gICAgICB2YXJpYWJsZXNUaXRsZXMucHVzaChpKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhcmlhYmxlc1RpdGxlcztcbiAgfVxuXG4gIGdldFZhcmlhYmxlSW5mbyh2YXJpYWJsZSkge1xuICAgIHJldHVybiB0aGlzLnZhcmlhYmxlc1t2YXJpYWJsZV07XG4gIH1cblxuICBnZXRNeUVtYWlscygpIHtcbiAgICByZXR1cm4gdGhpcy5jYWxsUG9saWN5RW5naW5lRnVuYygnZ2V0TXlFbWFpbHMnLCB7fSk7XG4gIH1cblxuICBnZXRNeUh5cGVydGllcygpIHtcbiAgICByZXR1cm4gdGhpcy5jYWxsUG9saWN5RW5naW5lRnVuYygnZ2V0TXlIeXBlcnRpZXMnLCB7fSk7XG4gIH1cblxuICAvL1RPRE8gSWYgdGhlcmUgaXMgYSBwcm9ibGVtIHdpdGggdGhlIGlucHV0LCBzaG93IGl0IHRvIHRoZSB1c2VyXG4gIHNldEluZm8odmFyaWFibGUsIHBvbGljeVRpdGxlLCBpbmZvLCBhdXRob3Jpc2UsIHNjb3BlLCB0YXJnZXQpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAoX3RoaXMudmFsaWRhdGlvblt2YXJpYWJsZV0oc2NvcGUsIGluZm8pKSB7XG4gICAgICAgIF90aGlzLmFkZGl0aW9uW3ZhcmlhYmxlXShbcG9saWN5VGl0bGUsIHNjb3BlLCB0YXJnZXQsIGluZm8sIGF1dGhvcmlzZV0pLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZWplY3QoJ0ludmFsaWQgY29uZmlndXJhdGlvbicpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlSW5mbyh2YXJpYWJsZSwgc2NvcGUsIHRhcmdldCwgaW5mbykge1xuICAgIGxldCBwYXJhbXMgPSBbc2NvcGUsIHRhcmdldCwgaW5mb107XG4gICAgaWYgKHZhcmlhYmxlID09PSAnbWVtYmVyJykge1xuICAgICAgbGV0IGNvbmRpdGlvblNwbGl0ID0gaW5mby5zcGxpdCgnICcpO1xuICAgICAgbGV0IGdyb3VwTmFtZSA9IGNvbmRpdGlvblNwbGl0WzJdO1xuICAgICAgcGFyYW1zID0gW3Njb3BlLCBncm91cE5hbWUsIGluZm9dO1xuICAgIH1cbiAgICB0aGlzLmRlbGV0aW9uW3ZhcmlhYmxlXShwYXJhbXMpO1xuICB9XG5cbiAgZ2V0R3JvdXBzKCkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdncm91cHMnLCB7fSkudGhlbigoZ3JvdXBzKSA9PiB7XG4gICAgICAgIGxldCBncm91cHNHVUkgPSB7XG4gICAgICAgICAgZ3JvdXBzTmFtZXM6IFtdLFxuICAgICAgICAgIG1lbWJlcnM6IFtdLFxuICAgICAgICAgIGlkczogW11cbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKGxldCBpIGluIGdyb3Vwcykge1xuICAgICAgICAgIGdyb3Vwc0dVSS5ncm91cHNOYW1lcy5wdXNoKGkpO1xuICAgICAgICAgIGdyb3Vwc0dVSS5tZW1iZXJzLnB1c2goZ3JvdXBzW2ldKTtcbiAgICAgICAgICBsZXQgaWRzID0gW107XG4gICAgICAgICAgZm9yIChsZXQgaiBpbiBncm91cHNbaV0pIHtcbiAgICAgICAgICAgIGlkcy5wdXNoKGkgKyAnOjonICsgZ3JvdXBzW2ldW2pdKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZ3JvdXBzR1VJLmlkcy5wdXNoKGlkcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2NvbnNvbGUubG9nKCdUSUFHTyBncm91cHMnLCBncm91cHNHVUkpXG4gICAgICAgIHJlc29sdmUoZ3JvdXBzR1VJKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0R3JvdXBzTmFtZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FsbFBvbGljeUVuZ2luZUZ1bmMoJ2dldEdyb3Vwc05hbWVzJywge30pO1xuICB9XG5cbiAgcmVtb3ZlRnJvbUdyb3VwKGdyb3VwTmFtZSwgdXNlcikge1xuICAgIHJldHVybiB0aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCdyZW1vdmVGcm9tR3JvdXAnLCB7Z3JvdXBOYW1lOiBncm91cE5hbWUsIHVzZXJFbWFpbDogdXNlcn0pO1xuICB9XG5cbiAgdXBkYXRlUG9saWN5KHBvbGljeVRpdGxlLCBydWxlLCBuZXdEZWNpc2lvbiwgbmV3U3Vic2NyaXB0aW9uVHlwZSkge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIF90aGlzLmNhbGxQb2xpY3lFbmdpbmVGdW5jKCd1c2VyUG9saWNpZXMnLCB7fSkudGhlbigodXNlclBvbGljaWVzKSA9PiB7XG4gICAgICAgIHVzZXJQb2xpY2llc1twb2xpY3lUaXRsZV0uZGVsZXRlUnVsZShydWxlKTtcbiAgICAgICAgaWYgKCFuZXdTdWJzY3JpcHRpb25UeXBlKSB7XG4gICAgICAgICAgdXNlclBvbGljaWVzW3BvbGljeVRpdGxlXS5jcmVhdGVSdWxlKG5ld0RlY2lzaW9uLCBydWxlLmNvbmRpdGlvbiwgcnVsZS5zY29wZSwgcnVsZS50YXJnZXQsIHJ1bGUucHJpb3JpdHkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxldCBvcGVyYXRvciA9IChuZXdTdWJzY3JpcHRpb25UeXBlID09PSAnKicpID8gJ2VxdWFscycgOiAnaW4nO1xuICAgICAgICAgIHVzZXJQb2xpY2llc1twb2xpY3lUaXRsZV0uY3JlYXRlUnVsZShuZXdEZWNpc2lvbiwgW3sgYXR0cmlidXRlOiAnc3Vic2NyaXB0aW9uJywgb3BlYXRvcjogb3BlcmF0b3IsIHBhcmFtczogbmV3U3Vic2NyaXB0aW9uVHlwZSB9XSwgcnVsZS5zY29wZSwgcnVsZS50YXJnZXQsIHJ1bGUucHJpb3JpdHkpO1xuICAgICAgICB9XG5cbiAgICAgICAgX3RoaXMuY2FsbFBvbGljeUVuZ2luZUZ1bmMoJ3NhdmVBY3RpdmVQb2xpY3knLCB7fSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9saWNpZXNNYW5hZ2VyO1xuIiwiLyoqXG4qIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQVxuKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRFxuKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0xcbiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlZcbiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBXG4qIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUdcbiogQ29weXJpZ2h0IDIwMTYgQXBpemVlXG4qIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOXG4qXG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4qIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4qXG4qICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4qXG4qIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbioqL1xuaW1wb3J0IFVSSSBmcm9tICd1cmlqcyc7XG5pbXBvcnQgSWRlbnRpdGllc0dVSSBmcm9tICcuL2FkbWluL0lkZW50aXRpZXNHVUknO1xuaW1wb3J0IFBvbGljaWVzR1VJIGZyb20gJy4vYWRtaW4vUG9saWNpZXNHVUknO1xuaW1wb3J0IFJ1bnRpbWVGYWN0b3J5IGZyb20gJy4vUnVudGltZUZhY3RvcnknO1xuXG50cnkge1xuICB3aW5kb3cuY29yZG92YSA9IHBhcmVudC5jb3Jkb3ZhICE9PSB1bmRlZmluZWQ7XG4gIGlmICh3aW5kb3cuY29yZG92YSkgeyB3aW5kb3cub3BlbiA9IGZ1bmN0aW9uKHVybCkgeyByZXR1cm4gcGFyZW50LmNvcmRvdmEuSW5BcHBCcm93c2VyLm9wZW4odXJsLCAnX2JsYW5rJywgJ2xvY2F0aW9uPW5vLHRvb2xiYXI9bm8nKTsgfTsgfVxufSBjYXRjaCAoZXJyKSB7IGNvbnNvbGUubG9nKCdjb3Jkb3ZhIG5vdCBzdXBwb3J0ZWQnKTsgfVxuXG5mdW5jdGlvbiByZXR1cm5IeXBlcnR5KHNvdXJjZSwgaHlwZXJ0eSkge1xuICBzb3VyY2UucG9zdE1lc3NhZ2Uoe3RvOiAncnVudGltZTpsb2FkZWRIeXBlcnR5JywgYm9keTogaHlwZXJ0eX0sICcqJyk7XG59XG5cbmZ1bmN0aW9uIHNlYXJjaEh5cGVydHkocnVudGltZSwgZGVzY3JpcHRvcikge1xuICBsZXQgaHlwZXJ0eSA9IHVuZGVmaW5lZDtcbiAgbGV0IGluZGV4ID0gMDtcbiAgd2hpbGUgKCFoeXBlcnR5ICYmIGluZGV4IDwgcnVudGltZS5yZWdpc3RyeS5oeXBlcnRpZXNMaXN0Lmxlbmd0aCkge1xuICAgIGlmIChydW50aW1lLnJlZ2lzdHJ5Lmh5cGVydGllc0xpc3RbaW5kZXhdLmRlc2NyaXB0b3IgPT09IGRlc2NyaXB0b3IpIHsgaHlwZXJ0eSA9IHJ1bnRpbWUucmVnaXN0cnkuaHlwZXJ0aWVzTGlzdFtpbmRleF07IH1cblxuICAgIGluZGV4Kys7XG4gIH1cblxuICByZXR1cm4gaHlwZXJ0eTtcbn1cblxubGV0IHBhcmFtZXRlcnMgPSBuZXcgVVJJKHdpbmRvdy5sb2NhdGlvbikuc2VhcmNoKHRydWUpO1xubGV0IHJ1bnRpbWVVUkwgPSBwYXJhbWV0ZXJzLnJ1bnRpbWU7XG5sZXQgZG9tYWluID0gcGFyYW1ldGVycy5kb21haW47XG5sZXQgZGV2ZWxvcG1lbnQgPSBwYXJhbWV0ZXJzLmRldmVsb3BtZW50ID09PSAndHJ1ZSc7XG5sZXQgY2F0YWxvZ3VlID0gUnVudGltZUZhY3RvcnkuY3JlYXRlUnVudGltZUNhdGFsb2d1ZShkZXZlbG9wbWVudCk7XG5sZXQgcnVudGltZURlc2NyaXB0b3I7XG5jYXRhbG9ndWUuZ2V0UnVudGltZURlc2NyaXB0b3IocnVudGltZVVSTClcbiAgLnRoZW4oZnVuY3Rpb24oZGVzY3JpcHRvcikge1xuICAgIHJ1bnRpbWVEZXNjcmlwdG9yID0gZGVzY3JpcHRvcjtcbiAgICBsZXQgc291cmNlUGFja2FnZVVSTCA9IGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZVVSTDtcbiAgICBpZiAoc291cmNlUGFja2FnZVVSTCA9PT0gJy9zb3VyY2VQYWNrYWdlJykge1xuICAgICAgcmV0dXJuIGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZTtcbiAgICB9XG4gICAgcmV0dXJuIGNhdGFsb2d1ZS5nZXRTb3VyY2VQYWNrYWdlRnJvbVVSTChzb3VyY2VQYWNrYWdlVVJMKTtcbiAgfSlcbiAgLnRoZW4oZnVuY3Rpb24oc291cmNlUGFja2FnZSkge1xuICAgIGV2YWwuYXBwbHkod2luZG93LCBbc291cmNlUGFja2FnZS5zb3VyY2VDb2RlXSk7XG5cbiAgICAvL2xldCBydW50aW1lID0gbmV3IFJ1bnRpbWUoUnVudGltZUZhY3RvcnksIHdpbmRvdy5sb2NhdGlvbi5ob3N0KTtcbiAgICBpZiAoIWRvbWFpbikgZG9tYWluID0gd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gICAgbGV0IHJ1bnRpbWUgPSBuZXcgUnVudGltZShydW50aW1lRGVzY3JpcHRvciwgUnVudGltZUZhY3RvcnksIGRvbWFpbik7XG4gICAgd2luZG93LnJ1bnRpbWUgPSBydW50aW1lO1xuICAgIHJ1bnRpbWUuaW5pdCgpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgIC8vIFRJQUdPXG4gICAgICBpZiAoIXJ1bnRpbWUucG9saWN5RW5naW5lKSB0aHJvdyBFcnJvcignUG9saWN5IEVuZ2luZSBpcyBub3Qgc2V0IScpO1xuICAgICAgbGV0IHBlcEd1aVVSTCA9IHJ1bnRpbWUucG9saWN5RW5naW5lLmNvbnRleHQuZ3VpVVJMO1xuICAgICAgbGV0IHBlcFVSTCA9IHJ1bnRpbWUucG9saWN5RW5naW5lLmNvbnRleHQucGVwVVJMO1xuICAgICAgbGV0IHBlcEdVSSA9IG5ldyBQb2xpY2llc0dVSShwZXBHdWlVUkwsIHBlcFVSTCwgcnVudGltZS5wb2xpY3lFbmdpbmUubWVzc2FnZUJ1cywgcnVudGltZS5wb2xpY3lFbmdpbmUpO1xuXG4gICAgICBwZXBHVUkucHJlcGFyZUF0dHJpYnV0ZXMoKS50aGVuKCgpID0+IHtcbiAgICAgICAgbGV0IGlkbUd1aVVSTCA9IHJ1bnRpbWUuaWRlbnRpdHlNb2R1bGUuX3J1bnRpbWVVUkwgKyAnL2lkZW50aXR5LWd1aSc7XG4gICAgICAgIGxldCBpZG1VUkwgPSBydW50aW1lLmlkZW50aXR5TW9kdWxlLl9ydW50aW1lVVJMICsgJy9pZG0nO1xuICAgICAgICBsZXQgaWRlbnRpdGllc0dVSSA9IG5ldyBJZGVudGl0aWVzR1VJKGlkbUd1aVVSTCwgaWRtVVJMLCBydW50aW1lLmlkZW50aXR5TW9kdWxlLm1lc3NhZ2VCdXMpO1xuXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICBpZiAoZXZlbnQuZGF0YS50byA9PT0gJ2NvcmU6bG9hZEh5cGVydHknKSB7XG4gICAgICAgICAgICBsZXQgZGVzY3JpcHRvciA9IGV2ZW50LmRhdGEuYm9keS5kZXNjcmlwdG9yO1xuICAgICAgICAgICAgbGV0IHJldXNlQWRkcmVzcyA9IGV2ZW50LmRhdGEuYm9keS5yZXVzZUFkZHJlc3M7XG4gICAgICAgICAgICBsZXQgcmVxdWlyZUh5cGVydHlJRCA9IGV2ZW50LmRhdGEuYm9keS5pZDtcblxuICAgICAgICAgICAgbGV0IGh5cGVydHkgPSBzZWFyY2hIeXBlcnR5KHJ1bnRpbWUsIGRlc2NyaXB0b3IpO1xuXG4gICAgICAgICAgICBpZiAoaHlwZXJ0eSkge1xuICAgICAgICAgICAgICByZXR1cm5IeXBlcnR5KGV2ZW50LnNvdXJjZSwgeyBydW50aW1lSHlwZXJ0eVVSTDogaHlwZXJ0eS5oeXBlcnR5VVJMLCBpZDogcmVxdWlyZUh5cGVydHlJRH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcnVudGltZS5sb2FkSHlwZXJ0eShkZXNjcmlwdG9yLCByZXVzZUFkZHJlc3MpLnRoZW4oZnVuY3Rpb24oaHlwZXJ0eSkge1xuICAgICAgICAgICAgICAgIGh5cGVydHkuaWQgPSByZXF1aXJlSHlwZXJ0eUlEO1xuICAgICAgICAgICAgICAgIHJldHVybkh5cGVydHkoZXZlbnQuc291cmNlLCBoeXBlcnR5KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChldmVudC5kYXRhLnRvID09PSAnY29yZTpsb2FkU3R1YicpIHtcbiAgICAgICAgICAgIHJ1bnRpbWUubG9hZFN0dWIoZXZlbnQuZGF0YS5ib2R5LmRvbWFpbikudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTdHViIExvYWRlZDogJywgcmVzdWx0KTtcbiAgICAgICAgICAgIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdTdHViIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuZGF0YS50byA9PT0gJ2NvcmU6Y2xvc2UnKSB7XG4gICAgICAgICAgICBydW50aW1lLmNsb3NlKGV2ZW50LmRhdGEuYm9keS5sb2dPdXQpLnRoZW4oKHJlc3VsdCk9PntcbiAgICAgICAgICAgICAgICBldmVudC5zb3VyY2UucG9zdE1lc3NhZ2Uoe3RvOiAncnVudGltZTpydW50aW1lQ2xvc2VkJywgYm9keTogcmVzdWx0fSwgJyonKVxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAuY2F0Y2goKHJlc3VsdCk9PntcbiAgICAgICAgICAgICAgICBldmVudC5zb3VyY2UucG9zdE1lc3NhZ2Uoe3RvOiAncnVudGltZTpydW50aW1lQ2xvc2VkJywgYm9keTogcmVzdWx0fSwgJyonKVxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gIHNlbmQgbG9nb3V0XG4gICAgICAgICAgICBpZGVudGl0aWVzR1VJLmxvZ091dCgpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmRhdGEudG8gPT09ICdjb3JlOnJlc2V0Jykge1xuICAgICAgICAgICAgcnVudGltZS5yZXNldCgpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgZXZlbnQuc291cmNlLnBvc3RNZXNzYWdlKHt0bzogJ3J1bnRpbWU6cnVudGltZVJlc2V0JywgYm9keTogcmVzdWx0fSwgJyonKVxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gIHNlbmQgbG9nb3V0XG4gICAgICAgICAgICBpZGVudGl0aWVzR1VJLmxvZ091dCgpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmRhdGEudG8gPT09ICdjb3JlOmxvZ2luJykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NvcmU6IGxvZ2dpbmcgd2l0aCAnLCBldmVudC5kYXRhLmJvZHkuaWRwKTtcbiAgICAgICAgICAgIGlkZW50aXRpZXNHVUkubG9naW5XaXRoSURQKGV2ZW50LmRhdGEuYm9keS5pZHApLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICBldmVudC5zb3VyY2UucG9zdE1lc3NhZ2Uoe3RvOiAncnVudGltZTpsb2dnZWRJbicsIGJvZHk6IHJlc3VsdH0sICcqJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmRhdGEudG8gPT09ICdjb3JlOmF1dGhvcmlzZScpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb3JlOmF1dGhvcmlzZSAnLCBldmVudC5kYXRhLmJvZHkuaWRwLCBldmVudC5kYXRhLmJvZHkuc2NvcGUpO1xuICAgICAgICAgICAgaWRlbnRpdGllc0dVSS5hdXRob3Jpc2UoZXZlbnQuZGF0YS5ib2R5LmlkcCwgZXZlbnQuZGF0YS5ib2R5LnNjb3BlKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgZXZlbnQuc291cmNlLnBvc3RNZXNzYWdlKHsgdG86ICdydW50aW1lOmF1dGhvcmlzZWQnLCBib2R5OiBKU09OLnN0cmluZ2lmeShyZXN1bHQpIH0sICcqJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cblxuICAgICAgICB9LCBmYWxzZSk7XG5cbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIChlKSA9PiB7XG4gICAgICAgICAgcnVudGltZS5jbG9zZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBwYXJlbnQucG9zdE1lc3NhZ2Uoe3RvOiAncnVudGltZTppbnN0YWxsZWQnLCBib2R5OiB7fX0sICcqJyk7XG5cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbiJdfQ=="}