{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/admin/IdentitiesGUI.js"],"names":[],"mappings":"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","file":"identities-gui.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","// jshint browser:true, jquery: true\n\nclass IdentitiesGUI {\n\n  constructor(guiURL, idmURL, messageBus) {\n    //if (!identityModule) throw Error('Identity Module not set!');\n    if (!messageBus) throw Error('Message Bus not set!');\n    let _this = this;\n    _this._guiURL = guiURL;\n    _this._idmURL = idmURL;\n    _this._messageBus = messageBus;\n\n    this.callIdentityModuleFunc('deployGUI', {}).then((result) => {\n      return this._buildDrawer();\n    }).then((result) => {\n      console.log('READY:', result)\n    });\n\n    const drawerEl = document.querySelector('.mdc-temporary-drawer');\n    const MDCTemporaryDrawer = mdc.drawer.MDCTemporaryDrawer;\n    const drawer = new MDCTemporaryDrawer(drawerEl);\n\n    this._drawerEl = drawerEl;\n    this._drawer = drawer;\n\n    document.querySelector('.settings-btn').addEventListener('click', function() {\n      drawer.open = true;\n    });\n\n    drawerEl.addEventListener('MDCTemporaryDrawer:open', () => {\n      console.log('Received MDCTemporaryDrawer:open');\n      this._isDrawerOpen = true;\n    });\n\n    drawerEl.addEventListener('MDCTemporaryDrawer:close', () => {\n      console.log('Received MDCTemporaryDrawer:close');\n      this._isDrawerOpen = false;\n\n      parent.postMessage({ body: { method: 'hideAdminPage' }, to: 'runtime:gui-manager' }, '*');\n    });\n\n  }\n\n  _buildDrawer() {\n\n    const guiURL = this._guiURL;\n\n    this._messageBus.addListener(guiURL, msg => {\n\n      const funcName = msg.body.method;\n\n      console.log('AQUI:', funcName);\n\n      const callback = (identityInfo) => {\n        this._buildMessage(msg, identityInfo);\n      };\n\n      if (funcName === 'openPopup') {\n\n        let urlreceived = msg.body.params.urlreceived;\n        this.openPopup(urlreceived).then((returnedValue) => {\n          let value = {type: 'execute', value: returnedValue, code: 200};\n          let replyMsg = {id: msg.id, type: 'response', to: msg.from, from: msg.to, body: value};\n          this._messageBus.postMessage(replyMsg);\n        });\n        return; // this avoids getting stuck in the identities page\n      }\n\n      this._getIdentities(callback);\n\n      const clickClose = new MouseEvent('click');\n      document.querySelector('.settings-btn').dispatchEvent(clickClose);\n\n    });\n\n    const callback = (identityInfo) => {\n      this._buildMessage(null, identityInfo);\n    };\n\n    this._getIdentities(callback);\n\n  }\n\n  _buildMessage(msg, identityInfo) {\n    let replyMsg;\n    let value;\n\n    const from = msg ? msg.from : this._guiURL;\n    const to = msg ? msg.to : this._idmURL;\n\n    console.log('chosen identity: ', identityInfo);\n\n    switch (identityInfo.type) {\n      case 'idp':\n        value = { type: 'idp', value: identityInfo.value, code: 200 };\n        break;\n\n      case 'identity':\n        value = { type: 'identity', value: identityInfo.value, code: 200 };\n        break;\n\n      default:\n        value = { type: 'error', value: 'Error on identity GUI', code: 400 };\n    }\n\n    if (msg && msg.type === 'execute') {\n      replyMsg = {id: msg.id, type: 'response', to: from, from: to, body: value };\n    } else {\n      // replyMsg = {type: 'execute', to: from, from: to, body: value };\n    }\n\n    this._messageBus.postMessage(replyMsg);\n  }\n\n  _getIdentities(callback) {\n\n    return this.callIdentityModuleFunc('getIdentitiesToChoose', {}).then((resultObject) => {\n      return Promise.all([this.showIdps(resultObject.idps, callback), this.showIdentities(resultObject.identities, callback)]);\n    });\n  }\n\n  // _openDrawer() {\n\n  //   let _this = this;\n  //   const guiURL = _this._guiURL;\n\n  //   _this.resultURL  = undefined;\n\n  //   _this._messageBus.addListener(guiURL, msg => {\n  //     let identityInfo = msg.body.value;\n  //     let funcName = msg.body.method;\n  //     let value;\n  //     console.log('[IdentitiesGUI] received msg: ', msg);\n\n  //     _this.showIdentitiesGUI(msg.body.value).then((identityInfo) => {\n\n  //       let replyMsg;\n  //       console.log('[IdentitiesGUI] identityInfo from GUI: ', identityInfo);\n\n  //       //hide config page with the identity GUI\n  //       parent.postMessage({ body: { method: 'hideAdminPage' }, to: 'runtime:gui-manager' }, '*');\n  //       $('.admin-page').addClass('hide');\n\n  //       // document.getElementsByTagName('body')[0].style = 'background-color:transparent';\n  //       $('.identities-section').addClass('hide');\n  //       $('.policies-section').addClass('hide');\n\n  //       switch (identityInfo.type) {\n  //         case 'idp':\n  //           value = { type: 'idp', value: identityInfo.value, code: 200 };\n  //           replyMsg = { id: msg.id, type: 'response', to: msg.from, from: msg.to, body: value };\n  //           _this._messageBus.postMessage(replyMsg);\n  //           break;\n\n  //         case 'identity':\n  //           value = { type: 'identity', value: identityInfo.value, code: 200 };\n  //           replyMsg = { id: msg.id, type: 'response', to: msg.from, from: msg.to, body: value };\n  //           _this._messageBus.postMessage(replyMsg);\n  //           break;\n\n  //         default:\n  //           value = { type: 'error', value: 'Error on identity GUI', code: 400 };\n  //           replyMsg = { id: msg.id, type: 'response', to: msg.from, from: msg.to, body: value };\n  //           _this._messageBus.postMessage(replyMsg);\n  //       }\n  //     });\n\n  //     if (funcName === 'openPopup') {\n  //       let urlreceived = msg.body.params.urlreceived;\n  //       _this.openPopup(urlreceived).then((returnedValue) => {\n  //         let value = {type: 'execute', value: returnedValue, code: 200};\n  //         let replyMsg = {id: msg.id, type: 'response', to: msg.from, from: msg.to, body: value};\n  //         _this._messageBus.postMessage(replyMsg);\n  //       });\n  //       return; // this avoids getting stuck in the identities page\n  //     }\n\n  //     // unhide the config page with the identity GUI\n  //     // document.getElementsByTagName('body')[0].style = 'background-color:white;';\n  //     parent.postMessage({ body: { method: 'showAdminPage' }, to: 'runtime:gui-manager' }, '*');\n\n  //     const clickOpen = new MouseEvent('click');\n  //     document.querySelector('.settings-btn').dispatchEvent(clickOpen);\n\n  //     $('.admin-page').removeClass('hide');\n\n  //   });\n  // }\n\n  callIdentityModuleFunc(methodName, parameters) {\n    let _this = this;\n\n    return new Promise((resolve, reject) => {\n      const message = { type: 'execute', to: _this._idmURL, from: _this._guiURL,\n        body: { resource: 'identity', method: methodName, params: parameters }};\n\n      this._messageBus.postMessage(message, (res) => {\n        let result = res.body.value;\n        resolve(result);\n      });\n\n    });\n  }\n\n  openPopup(urlreceived) {\n\n    return new Promise((resolve, reject) => {\n\n      let win = window.open(urlreceived, 'openIDrequest', 'width=800, height=600');\n      if (window.cordova) {\n        win.addEventListener('loadstart', function(e) {\n          let url = e.url;\n          let code = /\\&code=(.+)$/.exec(url);\n          let error = /\\&error=(.+)$/.exec(url);\n\n          if (code || error) {\n            win.close();\n            return resolve(url);\n          } else {\n            return reject('openPopup error 1 - should not happen');\n          }\n        });\n      } else {\n\n        let pollTimer = setInterval(function() {\n          try {\n            if (win.closed) {\n              clearInterval(pollTimer);\n              return reject('Some error occured when trying to get identity.');\n            }\n\n            if ((win.document.URL.indexOf('access_token') !== -1 || win.document.URL.indexOf('code') !== -1) && win.document.URL.indexOf(location.origin) !== -1) {\n              window.clearInterval(pollTimer);\n              let url =   win.document.URL;\n\n              win.close();\n              return resolve(url);\n            }\n          } catch (e) {\n            //return reject('openPopup error 2 - should not happen');\n            console.log(e);\n          }\n\n        }, 500);\n      }\n\n    });\n  }\n\n  // showIdentitiesGUI(receivedInfo) {\n  //   let _this = this;\n\n  //   return new Promise((resolve, reject) => {\n  //     console.log('[IdentitiesGUI.showIdentitiesGUI] receivedInfo: ', receivedInfo);\n\n  //     let identityInfo;\n  //     let toRemoveID;\n\n  //     let callback = (value) => {\n  //       console.log('chosen identity: ', value);\n\n  //       const clickClose = new MouseEvent('click');\n  //       document.querySelector('.settings-btn').dispatchEvent(clickClose);\n\n  //       resolve({type: 'identity', value: value});\n  //     };\n\n  //     _this._checkReceivedInfo(receivedInfo).then((resultObject) => {\n  //       identityInfo = resultObject.identityInfo;\n  //       toRemoveID = resultObject.toRemoveID;\n\n  //       $('.policies-section').addClass('hide');\n  //       $('.identities-section').removeClass('hide');\n\n  //       _this.showIdps(receivedInfo.idps, callback);\n\n  //       _this.showIdentities(identityInfo.identities, toRemoveID).then((identity) => {\n  //         console.log('chosen identity: ', identity);\n  //         resolve({type: 'identity', value: identity});\n  //       });\n\n  //       let idps = [];\n  //       let idpsObjects = identityInfo.idps;\n\n  //       idpsObjects.forEach(function(entry) {\n  //         if(entry.type && entry.type == 'idToken') {\n  //           idps.push(entry.domain);\n  //         }\n  //       });\n\n  //       $('#idproviders').html(_this._getList(idps));\n  //       $('#idproviders').off();\n  //       // $('#idproviders').on('click', (event) => _this.obtainNewIdentity(event, callback, toRemoveID));\n  //       //$('.back').on('click', (event) => _this.goHome());\n  //       $('.identities-reset').off();\n  //       // $('.identities-reset').on('click', (event) => _this._resetIdentities(callback));\n  //     });\n  //   });\n  // }\n\n  _checkReceivedInfo(receivedInfo) {\n    let _this = this;\n    return new Promise((resolve, reject) => {\n\n      let identityInfo;\n      let toRemoveID;\n\n      if (receivedInfo) {\n        identityInfo = receivedInfo;\n        toRemoveID = false;\n        resolve({identityInfo: identityInfo, toRemoveID: toRemoveID});\n      } else {\n        toRemoveID = true;\n        _this.callIdentityModuleFunc('getIdentitiesToChoose', {}).then((result) => {\n          resolve({identityInfo: result, toRemoveID: toRemoveID});\n        });\n      }\n    });\n  }\n\n  showIdps(idps, callback) {\n\n    let idpsList = document.getElementById('idps-list');\n\n    idps.forEach((key) => {\n\n      const exist = document.getElementById('link-' + key.domain);\n      if (exist) { return; }\n\n      const linkEl = document.createElement('a');\n      linkEl.setAttribute('id', 'link-' + key.domain);\n      linkEl.setAttribute('data-idp', key.domain);\n      linkEl.classList = 'mdc-list-item';\n      linkEl.href = '#';\n\n      linkEl.addEventListener('click', (event) => {\n        this.loginWithIDP.call(this, event);\n      });\n\n      const linkElText = document.createTextNode(key.domain);\n\n      const iconEl = document.createElement('i');\n      iconEl.classList = 'material-icons mdc-list-item__start-detail';\n      iconEl.setAttribute('aria-hidden', true);\n      iconEl.textContent = 'inbox';\n\n      linkEl.appendChild(iconEl);\n      linkEl.appendChild(linkElText);\n\n      idpsList.appendChild(linkEl);\n    });\n\n  }\n\n  showIdentities(iDs, callback) {\n    let _this = this;\n\n    // TODO: iDs should be replaced by user urls\n\n    return new Promise((resolve, reject) => {\n\n      console.log('[IdentitiesGUI.showMyIdentities] : ', iDs);\n\n      let identities = [];\n\n      for (let i in iDs) {\n        let split1 = iDs[i].split('://');\n\n        let identifier = split1[1].split('/')[1];\n        let domain = iDs[i].replace('/' + identifier, '');\n        identities.push({ userURL: iDs[i], domain: domain });\n      }\n\n      let activeIdentities = document.getElementById('active-identities');\n\n      identities.forEach((key) => {\n\n        const linkEl = document.createElement('a');\n        linkEl.classList = 'mdc-list-item';\n        linkEl.href = '#';\n\n        const linkElText = document.createTextNode(key.userURL);\n\n        const iconEl = document.createElement('i');\n        iconEl.classList = 'material-icons mdc-list-item__start-detail';\n        iconEl.setAttribute('aria-hidden', true);\n        iconEl.textContent = 'inbox';\n\n        linkEl.appendChild(iconEl);\n        linkEl.appendChild(linkElText);\n\n        activeIdentities.appendChild(linkEl);\n\n      });\n\n      if (identities.length === 1) {\n\n        if (callback) {\n          callback({type: 'identity', value: identities[0]});\n        }\n\n        return resolve({type: 'identity', value: identities[0]});\n      }\n\n      if (identities.length > 1) {\n        this._drawer.open = true;\n      }\n\n      // let callback = (identity) => {\n      //   resolve(identity);\n      // };\n\n      // if (!toRemoveID) {\n      //   $('.clickable-cell').on('click', (event) => _this.changeID(event, callback));\n      // }\n\n      // $('.remove-id').on('click', (event) => _this.removeID(iDs));\n\n    });\n  }\n\n  removeID(event, emails) {\n    let _this = this;\n    let row = event.target.parentNode.parentNode;\n    let idToRemove = row.children[0].textContent;\n    let domain = row.children[1].textContent;\n\n    _this.callIdentityModuleFunc('unregisterIdentity', { email: idToRemove }).then(() => {\n      let numEmails = emails.length;\n      for (let i = 0; i < numEmails; i++) {\n        if (emails[i].email === idToRemove) {\n          emails.splice(i, 1);\n          break;\n        }\n      }\n\n      // -------------------------------------------------------------------------//\n      _this.showIdentities(emails, true);\n    });\n\n    //_this.identityModule.unregisterIdentity(idToRemove);\n\n  }\n\n  loginWithIDP(event) {\n\n    // event.preventDefault();\n\n    const el = event.currentTarget;\n    const idp = el.getAttribute('data-idp');\n\n    console.log('this:', this, idp);\n\n    let _publicKey;\n    this.callIdentityModuleFunc('getMyPublicKey', {})\n      .then((publicKey) => {\n        _publicKey = publicKey;\n        const data = { contents: publicKey, origin: 'origin', usernameHint: undefined, idpDomain: idp };\n        return this.callIdentityModuleFunc('sendGenerateMessage', data);\n      })\n      .then((value) => {\n        console.log('[IdentitiesGUI.obtainNewIdentity] receivedURL from idp Proxy: ' + value.loginUrl.substring(0, 20) + '...');\n\n        let url = value.loginUrl;\n        let finalURL;\n\n        //check if the receivedURL contains the redirect field and replace it\n        if (url.indexOf('redirect_uri') !== -1) {\n          let firstPart = url.substring(0, url.indexOf('redirect_uri'));\n          let secondAuxPart = url.substring(url.indexOf('redirect_uri'), url.length);\n\n          let secondPart = secondAuxPart.substring(secondAuxPart.indexOf('&'), url.length);\n\n          //check if the reddirect field is the last field of the URL\n          if (secondPart.indexOf('&') !== -1) {\n            finalURL = firstPart + 'redirect_uri=' + location.origin + secondPart;\n          } else {\n            finalURL = firstPart + 'redirect_uri=' + location.origin;\n          }\n        }\n\n        this.resultURL = finalURL || url;\n\n        console.log('AQUI:', this.resultURL);\n\n        return this._authenticateUser(_publicKey, value, 'origin', idp);\n      }).then((email) => {\n        this._drawer.open = false;\n        const value = {type: 'identity', value: email};\n\n        console.log('AQUI:', value);\n\n        // return resolve(value);\n      });\n\n  }\n\n  // obtainNewIdentity(event, callback, toRemoveID) {\n  //   let _this = this;\n  //   let idProvider = event.target.textContent;\n  //   let idProvider2 = event.target.text;\n\n  //   _this.callIdentityModuleFunc('getMyPublicKey', {}).then((publicKey) => {\n  //     // let publicKey = btoa(keyPair.public);\n\n  //     _this.callIdentityModuleFunc('sendGenerateMessage',\n  //       { contents: publicKey, origin: 'origin', usernameHint: undefined, idpDomain: idProvider, }).then((value) => {\n  //       console.log('[IdentitiesGUI.obtainNewIdentity] receivedURL from idp Proxy: ' + value.loginUrl.substring(0, 20) + '...');\n\n  //       let url = value.loginUrl;\n  //       let finalURL;\n\n  //       //check if the receivedURL contains the redirect field and replace it\n  //       if (url.indexOf('redirect_uri') !== -1) {\n  //         let firstPart = url.substring(0, url.indexOf('redirect_uri'));\n  //         let secondAuxPart = url.substring(url.indexOf('redirect_uri'), url.length);\n\n  //         let secondPart = secondAuxPart.substring(secondAuxPart.indexOf('&'), url.length);\n\n  //         //check if the reddirect field is the last field of the URL\n  //         if (secondPart.indexOf('&') !== -1) {\n  //           finalURL = firstPart + 'redirect_uri=' + location.origin + secondPart;\n  //         } else {\n  //           finalURL = firstPart + 'redirect_uri=' + location.origin;\n  //         }\n  //       }\n\n  //       _this.resultURL = finalURL || url;\n\n  //       $('.login-idp').html('<p>Chosen IDP: ' + idProvider + '</p>');\n  //       $('.login').removeClass('hide');\n  //       $('.login-btn').off();\n  //       $('.login-btn').on('click', (event) => {\n  //         $('.login').addClass('hide');\n  //         // _this._authenticateUser(publicKey, value, 'origin', idProvider).then((email) => {\n  //         //   callback(email);\n  //         //   _this.showIdentitiesGUI();\n  //         // });\n  //       });\n  //     });\n  //   }).catch(err => console.log('obtanin new identity', err));\n\n  // }\n\n  _getList(items) {\n    let list = '';\n    let numItems = items.length;\n\n    for (let i = 0; i < numItems; i++) {\n      list += '<li class=\"divider\"></li>';\n      list += '<li><a class=\"center-align\">' + items[i] + '</a></li>';\n    }\n\n    return list;\n  }\n\n  _authenticateUser(publicKey, value, origin, idProvider) {\n    let _this = this;\n    let url = _this.resultURL;\n\n    return new Promise((resolve, reject) => {\n\n      console.log('OPENPOUP: ', url);\n\n      _this.openPopup(url).then((identity) => {\n\n        _this.callIdentityModuleFunc('sendGenerateMessage',\n          { contents: publicKey, origin: origin, usernameHint: identity, idpDomain: idProvider }).then((result) => {\n\n          if (result) {\n\n           //_this.identityModule.storeIdentity(result, keyPair).then((value) => {\n           _this.callIdentityModuleFunc('addAssertion', result).then((value) => {\n             resolve(value.userProfile.userURL);\n           }, (err) => {\n             reject(err);\n           });\n\n          } else {\n           reject('error on obtaining identity information');\n          }\n\n          });\n         }, (err) => {\n           reject(err);\n      });\n    });\n  }\n\n_resetIdentities() {\n  console.log('_resetIdentities');\n}\n\n\n}\n\nexport default IdentitiesGUI;\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYWRtaW4vSWRlbnRpdGllc0dVSS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7QUNBQTs7SUFFTSxhO0FBRUoseUJBQVksTUFBWixFQUFvQixNQUFwQixFQUE0QixVQUE1QixFQUF3QztBQUFBOztBQUFBOztBQUN0QztBQUNBLFFBQUksQ0FBQyxVQUFMLEVBQWlCLE1BQU0sTUFBTSxzQkFBTixDQUFOO0FBQ2pCLFFBQUksUUFBUSxJQUFaO0FBQ0EsVUFBTSxPQUFOLEdBQWdCLE1BQWhCO0FBQ0EsVUFBTSxPQUFOLEdBQWdCLE1BQWhCO0FBQ0EsVUFBTSxXQUFOLEdBQW9CLFVBQXBCOztBQUVBLFNBQUssc0JBQUwsQ0FBNEIsV0FBNUIsRUFBeUMsRUFBekMsRUFBNkMsSUFBN0MsQ0FBa0QsVUFBQyxNQUFELEVBQVk7QUFDNUQsYUFBTyxPQUFLLFlBQUwsRUFBUDtBQUNELEtBRkQsRUFFRyxJQUZILENBRVEsVUFBQyxNQUFELEVBQVk7QUFDbEIsY0FBUSxHQUFSLENBQVksUUFBWixFQUFzQixNQUF0QjtBQUNELEtBSkQ7O0FBTUEsUUFBTSxXQUFXLFNBQVMsYUFBVCxDQUF1Qix1QkFBdkIsQ0FBakI7QUFDQSxRQUFNLHFCQUFxQixJQUFJLE1BQUosQ0FBVyxrQkFBdEM7QUFDQSxRQUFNLFNBQVMsSUFBSSxrQkFBSixDQUF1QixRQUF2QixDQUFmOztBQUVBLFNBQUssU0FBTCxHQUFpQixRQUFqQjtBQUNBLFNBQUssT0FBTCxHQUFlLE1BQWY7O0FBRUEsYUFBUyxhQUFULENBQXVCLGVBQXZCLEVBQXdDLGdCQUF4QyxDQUF5RCxPQUF6RCxFQUFrRSxZQUFXO0FBQzNFLGFBQU8sSUFBUCxHQUFjLElBQWQ7QUFDRCxLQUZEOztBQUlBLGFBQVMsZ0JBQVQsQ0FBMEIseUJBQTFCLEVBQXFELFlBQU07QUFDekQsY0FBUSxHQUFSLENBQVksa0NBQVo7QUFDQSxh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QUFDLFFBQUQsRUFBYzs7QUFFdEMsZ0JBQU0sc0JBQU4sQ0FBNkIscUJBQTdCLEVBQ0UsRUFBRSxVQUFVLFNBQVosRUFBdUIsUUFBUSxNQUEvQixFQUF1QyxjQUFjLFFBQXJELEVBQStELFdBQVcsVUFBMUUsRUFERixFQUMwRixJQUQxRixDQUMrRixVQUFDLE1BQUQsRUFBWTs7QUFFekcsZ0JBQUksTUFBSixFQUFZOztBQUVYO0FBQ0Esb0JBQU0sc0JBQU4sQ0FBNkIsY0FBN0IsRUFBNkMsTUFBN0MsRUFBcUQsSUFBckQsQ0FBMEQsVUFBQyxLQUFELEVBQVc7QUFDbkUsd0JBQVEsTUFBTSxXQUFOLENBQWtCLE9BQTFCO0FBQ0QsZUFGRCxFQUVHLFVBQUMsR0FBRCxFQUFTO0FBQ1YsdUJBQU8sR0FBUDtBQUNELGVBSkQ7QUFNQSxhQVRELE1BU087QUFDTixxQkFBTyx5Q0FBUDtBQUNBO0FBRUEsV0FoQkg7QUFpQkUsU0FuQkosRUFtQk0sVUFBQyxHQUFELEVBQVM7QUFDVixpQkFBTyxHQUFQO0FBQ0osU0FyQkQ7QUFzQkQsT0ExQk0sQ0FBUDtBQTJCRDs7O3VDQUVnQjtBQUNqQixjQUFRLEdBQVIsQ0FBWSxrQkFBWjtBQUNEOzs7Ozs7a0JBS2MsYSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvLyBqc2hpbnQgYnJvd3Nlcjp0cnVlLCBqcXVlcnk6IHRydWVcblxuY2xhc3MgSWRlbnRpdGllc0dVSSB7XG5cbiAgY29uc3RydWN0b3IoZ3VpVVJMLCBpZG1VUkwsIG1lc3NhZ2VCdXMpIHtcbiAgICAvL2lmICghaWRlbnRpdHlNb2R1bGUpIHRocm93IEVycm9yKCdJZGVudGl0eSBNb2R1bGUgbm90IHNldCEnKTtcbiAgICBpZiAoIW1lc3NhZ2VCdXMpIHRocm93IEVycm9yKCdNZXNzYWdlIEJ1cyBub3Qgc2V0IScpO1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgX3RoaXMuX2d1aVVSTCA9IGd1aVVSTDtcbiAgICBfdGhpcy5faWRtVVJMID0gaWRtVVJMO1xuICAgIF90aGlzLl9tZXNzYWdlQnVzID0gbWVzc2FnZUJ1cztcblxuICAgIHRoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygnZGVwbG95R1VJJywge30pLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuX2J1aWxkRHJhd2VyKCk7XG4gICAgfSkudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnUkVBRFk6JywgcmVzdWx0KVxuICAgIH0pO1xuXG4gICAgY29uc3QgZHJhd2VyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWRjLXRlbXBvcmFyeS1kcmF3ZXInKTtcbiAgICBjb25zdCBNRENUZW1wb3JhcnlEcmF3ZXIgPSBtZGMuZHJhd2VyLk1EQ1RlbXBvcmFyeURyYXdlcjtcbiAgICBjb25zdCBkcmF3ZXIgPSBuZXcgTURDVGVtcG9yYXJ5RHJhd2VyKGRyYXdlckVsKTtcblxuICAgIHRoaXMuX2RyYXdlckVsID0gZHJhd2VyRWw7XG4gICAgdGhpcy5fZHJhd2VyID0gZHJhd2VyO1xuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNldHRpbmdzLWJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICBkcmF3ZXIub3BlbiA9IHRydWU7XG4gICAgfSk7XG5cbiAgICBkcmF3ZXJFbC5hZGRFdmVudExpc3RlbmVyKCdNRENUZW1wb3JhcnlEcmF3ZXI6b3BlbicsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdSZWNlaXZlZCBNRENUZW1wb3JhcnlEcmF3ZXI6b3BlbicpO1xuICAgICAgdGhpcy5faXNEcmF3ZXJPcGVuID0gdHJ1ZTtcbiAgICB9KTtcblxuICAgIGRyYXdlckVsLmFkZEV2ZW50TGlzdGVuZXIoJ01EQ1RlbXBvcmFyeURyYXdlcjpjbG9zZScsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdSZWNlaXZlZCBNRENUZW1wb3JhcnlEcmF3ZXI6Y2xvc2UnKTtcbiAgICAgIHRoaXMuX2lzRHJhd2VyT3BlbiA9IGZhbHNlO1xuXG4gICAgICBwYXJlbnQucG9zdE1lc3NhZ2UoeyBib2R5OiB7IG1ldGhvZDogJ2hpZGVBZG1pblBhZ2UnIH0sIHRvOiAncnVudGltZTpndWktbWFuYWdlcicgfSwgJyonKTtcbiAgICB9KTtcblxuICB9XG5cbiAgX2J1aWxkRHJhd2VyKCkge1xuXG4gICAgY29uc3QgZ3VpVVJMID0gdGhpcy5fZ3VpVVJMO1xuXG4gICAgdGhpcy5fbWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihndWlVUkwsIG1zZyA9PiB7XG5cbiAgICAgIGNvbnN0IGZ1bmNOYW1lID0gbXNnLmJvZHkubWV0aG9kO1xuXG4gICAgICBjb25zb2xlLmxvZygnQVFVSTonLCBmdW5jTmFtZSk7XG5cbiAgICAgIGNvbnN0IGNhbGxiYWNrID0gKGlkZW50aXR5SW5mbykgPT4ge1xuICAgICAgICB0aGlzLl9idWlsZE1lc3NhZ2UobXNnLCBpZGVudGl0eUluZm8pO1xuICAgICAgfTtcblxuICAgICAgaWYgKGZ1bmNOYW1lID09PSAnb3BlblBvcHVwJykge1xuXG4gICAgICAgIGxldCB1cmxyZWNlaXZlZCA9IG1zZy5ib2R5LnBhcmFtcy51cmxyZWNlaXZlZDtcbiAgICAgICAgdGhpcy5vcGVuUG9wdXAodXJscmVjZWl2ZWQpLnRoZW4oKHJldHVybmVkVmFsdWUpID0+IHtcbiAgICAgICAgICBsZXQgdmFsdWUgPSB7dHlwZTogJ2V4ZWN1dGUnLCB2YWx1ZTogcmV0dXJuZWRWYWx1ZSwgY29kZTogMjAwfTtcbiAgICAgICAgICBsZXQgcmVwbHlNc2cgPSB7aWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgdG86IG1zZy5mcm9tLCBmcm9tOiBtc2cudG8sIGJvZHk6IHZhbHVlfTtcbiAgICAgICAgICB0aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHJlcGx5TXNnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjsgLy8gdGhpcyBhdm9pZHMgZ2V0dGluZyBzdHVjayBpbiB0aGUgaWRlbnRpdGllcyBwYWdlXG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2dldElkZW50aXRpZXMoY2FsbGJhY2spO1xuXG4gICAgICBjb25zdCBjbGlja0Nsb3NlID0gbmV3IE1vdXNlRXZlbnQoJ2NsaWNrJyk7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZ3MtYnRuJykuZGlzcGF0Y2hFdmVudChjbGlja0Nsb3NlKTtcblxuICAgIH0pO1xuXG4gICAgY29uc3QgY2FsbGJhY2sgPSAoaWRlbnRpdHlJbmZvKSA9PiB7XG4gICAgICB0aGlzLl9idWlsZE1lc3NhZ2UobnVsbCwgaWRlbnRpdHlJbmZvKTtcbiAgICB9O1xuXG4gICAgdGhpcy5fZ2V0SWRlbnRpdGllcyhjYWxsYmFjayk7XG5cbiAgfVxuXG4gIF9idWlsZE1lc3NhZ2UobXNnLCBpZGVudGl0eUluZm8pIHtcbiAgICBsZXQgcmVwbHlNc2c7XG4gICAgbGV0IHZhbHVlO1xuXG4gICAgY29uc3QgZnJvbSA9IG1zZyA/IG1zZy5mcm9tIDogdGhpcy5fZ3VpVVJMO1xuICAgIGNvbnN0IHRvID0gbXNnID8gbXNnLnRvIDogdGhpcy5faWRtVVJMO1xuXG4gICAgY29uc29sZS5sb2coJ2Nob3NlbiBpZGVudGl0eTogJywgaWRlbnRpdHlJbmZvKTtcblxuICAgIHN3aXRjaCAoaWRlbnRpdHlJbmZvLnR5cGUpIHtcbiAgICAgIGNhc2UgJ2lkcCc6XG4gICAgICAgIHZhbHVlID0geyB0eXBlOiAnaWRwJywgdmFsdWU6IGlkZW50aXR5SW5mby52YWx1ZSwgY29kZTogMjAwIH07XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdpZGVudGl0eSc6XG4gICAgICAgIHZhbHVlID0geyB0eXBlOiAnaWRlbnRpdHknLCB2YWx1ZTogaWRlbnRpdHlJbmZvLnZhbHVlLCBjb2RlOiAyMDAgfTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHZhbHVlID0geyB0eXBlOiAnZXJyb3InLCB2YWx1ZTogJ0Vycm9yIG9uIGlkZW50aXR5IEdVSScsIGNvZGU6IDQwMCB9O1xuICAgIH1cblxuICAgIGlmIChtc2cgJiYgbXNnLnR5cGUgPT09ICdleGVjdXRlJykge1xuICAgICAgcmVwbHlNc2cgPSB7aWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgdG86IGZyb20sIGZyb206IHRvLCBib2R5OiB2YWx1ZSB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyByZXBseU1zZyA9IHt0eXBlOiAnZXhlY3V0ZScsIHRvOiBmcm9tLCBmcm9tOiB0bywgYm9keTogdmFsdWUgfTtcbiAgICB9XG5cbiAgICB0aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHJlcGx5TXNnKTtcbiAgfVxuXG4gIF9nZXRJZGVudGl0aWVzKGNhbGxiYWNrKSB7XG5cbiAgICByZXR1cm4gdGhpcy5jYWxsSWRlbnRpdHlNb2R1bGVGdW5jKCdnZXRJZGVudGl0aWVzVG9DaG9vc2UnLCB7fSkudGhlbigocmVzdWx0T2JqZWN0KSA9PiB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuc2hvd0lkcHMocmVzdWx0T2JqZWN0LmlkcHMsIGNhbGxiYWNrKSwgdGhpcy5zaG93SWRlbnRpdGllcyhyZXN1bHRPYmplY3QuaWRlbnRpdGllcywgY2FsbGJhY2spXSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBfb3BlbkRyYXdlcigpIHtcblxuICAvLyAgIGxldCBfdGhpcyA9IHRoaXM7XG4gIC8vICAgY29uc3QgZ3VpVVJMID0gX3RoaXMuX2d1aVVSTDtcblxuICAvLyAgIF90aGlzLnJlc3VsdFVSTCAgPSB1bmRlZmluZWQ7XG5cbiAgLy8gICBfdGhpcy5fbWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihndWlVUkwsIG1zZyA9PiB7XG4gIC8vICAgICBsZXQgaWRlbnRpdHlJbmZvID0gbXNnLmJvZHkudmFsdWU7XG4gIC8vICAgICBsZXQgZnVuY05hbWUgPSBtc2cuYm9keS5tZXRob2Q7XG4gIC8vICAgICBsZXQgdmFsdWU7XG4gIC8vICAgICBjb25zb2xlLmxvZygnW0lkZW50aXRpZXNHVUldIHJlY2VpdmVkIG1zZzogJywgbXNnKTtcblxuICAvLyAgICAgX3RoaXMuc2hvd0lkZW50aXRpZXNHVUkobXNnLmJvZHkudmFsdWUpLnRoZW4oKGlkZW50aXR5SW5mbykgPT4ge1xuXG4gIC8vICAgICAgIGxldCByZXBseU1zZztcbiAgLy8gICAgICAgY29uc29sZS5sb2coJ1tJZGVudGl0aWVzR1VJXSBpZGVudGl0eUluZm8gZnJvbSBHVUk6ICcsIGlkZW50aXR5SW5mbyk7XG5cbiAgLy8gICAgICAgLy9oaWRlIGNvbmZpZyBwYWdlIHdpdGggdGhlIGlkZW50aXR5IEdVSVxuICAvLyAgICAgICBwYXJlbnQucG9zdE1lc3NhZ2UoeyBib2R5OiB7IG1ldGhvZDogJ2hpZGVBZG1pblBhZ2UnIH0sIHRvOiAncnVudGltZTpndWktbWFuYWdlcicgfSwgJyonKTtcbiAgLy8gICAgICAgJCgnLmFkbWluLXBhZ2UnKS5hZGRDbGFzcygnaGlkZScpO1xuXG4gIC8vICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF0uc3R5bGUgPSAnYmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudCc7XG4gIC8vICAgICAgICQoJy5pZGVudGl0aWVzLXNlY3Rpb24nKS5hZGRDbGFzcygnaGlkZScpO1xuICAvLyAgICAgICAkKCcucG9saWNpZXMtc2VjdGlvbicpLmFkZENsYXNzKCdoaWRlJyk7XG5cbiAgLy8gICAgICAgc3dpdGNoIChpZGVudGl0eUluZm8udHlwZSkge1xuICAvLyAgICAgICAgIGNhc2UgJ2lkcCc6XG4gIC8vICAgICAgICAgICB2YWx1ZSA9IHsgdHlwZTogJ2lkcCcsIHZhbHVlOiBpZGVudGl0eUluZm8udmFsdWUsIGNvZGU6IDIwMCB9O1xuICAvLyAgICAgICAgICAgcmVwbHlNc2cgPSB7IGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIHRvOiBtc2cuZnJvbSwgZnJvbTogbXNnLnRvLCBib2R5OiB2YWx1ZSB9O1xuICAvLyAgICAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UocmVwbHlNc2cpO1xuICAvLyAgICAgICAgICAgYnJlYWs7XG5cbiAgLy8gICAgICAgICBjYXNlICdpZGVudGl0eSc6XG4gIC8vICAgICAgICAgICB2YWx1ZSA9IHsgdHlwZTogJ2lkZW50aXR5JywgdmFsdWU6IGlkZW50aXR5SW5mby52YWx1ZSwgY29kZTogMjAwIH07XG4gIC8vICAgICAgICAgICByZXBseU1zZyA9IHsgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgdG86IG1zZy5mcm9tLCBmcm9tOiBtc2cudG8sIGJvZHk6IHZhbHVlIH07XG4gIC8vICAgICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShyZXBseU1zZyk7XG4gIC8vICAgICAgICAgICBicmVhaztcblxuICAvLyAgICAgICAgIGRlZmF1bHQ6XG4gIC8vICAgICAgICAgICB2YWx1ZSA9IHsgdHlwZTogJ2Vycm9yJywgdmFsdWU6ICdFcnJvciBvbiBpZGVudGl0eSBHVUknLCBjb2RlOiA0MDAgfTtcbiAgLy8gICAgICAgICAgIHJlcGx5TXNnID0geyBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCB0bzogbXNnLmZyb20sIGZyb206IG1zZy50bywgYm9keTogdmFsdWUgfTtcbiAgLy8gICAgICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKHJlcGx5TXNnKTtcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfSk7XG5cbiAgLy8gICAgIGlmIChmdW5jTmFtZSA9PT0gJ29wZW5Qb3B1cCcpIHtcbiAgLy8gICAgICAgbGV0IHVybHJlY2VpdmVkID0gbXNnLmJvZHkucGFyYW1zLnVybHJlY2VpdmVkO1xuICAvLyAgICAgICBfdGhpcy5vcGVuUG9wdXAodXJscmVjZWl2ZWQpLnRoZW4oKHJldHVybmVkVmFsdWUpID0+IHtcbiAgLy8gICAgICAgICBsZXQgdmFsdWUgPSB7dHlwZTogJ2V4ZWN1dGUnLCB2YWx1ZTogcmV0dXJuZWRWYWx1ZSwgY29kZTogMjAwfTtcbiAgLy8gICAgICAgICBsZXQgcmVwbHlNc2cgPSB7aWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgdG86IG1zZy5mcm9tLCBmcm9tOiBtc2cudG8sIGJvZHk6IHZhbHVlfTtcbiAgLy8gICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShyZXBseU1zZyk7XG4gIC8vICAgICAgIH0pO1xuICAvLyAgICAgICByZXR1cm47IC8vIHRoaXMgYXZvaWRzIGdldHRpbmcgc3R1Y2sgaW4gdGhlIGlkZW50aXRpZXMgcGFnZVxuICAvLyAgICAgfVxuXG4gIC8vICAgICAvLyB1bmhpZGUgdGhlIGNvbmZpZyBwYWdlIHdpdGggdGhlIGlkZW50aXR5IEdVSVxuICAvLyAgICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXS5zdHlsZSA9ICdiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyc7XG4gIC8vICAgICBwYXJlbnQucG9zdE1lc3NhZ2UoeyBib2R5OiB7IG1ldGhvZDogJ3Nob3dBZG1pblBhZ2UnIH0sIHRvOiAncnVudGltZTpndWktbWFuYWdlcicgfSwgJyonKTtcblxuICAvLyAgICAgY29uc3QgY2xpY2tPcGVuID0gbmV3IE1vdXNlRXZlbnQoJ2NsaWNrJyk7XG4gIC8vICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZ3MtYnRuJykuZGlzcGF0Y2hFdmVudChjbGlja09wZW4pO1xuXG4gIC8vICAgICAkKCcuYWRtaW4tcGFnZScpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG5cbiAgLy8gICB9KTtcbiAgLy8gfVxuXG4gIGNhbGxJZGVudGl0eU1vZHVsZUZ1bmMobWV0aG9kTmFtZSwgcGFyYW1ldGVycykge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IHsgdHlwZTogJ2V4ZWN1dGUnLCB0bzogX3RoaXMuX2lkbVVSTCwgZnJvbTogX3RoaXMuX2d1aVVSTCxcbiAgICAgICAgYm9keTogeyByZXNvdXJjZTogJ2lkZW50aXR5JywgbWV0aG9kOiBtZXRob2ROYW1lLCBwYXJhbXM6IHBhcmFtZXRlcnMgfX07XG5cbiAgICAgIHRoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgKHJlcykgPT4ge1xuICAgICAgICBsZXQgcmVzdWx0ID0gcmVzLmJvZHkudmFsdWU7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH0pO1xuXG4gICAgfSk7XG4gIH1cblxuICBvcGVuUG9wdXAodXJscmVjZWl2ZWQpIHtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgIGxldCB3aW4gPSB3aW5kb3cub3Blbih1cmxyZWNlaXZlZCwgJ29wZW5JRHJlcXVlc3QnLCAnd2lkdGg9ODAwLCBoZWlnaHQ9NjAwJyk7XG4gICAgICBpZiAod2luZG93LmNvcmRvdmEpIHtcbiAgICAgICAgd2luLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRzdGFydCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICBsZXQgdXJsID0gZS51cmw7XG4gICAgICAgICAgbGV0IGNvZGUgPSAvXFwmY29kZT0oLispJC8uZXhlYyh1cmwpO1xuICAgICAgICAgIGxldCBlcnJvciA9IC9cXCZlcnJvcj0oLispJC8uZXhlYyh1cmwpO1xuXG4gICAgICAgICAgaWYgKGNvZGUgfHwgZXJyb3IpIHtcbiAgICAgICAgICAgIHdpbi5jbG9zZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUodXJsKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHJlamVjdCgnb3BlblBvcHVwIGVycm9yIDEgLSBzaG91bGQgbm90IGhhcHBlbicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuXG4gICAgICAgIGxldCBwb2xsVGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHdpbi5jbG9zZWQpIHtcbiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwb2xsVGltZXIpO1xuICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KCdTb21lIGVycm9yIG9jY3VyZWQgd2hlbiB0cnlpbmcgdG8gZ2V0IGlkZW50aXR5LicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoKHdpbi5kb2N1bWVudC5VUkwuaW5kZXhPZignYWNjZXNzX3Rva2VuJykgIT09IC0xIHx8IHdpbi5kb2N1bWVudC5VUkwuaW5kZXhPZignY29kZScpICE9PSAtMSkgJiYgd2luLmRvY3VtZW50LlVSTC5pbmRleE9mKGxvY2F0aW9uLm9yaWdpbikgIT09IC0xKSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHBvbGxUaW1lcik7XG4gICAgICAgICAgICAgIGxldCB1cmwgPSAgIHdpbi5kb2N1bWVudC5VUkw7XG5cbiAgICAgICAgICAgICAgd2luLmNsb3NlKCk7XG4gICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHVybCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy9yZXR1cm4gcmVqZWN0KCdvcGVuUG9wdXAgZXJyb3IgMiAtIHNob3VsZCBub3QgaGFwcGVuJyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgfSwgNTAwKTtcbiAgICAgIH1cblxuICAgIH0pO1xuICB9XG5cbiAgLy8gc2hvd0lkZW50aXRpZXNHVUkocmVjZWl2ZWRJbmZvKSB7XG4gIC8vICAgbGV0IF90aGlzID0gdGhpcztcblxuICAvLyAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gIC8vICAgICBjb25zb2xlLmxvZygnW0lkZW50aXRpZXNHVUkuc2hvd0lkZW50aXRpZXNHVUldIHJlY2VpdmVkSW5mbzogJywgcmVjZWl2ZWRJbmZvKTtcblxuICAvLyAgICAgbGV0IGlkZW50aXR5SW5mbztcbiAgLy8gICAgIGxldCB0b1JlbW92ZUlEO1xuXG4gIC8vICAgICBsZXQgY2FsbGJhY2sgPSAodmFsdWUpID0+IHtcbiAgLy8gICAgICAgY29uc29sZS5sb2coJ2Nob3NlbiBpZGVudGl0eTogJywgdmFsdWUpO1xuXG4gIC8vICAgICAgIGNvbnN0IGNsaWNrQ2xvc2UgPSBuZXcgTW91c2VFdmVudCgnY2xpY2snKTtcbiAgLy8gICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNldHRpbmdzLWJ0bicpLmRpc3BhdGNoRXZlbnQoY2xpY2tDbG9zZSk7XG5cbiAgLy8gICAgICAgcmVzb2x2ZSh7dHlwZTogJ2lkZW50aXR5JywgdmFsdWU6IHZhbHVlfSk7XG4gIC8vICAgICB9O1xuXG4gIC8vICAgICBfdGhpcy5fY2hlY2tSZWNlaXZlZEluZm8ocmVjZWl2ZWRJbmZvKS50aGVuKChyZXN1bHRPYmplY3QpID0+IHtcbiAgLy8gICAgICAgaWRlbnRpdHlJbmZvID0gcmVzdWx0T2JqZWN0LmlkZW50aXR5SW5mbztcbiAgLy8gICAgICAgdG9SZW1vdmVJRCA9IHJlc3VsdE9iamVjdC50b1JlbW92ZUlEO1xuXG4gIC8vICAgICAgICQoJy5wb2xpY2llcy1zZWN0aW9uJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgLy8gICAgICAgJCgnLmlkZW50aXRpZXMtc2VjdGlvbicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG5cbiAgLy8gICAgICAgX3RoaXMuc2hvd0lkcHMocmVjZWl2ZWRJbmZvLmlkcHMsIGNhbGxiYWNrKTtcblxuICAvLyAgICAgICBfdGhpcy5zaG93SWRlbnRpdGllcyhpZGVudGl0eUluZm8uaWRlbnRpdGllcywgdG9SZW1vdmVJRCkudGhlbigoaWRlbnRpdHkpID0+IHtcbiAgLy8gICAgICAgICBjb25zb2xlLmxvZygnY2hvc2VuIGlkZW50aXR5OiAnLCBpZGVudGl0eSk7XG4gIC8vICAgICAgICAgcmVzb2x2ZSh7dHlwZTogJ2lkZW50aXR5JywgdmFsdWU6IGlkZW50aXR5fSk7XG4gIC8vICAgICAgIH0pO1xuXG4gIC8vICAgICAgIGxldCBpZHBzID0gW107XG4gIC8vICAgICAgIGxldCBpZHBzT2JqZWN0cyA9IGlkZW50aXR5SW5mby5pZHBzO1xuXG4gIC8vICAgICAgIGlkcHNPYmplY3RzLmZvckVhY2goZnVuY3Rpb24oZW50cnkpIHtcbiAgLy8gICAgICAgICBpZihlbnRyeS50eXBlICYmIGVudHJ5LnR5cGUgPT0gJ2lkVG9rZW4nKSB7XG4gIC8vICAgICAgICAgICBpZHBzLnB1c2goZW50cnkuZG9tYWluKTtcbiAgLy8gICAgICAgICB9XG4gIC8vICAgICAgIH0pO1xuXG4gIC8vICAgICAgICQoJyNpZHByb3ZpZGVycycpLmh0bWwoX3RoaXMuX2dldExpc3QoaWRwcykpO1xuICAvLyAgICAgICAkKCcjaWRwcm92aWRlcnMnKS5vZmYoKTtcbiAgLy8gICAgICAgLy8gJCgnI2lkcHJvdmlkZXJzJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiBfdGhpcy5vYnRhaW5OZXdJZGVudGl0eShldmVudCwgY2FsbGJhY2ssIHRvUmVtb3ZlSUQpKTtcbiAgLy8gICAgICAgLy8kKCcuYmFjaycpLm9uKCdjbGljaycsIChldmVudCkgPT4gX3RoaXMuZ29Ib21lKCkpO1xuICAvLyAgICAgICAkKCcuaWRlbnRpdGllcy1yZXNldCcpLm9mZigpO1xuICAvLyAgICAgICAvLyAkKCcuaWRlbnRpdGllcy1yZXNldCcpLm9uKCdjbGljaycsIChldmVudCkgPT4gX3RoaXMuX3Jlc2V0SWRlbnRpdGllcyhjYWxsYmFjaykpO1xuICAvLyAgICAgfSk7XG4gIC8vICAgfSk7XG4gIC8vIH1cblxuICBfY2hlY2tSZWNlaXZlZEluZm8ocmVjZWl2ZWRJbmZvKSB7XG4gICAgbGV0IF90aGlzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXG4gICAgICBsZXQgaWRlbnRpdHlJbmZvO1xuICAgICAgbGV0IHRvUmVtb3ZlSUQ7XG5cbiAgICAgIGlmIChyZWNlaXZlZEluZm8pIHtcbiAgICAgICAgaWRlbnRpdHlJbmZvID0gcmVjZWl2ZWRJbmZvO1xuICAgICAgICB0b1JlbW92ZUlEID0gZmFsc2U7XG4gICAgICAgIHJlc29sdmUoe2lkZW50aXR5SW5mbzogaWRlbnRpdHlJbmZvLCB0b1JlbW92ZUlEOiB0b1JlbW92ZUlEfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0b1JlbW92ZUlEID0gdHJ1ZTtcbiAgICAgICAgX3RoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygnZ2V0SWRlbnRpdGllc1RvQ2hvb3NlJywge30pLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgIHJlc29sdmUoe2lkZW50aXR5SW5mbzogcmVzdWx0LCB0b1JlbW92ZUlEOiB0b1JlbW92ZUlEfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgc2hvd0lkcHMoaWRwcywgY2FsbGJhY2spIHtcblxuICAgIGxldCBpZHBzTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZHBzLWxpc3QnKTtcblxuICAgIGlkcHMuZm9yRWFjaCgoa2V5KSA9PiB7XG5cbiAgICAgIGNvbnN0IGV4aXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmstJyArIGtleS5kb21haW4pO1xuICAgICAgaWYgKGV4aXN0KSB7IHJldHVybjsgfVxuXG4gICAgICBjb25zdCBsaW5rRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICBsaW5rRWwuc2V0QXR0cmlidXRlKCdpZCcsICdsaW5rLScgKyBrZXkuZG9tYWluKTtcbiAgICAgIGxpbmtFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWRwJywga2V5LmRvbWFpbik7XG4gICAgICBsaW5rRWwuY2xhc3NMaXN0ID0gJ21kYy1saXN0LWl0ZW0nO1xuICAgICAgbGlua0VsLmhyZWYgPSAnIyc7XG5cbiAgICAgIGxpbmtFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICB0aGlzLmxvZ2luV2l0aElEUC5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBsaW5rRWxUZXh0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoa2V5LmRvbWFpbik7XG5cbiAgICAgIGNvbnN0IGljb25FbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcbiAgICAgIGljb25FbC5jbGFzc0xpc3QgPSAnbWF0ZXJpYWwtaWNvbnMgbWRjLWxpc3QtaXRlbV9fc3RhcnQtZGV0YWlsJztcbiAgICAgIGljb25FbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgdHJ1ZSk7XG4gICAgICBpY29uRWwudGV4dENvbnRlbnQgPSAnaW5ib3gnO1xuXG4gICAgICBsaW5rRWwuYXBwZW5kQ2hpbGQoaWNvbkVsKTtcbiAgICAgIGxpbmtFbC5hcHBlbmRDaGlsZChsaW5rRWxUZXh0KTtcblxuICAgICAgaWRwc0xpc3QuYXBwZW5kQ2hpbGQobGlua0VsKTtcbiAgICB9KTtcblxuICB9XG5cbiAgc2hvd0lkZW50aXRpZXMoaURzLCBjYWxsYmFjaykge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG5cbiAgICAvLyBUT0RPOiBpRHMgc2hvdWxkIGJlIHJlcGxhY2VkIGJ5IHVzZXIgdXJsc1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuICAgICAgY29uc29sZS5sb2coJ1tJZGVudGl0aWVzR1VJLnNob3dNeUlkZW50aXRpZXNdIDogJywgaURzKTtcblxuICAgICAgbGV0IGlkZW50aXRpZXMgPSBbXTtcblxuICAgICAgZm9yIChsZXQgaSBpbiBpRHMpIHtcbiAgICAgICAgbGV0IHNwbGl0MSA9IGlEc1tpXS5zcGxpdCgnOi8vJyk7XG5cbiAgICAgICAgbGV0IGlkZW50aWZpZXIgPSBzcGxpdDFbMV0uc3BsaXQoJy8nKVsxXTtcbiAgICAgICAgbGV0IGRvbWFpbiA9IGlEc1tpXS5yZXBsYWNlKCcvJyArIGlkZW50aWZpZXIsICcnKTtcbiAgICAgICAgaWRlbnRpdGllcy5wdXNoKHsgdXNlclVSTDogaURzW2ldLCBkb21haW46IGRvbWFpbiB9KTtcbiAgICAgIH1cblxuICAgICAgbGV0IGFjdGl2ZUlkZW50aXRpZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWN0aXZlLWlkZW50aXRpZXMnKTtcblxuICAgICAgaWRlbnRpdGllcy5mb3JFYWNoKChrZXkpID0+IHtcblxuICAgICAgICBjb25zdCBsaW5rRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgIGxpbmtFbC5jbGFzc0xpc3QgPSAnbWRjLWxpc3QtaXRlbSc7XG4gICAgICAgIGxpbmtFbC5ocmVmID0gJyMnO1xuXG4gICAgICAgIGNvbnN0IGxpbmtFbFRleHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShrZXkudXNlclVSTCk7XG5cbiAgICAgICAgY29uc3QgaWNvbkVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaScpO1xuICAgICAgICBpY29uRWwuY2xhc3NMaXN0ID0gJ21hdGVyaWFsLWljb25zIG1kYy1saXN0LWl0ZW1fX3N0YXJ0LWRldGFpbCc7XG4gICAgICAgIGljb25FbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgdHJ1ZSk7XG4gICAgICAgIGljb25FbC50ZXh0Q29udGVudCA9ICdpbmJveCc7XG5cbiAgICAgICAgbGlua0VsLmFwcGVuZENoaWxkKGljb25FbCk7XG4gICAgICAgIGxpbmtFbC5hcHBlbmRDaGlsZChsaW5rRWxUZXh0KTtcblxuICAgICAgICBhY3RpdmVJZGVudGl0aWVzLmFwcGVuZENoaWxkKGxpbmtFbCk7XG5cbiAgICAgIH0pO1xuXG4gICAgICBpZiAoaWRlbnRpdGllcy5sZW5ndGggPT09IDEpIHtcblxuICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICBjYWxsYmFjayh7dHlwZTogJ2lkZW50aXR5JywgdmFsdWU6IGlkZW50aXRpZXNbMF19KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXNvbHZlKHt0eXBlOiAnaWRlbnRpdHknLCB2YWx1ZTogaWRlbnRpdGllc1swXX0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoaWRlbnRpdGllcy5sZW5ndGggPiAxKSB7XG4gICAgICAgIHRoaXMuX2RyYXdlci5vcGVuID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gbGV0IGNhbGxiYWNrID0gKGlkZW50aXR5KSA9PiB7XG4gICAgICAvLyAgIHJlc29sdmUoaWRlbnRpdHkpO1xuICAgICAgLy8gfTtcblxuICAgICAgLy8gaWYgKCF0b1JlbW92ZUlEKSB7XG4gICAgICAvLyAgICQoJy5jbGlja2FibGUtY2VsbCcpLm9uKCdjbGljaycsIChldmVudCkgPT4gX3RoaXMuY2hhbmdlSUQoZXZlbnQsIGNhbGxiYWNrKSk7XG4gICAgICAvLyB9XG5cbiAgICAgIC8vICQoJy5yZW1vdmUtaWQnKS5vbignY2xpY2snLCAoZXZlbnQpID0+IF90aGlzLnJlbW92ZUlEKGlEcykpO1xuXG4gICAgfSk7XG4gIH1cblxuICByZW1vdmVJRChldmVudCwgZW1haWxzKSB7XG4gICAgbGV0IF90aGlzID0gdGhpcztcbiAgICBsZXQgcm93ID0gZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgICBsZXQgaWRUb1JlbW92ZSA9IHJvdy5jaGlsZHJlblswXS50ZXh0Q29udGVudDtcbiAgICBsZXQgZG9tYWluID0gcm93LmNoaWxkcmVuWzFdLnRleHRDb250ZW50O1xuXG4gICAgX3RoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygndW5yZWdpc3RlcklkZW50aXR5JywgeyBlbWFpbDogaWRUb1JlbW92ZSB9KS50aGVuKCgpID0+IHtcbiAgICAgIGxldCBudW1FbWFpbHMgPSBlbWFpbHMubGVuZ3RoO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1FbWFpbHM7IGkrKykge1xuICAgICAgICBpZiAoZW1haWxzW2ldLmVtYWlsID09PSBpZFRvUmVtb3ZlKSB7XG4gICAgICAgICAgZW1haWxzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLy9cbiAgICAgIF90aGlzLnNob3dJZGVudGl0aWVzKGVtYWlscywgdHJ1ZSk7XG4gICAgfSk7XG5cbiAgICAvL190aGlzLmlkZW50aXR5TW9kdWxlLnVucmVnaXN0ZXJJZGVudGl0eShpZFRvUmVtb3ZlKTtcblxuICB9XG5cbiAgbG9naW5XaXRoSURQKGV2ZW50KSB7XG5cbiAgICAvLyBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgZWwgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgIGNvbnN0IGlkcCA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1pZHAnKTtcblxuICAgIGNvbnNvbGUubG9nKCd0aGlzOicsIHRoaXMsIGlkcCk7XG5cbiAgICBsZXQgX3B1YmxpY0tleTtcbiAgICB0aGlzLmNhbGxJZGVudGl0eU1vZHVsZUZ1bmMoJ2dldE15UHVibGljS2V5Jywge30pXG4gICAgICAudGhlbigocHVibGljS2V5KSA9PiB7XG4gICAgICAgIF9wdWJsaWNLZXkgPSBwdWJsaWNLZXk7XG4gICAgICAgIGNvbnN0IGRhdGEgPSB7IGNvbnRlbnRzOiBwdWJsaWNLZXksIG9yaWdpbjogJ29yaWdpbicsIHVzZXJuYW1lSGludDogdW5kZWZpbmVkLCBpZHBEb21haW46IGlkcCB9O1xuICAgICAgICByZXR1cm4gdGhpcy5jYWxsSWRlbnRpdHlNb2R1bGVGdW5jKCdzZW5kR2VuZXJhdGVNZXNzYWdlJywgZGF0YSk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKHZhbHVlKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbSWRlbnRpdGllc0dVSS5vYnRhaW5OZXdJZGVudGl0eV0gcmVjZWl2ZWRVUkwgZnJvbSBpZHAgUHJveHk6ICcgKyB2YWx1ZS5sb2dpblVybC5zdWJzdHJpbmcoMCwgMjApICsgJy4uLicpO1xuXG4gICAgICAgIGxldCB1cmwgPSB2YWx1ZS5sb2dpblVybDtcbiAgICAgICAgbGV0IGZpbmFsVVJMO1xuXG4gICAgICAgIC8vY2hlY2sgaWYgdGhlIHJlY2VpdmVkVVJMIGNvbnRhaW5zIHRoZSByZWRpcmVjdCBmaWVsZCBhbmQgcmVwbGFjZSBpdFxuICAgICAgICBpZiAodXJsLmluZGV4T2YoJ3JlZGlyZWN0X3VyaScpICE9PSAtMSkge1xuICAgICAgICAgIGxldCBmaXJzdFBhcnQgPSB1cmwuc3Vic3RyaW5nKDAsIHVybC5pbmRleE9mKCdyZWRpcmVjdF91cmknKSk7XG4gICAgICAgICAgbGV0IHNlY29uZEF1eFBhcnQgPSB1cmwuc3Vic3RyaW5nKHVybC5pbmRleE9mKCdyZWRpcmVjdF91cmknKSwgdXJsLmxlbmd0aCk7XG5cbiAgICAgICAgICBsZXQgc2Vjb25kUGFydCA9IHNlY29uZEF1eFBhcnQuc3Vic3RyaW5nKHNlY29uZEF1eFBhcnQuaW5kZXhPZignJicpLCB1cmwubGVuZ3RoKTtcblxuICAgICAgICAgIC8vY2hlY2sgaWYgdGhlIHJlZGRpcmVjdCBmaWVsZCBpcyB0aGUgbGFzdCBmaWVsZCBvZiB0aGUgVVJMXG4gICAgICAgICAgaWYgKHNlY29uZFBhcnQuaW5kZXhPZignJicpICE9PSAtMSkge1xuICAgICAgICAgICAgZmluYWxVUkwgPSBmaXJzdFBhcnQgKyAncmVkaXJlY3RfdXJpPScgKyBsb2NhdGlvbi5vcmlnaW4gKyBzZWNvbmRQYXJ0O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmaW5hbFVSTCA9IGZpcnN0UGFydCArICdyZWRpcmVjdF91cmk9JyArIGxvY2F0aW9uLm9yaWdpbjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlc3VsdFVSTCA9IGZpbmFsVVJMIHx8IHVybDtcblxuICAgICAgICBjb25zb2xlLmxvZygnQVFVSTonLCB0aGlzLnJlc3VsdFVSTCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2F1dGhlbnRpY2F0ZVVzZXIoX3B1YmxpY0tleSwgdmFsdWUsICdvcmlnaW4nLCBpZHApO1xuICAgICAgfSkudGhlbigoZW1haWwpID0+IHtcbiAgICAgICAgdGhpcy5fZHJhd2VyLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB7dHlwZTogJ2lkZW50aXR5JywgdmFsdWU6IGVtYWlsfTtcblxuICAgICAgICBjb25zb2xlLmxvZygnQVFVSTonLCB2YWx1ZSk7XG5cbiAgICAgICAgLy8gcmV0dXJuIHJlc29sdmUodmFsdWUpO1xuICAgICAgfSk7XG5cbiAgfVxuXG4gIC8vIG9idGFpbk5ld0lkZW50aXR5KGV2ZW50LCBjYWxsYmFjaywgdG9SZW1vdmVJRCkge1xuICAvLyAgIGxldCBfdGhpcyA9IHRoaXM7XG4gIC8vICAgbGV0IGlkUHJvdmlkZXIgPSBldmVudC50YXJnZXQudGV4dENvbnRlbnQ7XG4gIC8vICAgbGV0IGlkUHJvdmlkZXIyID0gZXZlbnQudGFyZ2V0LnRleHQ7XG5cbiAgLy8gICBfdGhpcy5jYWxsSWRlbnRpdHlNb2R1bGVGdW5jKCdnZXRNeVB1YmxpY0tleScsIHt9KS50aGVuKChwdWJsaWNLZXkpID0+IHtcbiAgLy8gICAgIC8vIGxldCBwdWJsaWNLZXkgPSBidG9hKGtleVBhaXIucHVibGljKTtcblxuICAvLyAgICAgX3RoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygnc2VuZEdlbmVyYXRlTWVzc2FnZScsXG4gIC8vICAgICAgIHsgY29udGVudHM6IHB1YmxpY0tleSwgb3JpZ2luOiAnb3JpZ2luJywgdXNlcm5hbWVIaW50OiB1bmRlZmluZWQsIGlkcERvbWFpbjogaWRQcm92aWRlciwgfSkudGhlbigodmFsdWUpID0+IHtcbiAgLy8gICAgICAgY29uc29sZS5sb2coJ1tJZGVudGl0aWVzR1VJLm9idGFpbk5ld0lkZW50aXR5XSByZWNlaXZlZFVSTCBmcm9tIGlkcCBQcm94eTogJyArIHZhbHVlLmxvZ2luVXJsLnN1YnN0cmluZygwLCAyMCkgKyAnLi4uJyk7XG5cbiAgLy8gICAgICAgbGV0IHVybCA9IHZhbHVlLmxvZ2luVXJsO1xuICAvLyAgICAgICBsZXQgZmluYWxVUkw7XG5cbiAgLy8gICAgICAgLy9jaGVjayBpZiB0aGUgcmVjZWl2ZWRVUkwgY29udGFpbnMgdGhlIHJlZGlyZWN0IGZpZWxkIGFuZCByZXBsYWNlIGl0XG4gIC8vICAgICAgIGlmICh1cmwuaW5kZXhPZigncmVkaXJlY3RfdXJpJykgIT09IC0xKSB7XG4gIC8vICAgICAgICAgbGV0IGZpcnN0UGFydCA9IHVybC5zdWJzdHJpbmcoMCwgdXJsLmluZGV4T2YoJ3JlZGlyZWN0X3VyaScpKTtcbiAgLy8gICAgICAgICBsZXQgc2Vjb25kQXV4UGFydCA9IHVybC5zdWJzdHJpbmcodXJsLmluZGV4T2YoJ3JlZGlyZWN0X3VyaScpLCB1cmwubGVuZ3RoKTtcblxuICAvLyAgICAgICAgIGxldCBzZWNvbmRQYXJ0ID0gc2Vjb25kQXV4UGFydC5zdWJzdHJpbmcoc2Vjb25kQXV4UGFydC5pbmRleE9mKCcmJyksIHVybC5sZW5ndGgpO1xuXG4gIC8vICAgICAgICAgLy9jaGVjayBpZiB0aGUgcmVkZGlyZWN0IGZpZWxkIGlzIHRoZSBsYXN0IGZpZWxkIG9mIHRoZSBVUkxcbiAgLy8gICAgICAgICBpZiAoc2Vjb25kUGFydC5pbmRleE9mKCcmJykgIT09IC0xKSB7XG4gIC8vICAgICAgICAgICBmaW5hbFVSTCA9IGZpcnN0UGFydCArICdyZWRpcmVjdF91cmk9JyArIGxvY2F0aW9uLm9yaWdpbiArIHNlY29uZFBhcnQ7XG4gIC8vICAgICAgICAgfSBlbHNlIHtcbiAgLy8gICAgICAgICAgIGZpbmFsVVJMID0gZmlyc3RQYXJ0ICsgJ3JlZGlyZWN0X3VyaT0nICsgbG9jYXRpb24ub3JpZ2luO1xuICAvLyAgICAgICAgIH1cbiAgLy8gICAgICAgfVxuXG4gIC8vICAgICAgIF90aGlzLnJlc3VsdFVSTCA9IGZpbmFsVVJMIHx8IHVybDtcblxuICAvLyAgICAgICAkKCcubG9naW4taWRwJykuaHRtbCgnPHA+Q2hvc2VuIElEUDogJyArIGlkUHJvdmlkZXIgKyAnPC9wPicpO1xuICAvLyAgICAgICAkKCcubG9naW4nKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAvLyAgICAgICAkKCcubG9naW4tYnRuJykub2ZmKCk7XG4gIC8vICAgICAgICQoJy5sb2dpbi1idG4nKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgLy8gICAgICAgICAkKCcubG9naW4nKS5hZGRDbGFzcygnaGlkZScpO1xuICAvLyAgICAgICAgIC8vIF90aGlzLl9hdXRoZW50aWNhdGVVc2VyKHB1YmxpY0tleSwgdmFsdWUsICdvcmlnaW4nLCBpZFByb3ZpZGVyKS50aGVuKChlbWFpbCkgPT4ge1xuICAvLyAgICAgICAgIC8vICAgY2FsbGJhY2soZW1haWwpO1xuICAvLyAgICAgICAgIC8vICAgX3RoaXMuc2hvd0lkZW50aXRpZXNHVUkoKTtcbiAgLy8gICAgICAgICAvLyB9KTtcbiAgLy8gICAgICAgfSk7XG4gIC8vICAgICB9KTtcbiAgLy8gICB9KS5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coJ29idGFuaW4gbmV3IGlkZW50aXR5JywgZXJyKSk7XG5cbiAgLy8gfVxuXG4gIF9nZXRMaXN0KGl0ZW1zKSB7XG4gICAgbGV0IGxpc3QgPSAnJztcbiAgICBsZXQgbnVtSXRlbXMgPSBpdGVtcy5sZW5ndGg7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUl0ZW1zOyBpKyspIHtcbiAgICAgIGxpc3QgKz0gJzxsaSBjbGFzcz1cImRpdmlkZXJcIj48L2xpPic7XG4gICAgICBsaXN0ICs9ICc8bGk+PGEgY2xhc3M9XCJjZW50ZXItYWxpZ25cIj4nICsgaXRlbXNbaV0gKyAnPC9hPjwvbGk+JztcbiAgICB9XG5cbiAgICByZXR1cm4gbGlzdDtcbiAgfVxuXG4gIF9hdXRoZW50aWNhdGVVc2VyKHB1YmxpY0tleSwgdmFsdWUsIG9yaWdpbiwgaWRQcm92aWRlcikge1xuICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgbGV0IHVybCA9IF90aGlzLnJlc3VsdFVSTDtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgIGNvbnNvbGUubG9nKCdPUEVOUE9VUDogJywgdXJsKTtcblxuICAgICAgX3RoaXMub3BlblBvcHVwKHVybCkudGhlbigoaWRlbnRpdHkpID0+IHtcblxuICAgICAgICBfdGhpcy5jYWxsSWRlbnRpdHlNb2R1bGVGdW5jKCdzZW5kR2VuZXJhdGVNZXNzYWdlJyxcbiAgICAgICAgICB7IGNvbnRlbnRzOiBwdWJsaWNLZXksIG9yaWdpbjogb3JpZ2luLCB1c2VybmFtZUhpbnQ6IGlkZW50aXR5LCBpZHBEb21haW46IGlkUHJvdmlkZXIgfSkudGhlbigocmVzdWx0KSA9PiB7XG5cbiAgICAgICAgICBpZiAocmVzdWx0KSB7XG5cbiAgICAgICAgICAgLy9fdGhpcy5pZGVudGl0eU1vZHVsZS5zdG9yZUlkZW50aXR5KHJlc3VsdCwga2V5UGFpcikudGhlbigodmFsdWUpID0+IHtcbiAgICAgICAgICAgX3RoaXMuY2FsbElkZW50aXR5TW9kdWxlRnVuYygnYWRkQXNzZXJ0aW9uJywgcmVzdWx0KS50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgIHJlc29sdmUodmFsdWUudXNlclByb2ZpbGUudXNlclVSTCk7XG4gICAgICAgICAgIH0sIChlcnIpID0+IHtcbiAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICByZWplY3QoJ2Vycm9yIG9uIG9idGFpbmluZyBpZGVudGl0eSBpbmZvcm1hdGlvbicpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIH0pO1xuICAgICAgICAgfSwgKGVycikgPT4ge1xuICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbl9yZXNldElkZW50aXRpZXMoKSB7XG4gIGNvbnNvbGUubG9nKCdfcmVzZXRJZGVudGl0aWVzJyk7XG59XG5cblxufVxuXG5leHBvcnQgZGVmYXVsdCBJZGVudGl0aWVzR1VJO1xuIl19"}